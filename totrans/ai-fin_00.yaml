- en: Preface
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Will alpha eventually go to zero for every imaginable investment strategy? More
    fundamentally, is the day approaching when, thanks to so many smart people and
    smarter computers, financial markets really do become perfect, and we can just
    sit back, relax, and assume that all assets are priced correctly?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Robert Shiller (2015)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Artificial intelligence (AI) rose to become a key technology in the 2010s and
    is assumed to be the dominating technology in the 2020s. Spurred by technological
    innovations, algorithmic breakthroughs, availability of big data, and ever-increasing
    compute power, many industries are undergoing fundamental changes driven by AI.
  prefs: []
  type: TYPE_NORMAL
- en: While media and public attention mostly focus on breakthroughs in areas such
    as gaming and self-driving cars, AI has also become a major technological force
    in the financial industry. However, it is safe to say that AI in finance is still
    at a nascent stage—as compared, for example, to industries such as web search
    or social media.
  prefs: []
  type: TYPE_NORMAL
- en: 'This book sets out to cover a number of important aspects related to AI in
    finance. AI in finance is already a vast topic, and a single book needs to focus
    on selected aspects. Therefore, this book covers the basics first (see [Part I](part01.xhtml#part_introduction)
    and [Part II](part02.xhtml#part_background)). It then zooms in on discovering
    *statistical inefficiencies* in financial markets by the use of AI and, more specifically,
    neural networks (see [Part III](part03.xhtml#part_statistical_inefficiencies)).
    Such inefficiencies—embodied by AI algorithms that successfully predict future
    market movements—are a prerequisite for the exploitation of *economic inefficiencies*
    through algorithmic trading (see [Part IV](part04.xhtml#part_economic_inefficiencies)).
    Being able to systematically exploit statistical and economic inefficiencies would
    prove contradictory to one of the established theories and cornerstones in finance:
    the *efficient market hypothesis* (EMH). The design of a successful *trading bot*
    can be considered the holy grail in finance to which AI might lead the way. This
    book concludes by discussing consequences of AI for the financial industry and
    the possibility of a financial singularity (see [Part V](part05.xhtml#part_outlook)).
    There is also a technical appendix that shows how to build neural networks from
    scratch based on plain Python code and provides additional examples for their
    application (see [Part VI](part06.xhtml#part_appendices)).'
  prefs: []
  type: TYPE_NORMAL
- en: The problem of applying AI to finance is not too dissimilar to the problem of
    applying AI to other fields. Some major breakthroughs in AI in the 2010s were
    made possible by the application of reinforcement learning (RL) to playing arcade
    games, such as those from Atari published in the 1980s (see Mnih et al. 2013),
    and to board games, such as chess or Go (see Silver et al. 2016). Lessons learned
    from applying RL in gaming contexts, among other areas, are today applied to such
    challenging problems as designing and building autonomous vehicles or improving
    medical diagnostics. [Table P-1](#pre_table_comparison) compares the application
    of AI and RL in different domains.
  prefs: []
  type: TYPE_NORMAL
- en: Table P-1\. Comparison of AI in different domains
  prefs: []
  type: TYPE_NORMAL
- en: '| Domain | Agent | Goal | Approach | Reward | Obstacle | Risks |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| **Arcade games** | AI agent (software) | Maximizing game score | RL in virtual
    gaming environment | Points and scores | Planning and delayed rewards | None |'
  prefs: []
  type: TYPE_TB
- en: '| **Autonomous driving** | Self-driving car (software + car) | Safely driving
    from location A to B | RL in virtual (gaming) environment, real-world test drives
    | Punishment for mistakes | Transition from virtual to physical world | Damaging
    property, harming people |'
  prefs: []
  type: TYPE_TB
- en: '| **Financial trading** | Trading bot (software) | Maximizing long-term performance
    | RL in virtual trading environment | Financial returns | Efficient markets and
    competition | Financial losses |'
  prefs: []
  type: TYPE_TB
- en: The beauty of training AI agents to play arcade games lies in the availability
    of a perfect virtual learning environment^([1](preface01.xhtml#idm45625349196776))
    and the absence of any kind of risk. With autonomous vehicles, the major problem
    arises when transitioning from virtual learning environments—for example, a computer
    game such as *Grand Theft Auto*—to the physical world with a self-driving car
    navigating real streets populated by other cars and people. This leads to serious
    risks such as a car causing accidents or harming people.
  prefs: []
  type: TYPE_NORMAL
- en: For a trading bot, RL can also be completely virtual, that is, in a simulated
    financial market environment. The major risks that arise from malfunctioning trading
    bots are financial losses and, on an aggregated level, potential systematic risks
    due to herding by trading bots. Overall, however, the financial domain seems like
    an ideal place to train, test, and deploy AI algorithms.
  prefs: []
  type: TYPE_NORMAL
- en: Given the rapid developments in the field, it should even be possible for an
    interested and ambitious student, equipped with a notebook and internet access,
    to successfully apply AI in a financial trading context. Beyond the hardware and
    software improvements over recent years, this is due primarily to the rise of
    online brokers that supply historical and real-time financial data and that allow
    the execution of financial trades via programmatic APIs.
  prefs: []
  type: TYPE_NORMAL
- en: The book is structured in the following six parts.
  prefs: []
  type: TYPE_NORMAL
- en: '[Part I](part01.xhtml#part_introduction)'
  prefs: []
  type: TYPE_NORMAL
- en: The first part discusses central notions and algorithms of AI in general, such
    as supervised learning and neural networks (see [Chapter 1](ch01.xhtml#artificial_intelligence)).
    It also discusses the concept of superintelligence, which relates to an AI agent
    that possesses human-level intelligence and, in some domains, superhuman-level
    intelligence (see [Chapter 2](ch02.xhtml#superintelligence)). Not every researcher
    in AI believes that superintelligence is possible in the foreseeable future. However,
    the discussion of this idea provides a valuable framework for discussing AI in
    general and AI for finance in particular.
  prefs: []
  type: TYPE_NORMAL
- en: '[Part II](part02.xhtml#part_background)'
  prefs: []
  type: TYPE_NORMAL
- en: The second part consists of four chapters and is about traditional, normative
    finance theory (see [Chapter 3](ch03.xhtml#normative_finance)) and how the field
    is transformed by data-driven finance (see [Chapter 4](ch04.xhtml#data_driven_finance))
    and machine learning (ML) (see [Chapter 5](ch05.xhtml#machine_learning)). Taken
    together, data-driven finance and ML give rise to a model-free, AI-first approach
    to finance, as discussed in [Chapter 6](ch06.xhtml#ai_first_finance).
  prefs: []
  type: TYPE_NORMAL
- en: '[Part III](part03.xhtml#part_statistical_inefficiencies)'
  prefs: []
  type: TYPE_NORMAL
- en: The third part is about discovering statistical inefficiencies in financial
    markets by applying deep learning, neural networks, and reinforcement learning.
    The part covers dense neural networks (DNNs, see [Chapter 7](ch07.xhtml#dense_networks)),
    recurrent neural networks (RNNs, see [Chapter 8](ch08.xhtml#recurrent_networks)),
    and algorithms from reinforcement learning (RL, see [Chapter 9](ch09.xhtml#reinforcement_learning))
    that in turn often rely on DNNs to represent and approximate the optimal policy
    of the AI agent.
  prefs: []
  type: TYPE_NORMAL
- en: '[Part IV](part04.xhtml#part_economic_inefficiencies)'
  prefs: []
  type: TYPE_NORMAL
- en: The fourth part discusses how to exploit statistical inefficiencies through
    algorithmic trading. Topics are vectorized backtesting (see [Chapter 10](ch10.xhtml#vectorized_backtesting)),
    event-based backtesting and risk management (see [Chapter 11](ch11.xhtml#risk_management)),
    and execution and deployment of AI-powered algorithmic trading strategies (see
    [Chapter 12](ch12.xhtml#execution_deployment)).
  prefs: []
  type: TYPE_NORMAL
- en: '[Part V](part05.xhtml#part_outlook)'
  prefs: []
  type: TYPE_NORMAL
- en: The fifth part is about the consequences that arise from AI-based competition
    in the financial industry (see [Chapter 13](ch13.xhtml#ai_based_competition)).
    It also discusses the possibility of a financial singularity, a point in time
    at which AI agents would dominate all aspects of finance as we know it. The discussion
    in this context focuses on artificial financial intelligences as trading bots
    that consistently generate trading profits above any human or institutional benchmark
    (see [Chapter 14](ch14.xhtml#financial_singularity)).
  prefs: []
  type: TYPE_NORMAL
- en: '[Part VI](part06.xhtml#part_appendices)'
  prefs: []
  type: TYPE_NORMAL
- en: The Appendix contains Python code for interactive neural network training (see
    [Appendix A](app01.xhtml#app_interactive_neural_networks)), classes for simple
    and shallow neural networks that are implemented from scratch based on plain Python
    code (see [Appendix B](app02.xhtml#app_neural_network_classes)), and an example
    of how to use convolutional neural networks (CNNs) for financial time series prediction
    (see [Appendix C](app03.xhtml#app_convolutional_neural_networks)).
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Papers and books cited in the preface:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Chollet, François. 2017\. *Deep Learning with Python*. Shelter Island: Manning.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Hilpisch, Yves. 2018\. *Python for Finance: Mastering Data-Driven Finance.*
    2nd ed. Sebastopol: O’Reilly.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '⸻. 2020\. *Python for Algorithmic Trading: From Idea to Cloud Deployment.*
    Sebastopol: O’Reilly.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Lee, Justina and Melissa Karsh. 2020\. “Machine-Learning Hedge Fund Voleon Group
    Returns 7% in 2019.” *Bloomberg*, January 21, 2020\. [*https://oreil.ly/TOQiv*](https://oreil.ly/TOQiv).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'López de Prado, Marcos. 2018\. *Advances in Financial Machine Learning*. Hoboken,
    NJ: John Wiley & Sons.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mnih, Volodymyr et al. 2013\. “Playing Atari with Deep Reinforcement Learning.”
    arXiv. December 19\. [*https://oreil.ly/-pW-1*](https://oreil.ly/-pW-1).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Shiller, Robert. 2015\. “The Mirage of the Financial Singularity.” Yale Insights.
    July 16\. [*https://oreil.ly/VRkP3*](https://oreil.ly/VRkP3).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Silver, David et al. 2016\. “Mastering the Game of Go with Deep Neural Networks
    and Tree Search.” *Nature* 529 (January): 484-489.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Conventions Used in This Book
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following typographical conventions are used in this book:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Italic*'
  prefs: []
  type: TYPE_NORMAL
- en: Indicates new terms, URLs, email addresses, filenames, and file extensions.
  prefs: []
  type: TYPE_NORMAL
- en: '`Constant width`'
  prefs: []
  type: TYPE_NORMAL
- en: Used for program listings, as well as within paragraphs to refer to program
    elements such as variable or function names, databases, data types, environment
    variables, statements, and keywords.
  prefs: []
  type: TYPE_NORMAL
- en: '**`Constant width bold`**'
  prefs: []
  type: TYPE_NORMAL
- en: Shows commands or other text that should be typed literally by the user.
  prefs: []
  type: TYPE_NORMAL
- en: '*`Constant width italic`*'
  prefs: []
  type: TYPE_NORMAL
- en: Shows text that should be replaced with user-supplied values or by values determined
    by context.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: This element signifies a tip or suggestion.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: This element signifies a general note.
  prefs: []
  type: TYPE_NORMAL
- en: Important
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: This element indicates important information.
  prefs: []
  type: TYPE_NORMAL
- en: Warning
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: This element indicates a warning or caution.
  prefs: []
  type: TYPE_NORMAL
- en: Using Code Examples
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can access and execute the code that accompanies the book on the Quant Platform
    at [*https://aiif.pqp.io*](https://aiif.pqp.io), for which only a free registration
    is required.
  prefs: []
  type: TYPE_NORMAL
- en: If you have a technical question or a problem using the code examples, please
    send an email to [*bookquestions@oreilly.com*](mailto:bookquestions@oreilly.com).
  prefs: []
  type: TYPE_NORMAL
- en: This book is here to help you get your job done. In general, if example code
    is offered with this book, you may use it in your programs and documentation.
    You do not need to contact us for permission unless you’re reproducing a significant
    portion of the code. For example, writing a program that uses several chunks of
    code from this book does not require permission. Selling or distributing examples
    from O’Reilly books does require permission. Answering a question by citing this
    book and quoting example code does not require permission. Incorporating a significant
    amount of example code from this book into your product’s documentation does require
    permission.
  prefs: []
  type: TYPE_NORMAL
- en: 'We appreciate, but generally do not require, attribution. An attribution usually
    includes the title, author, publisher, and ISBN. For example, this book may be
    attributed as: “*Artificial Intelligence in Finance* by Yves Hilpisch (O’Reilly).
    Copyright 2021 Yves Hilpisch, 978-1-492-05543-3.”'
  prefs: []
  type: TYPE_NORMAL
- en: If you feel your use of code examples falls outside fair use or the permission
    given above, feel free to contact us at [*permissions@oreilly.com*](mailto:permissions@oreilly.com).
  prefs: []
  type: TYPE_NORMAL
- en: O’Reilly Online Learning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: For more than 40 years, [*O’Reilly Media*](http://oreilly.com) has provided
    technology and business training, knowledge, and insight to help companies succeed.
  prefs: []
  type: TYPE_NORMAL
- en: Our unique network of experts and innovators share their knowledge and expertise
    through books, articles, and our online learning platform. O’Reilly’s online learning
    platform gives you on-demand access to live training courses, in-depth learning
    paths, interactive coding environments, and a vast collection of text and video
    from O’Reilly and 200+ other publishers. For more information, visit [*http://oreilly.com*](http://oreilly.com).
  prefs: []
  type: TYPE_NORMAL
- en: How to Contact Us
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Please address comments and questions concerning this book to the publisher:'
  prefs: []
  type: TYPE_NORMAL
- en: O’Reilly Media, Inc.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 1005 Gravenstein Highway North
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sebastopol, CA 95472
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 800-998-9938 (in the United States or Canada)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 707-829-0515 (international or local)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 707-829-0104 (fax)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We have a web page for this book, where we list errata, examples, and any additional
    information. You can access this page at [*https://oreil.ly/ai-in-finance*](https://oreil.ly/ai-in-finance).
  prefs: []
  type: TYPE_NORMAL
- en: Email [*bookquestions@oreilly.com*](mailto:bookquestions@oreilly.com) to comment
    or ask technical questions about this book.
  prefs: []
  type: TYPE_NORMAL
- en: For news and information about our books and courses, visit [*http://oreilly.com*](http://oreilly.com).
  prefs: []
  type: TYPE_NORMAL
- en: 'Find us on Facebook: [*http://facebook.com/oreilly*](http://facebook.com/oreilly)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Follow us on Twitter: [*http://twitter.com/oreillymedia*](http://twitter.com/oreillymedia)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Watch us on YouTube: [*http://www.youtube.com/oreillymedia*](http://www.youtube.com/oreillymedia)'
  prefs: []
  type: TYPE_NORMAL
- en: Acknowledgments
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I want to thank the technical reviewers—Margaret Maynard-Reid, Dr. Tim Nugent,
    and Dr. Abdullah Karasan—who did a great job in helping me improve the contents
    of the book.
  prefs: []
  type: TYPE_NORMAL
- en: Delegates of the Certificate Programs in Python for Computational Finance and
    Algorithmic Trading also helped improve this book. Their ongoing feedback has
    enabled me to weed out errors and mistakes and refine the code and notebooks used
    in our online training classes and now, finally, in this book.
  prefs: []
  type: TYPE_NORMAL
- en: The same holds true for the team members of The Python Quants and The AI Machine.
    In particular, Michael Schwed, Ramanathan Ramakrishnamoorthy, and Prem Jebaseelan
    support me in numerous ways. They are the ones who assist me with the difficult
    technical problems that arise during the writing of a book like this one.
  prefs: []
  type: TYPE_NORMAL
- en: I would also like to thank the whole team at O’Reilly Media—especially Michelle
    Smith, Corbin Collins, Victoria DeRose, and Danny Elfanbaum—for making it all
    happen and helping me refine the book in so many ways.
  prefs: []
  type: TYPE_NORMAL
- en: Of course, all remaining errors are mine alone.
  prefs: []
  type: TYPE_NORMAL
- en: Furthermore, I would also like to thank the team at Refinitiv—in particular,
    Jason Ramchandani—for providing ongoing support and access to financial data.
    The major data files used throughout the book and made available to the readers
    were received in one way or another from Refinitiv’s data APIs.
  prefs: []
  type: TYPE_NORMAL
- en: 'Of course, everybody making use of artificial intelligence and machine learning
    today benefits from the achievements and contributions of so many others. Therefore,
    we should always recall what Sir Isaac Newton wrote in 1675: “If I have seen further
    it is by standing on the shoulders of Giants.” In that sense, a big thank you
    to all the researchers and open source maintainers contributing to the field.'
  prefs: []
  type: TYPE_NORMAL
- en: Finally, special thanks go to my family, who support me all year round in my
    business and book-writing activities. In particular, I thank my wife Sandra for
    relentlessly taking care of us all and for providing us with a home and environment
    that we all love so much. I dedicate this book to my lovely wife Sandra and my
    wonderful son Henry.
  prefs: []
  type: TYPE_NORMAL
- en: ^([1](preface01.xhtml#idm45625349196776-marker)) See the [Arcade Learning Environment](https://oreil.ly/bGgZs).
  prefs: []
  type: TYPE_NORMAL
