<html><head></head><body><div id="sbo-rt-content"><section data-type="appendix" epub:type="appendix" data-pdf-bookmark="Appendix C. Convolutional Neural Networks"><div class="appendix" id="app_convolutional_neural_networks">
<h1><span class="label">Appendix C. </span>Convolutional Neural Networks</h1>


<p><a data-type="xref" href="part03.xhtml#part_statistical_inefficiencies">Part III</a> focuses on dense neural networks (DNNs) and recurrent neural networks (RNNs) as two standard types of neural networks. The charm of DNNs lies in the fact that they are good universal approximators. The examples in the book for reinforcement learning, for instance, make use of DNNs to approximate the optimal action policy. On the other hand, RNNs are specifically designed to handle sequential data, such as time series data. This is helpful when trying, for example, to predict future values of financial time series.</p>

<p><a data-type="indexterm" data-primary="neural networks" data-secondary="CNNs" id="ix_nn_CNNs_appc"/><a data-type="indexterm" data-primary="DL (deep learning)" data-secondary="convolutional neural networks" id="ix_DL_CNNs_appc"/><a data-type="indexterm" data-primary="CNNs (convolutional neural networks)" id="ix_CNNs_appc"/>However, <em>convolutional neural networks</em> (CNNs) are another standard type of neural network that is widely used in practice. <a data-type="indexterm" data-primary="computer vision, and CNNs" id="idm45625227193096"/>They have been particularly successful, among other domains, in computer vision. CNNs were able to set new benchmarks in a number of standard tests and challenges, such as the ImageNet Challenge; for more on this, see <em>The Economist</em> (2016) or Gerrish (2018). Computer vision in turn is important in such domains as autonomous vehicles or security and surveillance.</p>

<p><a data-type="indexterm" data-primary="market prediction" data-secondary="with CNNs" data-secondary-sortas="CNNs" id="ix_market_predict_CNNs"/>This brief appendix illustrates the application of a CNN to the prediction of financial time series data. For details on CNNs, see Chollet (2017, ch. 5) and Goodfellow et al. (2016, ch. 9).</p>






<section data-type="sect1" data-pdf-bookmark="Features and Labels Data"><div class="sect1" id="idm45625227151576">
<h1>Features and Labels Data</h1>

<p>The following Python code first takes care of the required imports and customizations. It then imports the data set that contains end-of-day (EOD) data for a number of financial instruments. This data set is used throughout the book for different examples:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">os</code><code>
</code><code>        </code><code class="kn">import</code><code> </code><code class="nn">math</code><code>
</code><code>        </code><code class="kn">import</code><code> </code><code class="nn">numpy</code><code> </code><code class="kn">as</code><code> </code><code class="nn">np</code><code>
</code><code>        </code><code class="kn">import</code><code> </code><code class="nn">pandas</code><code> </code><code class="kn">as</code><code> </code><code class="nn">pd</code><code>
</code><code>        </code><code class="kn">from</code><code> </code><code class="nn">pylab</code><code> </code><code class="kn">import</code><code> </code><code class="n">plt</code><code class="p">,</code><code> </code><code class="n">mpl</code><code>
</code><code>        </code><code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'</code><code class="s1">seaborn</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>        </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s1">'</code><code class="s1">savefig.dpi</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">300</code><code>
</code><code>        </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s1">'</code><code class="s1">font.family</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">serif</code><code class="s1">'</code><code>
</code><code>        </code><code class="n">os</code><code class="o">.</code><code class="n">environ</code><code class="p">[</code><code class="s1">'</code><code class="s1">PYTHONHASHSEED</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">0</code><code class="s1">'</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">2</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">url</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">http://hilpisch.com/aiif_eikon_eod_data.csv</code><code class="s1">'</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO1-1" href="#callout_convolutional_neural_networks_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">3</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">symbol</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">EUR=</code><code class="s1">'</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO1-2" href="#callout_convolutional_neural_networks_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="n">url</code><code class="p">,</code><code> </code><code class="n">index_col</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code><code>
</code><code>                                        </code><code class="n">parse_dates</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code><code class="o">.</code><code class="n">dropna</code><code class="p">(</code><code class="p">)</code><code class="p">[</code><code class="n">symbol</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO1-3" href="#callout_convolutional_neural_networks_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO1-4" href="#callout_convolutional_neural_networks_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>        </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>
</code><code>        </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">2516</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2010</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">04</code><code> </code><code class="n">to</code><code> </code><code class="mi">2019</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>
</code><code>        </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">1</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>
</code><code>         </code><code class="c1">#   Column  Non-Null Count  Dtype</code><code>
</code><code>        </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>
</code><code>         </code><code class="mi">0</code><code>   </code><code class="n">EUR</code><code class="o">=</code><code>    </code><code class="mi">2516</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>   </code><code class="n">float64</code><code>
</code><code>        </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code>
</code><code>        </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">39.3</code><code> </code><code class="n">KB</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_convolutional_neural_networks_CO1-1" href="#co_convolutional_neural_networks_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Retrieves and selects the financial time series data</p></dd>
</dl>

<p>The next step is to generate the features data, lag the data, split it into training and test data sets, and finally normalize it based on the statistics of the training data set:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">lags</code><code> </code><code class="o">=</code><code> </code><code class="mi">5</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">features</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="n">symbol</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">d</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">sma</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">min</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">max</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">mom</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">vol</code><code class="s1">'</code><code class="p">]</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">add_lags</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="n">symbol</code><code class="p">,</code><code> </code><code class="n">lags</code><code class="p">,</code><code> </code><code class="n">window</code><code class="o">=</code><code class="mi">20</code><code class="p">,</code><code> </code><code class="n">features</code><code class="o">=</code><code class="n">features</code><code class="p">)</code><code class="p">:</code><code>
</code><code>            </code><code class="n">cols</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>
</code><code>            </code><code class="n">df</code><code> </code><code class="o">=</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">copy</code><code class="p">(</code><code class="p">)</code><code>
</code><code>            </code><code class="n">df</code><code class="o">.</code><code class="n">dropna</code><code class="p">(</code><code class="n">inplace</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code><code>
</code><code>            </code><code class="n">df</code><code class="p">[</code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">log</code><code class="p">(</code><code class="n">df</code><code> </code><code class="o">/</code><code> </code><code class="n">df</code><code class="o">.</code><code class="n">shift</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code>
</code><code>            </code><code class="n">df</code><code class="p">[</code><code class="s1">'</code><code class="s1">sma</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">df</code><code class="p">[</code><code class="n">symbol</code><code class="p">]</code><code class="o">.</code><code class="n">rolling</code><code class="p">(</code><code class="n">window</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO2-1" href="#callout_convolutional_neural_networks_CO2-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>            </code><code class="n">df</code><code class="p">[</code><code class="s1">'</code><code class="s1">min</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">df</code><code class="p">[</code><code class="n">symbol</code><code class="p">]</code><code class="o">.</code><code class="n">rolling</code><code class="p">(</code><code class="n">window</code><code class="p">)</code><code class="o">.</code><code class="n">min</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO2-2" href="#callout_convolutional_neural_networks_CO2-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>            </code><code class="n">df</code><code class="p">[</code><code class="s1">'</code><code class="s1">max</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">df</code><code class="p">[</code><code class="n">symbol</code><code class="p">]</code><code class="o">.</code><code class="n">rolling</code><code class="p">(</code><code class="n">window</code><code class="p">)</code><code class="o">.</code><code class="n">max</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO2-3" href="#callout_convolutional_neural_networks_CO2-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>            </code><code class="n">df</code><code class="p">[</code><code class="s1">'</code><code class="s1">mom</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">df</code><code class="p">[</code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">rolling</code><code class="p">(</code><code class="n">window</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO2-4" href="#callout_convolutional_neural_networks_CO2-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>            </code><code class="n">df</code><code class="p">[</code><code class="s1">'</code><code class="s1">vol</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">df</code><code class="p">[</code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">rolling</code><code class="p">(</code><code class="n">window</code><code class="p">)</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO2-5" href="#callout_convolutional_neural_networks_CO2-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code>            </code><code class="n">df</code><code class="o">.</code><code class="n">dropna</code><code class="p">(</code><code class="n">inplace</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code><code>
</code><code>            </code><code class="n">df</code><code class="p">[</code><code class="s1">'</code><code class="s1">d</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">where</code><code class="p">(</code><code class="n">df</code><code class="p">[</code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code>
</code><code>            </code><code class="k">for</code><code> </code><code class="n">f</code><code> </code><code class="ow">in</code><code> </code><code class="n">features</code><code class="p">:</code><code>
</code><code>                </code><code class="k">for</code><code> </code><code class="n">lag</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">lags</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">:</code><code>
</code><code>                    </code><code class="n">col</code><code> </code><code class="o">=</code><code> </code><code class="n">f</code><code class="s1">'</code><code class="s1">{f}_lag_{lag}</code><code class="s1">'</code><code>
</code><code>                    </code><code class="n">df</code><code class="p">[</code><code class="n">col</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">df</code><code class="p">[</code><code class="n">f</code><code class="p">]</code><code class="o">.</code><code class="n">shift</code><code class="p">(</code><code class="n">lag</code><code class="p">)</code><code>
</code><code>                    </code><code class="n">cols</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">col</code><code class="p">)</code><code>
</code><code>            </code><code class="n">df</code><code class="o">.</code><code class="n">dropna</code><code class="p">(</code><code class="n">inplace</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code><code>
</code><code>            </code><code class="k">return</code><code> </code><code class="n">df</code><code class="p">,</code><code> </code><code class="n">cols</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">9</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="p">,</code><code> </code><code class="n">cols</code><code> </code><code class="o">=</code><code> </code><code class="n">add_lags</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="n">symbol</code><code class="p">,</code><code> </code><code class="n">lags</code><code class="p">,</code><code> </code><code class="n">window</code><code class="o">=</code><code class="mi">20</code><code class="p">,</code><code> </code><code class="n">features</code><code class="o">=</code><code class="n">features</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">split</code><code> </code><code class="o">=</code><code> </code><code class="nb">int</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">data</code><code class="p">)</code><code> </code><code class="o">*</code><code> </code><code class="mf">0.8</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">train</code><code> </code><code class="o">=</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="p">:</code><code class="n">split</code><code class="p">]</code><code class="o">.</code><code class="n">copy</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO2-6" href="#callout_convolutional_neural_networks_CO2-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">12</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">mu</code><code class="p">,</code><code> </code><code class="n">std</code><code> </code><code class="o">=</code><code> </code><code class="n">train</code><code class="p">[</code><code class="n">cols</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">train</code><code class="p">[</code><code class="n">cols</code><code class="p">]</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO2-7" href="#callout_convolutional_neural_networks_CO2-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">13</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">train</code><code class="p">[</code><code class="n">cols</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="n">train</code><code class="p">[</code><code class="n">cols</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="n">mu</code><code class="p">)</code><code> </code><code class="o">/</code><code> </code><code class="n">std</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO2-8" href="#callout_convolutional_neural_networks_CO2-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">14</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">test</code><code> </code><code class="o">=</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">split</code><code class="p">:</code><code class="p">]</code><code class="o">.</code><code class="n">copy</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO2-9" href="#callout_convolutional_neural_networks_CO2-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">15</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">test</code><code class="p">[</code><code class="n">cols</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="n">test</code><code class="p">[</code><code class="n">cols</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="n">mu</code><code class="p">)</code><code> </code><code class="o">/</code><code> </code><code class="n">std</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO2-10" href="#callout_convolutional_neural_networks_CO2-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_convolutional_neural_networks_CO2-1" href="#co_convolutional_neural_networks_CO2-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Simple moving average feature</p></dd>
<dt><a class="co" id="callout_convolutional_neural_networks_CO2-2" href="#co_convolutional_neural_networks_CO2-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Rolling minimum value feature</p></dd>
<dt><a class="co" id="callout_convolutional_neural_networks_CO2-3" href="#co_convolutional_neural_networks_CO2-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Rolling maximum value feature</p></dd>
<dt><a class="co" id="callout_convolutional_neural_networks_CO2-4" href="#co_convolutional_neural_networks_CO2-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Time series momentum feature</p></dd>
<dt><a class="co" id="callout_convolutional_neural_networks_CO2-5" href="#co_convolutional_neural_networks_CO2-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>Rolling volatility feature</p></dd>
<dt><a class="co" id="callout_convolutional_neural_networks_CO2-6" href="#co_convolutional_neural_networks_CO2-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>Gaussian normalization of training data set</p></dd>
<dt><a class="co" id="callout_convolutional_neural_networks_CO2-7" href="#co_convolutional_neural_networks_CO2-9"><img src="Images/7.png" alt="7" width="12" height="12"/></a></dt>
<dd><p>Gaussian normalization of test data set</p></dd>
</dl>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Training the Model"><div class="sect1" id="idm45625229706760">
<h1>Training the Model</h1>

<p>The implementation of CNNs is similar to that of DNNs. First, the Python code that follows takes care of the imports from <code>Keras</code> and the definition of the function to set all relevant seed values of the random number generators:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">16</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">random</code>
         <code class="kn">import</code> <code class="nn">tensorflow</code> <code class="kn">as</code> <code class="nn">tf</code>
         <code class="kn">from</code> <code class="nn">keras.models</code> <code class="kn">import</code> <code class="n">Sequential</code>
         <code class="kn">from</code> <code class="nn">keras.layers</code> <code class="kn">import</code> <code class="n">Dense</code><code class="p">,</code> <code class="n">Conv1D</code><code class="p">,</code> <code class="n">Flatten</code>
         <code class="n">Using</code> <code class="n">TensorFlow</code> <code class="n">backend</code><code class="o">.</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">17</code><code class="p">]:</code> <code class="k">def</code> <code class="nf">set_seeds</code><code class="p">(</code><code class="n">seed</code><code class="o">=</code><code class="mi">100</code><code class="p">):</code>
             <code class="n">random</code><code class="o">.</code><code class="n">seed</code><code class="p">(</code><code class="n">seed</code><code class="p">)</code>
             <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">seed</code><code class="p">(</code><code class="n">seed</code><code class="p">)</code>
             <code class="n">tf</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">set_seed</code><code class="p">(</code><code class="n">seed</code><code class="p">)</code></pre>
<div style="page-break-after: always;"/>

<p><a data-type="indexterm" data-primary="one-dimensional convolutional layer" id="idm45625227741336"/>The following Python code implements and trains a simple CNN. At the core of the model is a <em>one-dimensional convolutional layer</em> that is suited for time series data (see <a href="https://oreil.ly/AXQ33">Keras convolutional layers</a> for details):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">18</code><code class="p">]:</code> <code class="n">set_seeds</code><code class="p">()</code>
         <code class="n">model</code> <code class="o">=</code> <code class="n">Sequential</code><code class="p">()</code>
         <code class="n">model</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">Conv1D</code><code class="p">(</code><code class="n">filters</code><code class="o">=</code><code class="mi">96</code><code class="p">,</code> <code class="n">kernel_size</code><code class="o">=</code><code class="mi">5</code><code class="p">,</code> <code class="n">activation</code><code class="o">=</code><code class="s1">'relu'</code><code class="p">,</code>
                          <code class="n">input_shape</code><code class="o">=</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">cols</code><code class="p">),</code> <code class="mi">1</code><code class="p">)))</code>
         <code class="n">model</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">Flatten</code><code class="p">())</code>
         <code class="n">model</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">Dense</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="n">activation</code><code class="o">=</code><code class="s1">'relu'</code><code class="p">))</code>
         <code class="n">model</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">Dense</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="n">activation</code><code class="o">=</code><code class="s1">'sigmoid'</code><code class="p">))</code>

         <code class="n">model</code><code class="o">.</code><code class="n">compile</code><code class="p">(</code><code class="n">optimizer</code><code class="o">=</code><code class="s1">'adam'</code><code class="p">,</code>
                       <code class="n">loss</code><code class="o">=</code><code class="s1">'binary_crossentropy'</code><code class="p">,</code>
                       <code class="n">metrics</code><code class="o">=</code><code class="p">[</code><code class="s1">'accuracy'</code><code class="p">])</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">19</code><code class="p">]:</code> <code class="n">model</code><code class="o">.</code><code class="n">summary</code><code class="p">()</code>
         <code class="n">Model</code><code class="p">:</code> <code class="s2">"sequential_1"</code>
         <code class="n">_________________________________________________________________</code>
         <code class="n">Layer</code> <code class="p">(</code><code class="nb">type</code><code class="p">)</code>                 <code class="n">Output</code> <code class="n">Shape</code>              <code class="n">Param</code> <code class="c1">#</code>
         <code class="o">=================================================================</code>
         <code class="n">conv1d_1</code> <code class="p">(</code><code class="n">Conv1D</code><code class="p">)</code>            <code class="p">(</code><code class="bp">None</code><code class="p">,</code> <code class="mi">36</code><code class="p">,</code> <code class="mi">96</code><code class="p">)</code>            <code class="mi">576</code>
         <code class="n">_________________________________________________________________</code>
         <code class="n">flatten_1</code> <code class="p">(</code><code class="n">Flatten</code><code class="p">)</code>          <code class="p">(</code><code class="bp">None</code><code class="p">,</code> <code class="mi">3456</code><code class="p">)</code>              <code class="mi">0</code>
         <code class="n">_________________________________________________________________</code>
         <code class="n">dense_1</code> <code class="p">(</code><code class="n">Dense</code><code class="p">)</code>              <code class="p">(</code><code class="bp">None</code><code class="p">,</code> <code class="mi">10</code><code class="p">)</code>                <code class="mi">34570</code>
         <code class="n">_________________________________________________________________</code>
         <code class="n">dense_2</code> <code class="p">(</code><code class="n">Dense</code><code class="p">)</code>              <code class="p">(</code><code class="bp">None</code><code class="p">,</code> <code class="mi">1</code><code class="p">)</code>                 <code class="mi">11</code>
         <code class="o">=================================================================</code>
         <code class="n">Total</code> <code class="n">params</code><code class="p">:</code> <code class="mi">35</code><code class="p">,</code><code class="mi">157</code>
         <code class="n">Trainable</code> <code class="n">params</code><code class="p">:</code> <code class="mi">35</code><code class="p">,</code><code class="mi">157</code>
         <code class="n">Non</code><code class="o">-</code><code class="n">trainable</code> <code class="n">params</code><code class="p">:</code> <code class="mi">0</code>
         <code class="n">_________________________________________________________________</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">20</code><code class="p">]:</code> <code class="o">%%</code><code class="n">time</code>
         <code class="n">model</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">atleast_3d</code><code class="p">(</code><code class="n">train</code><code class="p">[</code><code class="n">cols</code><code class="p">]),</code> <code class="n">train</code><code class="p">[</code><code class="s1">'d'</code><code class="p">],</code>
                   <code class="n">epochs</code><code class="o">=</code><code class="mi">60</code><code class="p">,</code> <code class="n">batch_size</code><code class="o">=</code><code class="mi">48</code><code class="p">,</code> <code class="n">verbose</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code>
                   <code class="n">validation_split</code><code class="o">=</code><code class="mf">0.15</code><code class="p">,</code> <code class="n">shuffle</code><code class="o">=</code><code class="bp">False</code><code class="p">)</code>
         <code class="n">CPU</code> <code class="n">times</code><code class="p">:</code> <code class="n">user</code> <code class="mf">10.1</code> <code class="n">s</code><code class="p">,</code> <code class="n">sys</code><code class="p">:</code> <code class="mf">1.87</code> <code class="n">s</code><code class="p">,</code> <code class="n">total</code><code class="p">:</code> <code class="mi">12</code> <code class="n">s</code>
         <code class="n">Wall</code> <code class="n">time</code><code class="p">:</code> <code class="mf">4.78</code> <code class="n">s</code>

<code class="n">Out</code><code class="p">[</code><code class="mi">20</code><code class="p">]:</code> <code class="o">&lt;</code><code class="n">keras</code><code class="o">.</code><code class="n">callbacks</code><code class="o">.</code><code class="n">callbacks</code><code class="o">.</code><code class="n">History</code> <code class="n">at</code> <code class="mh">0x7ffe3f32b110</code><code class="o">&gt;</code></pre>

<p><a data-type="xref" href="#figure_cnn_01">Figure C-1</a> presents the performance metrics for the training and validation data sets over the different training epochs:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">21</code><code class="p">]:</code> <code class="n">res</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">model</code><code class="o">.</code><code class="n">history</code><code class="o">.</code><code class="n">history</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">22</code><code class="p">]:</code> <code class="n">res</code><code class="o">.</code><code class="n">tail</code><code class="p">(</code><code class="mi">3</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">22</code><code class="p">]:</code>     <code class="n">val_loss</code>  <code class="n">val_accuracy</code>      <code class="n">loss</code>  <code class="n">accuracy</code>
         <code class="mi">57</code>  <code class="mf">0.699932</code>      <code class="mf">0.508361</code>  <code class="mf">0.635633</code>  <code class="mf">0.597165</code>
         <code class="mi">58</code>  <code class="mf">0.719671</code>      <code class="mf">0.501672</code>  <code class="mf">0.634539</code>  <code class="mf">0.598937</code>
         <code class="mi">59</code>  <code class="mf">0.729954</code>      <code class="mf">0.505017</code>  <code class="mf">0.634403</code>  <code class="mf">0.601890</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">23</code><code class="p">]:</code> <code class="n">res</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mi">6</code><code class="p">));</code></pre>

<figure class="thumb"><div id="figure_cnn_01" class="figure">
<img src="Images/aiif_1701.png" alt="aiif 1701" width="2444" height="1421"/>
<h6><span class="label">Figure C-1. </span>Performance metrics for the training and validation of the CNN</h6>
</div></figure>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Testing the Model"><div class="sect1" id="idm45625226206760">
<h1>Testing the Model</h1>

<p>Finally, the Python code that follows applies the trained model to the test data set. The CNN model outperforms the passive benchmark investment significantly. However, taking into account transaction costs in the form of typical (retail) bid-ask spreads, it eats up larger parts of the outperformance. <a data-type="xref" href="#figure_cnn_02">Figure C-2</a> visualizes the performances over time:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">evaluate</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">atleast_3d</code><code class="p">(</code><code class="n">test</code><code class="p">[</code><code class="n">cols</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">d</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO3-1" href="#callout_convolutional_neural_networks_CO3-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>         </code><code class="mi">499</code><code class="o">/</code><code class="mi">499</code><code> </code><code class="p">[</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="mi">0</code><code class="n">s</code><code> </code><code class="mi">25</code><code class="n">us</code><code class="o">/</code><code class="n">step</code><code>
</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code> </code><code class="p">[</code><code class="mf">0.7364848222665653</code><code class="p">,</code><code> </code><code class="mf">0.5210421085357666</code><code class="p">]</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">p</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">where</code><code class="p">(</code><code class="n">model</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">atleast_3d</code><code class="p">(</code><code class="n">test</code><code class="p">[</code><code class="n">cols</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code> </code><code class="o">&gt;</code><code> </code><code class="mf">0.5</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">p</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">where</code><code class="p">(</code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">p</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mi">1</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO3-2" href="#callout_convolutional_neural_networks_CO3-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">p</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">value_counts</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO3-3" href="#callout_convolutional_neural_networks_CO3-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">-</code><code class="mi">1</code><code>    </code><code class="mi">478</code><code>
</code><code>          </code><code class="mi">1</code><code>     </code><code class="mi">21</code><code>
</code><code>         </code><code class="n">Name</code><code class="p">:</code><code> </code><code class="n">p</code><code class="p">,</code><code> </code><code class="n">dtype</code><code class="p">:</code><code> </code><code class="n">int64</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code> </code><code class="p">(</code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">p</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">diff</code><code class="p">(</code><code class="p">)</code><code> </code><code class="o">!=</code><code> </code><code class="mi">0</code><code class="p">)</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO3-4" href="#callout_convolutional_neural_networks_CO3-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mi">41</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">29</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">s</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">p</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">*</code><code> </code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">]</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO3-5" href="#callout_convolutional_neural_networks_CO3-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">ptc</code><code> </code><code class="o">=</code><code> </code><code class="mf">0.00012</code><code> </code><code class="o">/</code><code> </code><code class="n">test</code><code class="p">[</code><code class="n">symbol</code><code class="p">]</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO3-6" href="#callout_convolutional_neural_networks_CO3-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">31</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">s_</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">where</code><code class="p">(</code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">p</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">!=</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">s</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="n">ptc</code><code class="p">,</code><code> </code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">s</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" id="co_convolutional_neural_networks_CO3-7" href="#callout_convolutional_neural_networks_CO3-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">test</code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">s</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">s_</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">apply</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">exp</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">r</code><code>     </code><code class="mf">0.931992</code><code>
</code><code>         </code><code class="n">s</code><code>     </code><code class="mf">1.086525</code><code>
</code><code>         </code><code class="n">s_</code><code>    </code><code class="mf">1.031307</code><code>
</code><code>         </code><code class="n">dtype</code><code class="p">:</code><code> </code><code class="n">float64</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">test</code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">s</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">s_</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code class="o">.</code><code class="n">cumsum</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">apply</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">exp</code><code class="p">)</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_convolutional_neural_networks_CO3-1" href="#co_convolutional_neural_networks_CO3-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The accuracy ratio out-of-sample</p></dd>
<dt><a class="co" id="callout_convolutional_neural_networks_CO3-2" href="#co_convolutional_neural_networks_CO3-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>The positions (long/short) based on the predictions</p></dd>
<dt><a class="co" id="callout_convolutional_neural_networks_CO3-3" href="#co_convolutional_neural_networks_CO3-4"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>The number of trades resulting from the positions</p></dd>
<dt><a class="co" id="callout_convolutional_neural_networks_CO3-4" href="#co_convolutional_neural_networks_CO3-5"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Proportional transaction costs for given bid-ask spread</p></dd>
<dt><a class="co" id="callout_convolutional_neural_networks_CO3-5" href="#co_convolutional_neural_networks_CO3-6"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>The strategy performance <em>before</em> transaction costs</p></dd>
<dt><a class="co" id="callout_convolutional_neural_networks_CO3-6" href="#co_convolutional_neural_networks_CO3-7"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>The strategy performance <em>after</em> transaction costs<a data-type="indexterm" data-primary="" data-startref="ix_CNNs_appc" id="idm45625226157496"/><a data-type="indexterm" data-primary="" data-startref="ix_DL_CNNs_appc" id="idm45625226156488"/><a data-type="indexterm" data-primary="" data-startref="ix_market_predict_CNNs" id="idm45625226155544"/><a data-type="indexterm" data-primary="" data-startref="ix_nn_CNNs_appc" id="idm45625226154600"/></p></dd>
</dl>

<figure class="thumb"><div id="figure_cnn_02" class="figure">
<img src="Images/aiif_1702.png" alt="aiif 1702" width="2444" height="1428"/>
<h6><span class="label">Figure C-2. </span>Gross performance of passive benchmark investment and CNN strategy (before/after transaction costs)</h6>
</div></figure>
<div style="page-break-after: always;"/>
</div></section>













<section data-type="sect1" class="less_space" data-pdf-bookmark="Resources"><div class="sect1" id="idm45625226150856">
<h1>Resources</h1>

<p>Books and papers cited in this appendix:</p>

<ul class="author-date-bib">
<li>
<p>Chollet, François. 2017. <em>Deep Learning with Python</em>. Shelter Island: Manning.</p>
</li>
<li>
<p><em>Economist, The</em>. 2016. “From Not Working to Neural Networking.” <em>The Economist</em> Special Report, June 23, 2016. <a href="https://oreil.ly/6VvlS"><em class="hyperlink">https://oreil.ly/6VvlS</em></a>.</p>
</li>
<li>
<p>Gerrish, Sean. 2018. <em>How Smart Machines Think</em>. Cambridge: MIT Press.</p>
</li>
<li>
<p>Goodfellow, Ian, Yoshua Bengio, and Aaron Courville. 2016. <em>Deep Learning</em>. Cambridge: MIT Press. <a href="http://deeplearningbook.org"><em class="hyperlink">http://deeplearningbook.org</em></a>.</p>
</li>
</ul>
</div></section>







</div></section></div>



  </body></html>