<html><head></head><body><section data-pdf-bookmark="Chapter 7. Liquidity Modeling" data-type="chapter" epub:type="chapter"><div class="chapter" id="chapter_7">&#13;
<h1><span class="label">Chapter 7. </span>Liquidity Modeling</h1>&#13;
&#13;
<blockquote data-type="epigram">&#13;
<p> When the music stops, in terms of liquidity, things will be complicated. But as long as the music is playing, you’ve got to get up and dance. We’re still dancing.</p>&#13;
<p data-type="attribution">Chuck Prince (2007)</p>&#13;
</blockquote>&#13;
&#13;
<p><a data-primary="liquidity modeling" data-type="indexterm" id="ix_liquidity_model_ch7"/>Liquidity is another important source of financial risk. However, it has been long neglected, and the finance industry has paid a huge price for modeling risk without considering liquidity.</p>&#13;
&#13;
<p><a data-primary="liquidity risk" data-type="indexterm" id="idm45737218270752"/>The causes of liquidity risk are departures from the complete markets and symmetric information paradigm, which can lead to moral hazard and adverse selection. To the extent that such conditions persist, liquidity risk is endemic in the financial system and can cause a vicious link between funding and market liquidity, prompting systemic liquidity risk (Nikolaou 2009).</p>&#13;
&#13;
<p>Tapping into the time lag between a changing value of the variable and its impact on the real market turns out to be a success criterion in modeling. For instance, interest rates, to some extent, diverge from real market dynamics from time to time, and it takes some time to settle. Together with this, uncertainty is the solely source of risk in traditional asset pricing models; however, it is far from reality. To fill the gap between financial models and real-market dynamics, the liquidity dimension stands out. A model with liquidity can better adjust itself to developments in the financial markets in that liquidity affects both the required returns of assets and also the level of uncertainty. <a data-primary="probability approaches" data-secondary="liquidity’s role in default probability" data-type="indexterm" id="idm45737218268432"/>Thus, liquidity is quite an important dimension in estimating probability of default (Gaygisiz, Karasan, and Hekimoglu 2021).</p>&#13;
&#13;
<p><a data-primary="crisis periods" data-secondary="global financial crisis of 2007–2008" data-type="indexterm" id="idm45737218266832"/><a data-primary="global financial crisis of 2007–2008" data-type="indexterm" id="idm45737218265840"/>The importance of liquidity has been highlighted and has gained much attention since the global mortgage crisis broke out in 2007–2008. During this crisis, most financial institutions were hit hard by liquidity pressures, resulting in several strict measures taken by regulatory authorities and central banks. Since then, debates over the need to include liquidity, originating from the lack of tradable securities, have intensified.</p>&#13;
&#13;
<p>The concept of liquidity is multifaceted. <a data-primary="liquid asset" data-type="indexterm" id="idm45737218264192"/>By and large, a <em>liquid asset</em> is defined by the extent to which a large amount of it is sold without a considerable price impact. <a data-primary="transaction cost" data-type="indexterm" id="idm45737218262832"/>This is also known as <em>transaction cost</em>. This is, however, not the only important facet of liquidity. Rather, during a period of stress, resilience stands out as investors seek prompt price discovery (Sarr and Lybek 2002). This is pointed out by Kyle (1985): “Liquidity is a slippery and elusive concept, in part because it encompasses a number of transactional properties of markets.”</p>&#13;
&#13;
<p>With that said, liquidity is an ambiguous concept, and to define it we need to focus on its different dimensions. In the literature, different researchers come up with different dimensions of liquidity, but for the purposes of this book, we will identify four defining characteristics of liquidity:</p>&#13;
<dl>&#13;
<dt><a data-primary="tightness, liquidity dimension" data-type="indexterm" id="idm45737218259680"/>Tightness</dt>&#13;
<dd>&#13;
<p>The ability to trade an asset at the same price at the same time. This refers to the transaction cost occurring during a trade. If the transaction cost is high, the difference between buy and sell prices will be high or vice versa. So, a narrow transaction cost defines how tight the market is.</p>&#13;
</dd>&#13;
<dt><a data-primary="immediacy, liquidity dimension" data-type="indexterm" id="idm45737218257344"/>Immediacy</dt>&#13;
<dd>&#13;
<p>The speed at which a large amount of buy or sell orders can be traded. This dimension of liquidity provides us with valuable information about the financial market, as low immediacy refers to malfunctioning of parts of the market such as clearing, settlement, and so forth.</p>&#13;
</dd>&#13;
<dt><a data-primary="depth, liquidity dimension" data-type="indexterm" id="idm45737218255104"/>Depth</dt>&#13;
<dd>&#13;
<p>The presence of large numbers of buyers and sellers who are able to cover abundant orders at various prices.</p>&#13;
</dd>&#13;
<dt><a data-primary="resiliency, liquidity dimension" data-type="indexterm" id="idm45737218252976"/>Resiliency</dt>&#13;
<dd>&#13;
<p>A market’s ability to bounce back from nonequilibrium. It can be thought of as a price-recovery process in which order imbalance dies out quickly.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>Given the definition and interconnectedness of liquidity, it is not hard to see that modeling liquidity is a tough task. In the literature, many different types of liquidity models are proposed, however, considering the multidimensionality of liquidity, it may be wise to cluster the data depending on which dimension it captures. To this end, we will come up with different liquidity measures to represent all four dimensions. These liquidity measures are volume-based measures, transaction cost–based measures, price impact-based measures, and market-impact measures. For all these dimensions, several different liquidity proxies will be used.</p>&#13;
&#13;
<p><a data-primary="clustering method" data-secondary="liquidity measures" data-type="indexterm" id="idm45737218249744"/>Using clustering analysis, these liquidity measures will be clustered, which helps us to understand which part of liquidity an investor should focus on, because it is known that different dimensions of liquidity prevail in an economy during different time periods. Thus, once we are done with clustering analysis, we end up with a smaller number of liquidity measures. For the sake of clustering analysis, we will use the Gaussian mixture model (GMM) and the <a data-primary="GMCM (Gaussian mixture copula model)" data-type="indexterm" id="idm45737218248160"/><a data-primary="copula, Gaussian mixture model" data-type="indexterm" id="idm45737218247520"/>Gaussian mixture copula model (GMCM) to tackle this problem. <a data-primary="GMM (Gaussian mixture model)" data-type="indexterm" id="idm45737218246704"/>GMM is a widely recognized clustering model that works well under elliptical distribution. GMCM is an extension of the GMM in that we include a copula analysis to take correlation into account. We will discuss these models in detail, so let us start by identifying the liquidity measures based on different liquidity dimensions.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Liquidity Measures" data-type="sect1"><div class="sect1" id="idm45737218245408">&#13;
<h1>Liquidity Measures</h1>&#13;
&#13;
<p><a data-primary="liquidity modeling" data-secondary="liquidity measures" data-type="indexterm" id="ix_liquidity_model_meas_ch7"/>The role of liquidity has finally been recognized by finance practitioners and economists, which makes it even more important to understand and develop liquidity measurement. Existing literature concentrates on a single measure by which it is hard to conceptualize an elusive concept like liquidity. Instead, we will cover four dimensions to develop a more comprehensive application:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Volume</p>&#13;
</li>&#13;
<li>&#13;
<p>Transaction cost</p>&#13;
</li>&#13;
<li>&#13;
<p>Price impact</p>&#13;
</li>&#13;
<li>&#13;
<p>Market impact</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Let’s get started with the volume-based liquidity measures.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Volume-Based Liquidity Measures" data-type="sect2"><div class="sect2" id="idm45737218237728">&#13;
<h2>Volume-Based Liquidity Measures</h2>&#13;
&#13;
<p><a data-primary="volume-based liquidity measures" data-type="indexterm" id="ix_vol_based_liquidity_meas"/><a data-primary="liquidity modeling" data-secondary="liquidity measures" data-tertiary="volume-based" data-type="indexterm" id="ix_liquidity_model_meas_vol"/><a data-primary="depth, liquidity dimension" data-type="indexterm" id="idm45737218233824"/>Large orders are covered when the market has depth, that is, a deep financial market has the ability to meet abundant orders. This, in turn, provides information about the market, and if the market lacks depth, order imbalance and discontinuity emerge in the market. Given the market’s depth, volume-based liquidity measures can be used to distinguish liquid and illiquid assets. <a data-primary="bid-ask spread" data-secondary="in volume-based liquidity measures" data-secondary-sortas="volume-based liquidity measures" data-type="indexterm" id="idm45737218232608"/>Moreover, volume-based liquidity measures have a strong association with bid-ask spread: a large bid-ask spread implies low &#13;
<span class="keep-together">volume</span>, while a narrow bid-ask spread implies high volume (Huong and Gregoriou 2020).</p>&#13;
&#13;
<p>As you can imagine, a large portion&#13;
of the variation in liquidity arises from trading activities.&#13;
The importance of the volume-based approach is stressed by Blume, Easley, and O’Hara (1994) saying that volume traded generates information that cannot be extracted from alternative statistics.</p>&#13;
&#13;
<p>To properly represent the depth dimension of liquidity, the following volume-based measures will be introduced:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Liquidity ratio</p>&#13;
</li>&#13;
<li>&#13;
<p>Hui-Heubel ratio</p>&#13;
</li>&#13;
<li>&#13;
<p>Turnover ratio</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Liquidity ratio" data-type="sect3"><div class="sect3" id="idm45737218225936">&#13;
<h3>Liquidity ratio</h3>&#13;
&#13;
<p><a data-primary="volume-based liquidity measures" data-secondary="liquidity ratio" data-type="indexterm" id="ix_vol_meas_liquidity_ratio"/><a data-primary="liquidity ratio" data-type="indexterm" id="ix_liquidity_ratio"/>This ratio measures the extent to which volume is required to induce a price change of 1%:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign upper L upper R Subscript i t Baseline equals StartFraction sigma-summation Underscript t equals 1 Overscript upper T Endscripts upper P Subscript i t Baseline upper V Subscript i t Baseline Over sigma-summation Underscript t equals 1 Overscript upper T Endscripts StartAbsoluteValue upper P upper C Subscript i t Baseline EndAbsoluteValue EndFraction dollar-sign">&#13;
  <mrow>&#13;
    <mi>L</mi>&#13;
    <msub><mi>R</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
    <mo>=</mo>&#13;
    <mfrac><mrow><msubsup><mo>∑</mo> <mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow> <mi>T</mi> </msubsup><msub><mi>P</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub><msub><mi>V</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub></mrow> <mrow><msubsup><mo>∑</mo> <mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow> <mi>T</mi> </msubsup><mrow><mo>|</mo><mi>P</mi><msub><mi>C</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub><mo>|</mo></mrow></mrow></mfrac>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="upper P Subscript i t">&#13;
  <msub><mi>P</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
</math> is the total price of stock <em>i</em> on day <em>t</em>, <math alttext="upper V Subscript i t">&#13;
  <msub><mi>V</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
</math> represents the volume traded of stock <em>i</em> on day <em>t</em>, and finally, <math alttext="StartAbsoluteValue upper P upper C Subscript i t Baseline EndAbsoluteValue">&#13;
  <mrow>&#13;
    <mrow>&#13;
      <mo>|</mo>&#13;
      <mi>P</mi>&#13;
    </mrow>&#13;
    <msub><mi>C</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
    <mrow>&#13;
      <mo>|</mo>&#13;
    </mrow>&#13;
  </mrow>&#13;
</math> is the absolute value of difference between price at time <em>t</em> and <em>t</em> - 1.</p>&#13;
&#13;
<p>The higher the ratio <math alttext="upper L upper R Subscript i t">&#13;
  <mrow>&#13;
    <mi>L</mi>&#13;
    <msub><mi>R</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
  </mrow>&#13;
</math> is, the higher the liquidity of asset <em>i</em> will be. This implies that higher traded volume, <math alttext="upper P Subscript i t Baseline upper V Subscript i t">&#13;
  <mrow>&#13;
    <msub><mi>P</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
    <msub><mi>V</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
  </mrow>&#13;
</math>, and low price difference, <math alttext="StartAbsoluteValue upper P upper C Subscript i t Baseline EndAbsoluteValue">&#13;
  <mrow>&#13;
    <mrow>&#13;
      <mo>|</mo>&#13;
      <mi>P</mi>&#13;
    </mrow>&#13;
    <msub><mi>C</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
    <mrow>&#13;
      <mo>|</mo>&#13;
    </mrow>&#13;
  </mrow>&#13;
</math>, amount to high liquidity level. Conversely, if a low volume is necessary to initiate a price change, then this asset is referred to as illiquid. Obviously, this conceptual framework focuses more on the price aspect than on the issue of time or on the execution costs typically present in a market&#13;
(Gabrielsen, Marzo, and Zagaglia 2011).</p>&#13;
&#13;
<p>Let’s first import the data and observe it via the following codes. As it is readily observable, the main variables in the dataset are ask (<code>ASKHI</code>), bid (<code>BIDLO</code>), open (<code>OPENPRC</code>), and trading price (<code>PRC</code>) along with the volume (<code>VOL</code>), return (<code>RET</code>), volume-weighted return (<code>vwretx</code>) of the stock, and number of shares outstanding (<code>SHROUT</code>):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">pandas</code> <code class="kn">as</code> <code class="nn">pd</code>&#13;
        <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code>&#13;
        <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>&#13;
        <code class="kn">import</code> <code class="nn">warnings</code>&#13;
        <code class="n">warnings</code><code class="o">.</code><code class="n">filterwarnings</code><code class="p">(</code><code class="s2">"ignore"</code><code class="p">)</code>&#13;
        <code class="n">plt</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s1">'figure.figsize'</code><code class="p">]</code> <code class="o">=</code> <code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mi">6</code><code class="p">)</code>&#13;
        <code class="n">pd</code><code class="o">.</code><code class="n">set_option</code><code class="p">(</code><code class="s1">'use_inf_as_na'</code><code class="p">,</code> <code class="bp">True</code><code class="p">)</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">liq_data</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'bid_ask.csv'</code><code class="p">)</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">liq_data</code><code class="o">.</code><code class="n">head</code><code class="p">()</code>&#13;
&#13;
<code class="n">Out</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">Unnamed</code><code class="p">:</code> <code class="mi">0</code>        <code class="n">Date</code>  <code class="n">EXCHCD</code> <code class="n">TICKER</code>      <code class="n">COMNAM</code>  <code class="n">BIDLO</code>   <code class="n">ASKHI</code>    <code class="n">PRC</code>&#13;
         \&#13;
        <code class="mi">0</code>     <code class="mi">1031570</code>  <code class="mi">2019</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">02</code>     <code class="mf">3.0</code>   <code class="n">INTC</code>  <code class="n">INTEL</code> <code class="n">CORP</code>  <code class="mf">45.77</code>  <code class="mf">47.470</code>&#13;
         <code class="mf">47.08</code>&#13;
        <code class="mi">1</code>     <code class="mi">1031571</code>  <code class="mi">2019</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">03</code>     <code class="mf">3.0</code>   <code class="n">INTC</code>  <code class="n">INTEL</code> <code class="n">CORP</code>  <code class="mf">44.39</code>  <code class="mf">46.280</code>&#13;
         <code class="mf">44.49</code>&#13;
        <code class="mi">2</code>     <code class="mi">1031572</code>  <code class="mi">2019</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">04</code>     <code class="mf">3.0</code>   <code class="n">INTC</code>  <code class="n">INTEL</code> <code class="n">CORP</code>  <code class="mf">45.54</code>  <code class="mf">47.570</code>&#13;
         <code class="mf">47.22</code>&#13;
        <code class="mi">3</code>     <code class="mi">1031573</code>  <code class="mi">2019</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">07</code>     <code class="mf">3.0</code>   <code class="n">INTC</code>  <code class="n">INTEL</code> <code class="n">CORP</code>  <code class="mf">46.75</code>  <code class="mf">47.995</code>&#13;
         <code class="mf">47.44</code>&#13;
        <code class="mi">4</code>     <code class="mi">1031574</code>  <code class="mi">2019</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mi">08</code>     <code class="mf">3.0</code>   <code class="n">INTC</code>  <code class="n">INTEL</code> <code class="n">CORP</code>  <code class="mf">46.78</code>  <code class="mf">48.030</code>&#13;
         <code class="mf">47.74</code>&#13;
&#13;
&#13;
                  <code class="n">VOL</code>       <code class="n">RET</code>     <code class="n">SHROUT</code>  <code class="n">OPENPRC</code>    <code class="n">vwretx</code>&#13;
&#13;
        <code class="mi">0</code>  <code class="mf">18761673.0</code>  <code class="mf">0.003196</code>  <code class="mf">4564000.0</code>   <code class="mf">45.960</code>  <code class="mf">0.001783</code>&#13;
&#13;
        <code class="mi">1</code>  <code class="mf">32254097.0</code> <code class="o">-</code><code class="mf">0.055013</code>  <code class="mf">4564000.0</code>   <code class="mf">46.150</code> <code class="o">-</code><code class="mf">0.021219</code>&#13;
&#13;
        <code class="mi">2</code>  <code class="mf">35419836.0</code>  <code class="mf">0.061362</code>  <code class="mf">4564000.0</code>   <code class="mf">45.835</code>  <code class="mf">0.033399</code>&#13;
&#13;
        <code class="mi">3</code>  <code class="mf">22724997.0</code>  <code class="mf">0.004659</code>  <code class="mf">4564000.0</code>   <code class="mf">47.100</code>  <code class="mf">0.009191</code>&#13;
&#13;
        <code class="mi">4</code>  <code class="mf">22721240.0</code>  <code class="mf">0.006324</code>  <code class="mf">4564000.0</code>   <code class="mf">47.800</code>  <code class="mf">0.010240</code></pre>&#13;
&#13;
<p>Calculating some liquidity measures requires a rolling-window estimation, such as the calculation of the bid price for five days. To accomplish this task, the list named <code>rolling_five</code> is generated using the following code:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rolling_five</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="k">for</code><code> </code><code class="n">j</code><code> </code><code class="ow">in</code><code> </code><code class="n">liq_data</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>            </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">liq_data</code><code class="p">[</code><code class="n">liq_data</code><code class="o">.</code><code class="n">TICKER</code><code> </code><code class="o">==</code><code> </code><code class="n">j</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>                </code><code class="n">rolling_five</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">liq_data</code><code class="p">[</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">5</code><code class="p">]</code><code class="o">.</code><code class="n">agg</code><code class="p">(</code><code class="p">{</code><code class="s1">'</code><code class="s1">BIDLO</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">min</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                                        </code><code class="s1">'</code><code class="s1">ASKHI</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">max</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                                         </code><code class="s1">'</code><code class="s1">VOL</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">sum</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                                         </code><code class="s1">'</code><code class="s1">SHROUT</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">mean</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                                         </code><code class="s1">'</code><code class="s1">PRC</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">mean</code><code class="s1">'</code><code class="p">}</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO1-1" id="co_liquidity_modeling_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rolling_five_df</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">rolling_five</code><code class="p">)</code><code>&#13;
</code><code>        </code><code class="n">rolling_five_df</code><code class="o">.</code><code class="n">columns</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">bidlo_min</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">askhi_max</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">vol_sum</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                   </code><code class="s1">'</code><code class="s1">shrout_mean</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">prc_mean</code><code class="s1">'</code><code class="p">]</code><code>&#13;
</code><code>        </code><code class="n">liq_vol_all</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">concat</code><code class="p">(</code><code class="p">[</code><code class="n">liq_data</code><code class="p">,</code><code class="n">rolling_five_df</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">axis</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">liq_ratio</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="k">for</code><code> </code><code class="n">j</code><code> </code><code class="ow">in</code><code> </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>            </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code> </code><code class="o">==</code><code> </code><code class="n">j</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>                </code><code class="n">liq_ratio</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">PRC</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">6</code><code class="p">]</code><code> </code><code class="o">*</code><code>&#13;
</code><code>                                  </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">VOL</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">6</code><code class="p">]</code><code class="p">)</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="p">)</code><code class="o">/</code><code>&#13;
</code><code>                                 </code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">abs</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">PRC</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">6</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code> </code><code class="o">-</code><code>&#13;
</code><code>                                         </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">PRC</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">5</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code class="p">)</code><code class="p">)</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO1-1" id="callout_liquidity_modeling_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Calculating the required statistical measures for five-day window</p></dd>&#13;
</dl>&#13;
&#13;
<p>Now, we have minimum bid price, max ask price, summation of volume traded, mean of the number of shares outstanding, and mean of the trading price per five days.<a data-primary="" data-startref="ix_liquidity_ratio" data-type="indexterm" id="idm45737217586032"/><a data-primary="" data-startref="ix_vol_meas_liquidity_ratio" data-type="indexterm" id="idm45737217585056"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Hui-Heubel ratio" data-type="sect3"><div class="sect3" id="idm45737218225408">&#13;
<h3>Hui-Heubel ratio</h3>&#13;
&#13;
<p><a data-primary="volume-based liquidity measures" data-secondary="Hui-Heubel ratio" data-type="indexterm" id="idm45737217559888"/><a data-primary="Hui-Heubel ratio" data-type="indexterm" id="idm45737217558944"/>Another measure that captures the depth is the Hui-Heubel liquidity ratio, known as  &#13;
<span class="keep-together"><math alttext="upper L Subscript upper H upper H">&#13;
  <msub><mi>L</mi> <mrow><mi>H</mi><mi>H</mi></mrow> </msub>&#13;
</math>:</span></p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign upper L Subscript upper H upper H Baseline equals StartFraction upper P Subscript m a x Baseline minus upper P Subscript m i n Baseline Over upper P Subscript m i n Baseline EndFraction slash upper V slash upper P overbar times shrout dollar-sign">&#13;
  <mrow>&#13;
    <msub><mi>L</mi> <mrow><mi>H</mi><mi>H</mi></mrow> </msub>&#13;
    <mo>=</mo>&#13;
    <mfrac><mrow><msub><mi>P</mi> <mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow> </msub><mo>-</mo><msub><mi>P</mi> <mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow> </msub></mrow> <msub><mi>P</mi> <mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow> </msub></mfrac>&#13;
    <mo>/</mo>&#13;
    <mi>V</mi>&#13;
    <mo>/</mo>&#13;
    <mover><mi>P</mi> <mo>¯</mo></mover>&#13;
    <mo>×</mo>&#13;
    <mtext>shrout</mtext>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="upper P Subscript m a x">&#13;
  <msub><mi>P</mi> <mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow> </msub>&#13;
</math> and <math alttext="upper P Subscript m i n">&#13;
  <msub><mi>P</mi> <mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow> </msub>&#13;
</math> show maximum and minimum price over the determined period, respectively. <math alttext="upper P overbar">&#13;
  <mover><mi>P</mi> <mo>¯</mo></mover>&#13;
</math> is average closing price over determined period. What we have in the numerator is the percentage change in the stock price, and the volume traded is divided by market capitalization, i.e., <math alttext="upper P overbar times shrout">&#13;
  <mrow>&#13;
    <mover><mi>P</mi> <mo>¯</mo></mover>&#13;
    <mo>×</mo>&#13;
    <mtext>shrout</mtext>&#13;
  </mrow>&#13;
</math> in the denominator. One of the most distinguish features of Hui-Heubel liquidity measure is that it is applicable to a single stock, not only portfolios.</p>&#13;
&#13;
<p>As discussed by&#13;
Gabrielsen, Marzo, and Zagaglia (2011),&#13;
<math alttext="upper P Subscript m a x">&#13;
  <msub><mi>P</mi> <mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow> </msub>&#13;
</math> and <math alttext="upper P Subscript m i n">&#13;
  <msub><mi>P</mi> <mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow> </msub>&#13;
</math> can be replaced by bid-ask spread but due to low volatility in bid-ask spread, it tends to bias downward.</p>&#13;
&#13;
<p>To compute the Hui-Heubel liquidity ratio, we first have the liquidity measures in a list, then we add all these measures into the dataframe to have all-encompassing data:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="n">Lhh</code> <code class="o">=</code> <code class="p">[]</code>&#13;
&#13;
        <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">():</code>&#13;
            <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">j</code><code class="p">])):</code>&#13;
                <code class="n">Lhh</code><code class="o">.</code><code class="n">append</code><code class="p">((</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'PRC'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">5</code><code class="p">]</code><code class="o">.</code><code class="n">max</code><code class="p">()</code> <code class="o">-</code>&#13;
                            <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'PRC'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">5</code><code class="p">]</code><code class="o">.</code><code class="n">min</code><code class="p">())</code> <code class="o">/</code>&#13;
                           <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'PRC'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">5</code><code class="p">]</code><code class="o">.</code><code class="n">min</code><code class="p">()</code> <code class="o">/</code>&#13;
                           <code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'VOL'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">5</code><code class="p">]</code><code class="o">.</code><code class="n">sum</code><code class="p">()</code> <code class="o">/</code>&#13;
                            <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'SHROUT'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">5</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">()</code> <code class="o">*</code>&#13;
                            <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'PRC'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">5</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">()))</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Turnover ratio" data-type="sect3"><div class="sect3" id="idm45737217688624">&#13;
<h3>Turnover ratio</h3>&#13;
&#13;
<p><a data-primary="turnover ratio" data-type="indexterm" id="idm45737217355504"/><a data-primary="volume-based liquidity measures" data-secondary="turnover ratio" data-type="indexterm" id="idm45737217354800"/>Turnover ratio has long been treated as a proxy for liquidity. It is basically the ratio of volatility to number of shares outstanding:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign upper L upper R Subscript i t Baseline equals StartFraction 1 Over upper D Subscript i t Baseline EndFraction StartFraction sigma-summation Underscript t equals 1 Overscript upper T Endscripts upper V o l Subscript i t Baseline Over sigma-summation Underscript t equals 1 Overscript upper T Endscripts shrout Subscript i t Baseline EndFraction dollar-sign">&#13;
  <mrow>&#13;
    <mi>L</mi>&#13;
    <msub><mi>R</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
    <mo>=</mo>&#13;
    <mfrac><mn>1</mn> <msub><mi>D</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub></mfrac>&#13;
    <mfrac><mrow><msubsup><mo>∑</mo> <mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow> <mi>T</mi> </msubsup><mi>V</mi><mi>o</mi><msub><mi>l</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub></mrow> <mrow><msubsup><mo>∑</mo> <mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow> <mi>T</mi> </msubsup><msub><mtext>shrout</mtext> <mrow><mi>i</mi><mi>t</mi></mrow> </msub></mrow></mfrac>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="upper D Subscript i t">&#13;
  <msub><mi>D</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
</math> denotes the number of trading days, <math alttext="upper V o l Subscript i t">&#13;
  <mrow>&#13;
    <mi>V</mi>&#13;
    <mi>o</mi>&#13;
    <msub><mi>l</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
  </mrow>&#13;
</math> is the number of shares traded at time <em>t</em>, and <math alttext="shrout Subscript i t">&#13;
  <msub><mtext>shrout</mtext> <mrow><mi>i</mi><mi>t</mi></mrow> </msub>&#13;
</math> shows the number of shares outstanding at time <em>t</em>. A large turnover rate indicates a high level of liquidity, in that turnover implies trading frequency. As turnover rate incorporates the number of shares outstanding, it makes it a more subtle measure of liquidity.<a data-primary="" data-startref="ix_liquidity_model_meas_vol" data-type="indexterm" id="idm45737217302864"/><a data-primary="" data-startref="ix_vol_based_liquidity_meas" data-type="indexterm" id="idm45737217302016"/></p>&#13;
&#13;
<p>Turnover ratio is calculated based on daily data, and then all the volume-based liquidity measures are converted into a dataframe and are included in <code>liq_vol_all</code>:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">turnover_ratio</code> <code class="o">=</code> <code class="p">[]</code>&#13;
&#13;
        <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">():</code>&#13;
            <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">j</code><code class="p">])):</code>&#13;
                <code class="n">turnover_ratio</code><code class="o">.</code><code class="n">append</code><code class="p">((</code><code class="mi">1</code><code class="o">/</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'VOL'</code><code class="p">]</code><code class="o">.</code><code class="n">count</code><code class="p">())</code> <code class="o">*</code>&#13;
                                      <code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'VOL'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">])</code> <code class="o">/</code>&#13;
                                       <code class="n">np</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'SHROUT'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">])))</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'liq_ratio'</code><code class="p">]</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">liq_ratio</code><code class="p">)</code>&#13;
        <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'Lhh'</code><code class="p">]</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">Lhh</code><code class="p">)</code>&#13;
        <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'turnover_ratio'</code><code class="p">]</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">turnover_ratio</code><code class="p">)</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Transaction Cost–Based Liquidity Measures" data-type="sect2"><div class="sect2" id="idm45737217300112">&#13;
<h2>Transaction Cost–Based Liquidity Measures</h2>&#13;
&#13;
<p><a data-primary="transaction cost-based liquidity measures" data-type="indexterm" id="ix_trans_cost_liquidity_meas"/><a data-primary="liquidity modeling" data-secondary="liquidity measures" data-tertiary="transaction cost-based" data-type="indexterm" id="ix_liquidity_model_meas_trans"/>In the real world, buyers and sellers do not magically meet in a frictionless environment. Rather, intermediaries (brokers and dealers), equipment (computers and the like), patience (trades cannot be realized instantaneously), and a rule book that stipulates how orders are to be handled and turned into trades are required. Also, the orders of large, institutional investors are big enough to affect market prices. All of these imply the existence of trading costs, and just how to structure a market (and a broader marketplace) to contain these costs is a subtle and intricate challenge (Baker and Kıymaz (2013). This led to the emergence of transaction cost.</p>&#13;
&#13;
<p><em>Transaction cost</em> <a data-primary="transaction cost" data-type="indexterm" id="idm45737217139632"/>is a cost an investor must bear during trade. It is referred to as any expenses related to the execution of trade. A distinction of transaction cost as explicit and implicit costs is possible. The former relates to order processing, taxes, and brokerage fees, while the latter includes more latent costs, such as bid-ask spread, timing of execution, and so on.</p>&#13;
&#13;
<p><a data-primary="immediacy, liquidity dimension" data-type="indexterm" id="idm45737217138128"/><a data-primary="tightness, liquidity dimension" data-type="indexterm" id="idm45737217137408"/>Transaction cost is related to the tightness and immediacy dimensions of liquidity. High transaction costs discourage investors to trade and this, in turn, decreases the number of buyers and sellers in the market so that the trading place diverges away from the more centralized market into a fragmented one, which result in a shallow market (Sarr and Lybek 2002). To the extent that transaction cost is low, investors are willing to trade and this results in a flourished trading environment in which markets will be more centralized.</p>&#13;
&#13;
<p>Similarly, an abundance of buyers and sellers in a low transaction cost environment refers to the fact that a large number of orders are traded in a short period of time. So, immediacy is the other dimension of liquidity, which is closely related to the transaction cost.</p>&#13;
&#13;
<p><a data-primary="bid-ask spread" data-secondary="as proxy for transaction cost" data-type="indexterm" id="idm45737217135088"/>Even though there is an ongoing debate about the goodness of bid-ask spread as well as the assurance that these models provide, bid-ask spread is a widely recognized proxy for transaction cost. To the extent that bid-ask spread is a good analysis of transaction cost, it is also a good indicator of liquidity by which the ease of converting an asset into cash (or a cash equivalent) might be determined. Without going into further detail, bid-ask spread can be measured by quoted spread, effective spread, and realized spread methods. So at first glance, it may seem strange to calculate bid-ask spread, which can be easily calculated by these methods. But this is not the case in reality. When the trade cannot be realized inside the quotes, then the spread is no longer the observed spread on which these methods are based.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Percentage quoted and effective bid-ask spreads" data-type="sect3"><div class="sect3" id="idm45737217132992">&#13;
<h3>Percentage quoted and effective bid-ask spreads</h3>&#13;
&#13;
<p><a data-primary="percentage quoted and effective bid-ask spreads" data-type="indexterm" id="idm45737217131680"/><a data-primary="transaction cost-based liquidity measures" data-secondary="percentage quoted and effective bid-ask spreads" data-type="indexterm" id="idm45737217130880"/><a data-primary="bid-ask spread" data-secondary="percentage quoted and effective" data-type="indexterm" id="idm45737217129872"/>The other two well-known bid-ask spreads are <em>percentage quoted</em> and <em>percentage effective</em> bid-ask spreads. Quoted spread measures the cost of completing a trade, that is, the difference in the bid-ask spread. There are different forms of quoted spread but for the sake of scaling, we’ll choose the percentage quoted spread:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign Percentage quoted spread equals StartFraction upper P Subscript a s k Baseline minus upper P Subscript b i d Baseline Over upper P Subscript m i d Baseline EndFraction dollar-sign">&#13;
  <mrow>&#13;
    <mtext>Percentage</mtext>&#13;
    <mspace width="4.pt"/>&#13;
    <mtext>quoted</mtext>&#13;
    <mspace width="4.pt"/>&#13;
    <mtext>spread</mtext>&#13;
    <mo>=</mo>&#13;
    <mfrac><mrow><msub><mi>P</mi> <mrow><mi>a</mi><mi>s</mi><mi>k</mi></mrow> </msub><mo>-</mo><msub><mi>P</mi> <mrow><mi>b</mi><mi>i</mi><mi>d</mi></mrow> </msub></mrow> <msub><mi>P</mi> <mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow> </msub></mfrac>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="upper P Subscript a s k">&#13;
  <msub><mi>P</mi> <mrow><mi>a</mi><mi>s</mi><mi>k</mi></mrow> </msub>&#13;
</math> is the ask price of the stock and <math alttext="upper P Subscript b i d">&#13;
  <msub><mi>P</mi> <mrow><mi>b</mi><mi>i</mi><mi>d</mi></mrow> </msub>&#13;
</math> is the bid price of the stock.</p>&#13;
&#13;
<p><a data-primary="mid-price versus quoted price" data-type="indexterm" id="idm45737217110736"/>The effective spread measures the deviation between trading price and the mid-price, which is sometimes called the true underlying value of the stock. When trades occur either within or outside the quotes, a better measure of trading costs is the percentage effective half spread, which is based on the actual trade price, and is computed on a percentage basis&#13;
(Bessembinder and Venkataraman 2010):</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign Effective spread equals StartFraction 2 StartAbsoluteValue upper P Subscript t Baseline minus upper P Subscript m i d Baseline EndAbsoluteValue Over upper P Subscript m i d Baseline EndFraction dollar-sign">&#13;
  <mrow>&#13;
    <mtext>Effective</mtext>&#13;
    <mspace width="4.pt"/>&#13;
    <mtext>spread</mtext>&#13;
    <mo>=</mo>&#13;
    <mfrac><mrow><mrow><mn>2</mn><mo>|</mo></mrow><msub><mi>P</mi> <mi>t</mi> </msub><mo>-</mo><msub><mi>P</mi> <mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow> </msub><mrow><mo>|</mo></mrow></mrow> <msub><mi>P</mi> <mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow> </msub></mfrac>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="upper P Subscript t">&#13;
  <msub><mi>P</mi> <mi>t</mi> </msub>&#13;
</math> is the trading price of the stock and <math alttext="upper P Subscript m i d">&#13;
  <msub><mi>P</mi> <mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow> </msub>&#13;
</math> is the midpoint of the bid-ask offer prevailing at the time of the trade.</p>&#13;
&#13;
<p>It is relatively easy to calculate the percentage quoted and effective bid-ask spreads, as shown in the following:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'mid_price'</code><code class="p">]</code> <code class="o">=</code> <code class="p">(</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">ASKHI</code> <code class="o">+</code> <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">BIDLO</code><code class="p">)</code> <code class="o">/</code> <code class="mi">2</code>&#13;
         <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'percent_quoted_ba'</code><code class="p">]</code> <code class="o">=</code> <code class="p">(</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">ASKHI</code> <code class="o">-</code>&#13;
                                             <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">BIDLO</code><code class="p">)</code> <code class="o">/</code> \&#13;
                                             <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">mid_price</code>&#13;
         <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'percent_effective_ba'</code><code class="p">]</code> <code class="o">=</code> <code class="mi">2</code> <code class="o">*</code> <code class="nb">abs</code><code class="p">((</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">PRC</code> <code class="o">-</code>&#13;
                                                      <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">mid_price</code><code class="p">))</code> <code class="o">/</code> \&#13;
                                                      <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">mid_price</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Roll’s spread estimate" data-type="sect3"><div class="sect3" id="idm45737217092544">&#13;
<h3>Roll’s spread estimate</h3>&#13;
&#13;
<p><a data-primary="transaction cost-based liquidity measures" data-secondary="Roll’s spread estimate" data-type="indexterm" id="idm45737216996640"/><a data-primary="Roll’s spread estimate" data-type="indexterm" id="idm45737216995632"/>One of the first and foremost spread measures was proposed by Roll (1984). The <em>Roll spread</em> can be defined as:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign Roll equals StartRoot minus cov left-parenthesis normal upper Delta p Subscript t Baseline comma normal upper Delta p Subscript t minus 1 Baseline right-parenthesis EndRoot dollar-sign">&#13;
  <mrow>&#13;
    <mtext>Roll</mtext>&#13;
    <mo>=</mo>&#13;
    <msqrt>&#13;
      <mrow>&#13;
        <mo>-</mo>&#13;
        <mtext>cov</mtext>&#13;
        <mo>(</mo>&#13;
        <mi>Δ</mi>&#13;
        <msub><mi>p</mi> <mi>t</mi> </msub>&#13;
        <mo>,</mo>&#13;
        <mi>Δ</mi>&#13;
        <msub><mi>p</mi> <mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow> </msub>&#13;
        <mo>)</mo>&#13;
      </mrow>&#13;
    </msqrt>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="normal upper Delta p Subscript t">&#13;
  <mrow>&#13;
    <mi>Δ</mi>&#13;
    <msub><mi>p</mi> <mi>t</mi> </msub>&#13;
  </mrow>&#13;
</math> and <math alttext="normal upper Delta p Subscript t minus 1">&#13;
  <mrow>&#13;
    <mi>Δ</mi>&#13;
    <msub><mi>p</mi> <mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow> </msub>&#13;
  </mrow>&#13;
</math> are the price differences at time <em>t</em> and at time <em>t</em> – 1, and <math alttext="cov">&#13;
  <mtext>cov</mtext>&#13;
</math> denotes the covariance between these price differences.</p>&#13;
&#13;
<p>Assuming that the market is <a data-primary="efficient market" data-type="indexterm" id="idm45737216974976"/>efficient<sup><a data-type="noteref" href="ch07.html#idm45737216974144" id="idm45737216974144-marker">1</a></sup> and the probability of distribution of observed price changes is stationary, Roll’s spread is motivated by the fact that serial correlation of price changes is a good proxy for liquidity.</p>&#13;
&#13;
<p><a data-primary="positive covariance challenge for Roll’s spread estimate" data-type="indexterm" id="idm45737216972528"/>One of the most important things to note in calculating Roll’s spread is that positive covariance is not well-defined, and it consists of almost half of the cases. The literature puts forth several methods to remedy this shortcoming, and we’ll embrace Harris’s (1990) approach in the following:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">price_diff</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">)</code><code class="p">[</code><code class="s1">'</code><code class="s1">PRC</code><code class="s1">'</code><code class="p">]</code><code>\&#13;
</code><code>                                     </code><code class="o">.</code><code class="n">apply</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">x</code><code class="p">:</code><code class="n">x</code><code class="o">.</code><code class="n">diff</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">dropna</code><code class="p">(</code><code class="n">inplace</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">roll</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="k">for</code><code> </code><code class="n">j</code><code> </code><code class="ow">in</code><code> </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>              </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code> </code><code class="o">==</code><code> </code><code class="n">j</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>                 </code><code class="n">roll_cov</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">cov</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">price_diff</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">5</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>                                   </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">price_diff</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">6</code><code class="p">]</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO2-1" id="co_liquidity_modeling_CO2-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>                 </code><code class="k">if</code><code> </code><code class="n">roll_cov</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code class="mi">1</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="mi">0</code><code class="p">:</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO2-2" id="co_liquidity_modeling_CO2-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>                     </code><code class="n">roll</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="mi">2</code><code> </code><code class="o">*</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="o">-</code><code class="n">roll_cov</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>                 </code><code class="k">else</code><code class="p">:</code><code>&#13;
</code><code>                      </code><code class="n">roll</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="mi">2</code><code> </code><code class="o">*</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">abs</code><code class="p">(</code><code class="n">roll_cov</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO2-3" id="co_liquidity_modeling_CO2-3"><img alt="3" src="assets/3.png"/></a></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO2-1" id="callout_liquidity_modeling_CO2-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Calculating the covariance between price differences for the five-day window</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO2-2" id="callout_liquidity_modeling_CO2-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Checking the case where the covariance is negative</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO2-3" id="callout_liquidity_modeling_CO2-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>In the case of positive covariance, Harris’s approach is applied</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="The Corwin-Schultz spread" data-type="sect3"><div class="sect3" id="idm45737216656384">&#13;
<h3>The Corwin-Schultz spread</h3>&#13;
&#13;
<p><a data-primary="transaction cost-based liquidity measures" data-secondary="Corwin-Schultz spread" data-type="indexterm" id="idm45737216654976"/><a data-primary="Corwin-Schultz spread" data-type="indexterm" id="idm45737216654032"/><a data-primary="bid-ask spread" data-secondary="and Corwin-Schultz spread" data-secondary-sortas="Corwin-Schultz spread" data-type="indexterm" id="idm45737216955840"/>The <em>Corwin-Schultz spread</em> is rather intuitive and easy to apply. It rests mainly on the following assumption: given that the daily high and low prices are typically buyer and seller initiated, respectively, the observed price change can be split into <a data-primary="effective price volatility, and Corwin-Schultz spread" data-type="indexterm" id="idm45737216953872"/>effective price volatility and bid-ask spread. So the ratio of high-to-low prices for a day reflects both the stock’s variance and its bid-ask spread (Corwin and Schultz 2012;&#13;
Abdi and Ranaldo 2017).</p>&#13;
&#13;
<p>This spread proposes an entirely new approach based on the daily high and low prices only, and the logic behind it is summarized by Corwin and Schultz (2012) as “the sum of the price ranges over 2 consecutive single days reflect 2 days’ volatility and twice the spread, while the price range over one 2-day period reflects 2 days’ volatility and one spread”:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign upper S equals StartFraction 2 left-parenthesis e Superscript alpha Baseline minus 1 right-parenthesis Over 1 plus e Superscript alpha Baseline EndFraction dollar-sign">&#13;
  <mrow>&#13;
    <mi>S</mi>&#13;
    <mo>=</mo>&#13;
    <mfrac><mrow><mn>2</mn><mo>(</mo><msup><mi>e</mi> <mi>α</mi> </msup><mo>-</mo><mn>1</mn><mo>)</mo></mrow> <mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi> <mi>α</mi> </msup></mrow></mfrac>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign alpha equals StartFraction StartRoot 2 beta EndRoot minus StartRoot beta EndRoot Over 3 minus 2 StartRoot 2 EndRoot EndFraction minus NestedStartRoot StartFraction gamma Over 3 minus 2 StartRoot 2 EndRoot EndFraction NestedEndRoot dollar-sign">&#13;
  <mrow>&#13;
    <mi>α</mi>&#13;
    <mo>=</mo>&#13;
    <mfrac><mrow><msqrt><mrow><mn>2</mn><mi>β</mi></mrow></msqrt><mo>-</mo><msqrt><mi>β</mi></msqrt></mrow> <mrow><mn>3</mn><mo>-</mo><mn>2</mn><msqrt><mn>2</mn></msqrt></mrow></mfrac>&#13;
    <mo>-</mo>&#13;
    <msqrt>&#13;
      <mfrac><mi>γ</mi> <mrow><mn>3</mn><mo>-</mo><mn>2</mn><msqrt><mn>2</mn></msqrt></mrow></mfrac>&#13;
    </msqrt>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign beta equals double-struck upper E left-parenthesis sigma-summation Underscript j equals 0 Overscript 1 Endscripts left-bracket l n left-parenthesis StartFraction upper H Subscript t plus j Superscript 0 Baseline Over upper L Subscript t plus j Superscript 0 Baseline EndFraction right-parenthesis right-bracket squared right-parenthesis dollar-sign">&#13;
  <mrow>&#13;
    <mi>β</mi>&#13;
    <mo>=</mo>&#13;
    <mi>𝔼</mi>&#13;
    <mo>(</mo>&#13;
    <msubsup><mo>∑</mo> <mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow> <mn>1</mn> </msubsup>&#13;
    <msup><mrow><mo>[</mo><mi>l</mi><mi>n</mi><mrow><mo>(</mo><mfrac><msubsup><mi>H</mi> <mrow><mi>t</mi><mo>+</mo><mi>j</mi></mrow> <mn>0</mn> </msubsup> <msubsup><mi>L</mi> <mrow><mi>t</mi><mo>+</mo><mi>j</mi></mrow> <mn>0</mn> </msubsup></mfrac><mo>)</mo></mrow><mo>]</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>)</mo>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign gamma equals double-struck upper E left-parenthesis sigma-summation Underscript j equals 0 Overscript 1 Endscripts left-bracket l n left-parenthesis StartFraction upper H Subscript t plus 1 Superscript 0 Baseline Over upper L Subscript t plus 1 Superscript 0 Baseline EndFraction right-parenthesis right-bracket squared right-parenthesis dollar-sign">&#13;
  <mrow>&#13;
    <mi>γ</mi>&#13;
    <mo>=</mo>&#13;
    <mi>𝔼</mi>&#13;
    <mo>(</mo>&#13;
    <msubsup><mo>∑</mo> <mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow> <mn>1</mn> </msubsup>&#13;
    <msup><mrow><mo>[</mo><mi>l</mi><mi>n</mi><mrow><mo>(</mo><mfrac><msubsup><mi>H</mi> <mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow> <mn>0</mn> </msubsup> <msubsup><mi>L</mi> <mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow> <mn>0</mn> </msubsup></mfrac><mo>)</mo></mrow><mo>]</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>)</mo>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="upper H Subscript t Superscript upper A">&#13;
  <msubsup><mi>H</mi> <mi>t</mi> <mi>A</mi> </msubsup>&#13;
</math> <math alttext="left-parenthesis upper L Subscript t Superscript upper A Baseline right-parenthesis">&#13;
  <mrow>&#13;
    <mo>(</mo>&#13;
    <msubsup><mi>L</mi> <mi>t</mi> <mi>A</mi> </msubsup>&#13;
    <mo>)</mo>&#13;
  </mrow>&#13;
</math> denotes actual high (low) prices on day <em>t</em> and <math alttext="upper H Subscript t Superscript o">&#13;
  <msubsup><mi>H</mi> <mi>t</mi> <mi>o</mi> </msubsup>&#13;
</math> or <math alttext="upper L Subscript t Superscript o">&#13;
  <msubsup><mi>L</mi> <mi>t</mi> <mi>o</mi> </msubsup>&#13;
</math> the observed high (low) stock price on day <em>t</em>.</p>&#13;
&#13;
<p>The Corwin-Schultz spread requires multiple steps to calculate, as it includes many variables. The following code presents our way of doing this calculation:<a data-primary="" data-startref="ix_liquidity_model_meas_trans" data-type="indexterm" id="idm45737216892608"/><a data-primary="" data-startref="ix_trans_cost_liquidity_meas" data-type="indexterm" id="idm45737216891664"/><a data-primary="" data-startref="ix_Corwin-Schultz_spread" data-type="indexterm" id="idm45737216890704"/><a data-primary="" data-startref="ix_trans_cost_meas_Corwin-Schultz" data-type="indexterm" id="idm45737216889744"/></p>&#13;
&#13;
<pre class="pagebreak-before less_space" data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">12</code><code class="p">]:</code> <code class="n">gamma</code> <code class="o">=</code> <code class="p">[]</code>&#13;
&#13;
         <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">():</code>&#13;
             <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">j</code><code class="p">])):</code>&#13;
                 <code class="n">gamma</code><code class="o">.</code><code class="n">append</code><code class="p">((</code><code class="nb">max</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'ASKHI'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">],</code>&#13;
                                   <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'ASKHI'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">i</code><code class="p">])</code> <code class="o">-</code>&#13;
                               <code class="nb">min</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'BIDLO'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">],</code>&#13;
                                   <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'BIDLO'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">i</code><code class="p">]))</code> <code class="o">**</code> <code class="mi">2</code><code class="p">)</code>&#13;
                 <code class="n">gamma_array</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="n">gamma</code><code class="p">)</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">13</code><code class="p">]:</code> <code class="n">beta</code> <code class="o">=</code> <code class="p">[]</code>&#13;
&#13;
         <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">():</code>&#13;
             <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">j</code><code class="p">])):</code>&#13;
                 <code class="n">beta</code><code class="o">.</code><code class="n">append</code><code class="p">((</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'ASKHI'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">]</code> <code class="o">-</code>&#13;
                              <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'BIDLO'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">])</code> <code class="o">**</code> <code class="mi">2</code> <code class="o">+</code>&#13;
                             <code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'ASKHI'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">i</code><code class="p">]</code> <code class="o">-</code>&#13;
                              <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'BIDLO'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">i</code><code class="p">])</code> <code class="o">**</code> <code class="mi">2</code><code class="p">)</code>&#13;
                 <code class="n">beta_array</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="n">beta</code><code class="p">)</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="n">alpha</code> <code class="o">=</code> <code class="p">((</code><code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="mi">2</code> <code class="o">*</code> <code class="n">beta_array</code><code class="p">)</code> <code class="o">-</code> <code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">beta_array</code><code class="p">))</code> <code class="o">/</code>&#13;
                <code class="p">(</code><code class="mi">3</code> <code class="o">-</code> <code class="p">(</code><code class="mi">2</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="mi">2</code><code class="p">))))</code> <code class="o">-</code> <code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">gamma_array</code> <code class="o">/</code>&#13;
                                                  <code class="p">(</code><code class="mi">3</code> <code class="o">-</code> <code class="p">(</code><code class="mi">2</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="mi">2</code><code class="p">))))</code>&#13;
         <code class="n">CS_spread</code> <code class="o">=</code> <code class="p">(</code><code class="mi">2</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="n">alpha</code> <code class="o">-</code> <code class="mi">1</code><code class="p">))</code> <code class="o">/</code> <code class="p">(</code><code class="mi">1</code> <code class="o">+</code> <code class="n">np</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="n">alpha</code><code class="p">))</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="n">liq_vol_all</code> <code class="o">=</code> <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">reset_index</code><code class="p">()</code>&#13;
         <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'roll'</code><code class="p">]</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">roll</code><code class="p">)</code>&#13;
         <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'CS_spread'</code><code class="p">]</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">CS_spread</code><code class="p">)</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Price Impact–Based Liquidity Measures" data-type="sect2"><div class="sect2" id="idm45737216655792">&#13;
<h2>Price Impact–Based Liquidity Measures</h2>&#13;
&#13;
<p><a data-primary="price impact-based liquidity measures" data-type="indexterm" id="ix_price_imp_liquidity_meas"/><a data-primary="liquidity modeling" data-secondary="liquidity measures" data-tertiary="price impact-based" data-type="indexterm" id="ix_liquidity_meas_price"/>In this section, we will introduce price impact–based liquidity measures by which we are able to gauge the extent to which price is sensitive to volume and <a data-primary="turnover ratio" data-type="indexterm" id="idm45737216621232"/>turnover ratio. Recall that resiliency refers to the market responsiveness about new orders. If the market is responsive to the new order—that is, a new order correct the imbalances in the market—then it is said to be resilient. Thus, given a change in volume and/or turnover ratio, high price adjustment amounts to resiliency or vice versa.</p>&#13;
&#13;
<p>We have three price impact–based liquidity measures to discuss:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>The Amihud illiquidity measure</p>&#13;
</li>&#13;
<li>&#13;
<p>The Florackis, Andros, and Alexandros (2011) price impact ratio</p>&#13;
</li>&#13;
<li>&#13;
<p>Coefficient of elasticity of trading (CET)</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="pagebreak-before less_space" data-pdf-bookmark="Amihud illiquidity" data-type="sect3"><div class="sect3" id="idm45737216259376">&#13;
<h3>Amihud illiquidity</h3>&#13;
&#13;
<p><a data-primary="Amihud illiquidity" data-type="indexterm" id="idm45737216257760"/>This liquidity proxy is a celebrated and widely recognized measure. Amihud illiquidity (2002) basically measures the sensitivity of the return to trading volume. More concretely, it gives us a sense about a change in absolute return as trading volume changes by $1. The Amihud illiquidity measure, or ILLIQ for short, is well known among academics and practitioners:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign ILLIQ equals StartFraction 1 Over upper D Subscript i t Baseline EndFraction sigma-summation Underscript d equals 1 Overscript upper D Subscript i t Baseline Endscripts StartFraction StartAbsoluteValue upper R Subscript i t d Baseline EndAbsoluteValue Over upper V Subscript i t d Baseline EndFraction dollar-sign">&#13;
  <mrow>&#13;
    <mtext>ILLIQ</mtext>&#13;
    <mo>=</mo>&#13;
    <mfrac><mn>1</mn> <msub><mi>D</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub></mfrac>&#13;
    <msubsup><mo>∑</mo> <mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow> <msub><mi>D</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub> </msubsup>&#13;
    <mfrac><mrow><mrow><mo>|</mo></mrow><msub><mi>R</mi> <mrow><mi>i</mi><mi>t</mi><mi>d</mi></mrow> </msub><mrow><mo>|</mo></mrow></mrow> <msub><mi>V</mi> <mrow><mi>i</mi><mi>t</mi><mi>d</mi></mrow> </msub></mfrac>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="upper R Subscript i t d">&#13;
  <msub><mi>R</mi> <mrow><mi>i</mi><mi>t</mi><mi>d</mi></mrow> </msub>&#13;
</math> is the stock return on day <em>t</em> at month <em>t</em>, <math alttext="upper V Subscript i t d">&#13;
  <msub><mi>V</mi> <mrow><mi>i</mi><mi>t</mi><mi>d</mi></mrow> </msub>&#13;
</math> represents the dollar volume on day <em>d</em> at month <em>t</em>, and <em>D</em> is the number of observation days in month <em>t</em>.</p>&#13;
&#13;
<p>The Amihud measure has two advantages over many other liquidity measures. First, the Amihud measure has a simple construction that uses the absolute value of the daily <a data-primary="return-to-volume ratio, Amihud illiquidity" data-type="indexterm" id="idm45737216233424"/>return-to-volume ratio to capture price impact. <a data-primary="return" data-secondary="expected stock return, Amihud illiquidity" data-type="indexterm" id="idm45737216232496"/><a data-primary="expected stock return, Amihud illiquidity" data-type="indexterm" id="idm45737216231456"/>Second, the measure has a strong positive relation with expected stock return (Lou and Tao 2017).</p>&#13;
&#13;
<p>The Amihud illiquidity measure is not hard to calculate. However, before directly calculating the Amihud’s measure, the dollar volume of stocks needs to be computed:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">16</code><code class="p">]:</code> <code class="n">dvol</code> <code class="o">=</code> <code class="p">[]</code>&#13;
&#13;
         <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">():</code>&#13;
             <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">j</code><code class="p">])):</code>&#13;
                 <code class="n">dvol</code><code class="o">.</code><code class="n">append</code><code class="p">((</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'PRC'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">5</code><code class="p">]</code> <code class="o">*</code>&#13;
                              <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'VOL'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">5</code><code class="p">])</code><code class="o">.</code><code class="n">sum</code><code class="p">())</code>&#13;
         <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'dvol'</code><code class="p">]</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">dvol</code><code class="p">)</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">17</code><code class="p">]:</code> <code class="n">amihud</code> <code class="o">=</code> <code class="p">[]</code>&#13;
&#13;
         <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">():</code>&#13;
             <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">j</code><code class="p">])):</code>&#13;
                 <code class="n">amihud</code><code class="o">.</code><code class="n">append</code><code class="p">((</code><code class="mi">1</code> <code class="o">/</code> <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'RET'</code><code class="p">]</code><code class="o">.</code><code class="n">count</code><code class="p">())</code> <code class="o">*</code>&#13;
                               <code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">abs</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'RET'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">]))</code> <code class="o">/</code>&#13;
                                       <code class="n">np</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'dvol'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">])))</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="The price impact ratio" data-type="sect3"><div class="sect3" id="idm45737216229568">&#13;
<h3>The price impact ratio</h3>&#13;
&#13;
<p><a data-primary="price impact ratio" data-type="indexterm" id="idm45737216228320"/>Florackis, Andros, and Alexandros (2011) aimed to improve the Amihud illiquidity ratio, and came up with a new liquidity measure, <a data-primary="RtoTR (Return-to-Turnover) measure" data-type="indexterm" id="idm45737216227344"/>Return-to-Turnover (RtoTR). The disadvantages of Amihud’s illiquidity measure are listed by authors as:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>It is not comparable across stocks with different market capitalizations.</p>&#13;
</li>&#13;
<li>&#13;
<p>It neglects the investor’s holding horizon.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>To deal with these drawbacks, Florackis, Andros, and Alexandros presented a new measure, RtoTR, that replaces the volume ratio of Amihud’s model with turnover ratio so that the new measure is able to capture the trading frequency:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign RtoTR equals StartFraction 1 Over upper D Subscript i t Baseline EndFraction sigma-summation Underscript d equals 1 Overscript upper D Subscript i t Baseline Endscripts StartFraction StartAbsoluteValue upper R Subscript i t d Baseline EndAbsoluteValue Over upper T upper R Subscript i t d Baseline EndFraction dollar-sign">&#13;
  <mrow>&#13;
    <mtext>RtoTR</mtext>&#13;
    <mo>=</mo>&#13;
    <mfrac><mn>1</mn> <msub><mi>D</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub></mfrac>&#13;
    <msubsup><mo>∑</mo> <mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow> <msub><mi>D</mi> <mrow><mi>i</mi><mi>t</mi></mrow> </msub> </msubsup>&#13;
    <mfrac><mrow><mrow><mo>|</mo></mrow><msub><mi>R</mi> <mrow><mi>i</mi><mi>t</mi><mi>d</mi></mrow> </msub><mrow><mo>|</mo></mrow></mrow> <mrow><mi>T</mi><msub><mi>R</mi> <mrow><mi>i</mi><mi>t</mi><mi>d</mi></mrow> </msub></mrow></mfrac>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="upper T upper R Subscript i t d">&#13;
  <mrow>&#13;
    <mi>T</mi>&#13;
    <msub><mi>R</mi> <mrow><mi>i</mi><mi>t</mi><mi>d</mi></mrow> </msub>&#13;
  </mrow>&#13;
</math> is the monetary volume of stock <em>i</em> on day <em>d</em> at month <em>t</em>, and the rest of the components are the same as in Amihud’s illiquidity measure.</p>&#13;
&#13;
<p>The measure is as easy to calculate as Amihud’s measure, and it has no size bias because it includes the turnover ratio for capturing the trading frequency. This also helps us to examine the price and size effect.</p>&#13;
&#13;
<p>The calculation of the price impact ratio is provided below:<a data-primary="" data-startref="ix_liquidity_meas_price" data-type="indexterm" id="idm45737215998528"/><a data-primary="" data-startref="ix_price_imp_liquidity_meas" data-type="indexterm" id="idm45737215997472"/></p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">18</code><code class="p">]:</code> <code class="n">florackis</code> <code class="o">=</code> <code class="p">[]</code>&#13;
&#13;
         <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">():</code>&#13;
             <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">j</code><code class="p">])):</code>&#13;
                 <code class="n">florackis</code><code class="o">.</code><code class="n">append</code><code class="p">((</code><code class="mi">1</code> <code class="o">/</code> <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'RET'</code><code class="p">]</code><code class="o">.</code><code class="n">count</code><code class="p">())</code> <code class="o">*</code>&#13;
                                  <code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">abs</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'RET'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">])</code> <code class="o">/</code>&#13;
                                          <code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'turnover_ratio'</code><code class="p">][</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">])))</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Coefficient of elasticity of trading" data-type="sect3"><div class="sect3" id="idm45737215996192">&#13;
<h3>Coefficient of elasticity of trading</h3>&#13;
&#13;
<p><a data-primary="liquidity modeling" data-secondary="liquidity measures" data-tertiary="CET" data-type="indexterm" id="idm45737215882688"/><a data-primary="CET (coefficient of elasticity of trading) liquidity measure" data-type="indexterm" id="idm45737215881504"/>CET is a liquidity measure proposed to remedy the shortcomings of time-related liquidity measures such as number of trades and orders per unit of time. These measures are adopted to assess the extent to which market immediacy affects the liquidity level.</p>&#13;
&#13;
<p><a data-primary="immediacy, liquidity dimension" data-type="indexterm" id="idm45737215880208"/>Market immediacy and CET go hand in hand as it measures the price elasticity of trading volume and if price is responsive (i.e., elastic) to the trading volume, that amounts to a greater level of market immediacy:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign CET equals StartFraction percent-sign normal upper Delta upper V Over percent-sign normal upper Delta upper P EndFraction dollar-sign">&#13;
  <mrow>&#13;
    <mtext>CET</mtext>&#13;
    <mo>=</mo>&#13;
    <mfrac><mrow><mo>%</mo><mi>Δ</mi><mi>V</mi></mrow> <mrow><mo>%</mo><mi>Δ</mi><mi>P</mi></mrow></mfrac>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="percent-sign normal upper Delta upper V">&#13;
  <mrow>&#13;
    <mo>%</mo>&#13;
    <mi>Δ</mi>&#13;
    <mi>V</mi>&#13;
  </mrow>&#13;
</math> refers to change in trading volume and <math alttext="percent-sign normal upper Delta upper P">&#13;
  <mrow>&#13;
    <mo>%</mo>&#13;
    <mi>Δ</mi>&#13;
    <mi>P</mi>&#13;
  </mrow>&#13;
</math> denotes a change in price.</p>&#13;
&#13;
<p>The Python code of the CET formula is provided below. As a first part of this application, percentage difference in volume and price are calculated. Then all price impact-based liquidity measures are stored in the <code>liq_vol_all</code> dataframe:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">vol_diff_pct</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">)</code><code class="p">[</code><code class="s1">'</code><code class="s1">VOL</code><code class="s1">'</code><code class="p">]</code><code>\&#13;
</code><code>                                       </code><code class="o">.</code><code class="n">apply</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">x</code><code class="o">.</code><code class="n">diff</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">pct_change</code><code class="p">(</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO3-1" id="co_liquidity_modeling_CO3-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>         </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">price_diff_pct</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">)</code><code class="p">[</code><code class="s1">'</code><code class="s1">PRC</code><code class="s1">'</code><code class="p">]</code><code>\&#13;
</code><code>                                       </code><code class="o">.</code><code class="n">apply</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">x</code><code class="o">.</code><code class="n">diff</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">pct_change</code><code class="p">(</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO3-2" id="co_liquidity_modeling_CO3-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">20</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">cet</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="k">for</code><code> </code><code class="n">j</code><code> </code><code class="ow">in</code><code> </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>             </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code> </code><code class="o">==</code><code> </code><code class="n">j</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>                 </code><code class="n">cet</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">vol_diff_pct</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="o">/</code><code>&#13;
</code><code>                            </code><code class="n">np</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">price_diff_pct</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="n">i</code><code class="p">:</code><code class="n">i</code><code class="o">+</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">21</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">amihud</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">amihud</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">florackis</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">florackis</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">cet</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">cet</code><code class="p">)</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO3-1" id="callout_liquidity_modeling_CO3-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Calculating the percentage volume difference</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO3-2" id="callout_liquidity_modeling_CO3-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Calculating the percentage price difference</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Market Impact-Based Liquidity Measures" data-type="sect2"><div class="sect2" id="idm45737215811328">&#13;
<h2>Market Impact-Based Liquidity Measures</h2>&#13;
&#13;
<p><a data-primary="liquidity modeling" data-secondary="liquidity measures" data-tertiary="market impact-based" data-type="indexterm" id="ix_liquidity_model_meas_market"/><a data-primary="market impact-based liquidity measure" data-type="indexterm" id="ix_market_impact_liquidity"/>Identifying the source of information is a big deal in finance because an unknown source of information might mislead investors and lead to unintended consequences. A price surge, for instance, arising from the market does not provide the same information as one arising from an individual stock. With that being said, a new source of information should be identified in a way to capture price movement &#13;
<span class="keep-together">properly</span>.</p>&#13;
&#13;
<p><a data-primary="unsystematic versus systematic risk, and CAPM" data-type="indexterm" id="idm45737215789088"/><a data-primary="systematic versus unsystematic risk, and CAPM" data-type="indexterm" id="idm45737215788416"/><a data-primary="CAPM (capital asset pricing model)" data-type="indexterm" id="ix_capm_ch7"/>To accomplish this task, we use the capital asset pricing model (CAPM), by which we can distinguish systematic and unsystematic risk. The famous slope coefficient in CAPM indicates systematic risks, and the unsystematic risk is attributable to individual stocks as long as market risk is removed.</p>&#13;
&#13;
<p>As it is referenced in Sarr and Lybek (2002),&#13;
<a data-primary="volume-based liquidity measures" data-secondary="Hui-Heubel ratio" data-type="indexterm" id="idm45737215812816"/><a data-primary="Hui-Heubel ratio" data-type="indexterm" id="idm45737215827520"/>Hui-Heubel embraces the following approach:</p>&#13;
<div data-type="equation" id="capm1">&#13;
<math alttext="dollar-sign upper R Subscript i Baseline equals alpha plus beta upper R Subscript m Baseline plus u Subscript i dollar-sign">&#13;
  <mrow>&#13;
    <msub><mi>R</mi> <mi>i</mi> </msub>&#13;
    <mo>=</mo>&#13;
    <mi>α</mi>&#13;
    <mo>+</mo>&#13;
    <mi>β</mi>&#13;
    <msub><mi>R</mi> <mi>m</mi> </msub>&#13;
    <mo>+</mo>&#13;
    <msub><mi>u</mi> <mi>i</mi> </msub>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="upper R Subscript i">&#13;
  <msub><mi>R</mi> <mi>i</mi> </msub>&#13;
</math> is the daily return on <math alttext="i Superscript t h">&#13;
  <msup><mi>i</mi> <mrow><mi>t</mi><mi>h</mi></mrow> </msup>&#13;
</math> stock, and <math alttext="u Subscript i">&#13;
  <msub><mi>u</mi> <mi>i</mi> </msub>&#13;
</math> is the idiosyncratic or unsystematic risk.</p>&#13;
&#13;
<p>Once we estimate residuals, <math alttext="u Subscript i">&#13;
  <msub><mi>u</mi> <mi>i</mi> </msub>&#13;
</math>, from the equation, it is regressed over the volatility, <math alttext="upper V Subscript i">&#13;
  <msub><mi>V</mi> <mi>i</mi> </msub>&#13;
</math>, and the estimated coefficient of <math alttext="upper V Subscript i">&#13;
  <msub><mi>V</mi> <mi>i</mi> </msub>&#13;
</math> gives the liquidity level of the related stock, also known as the idiosyncratic risk:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign u Subscript i Superscript 2 Baseline equals gamma 1 plus gamma 2 upper V Subscript i Baseline plus e Subscript i dollar-sign">&#13;
  <mrow>&#13;
    <msubsup><mi>u</mi> <mi>i</mi> <mn>2</mn> </msubsup>&#13;
    <mo>=</mo>&#13;
    <msub><mi>γ</mi> <mn>1</mn> </msub>&#13;
    <mo>+</mo>&#13;
    <msub><mi>γ</mi> <mn>2</mn> </msub>&#13;
    <msub><mi>V</mi> <mi>i</mi> </msub>&#13;
    <mo>+</mo>&#13;
    <msub><mi>e</mi> <mi>i</mi> </msub>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="u Subscript i Superscript 2">&#13;
  <msubsup><mi>u</mi> <mi>i</mi> <mn>2</mn> </msubsup>&#13;
</math> denotes the squared residuals, <math alttext="upper V Subscript i">&#13;
  <msub><mi>V</mi> <mi>i</mi> </msub>&#13;
</math> is the daily percentage change in trading volume, and <math alttext="e Subscript i">&#13;
  <msub><mi>e</mi> <mi>i</mi> </msub>&#13;
</math> is the residual term.</p>&#13;
&#13;
<p>Larger <math alttext="gamma 2">&#13;
  <msub><mi>γ</mi> <mn>2</mn> </msub>&#13;
</math> implies larger price movements, and this gives us a sense about the liquidity of the stock. Conversely, the smaller <math alttext="gamma 2">&#13;
  <msub><mi>γ</mi> <mn>2</mn> </msub>&#13;
</math> leads to smaller price movements, indicating higher liquidity levels. In code, we have:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">statsmodels.api</code><code> </code><code class="kn">as</code><code> </code><code class="nn">sm</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">23</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">VOL_pct_change</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">)</code><code class="p">[</code><code class="s1">'</code><code class="s1">VOL</code><code class="s1">'</code><code class="p">]</code><code>\&#13;
</code><code>                                         </code><code class="o">.</code><code class="n">apply</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">x</code><code class="o">.</code><code class="n">pct_change</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">dropna</code><code class="p">(</code><code class="n">subset</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">VOL_pct_change</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">inplace</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">liq_vol_all</code><code> </code><code class="o">=</code><code> </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">unsys_resid</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>             </code><code class="n">X1</code><code> </code><code class="o">=</code><code> </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="n">i</code><code class="p">]</code><code class="p">[</code><code class="s1">'</code><code class="s1">vwretx</code><code class="s1">'</code><code class="p">]</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO4-1" id="co_liquidity_modeling_CO4-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>             </code><code class="n">y</code><code> </code><code class="o">=</code><code> </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="n">i</code><code class="p">]</code><code class="p">[</code><code class="s1">'</code><code class="s1">RET</code><code class="s1">'</code><code class="p">]</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO4-2" id="co_liquidity_modeling_CO4-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>             </code><code class="n">ols</code><code> </code><code class="o">=</code><code> </code><code class="n">sm</code><code class="o">.</code><code class="n">OLS</code><code class="p">(</code><code class="n">y</code><code class="p">,</code><code> </code><code class="n">X1</code><code class="p">)</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO4-3" id="co_liquidity_modeling_CO4-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>             </code><code class="n">unsys_resid</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">ols</code><code class="o">.</code><code class="n">resid</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO4-4" id="co_liquidity_modeling_CO4-4"><img alt="4" src="assets/4.png"/></a></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO4-1" id="callout_liquidity_modeling_CO4-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Assigning volume-weighted returns of all tickers as the independent variable</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO4-2" id="callout_liquidity_modeling_CO4-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Assigning returns of all tickers as the dependent variable</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO4-3" id="callout_liquidity_modeling_CO4-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Running the linear regression model with the defined variables</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO4-4" id="callout_liquidity_modeling_CO4-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Storing the residuals coming from the linear regression as an unsystematic factor</p></dd>&#13;
</dl>&#13;
&#13;
<p>And then we calculate the market impact-based liquidity ratio:</p>&#13;
&#13;
<pre data-type="programlisting">In [25]: market_impact = {}&#13;
&#13;
         for i, j in zip(liq_vol_all.TICKER.unique(),&#13;
                         range(len(liq_vol_all['TICKER'].unique()))):&#13;
             X2 = liq_vol_all[liq_vol_all['TICKER'] == i]['VOL_pct_change'] <a class="co" href="#callout_liquidity_modeling_CO5-1" id="co_liquidity_modeling_CO5-1"><img alt="1" src="assets/1.png"/></a>&#13;
             ols = sm.OLS(unsys_resid[j] ** 2, X2).fit()&#13;
             print('***' * 30)&#13;
             print(f'OLS Result for {i}')&#13;
             print(ols.summary())&#13;
             market_impact[j] = ols.resid <a class="co" href="#callout_liquidity_modeling_CO5-2" id="co_liquidity_modeling_CO5-2"><img alt="2" src="assets/2.png"/></a>&#13;
********************************************************************************&#13;
OLS Result for INTC&#13;
                        OLS Regression Results&#13;
================================================================================&#13;
Dep. Variable:                  y   R-squared (uncentered):                0.157&#13;
Model:                        OLS   Adj. R-squared (uncentered)            0.154&#13;
Method:             Least Squares   F-statistic:                           46.31&#13;
Date:            Thu, 02 Dec 2021   Prob (F-statistic):                 7.53e-11&#13;
Time:                    15:33:38   Log-Likelihood:                       1444.9&#13;
No. Observations:             249   AIC:                                  -2888.&#13;
Df Residuals:                 248   BIC:                                  -2884.&#13;
Df Model:                       1&#13;
Covariance Type:        nonrobust&#13;
================================================================================&#13;
                   coef    std err          t      P&gt;|t|      [0.025      0.975]&#13;
--------------------------------------------------------------------------------&#13;
VOL_pct_change    0.0008     0.000      6.805      0.000       0.001       0.001&#13;
==============================================================================&#13;
Omnibus:                      373.849   Durbin-Watson:                   1.908&#13;
Prob(Omnibus):                  0.000   Jarque-Bera (JB):            53506.774&#13;
Skew:                           7.228   Prob(JB):                         0.00&#13;
Kurtosis:                      73.344   Cond. No.                         1.00&#13;
==============================================================================&#13;
&#13;
Notes:&#13;
[1] R² is computed without centering (uncentered) since the model does not&#13;
contain a constant.&#13;
[2] Standard Errors assume that the covariance matrix of the errors is&#13;
correctly specified.&#13;
********************************************************************************&#13;
OLS Result for MSFT&#13;
                        OLS Regression Results&#13;
================================================================================&#13;
Dep. Variable:                  y   R-squared (uncentered):                0.044&#13;
Model:                        OLS   Adj. R-squared (uncentered):           0.040&#13;
Method:             Least Squares   F-statistic:                           11.45&#13;
Date:            Thu, 02 Dec 2021   Prob (F-statistic):                 0.000833&#13;
Time:                    15:33:38   Log-Likelihood:                       1851.0&#13;
No. Observations:             249   AIC:                                 -3700.&#13;
Df Residuals:                 248   BIC:                                 -3696.&#13;
Df Model:                       1&#13;
Covariance Type:        nonrobust&#13;
================================================================================&#13;
                   coef    std err          t      P&gt;|t|      [0.025      0.975]&#13;
--------------------------------------------------------------------------------&#13;
VOL_pct_change  9.641e-05  2.85e-05     3.383      0.001      4.03e-05     0.000&#13;
==============================================================================&#13;
Omnibus:                      285.769   Durbin-Watson:                   1.533&#13;
Prob(Omnibus):                  0.000   Jarque-Bera (JB):            11207.666&#13;
Skew:                           4.937   Prob(JB):                         0.00&#13;
Kurtosis:                      34.349   Cond. No.                         1.00&#13;
==============================================================================&#13;
&#13;
Notes:&#13;
[1] R² is computed without centering (uncentered) since the model does not&#13;
contain a constant.&#13;
[2] Standard Errors assume that the covariance matrix of the errors is&#13;
correctly specified.&#13;
&#13;
********************************************************************************&#13;
OLS Result for IBM&#13;
                         OLS Regression Results&#13;
================================================================================&#13;
Dep. Variable:                  y   R-squared (uncentered):                0.134&#13;
Model:                        OLS   Adj. R-squared (uncentered):           0.130&#13;
Method:             Least Squares   F-statistic:                           38.36&#13;
Date:            Thu, 02 Dec 2021   Prob (F-statistic):                 2.43e-09&#13;
Time:                    15:33:38   Log-Likelihood:                       1547.1&#13;
No. Observations:             249   AIC:                                  -3092.&#13;
Df Residuals:                 248   BIC:                                  -3089.&#13;
Df Model:                       1&#13;
Covariance Type:        nonrobust&#13;
================================================================================&#13;
                  coef    std err          t      P&gt;|t|      [0.025      0.975]&#13;
--------------------------------------------------------------------------------&#13;
VOL_pct_change  0.0005   7.43e-05      6.193      0.000       0.000       0.001&#13;
==============================================================================&#13;
Omnibus:                      446.818   Durbin-Watson:                   2.034&#13;
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           156387.719&#13;
Skew:                           9.835   Prob(JB):                         0.00&#13;
Kurtosis:                     124.188   Cond. No.                         1.00&#13;
==============================================================================&#13;
&#13;
Notes:&#13;
[1] R² is computed without centering (uncentered) since the model does not&#13;
contain a constant.&#13;
[2] Standard Errors assume that the covariance matrix of the errors is&#13;
correctly specified.</pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO5-1" id="callout_liquidity_modeling_CO5-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Assigning percentage change in volume of all tickers as the independent variable</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO5-2" id="callout_liquidity_modeling_CO5-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Market impact the residual of this linear regression</p></dd>&#13;
</dl>&#13;
&#13;
<p>Then, we include the market impact in our dataframe and observe the summary statistics of all the liquidity measures that we’ve introduced so far:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">append1</code><code> </code><code class="o">=</code><code> </code><code class="n">market_impact</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">market_impact</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">liq_vol_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">market_impact</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">append1</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">market_impact</code><code class="p">[</code><code class="mi">2</code><code class="p">]</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO6-1" id="co_liquidity_modeling_CO6-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">cols</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">vol_diff_pct</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">price_diff_pct</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">price_diff</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                 </code><code class="s1">'</code><code class="s1">VOL_pct_change</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">dvol</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">mid_price</code><code class="s1">'</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="n">liq_measures_all</code><code> </code><code class="o">=</code><code> </code><code class="n">liq_vol_all</code><code class="o">.</code><code class="n">drop</code><code class="p">(</code><code class="n">liq_vol_all</code><code class="p">[</code><code class="n">cols</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">axis</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code>\&#13;
</code><code>                            </code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mi">11</code><code class="p">:</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="n">liq_measures_all</code><code class="o">.</code><code class="n">dropna</code><code class="p">(</code><code class="n">inplace</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">liq_measures_all</code><code class="o">.</code><code class="n">describe</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">T</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code>                       </code><code class="n">count</code><code>          </code><code class="n">mean</code><code>           </code><code class="n">std</code><code>           </code><code class="nb">min</code><code> </code><code>\&#13;
</code><code>         </code><code class="n">liq_ratio</code><code>             </code><code class="mf">738.0</code><code>  </code><code class="mf">7.368514e+10</code><code>  </code><code class="mf">2.569030e+11</code><code>  </code><code class="mf">8.065402e+08</code><code>&#13;
</code><code>         </code><code class="n">Lhh</code><code>                   </code><code class="mf">738.0</code><code>  </code><code class="mf">3.340167e-05</code><code>  </code><code class="mf">5.371681e-05</code><code>  </code><code class="mf">3.966368e-06</code><code>&#13;
</code><code>         </code><code class="n">turnover_ratio</code><code>        </code><code class="mf">738.0</code><code>  </code><code class="mf">6.491127e-03</code><code>  </code><code class="mf">2.842668e-03</code><code>  </code><code class="mf">1.916371e-03</code><code>&#13;
</code><code>         </code><code class="n">percent_quoted_ba</code><code>     </code><code class="mf">738.0</code><code>  </code><code class="mf">1.565276e-02</code><code>  </code><code class="mf">7.562850e-03</code><code>  </code><code class="mf">3.779877e-03</code><code>&#13;
</code><code>         </code><code class="n">percent_effective_ba</code><code>  </code><code class="mf">738.0</code><code>  </code><code class="mf">8.334177e-03</code><code>  </code><code class="mf">7.100304e-03</code><code>  </code><code class="mf">0.000000e+00</code><code>&#13;
</code><code>         </code><code class="n">roll</code><code>                  </code><code class="mf">738.0</code><code>  </code><code class="mf">8.190794e-01</code><code>  </code><code class="mf">6.066821e-01</code><code>  </code><code class="mf">7.615773e-02</code><code>&#13;
</code><code>         </code><code class="n">CS_spread</code><code>             </code><code class="mf">738.0</code><code>  </code><code class="mf">3.305464e-01</code><code>  </code><code class="mf">1.267434e-01</code><code>  </code><code class="mf">1.773438e-40</code><code>&#13;
</code><code>         </code><code class="n">amihud</code><code>                </code><code class="mf">738.0</code><code>  </code><code class="mf">2.777021e-15</code><code>  </code><code class="mf">2.319450e-15</code><code>  </code><code class="mf">0.000000e+00</code><code>&#13;
</code><code>         </code><code class="n">florackis</code><code>             </code><code class="mf">738.0</code><code>  </code><code class="mf">2.284291e-03</code><code>  </code><code class="mf">1.546181e-03</code><code>  </code><code class="mf">0.000000e+00</code><code>&#13;
</code><code>         </code><code class="n">cet</code><code>                   </code><code class="mf">738.0</code><code> </code><code class="o">-</code><code class="mf">1.113583e+00</code><code>  </code><code class="mf">3.333932e+01</code><code> </code><code class="o">-</code><code class="mf">4.575246e+02</code><code>&#13;
</code><code>         </code><code class="n">market_impact</code><code>         </code><code class="mf">738.0</code><code>  </code><code class="mf">8.614680e-05</code><code>  </code><code class="mf">5.087547e-04</code><code> </code><code class="o">-</code><code class="mf">1.596135e-03</code><code>&#13;
</code><code>&#13;
</code><code>                                   </code><code class="mi">25</code><code class="o">%</code><code>           </code><code class="mi">50</code><code class="o">%</code><code>           </code><code class="mi">75</code><code class="o">%</code><code>           </code><code class="nb">max</code><code>&#13;
</code><code>    </code><code class="n">liq_ratio</code><code>             </code><code class="mf">1.378496e+10</code><code>  </code><code class="mf">2.261858e+10</code><code>  </code><code class="mf">4.505784e+10</code><code>  </code><code class="mf">3.095986e+12</code><code>&#13;
</code><code>    </code><code class="n">Lhh</code><code>                   </code><code class="mf">1.694354e-05</code><code>  </code><code class="mf">2.368095e-05</code><code>  </code><code class="mf">3.558960e-05</code><code>  </code><code class="mf">5.824148e-04</code><code>&#13;
</code><code>    </code><code class="n">turnover_ratio</code><code>        </code><code class="mf">4.897990e-03</code><code>  </code><code class="mf">5.764112e-03</code><code>  </code><code class="mf">7.423111e-03</code><code>  </code><code class="mf">2.542853e-02</code><code>&#13;
</code><code>    </code><code class="n">percent_quoted_ba</code><code>     </code><code class="mf">1.041887e-02</code><code>  </code><code class="mf">1.379992e-02</code><code>  </code><code class="mf">1.878123e-02</code><code>  </code><code class="mf">5.545110e-02</code><code>&#13;
</code><code>    </code><code class="n">percent_effective_ba</code><code>  </code><code class="mf">3.032785e-03</code><code>  </code><code class="mf">6.851479e-03</code><code>  </code><code class="mf">1.152485e-02</code><code>  </code><code class="mf">4.656669e-02</code><code>&#13;
</code><code>    </code><code class="n">roll</code><code>                  </code><code class="mf">4.574986e-01</code><code>  </code><code class="mf">6.975982e-01</code><code>  </code><code class="mf">1.011879e+00</code><code>  </code><code class="mf">4.178873e+00</code><code>&#13;
</code><code>    </code><code class="n">CS_spread</code><code>             </code><code class="mf">2.444225e-01</code><code>  </code><code class="mf">3.609800e-01</code><code>  </code><code class="mf">4.188028e-01</code><code>  </code><code class="mf">5.877726e-01</code><code>&#13;
</code><code>    </code><code class="n">amihud</code><code>                </code><code class="mf">1.117729e-15</code><code>  </code><code class="mf">2.220439e-15</code><code>  </code><code class="mf">3.766086e-15</code><code>  </code><code class="mf">1.320828e-14</code><code>&#13;
</code><code>    </code><code class="n">florackis</code><code>             </code><code class="mf">1.059446e-03</code><code>  </code><code class="mf">2.013517e-03</code><code>  </code><code class="mf">3.324181e-03</code><code>  </code><code class="mf">7.869841e-03</code><code>&#13;
</code><code>    </code><code class="n">cet</code><code>                  </code><code class="o">-</code><code class="mf">1.687807e-01</code><code>  </code><code class="mf">5.654237e-01</code><code>  </code><code class="mf">1.660166e+00</code><code>  </code><code class="mf">1.845917e+02</code><code>&#13;
</code><code>    </code><code class="n">market_impact</code><code>        </code><code class="o">-</code><code class="mf">3.010645e-05</code><code>  </code><code class="mf">3.383862e-05</code><code>  </code><code class="mf">1.309451e-04</code><code>  </code><code class="mf">8.165527e-03</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO6-1" id="callout_liquidity_modeling_CO6-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Appending market impact into the <code>liq_vol_all</code> dataframe.<a data-primary="" data-startref="ix_capm_ch7" data-type="indexterm" id="idm45737215491408"/></p></dd>&#13;
</dl>&#13;
&#13;
<p>These are the liquidity measures that we take advantage of in the process of modeling the liquidity via GMM. Now let’s discuss this via a probabilistic unsupervised learning algorithm.<a data-primary="" data-startref="ix_liquidity_model_meas_ch7" data-type="indexterm" id="idm45737214177456"/><a data-primary="" data-startref="ix_liquidity_model_meas_market" data-type="indexterm" id="idm45737214176448"/><a data-primary="" data-startref="ix_market_impact_liquidity" data-type="indexterm" id="idm45737214175488"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Gaussian Mixture Model" data-type="sect1"><div class="sect1" id="idm45737215810864">&#13;
<h1>Gaussian Mixture Model</h1>&#13;
&#13;
<p><a data-primary="GMM (Gaussian mixture model)" data-type="indexterm" id="ix_gmm_liquidity"/><a data-primary="liquidity modeling" data-secondary="GMM" data-type="indexterm" id="ix_liquidity_model_gmm"/><a data-primary="clustering method" data-secondary="GMM" data-type="indexterm" id="ix_cluster_GMM"/>What happens if we have data with several modes that represent different aspects of the data? Or let’s put it in the context of liquidity measures, how can you model &#13;
<span class="keep-together">liquidity</span> measures with different mean variance? As you can imagine, data consisting of liquidity measures is multimodal, meaning that there exists several different high-probability masses and our task is to find out which model fits best to this type &#13;
<span class="keep-together">of data.</span></p>&#13;
&#13;
<p>It is evident that the proposed model is supposed to include a mixture of several components, and without knowing the specific liquidity measure, it should be clustered based on the values obtained from the measures. To recap, we will have one big dataset that includes all liquidity measures, and assuming for the moment that we forgot to assign labels to these measures, we need a model that presents different distributions of these measures without knowing the labels. This model is GMM, which enables us to model multimodal data without knowing the names of the variables.</p>&#13;
&#13;
<p>Considering the different focus of the liquidity measures introduced before, if we somehow manage to model this data, that means we can capture different liquidity level at different times. For instance, liquidity in a high-volatility period cannot be modeled in the same way as a low-volatility period. In a similar vein, given the depth of the market, we need to focus on these different aspects of liquidity. GMM provides us with a tool to address this problem.</p>&#13;
&#13;
<p>Long story short, if a market is experiencing a boom period, which coincides with high volatility, volume and transaction cost–based measures would be good choices, and if a market ends up with price discontinuity, price-based measures would be the optimal choice. Of course, we are not talking about one-size-fits-all measures—there may be some instances in which a mixture of measures would work better.</p>&#13;
&#13;
<p><a data-primary="credit risk" data-secondary="risk bucketing" data-tertiary="versus GMM" data-tertiary-sortas="GMM" data-type="indexterm" id="idm45737214164560"/><a data-primary="risk bucketing" data-secondary="versus GMM" data-secondary-sortas="GMM" data-type="indexterm" id="idm45737214163040"/><a data-primary="K-means algorithm for clustering customers" data-secondary="versus GMM" data-secondary-sortas="GMM" data-type="indexterm" id="idm45737214161824"/>As put by VanderPlas (2016), for K-means to succeed, cluster models must have circular characteristics. Nevertheless, many financial variables exhibit non-circular shapes that make it hard to model via K-means. As is readily observable, liquidity measures overlap and do not have circular shapes, so GMM with its probabilistic nature would be a good choice for modeling this type of data, as described by&#13;
Fraley and Raftery (1998):</p>&#13;
<blockquote data-type="epigram">&#13;
<p>One advantage of the mixture-model approach to clustering is that it allows the use of approximate Bayes factors to compare models. This gives a systematic means of selecting not only the parameterization of the model (and hence the clustering method), but also the number of clusters.</p>&#13;
</blockquote>&#13;
&#13;
<p>In this part, we would like to import necessary libraries to be used in the GMM. <a data-primary="scaling, in GMM clustering method" data-type="indexterm" id="idm45737214596128"/>Also, scaling is applied, which is an essential step in clustering as we have mixed numerical values in the dataframe. In the last part of the code that follows, a histogram is drawn to observe the multimodality in the data (<a data-type="xref" href="#modality_liq">Figure 7-1</a>). This is a phenomenon that we have discussed in the very first part of this section.</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">28</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">sklearn.mixture</code> <code class="kn">import</code> <code class="n">GaussianMixture</code>&#13;
         <code class="kn">from</code> <code class="nn">sklearn.preprocessing</code> <code class="kn">import</code> <code class="n">StandardScaler</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">29</code><code class="p">]:</code> <code class="n">liq_measures_all2</code> <code class="o">=</code> <code class="n">liq_measures_all</code><code class="o">.</code><code class="n">dropna</code><code class="p">()</code>&#13;
         <code class="n">scaled_liq</code> <code class="o">=</code> <code class="n">StandardScaler</code><code class="p">()</code><code class="o">.</code><code class="n">fit_transform</code><code class="p">(</code><code class="n">liq_measures_all2</code><code class="p">)</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">30</code><code class="p">]:</code> <code class="n">kwargs</code> <code class="o">=</code> <code class="nb">dict</code><code class="p">(</code><code class="n">alpha</code><code class="o">=</code><code class="mf">0.5</code><code class="p">,</code> <code class="n">bins</code><code class="o">=</code><code class="mi">50</code><code class="p">,</code>  <code class="n">stacked</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">liq_measures_all</code><code class="o">.</code><code class="n">loc</code><code class="p">[:,</code> <code class="s1">'percent_quoted_ba'</code><code class="p">],</code>&#13;
                  <code class="o">**</code><code class="n">kwargs</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'TC-based'</code><code class="p">)</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">liq_measures_all</code><code class="o">.</code><code class="n">loc</code><code class="p">[:,</code> <code class="s1">'turnover_ratio'</code><code class="p">],</code>&#13;
                  <code class="o">**</code><code class="n">kwargs</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'Volume-based'</code><code class="p">)</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">liq_measures_all</code><code class="o">.</code><code class="n">loc</code><code class="p">[:,</code> <code class="s1">'market_impact'</code><code class="p">],</code>&#13;
                  <code class="o">**</code><code class="n">kwargs</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'Market-based'</code><code class="p">)</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">title</code><code class="p">(</code><code class="s1">'Multi Modality of the Liquidity Measures'</code><code class="p">)</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code></pre>&#13;
&#13;
<figure><div class="figure" id="modality_liq">&#13;
<img alt="modality" src="assets/mlfr_0701.png"/>&#13;
<h6><span class="label">Figure 7-1. </span>Multimodality of the liquidity measures</h6>&#13;
</div></figure>&#13;
&#13;
<p>And now, given the transaction cost, volume, and market-based liquidity measures, multimodality (i.e., three peaks) can be easily observed in  <a data-type="xref" href="#modality_liq">Figure 7-1</a>. Due to the &#13;
<span class="keep-together">scaling</span> issue, the price impact–based liquidity dimension is not included in the &#13;
<span class="keep-together">histogram</span>.</p>&#13;
&#13;
<p>Now, let’s run GMM and see how we can cluster the liquidity measures. But first, a common question arises: how many clusters should we have? <a data-primary="BIC (Bayesian Information Criteria)" data-type="indexterm" id="idm45737214708096"/>To address this question, we’ll use BIC again, and generate the plot shown in <a data-type="xref" href="#scree_gmm">Figure 7-2</a>:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">31</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">n_components</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">10</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">clusters</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="n">GaussianMixture</code><code class="p">(</code><code class="n">n</code><code class="p">,</code><code> </code><code class="n">covariance_type</code><code class="o">=</code><code class="s1">'</code><code class="s1">spherical</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                     </code><code class="n">random_state</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">scaled_liq</code><code class="p">)</code><code>&#13;
</code><code>                   </code><code class="k">for</code><code> </code><code class="n">n</code><code> </code><code class="ow">in</code><code> </code><code class="n">n_components</code><code class="p">]</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO7-1" id="co_liquidity_modeling_CO7-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">n_components</code><code class="p">,</code><code> </code><code class="p">[</code><code class="n">m</code><code class="o">.</code><code class="n">bic</code><code class="p">(</code><code class="n">scaled_liq</code><code class="p">)</code><code> </code><code class="k">for</code><code> </code><code class="n">m</code><code> </code><code class="ow">in</code><code> </code><code class="n">clusters</code><code class="p">]</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO7-2" id="co_liquidity_modeling_CO7-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">title</code><code class="p">(</code><code class="s1">'</code><code class="s1">Optimum Number of Components</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">n_components</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">BIC values</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">(</code><code class="p">)</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO7-1" id="callout_liquidity_modeling_CO7-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Generating different BIC values based on different numbers of clusters</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO7-2" id="callout_liquidity_modeling_CO7-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Drawing a line plot for BIC values given number of components</p></dd>&#13;
</dl>&#13;
&#13;
<figure><div class="figure" id="scree_gmm">&#13;
<img alt="opt_cluster" src="assets/mlfr_0702.png"/>&#13;
<h6><span class="label">Figure 7-2. </span>Optimum number of components</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-type="xref" href="#scree_gmm">Figure 7-2</a> shows us that the line seems to flatten out after the third cluster, making that an ideal point at which to stop.</p>&#13;
&#13;
<p><a data-primary="state, in cluster method" data-type="indexterm" id="idm45737214740128"/>Using the following code, we are able to detect the state by which data is best represented. The term <em>state</em> represents nothing but the cluster with the highest posterior probability. It means that this specific state accounts for the dynamics of the data most. In this case, State-3 with a probability of 0.55 is the most likely state to explain the dynamics of the data:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">cluster_state</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="n">nstates</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>             </code><code class="n">gmm</code><code> </code><code class="o">=</code><code> </code><code class="n">GaussianMixture</code><code class="p">(</code><code class="n">n_components</code><code class="o">=</code><code class="n">nstates</code><code class="p">,</code><code>&#13;
</code><code>                                   </code><code class="n">covariance_type</code><code class="o">=</code><code class="s1">'</code><code class="s1">spherical</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                   </code><code class="n">init_params</code><code class="o">=</code><code class="s1">'</code><code class="s1">kmeans</code><code class="s1">'</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO8-1" id="co_liquidity_modeling_CO8-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>             </code><code class="n">gmm_fit</code><code> </code><code class="o">=</code><code> </code><code class="n">gmm</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">scaled_liq</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO8-2" id="co_liquidity_modeling_CO8-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>             </code><code class="n">labels</code><code> </code><code class="o">=</code><code> </code><code class="n">gmm_fit</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">scaled_liq</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO8-3" id="co_liquidity_modeling_CO8-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>             </code><code class="n">state_probs</code><code> </code><code class="o">=</code><code> </code><code class="n">gmm</code><code class="o">.</code><code class="n">predict_proba</code><code class="p">(</code><code class="n">scaled_liq</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO8-4" id="co_liquidity_modeling_CO8-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>             </code><code class="n">state_probs_df</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">state_probs</code><code class="p">,</code><code>&#13;
</code><code>                                           </code><code class="n">columns</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">state-1</code><code class="s1">'</code><code class="p">,</code><code class="s1">'</code><code class="s1">state-2</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                                    </code><code class="s1">'</code><code class="s1">state-3</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>&#13;
</code><code>             </code><code class="n">state_prob_means</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="n">state_probs_df</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="n">i</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>                                 </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">state_probs_df</code><code class="o">.</code><code class="n">columns</code><code class="p">)</code><code class="p">)</code><code class="p">]</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO8-5" id="co_liquidity_modeling_CO8-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>             </code><code class="k">if</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">max</code><code class="p">(</code><code class="n">state_prob_means</code><code class="p">)</code><code> </code><code class="o">==</code><code> </code><code class="n">state_prob_means</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">:</code><code>&#13;
</code><code>                 </code><code class="k">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">State-1 is likely to occur with a probability of {:4f}</code><code class="s1">'</code><code>&#13;
</code><code>                       </code><code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">state_prob_means</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>             </code><code class="k">elif</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">max</code><code class="p">(</code><code class="n">state_prob_means</code><code class="p">)</code><code> </code><code class="o">==</code><code> </code><code class="n">state_prob_means</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">:</code><code>&#13;
</code><code>                 </code><code class="k">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">State-2 is likely to occur with a probability of {:4f}</code><code class="s1">'</code><code>&#13;
</code><code>                       </code><code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">state_prob_means</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>             </code><code class="k">else</code><code class="p">:</code><code>&#13;
</code><code>                 </code><code class="k">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">State-3 is likely to occur with a probability of {:4f}</code><code class="s1">'</code><code>&#13;
</code><code>                       </code><code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">state_prob_means</code><code class="p">[</code><code class="mi">2</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>             </code><code class="k">return</code><code> </code><code class="n">state_probs</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">state_probs</code><code> </code><code class="o">=</code><code> </code><code class="n">cluster_state</code><code class="p">(</code><code class="n">scaled_liq</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="k">print</code><code class="p">(</code><code class="n">f</code><code class="s1">'</code><code class="s1">State probabilities are {state_probs.mean(axis=0)}</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="n">State</code><code class="o">-</code><code class="mi">3</code><code> </code><code class="ow">is</code><code> </code><code class="n">likely</code><code> </code><code class="n">to</code><code> </code><code class="n">occur</code><code> </code><code class="k">with</code><code> </code><code class="n">a</code><code> </code><code class="n">probability</code><code> </code><code class="n">of</code><code> </code><code class="mf">0.550297</code><code>&#13;
</code><code>         </code><code class="n">State</code><code> </code><code class="n">probabilities</code><code> </code><code class="n">are</code><code> </code><code class="p">[</code><code class="mf">0.06285593</code><code> </code><code class="mf">0.38684657</code><code> </code><code class="mf">0.5502975</code><code> </code><code class="p">]</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO8-1" id="callout_liquidity_modeling_CO8-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Configuring the GMM</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO8-2" id="callout_liquidity_modeling_CO8-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Fitting GMM with scaled data</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO8-3" id="callout_liquidity_modeling_CO8-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Running prediction</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO8-4" id="callout_liquidity_modeling_CO8-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Obtaining the state probabilities</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO8-5" id="callout_liquidity_modeling_CO8-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Computing the average of all three state probabilities</p></dd>&#13;
</dl>&#13;
&#13;
<p><a data-primary="PCA (principle component analysis) of bid-ask spread" data-type="indexterm" id="ix_PCA_bid-ask2"/>All right, does it not make sense to apply GMM to cluster liquidity measures and extract the likely state to represent it as one-dimensional data? It literally makes our lives easier because at the end of the data, we come up with only one cluster with highest probability. But what would you think if we applied PCA to fully understand which variables are correlated with the prevailing state? In PCA, we are able to build a bridge between components and features using loadings so that we can analyze which liquidity measures have the defining characteristics of a specific period.</p>&#13;
&#13;
<p>As a first step, let’s apply PCA and create a scree plot (<a data-type="xref" href="#scree_plot_gmm">Figure 7-3</a>) to determine the number of components we are working with:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">34</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">sklearn.decomposition</code> <code class="kn">import</code> <code class="n">PCA</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">35</code><code class="p">]:</code> <code class="n">pca</code> <code class="o">=</code> <code class="n">PCA</code><code class="p">(</code><code class="n">n_components</code><code class="o">=</code><code class="mi">11</code><code class="p">)</code>&#13;
         <code class="n">components</code> <code class="o">=</code> <code class="n">pca</code><code class="o">.</code><code class="n">fit_transform</code><code class="p">(</code><code class="n">scaled_liq</code><code class="p">)</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">pca</code><code class="o">.</code><code class="n">explained_variance_ratio_</code><code class="p">)</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">title</code><code class="p">(</code><code class="s1">'Scree Plot'</code><code class="p">)</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'Number of Components'</code><code class="p">)</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s1">'</code><code class="si">% o</code><code class="s1">f Explained Variance'</code><code class="p">)</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code></pre>&#13;
&#13;
<figure class="width-90"><div class="figure" id="scree_plot_gmm">&#13;
<img alt="scree_plot_gmm" src="assets/mlfr_0703.png"/>&#13;
<h6><span class="label">Figure 7-3. </span>Scree plot</h6>&#13;
</div></figure>&#13;
&#13;
<p>Based on <a data-type="xref" href="#scree_plot_gmm">Figure 7-3</a>, we’ll decide to stop at component 3.</p>&#13;
&#13;
<p>As we now have determined the number of components, let’s rerun PCA with three components and GMM. Similar to our previous GMM application, posterior probability is calculated and assigned to a variable named <code>state_probs</code>:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">36</code><code class="p">]:</code> <code class="k">def</code> <code class="nf">gmm_pca</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">nstate</code><code class="p">):</code>&#13;
             <code class="n">pca</code> <code class="o">=</code> <code class="n">PCA</code><code class="p">(</code><code class="n">n_components</code><code class="o">=</code><code class="mi">3</code><code class="p">)</code>&#13;
             <code class="n">components</code> <code class="o">=</code> <code class="n">pca</code><code class="o">.</code><code class="n">fit_transform</code><code class="p">(</code><code class="n">data</code><code class="p">)</code>&#13;
             <code class="n">mxtd</code> <code class="o">=</code> <code class="n">GaussianMixture</code><code class="p">(</code><code class="n">n_components</code><code class="o">=</code><code class="n">nstate</code><code class="p">,</code>&#13;
                                    <code class="n">covariance_type</code><code class="o">=</code><code class="s1">'spherical'</code><code class="p">)</code>&#13;
             <code class="n">gmm</code> <code class="o">=</code> <code class="n">mxtd</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">components</code><code class="p">)</code>&#13;
             <code class="n">labels</code> <code class="o">=</code> <code class="n">gmm</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">components</code><code class="p">)</code>&#13;
             <code class="n">state_probs</code> <code class="o">=</code> <code class="n">gmm</code><code class="o">.</code><code class="n">predict_proba</code><code class="p">(</code><code class="n">components</code><code class="p">)</code>&#13;
             <code class="k">return</code> <code class="n">state_probs</code><code class="p">,</code><code class="n">pca</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">37</code><code class="p">]:</code> <code class="n">state_probs</code><code class="p">,</code> <code class="n">pca</code> <code class="o">=</code> <code class="n">gmm_pca</code><code class="p">(</code><code class="n">scaled_liq</code><code class="p">,</code> <code class="mi">3</code><code class="p">)</code>&#13;
         <code class="k">print</code><code class="p">(</code><code class="n">f</code><code class="s1">'State probabilities are {state_probs.mean(axis=0)}'</code><code class="p">)</code>&#13;
         <code class="n">State</code> <code class="n">probabilities</code> <code class="n">are</code> <code class="p">[</code><code class="mf">0.7329713</code>  <code class="mf">0.25076855</code> <code class="mf">0.01626015</code><code class="p">]</code></pre>&#13;
&#13;
<p>In what follows, we find out the state with the highest probability, and it turns out to be State-1 with a probability of 73%:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">38</code><code class="p">]:</code> <code class="k">def</code> <code class="nf">wpc</code><code class="p">():</code>&#13;
             <code class="n">state_probs_df</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">state_probs</code><code class="p">,</code>&#13;
                                           <code class="n">columns</code><code class="o">=</code><code class="p">[</code><code class="s1">'state-1'</code><code class="p">,</code> <code class="s1">'state-2'</code><code class="p">,</code>&#13;
                                                    <code class="s1">'state-3'</code><code class="p">])</code>&#13;
             <code class="n">state_prob_means</code> <code class="o">=</code> <code class="p">[</code><code class="n">state_probs_df</code><code class="o">.</code><code class="n">iloc</code><code class="p">[:,</code> <code class="n">i</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">()</code>&#13;
                                 <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">state_probs_df</code><code class="o">.</code><code class="n">columns</code><code class="p">))]</code>&#13;
             <code class="k">if</code> <code class="n">np</code><code class="o">.</code><code class="n">max</code><code class="p">(</code><code class="n">state_prob_means</code><code class="p">)</code> <code class="o">==</code> <code class="n">state_prob_means</code><code class="p">[</code><code class="mi">0</code><code class="p">]:</code>&#13;
                 <code class="k">print</code><code class="p">(</code><code class="s1">'State-1 is likely to occur with a probability of {:4f}'</code>&#13;
                       <code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">state_prob_means</code><code class="p">[</code><code class="mi">0</code><code class="p">]))</code>&#13;
             <code class="k">elif</code> <code class="n">np</code><code class="o">.</code><code class="n">max</code><code class="p">(</code><code class="n">state_prob_means</code><code class="p">)</code> <code class="o">==</code> <code class="n">state_prob_means</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code>&#13;
                 <code class="k">print</code><code class="p">(</code><code class="s1">'State-2 is likely to occur with a probability of {:4f}'</code>&#13;
                       <code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">state_prob_means</code><code class="p">[</code><code class="mi">1</code><code class="p">]))</code>&#13;
             <code class="k">else</code><code class="p">:</code>&#13;
                 <code class="k">print</code><code class="p">(</code><code class="s1">'State-3 is likely to occur with a probability of {:4f}'</code>&#13;
                       <code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">state_prob_means</code><code class="p">[</code><code class="mi">2</code><code class="p">]))</code>&#13;
         <code class="n">wpc</code><code class="p">()</code>&#13;
         <code class="n">State</code><code class="o">-</code><code class="mi">1</code> <code class="ow">is</code> <code class="n">likely</code> <code class="n">to</code> <code class="n">occur</code> <code class="k">with</code> <code class="n">a</code> <code class="n">probability</code> <code class="n">of</code> <code class="mf">0.732971</code></pre>&#13;
&#13;
<p>Let’s now turn our attention to finding which liquidity measures matter most using loading analysis. This analysis suggests that <code>turnover_ratio</code>, <code>percent_quoted_ba</code>, <code>percent_effective_ba</code>, <code>amihud</code>, and <code>florackis</code> ratios are the liquidity ratios composing the State-1. The following code shows the result:<a data-primary="" data-startref="ix_cluster_GMM" data-type="indexterm" id="idm45737213818304"/><a data-primary="" data-startref="ix_gmm_liquidity" data-type="indexterm" id="idm45737213817328"/><a data-primary="" data-startref="ix_liquidity_model_gmm" data-type="indexterm" id="idm45737213816384"/><a data-primary="" data-startref="ix_PCA_bid-ask2" data-type="indexterm" id="idm45737213815440"/></p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">loadings</code><code> </code><code class="o">=</code><code> </code><code class="n">pca</code><code class="o">.</code><code class="n">components_</code><code class="o">.</code><code class="n">T</code><code> </code><code class="o">*</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">pca</code><code class="o">.</code><code class="n">explained_variance_</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO9-1" id="co_liquidity_modeling_CO9-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>         </code><code class="n">loading_matrix</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">loadings</code><code class="p">,</code><code>&#13;
</code><code>                                       </code><code class="n">columns</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">PC1</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">PC2</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">PC3</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>                                       </code><code class="n">index</code><code class="o">=</code><code class="n">liq_measures_all</code><code class="o">.</code><code class="n">columns</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">loading_matrix</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code>                            </code><code class="n">PC1</code><code>       </code><code class="n">PC2</code><code>       </code><code class="n">PC3</code><code>&#13;
</code><code>         </code><code class="n">liq_ratio</code><code>             </code><code class="mf">0.116701</code><code> </code><code class="o">-</code><code class="mf">0.115791</code><code> </code><code class="o">-</code><code class="mf">0.196355</code><code>&#13;
</code><code>         </code><code class="n">Lhh</code><code>                  </code><code class="o">-</code><code class="mf">0.211827</code><code>  </code><code class="mf">0.882007</code><code> </code><code class="o">-</code><code class="mf">0.125890</code><code>&#13;
</code><code>         </code><code class="n">turnover_ratio</code><code>        </code><code class="mf">0.601041</code><code> </code><code class="o">-</code><code class="mf">0.006381</code><code>  </code><code class="mf">0.016222</code><code>&#13;
</code><code>         </code><code class="n">percent_quoted_ba</code><code>     </code><code class="mf">0.713239</code><code>  </code><code class="mf">0.140103</code><code>  </code><code class="mf">0.551385</code><code>&#13;
</code><code>         </code><code class="n">percent_effective_ba</code><code>  </code><code class="mf">0.641527</code><code>  </code><code class="mf">0.154973</code><code>  </code><code class="mf">0.526933</code><code>&#13;
</code><code>         </code><code class="n">roll</code><code>                 </code><code class="o">-</code><code class="mf">0.070192</code><code>  </code><code class="mf">0.886080</code><code> </code><code class="o">-</code><code class="mf">0.093126</code><code>&#13;
</code><code>         </code><code class="n">CS_spread</code><code>             </code><code class="mf">0.013373</code><code> </code><code class="o">-</code><code class="mf">0.299229</code><code> </code><code class="o">-</code><code class="mf">0.092705</code><code>&#13;
</code><code>         </code><code class="n">amihud</code><code>                </code><code class="mf">0.849614</code><code> </code><code class="o">-</code><code class="mf">0.020623</code><code> </code><code class="o">-</code><code class="mf">0.488324</code><code>&#13;
</code><code>         </code><code class="n">florackis</code><code>             </code><code class="mf">0.710818</code><code>  </code><code class="mf">0.081948</code><code> </code><code class="o">-</code><code class="mf">0.589693</code><code>&#13;
</code><code>         </code><code class="n">cet</code><code>                  </code><code class="o">-</code><code class="mf">0.035736</code><code>  </code><code class="mf">0.101575</code><code>  </code><code class="mf">0.001595</code><code>&#13;
</code><code>         </code><code class="n">market_impact</code><code>         </code><code class="mf">0.357031</code><code>  </code><code class="mf">0.095045</code><code>  </code><code class="mf">0.235266</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO9-1" id="callout_liquidity_modeling_CO9-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Calculating loading from PCA</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Gaussian Mixture Copula Model" data-type="sect1"><div class="sect1" id="idm45737214173616">&#13;
<h1>Gaussian Mixture Copula Model</h1>&#13;
&#13;
<p><a data-primary="liquidity modeling" data-secondary="GMCM" data-type="indexterm" id="ix_liquidity_model_gmcm"/><a data-primary="GMCM (Gaussian mixture copula model)" data-type="indexterm" id="ix_gmcm_ch7"/>Given the complexity and sophistication of financial markets, it is not possible to suggest one-size-fits-all risk models. Thus, financial institutions develop their own models for credit, liquidity, market, and operational risks so that they can manage the risks they face more efficiently and realistically. However, one of the biggest challenges that these financial institutions come across is the <a data-primary="correlation of risk" data-type="indexterm" id="ix_correlation_risk"/>correlation, also known as <a data-primary="joint distribution of risk" data-type="indexterm" id="ix_joint_distr"/>joint distribution, of the risk, as put by Rachev and Stein (2009):</p>&#13;
<blockquote data-type="epigram">&#13;
<p>&#13;
With the emergence of the sub-prime crisis and the following credit crunch, academics, practitioners, philosophers and journalists started searching for causes and failures that led to the turmoil and (almost) unprecedented market deteriorations... the arguments against several methods and models used at Wall Street and throughout the world are, in many cases, putting those in the wrong light. Beyond the fact that risks and issues were clouded by the securitization, tranching and packaging of underlyings in the credit markets as well as by the unfortunate and somehow misleading role of rating agencies, mathematical models were used in the markets which are now under fire due to their incapability of capturing risks in extreme market phases.</p>&#13;
</blockquote>&#13;
&#13;
<p>The task of modeling “extreme market phases” leads us to the concept of joint distribution by which we are allowed to model multiple risks with a single distribution.</p>&#13;
&#13;
<p>A model disregarding the interaction of risks is destined for failure. In this respect, an intuitive yet simple approach is proposed: <em>copulas</em>.</p>&#13;
&#13;
<p><a data-primary="copula, Gaussian mixture model" data-type="indexterm" id="ix_copula_gmm"/>Copula is a function that maps marginal distribution of individual risks to multivariate distribution, resulting in a joint distribution of many standard uniform random variables. If we are working with a known distribution, such as normal distribution, it is easy to model joint distribution of variables, known as bivariate normal. However, the challenge here is to define the correlation structure between these two variables, and this is the point at which copulas come in (Hull 2012).</p>&#13;
&#13;
<p><a data-primary="Sklar’s theorem" data-type="indexterm" id="idm45737213736768"/>With Sklar’s theorem, let <em>F</em> be a marginal continuous cumulative distribution function (CDF) of <math alttext="upper X Superscript i">&#13;
  <msup><mi>X</mi> <mi>i</mi> </msup>&#13;
</math>. A CDF transformation maps a random variable to a scalar that is uniformly distributed in [0,1]. However, the joint distribution of all these marginal CDFs does not follow uniform distribution and a copula function (Kasa and Rajan 2020):</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign upper C colon left-bracket 0 comma 1 right-bracket Superscript i Baseline right-arrow left-bracket 0 comma 1 right-bracket dollar-sign">&#13;
  <mrow>&#13;
    <mi>C</mi>&#13;
    <mo>:</mo>&#13;
    <msup><mrow><mo>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>]</mo></mrow> <mi>i</mi> </msup>&#13;
    <mo>→</mo>&#13;
    <mrow>&#13;
      <mo>[</mo>&#13;
      <mn>0</mn>&#13;
      <mo>,</mo>&#13;
      <mn>1</mn>&#13;
      <mo>]</mo>&#13;
    </mrow>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <em>i</em> shows the number of marginal CDFs. In other words, in the bivariate case, <em>i</em> takes the value of 2 and the function becomes:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign upper C colon left-bracket 0 comma 1 right-bracket squared right-arrow left-bracket 0 comma 1 right-bracket dollar-sign">&#13;
  <mrow>&#13;
    <mi>C</mi>&#13;
    <mo>:</mo>&#13;
    <msup><mrow><mo>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>]</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>→</mo>&#13;
    <mrow>&#13;
      <mo>[</mo>&#13;
      <mn>0</mn>&#13;
      <mo>,</mo>&#13;
      <mn>1</mn>&#13;
      <mo>]</mo>&#13;
    </mrow>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>Hence:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign upper F left-parenthesis x 1 comma x 2 right-parenthesis identical-to upper C left-parenthesis upper F 1 left-parenthesis x 1 right-parenthesis comma period period period comma upper F Subscript i Baseline left-parenthesis x Subscript i Baseline right-parenthesis right-parenthesis dollar-sign">&#13;
  <mrow>&#13;
    <mi>F</mi>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <msub><mi>x</mi> <mn>1</mn> </msub>&#13;
      <mo>,</mo>&#13;
      <msub><mi>x</mi> <mn>2</mn> </msub>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <mo>≡</mo>&#13;
    <mi>C</mi>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <msub><mi>F</mi> <mn>1</mn> </msub>&#13;
      <mrow>&#13;
        <mo>(</mo>&#13;
        <msub><mi>x</mi> <mn>1</mn> </msub>&#13;
        <mo>)</mo>&#13;
      </mrow>&#13;
      <mo>,</mo>&#13;
      <mo>.</mo>&#13;
      <mo>.</mo>&#13;
      <mo>.</mo>&#13;
      <mo>,</mo>&#13;
      <msub><mi>F</mi> <mi>i</mi> </msub>&#13;
      <mrow>&#13;
        <mo>(</mo>&#13;
        <msub><mi>x</mi> <mi>i</mi> </msub>&#13;
        <mo>)</mo>&#13;
      </mrow>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <em>C</em> is copula and unique given the marginal distribution of <math alttext="upper F Subscript i">&#13;
  <msub><mi>F</mi> <mi>i</mi> </msub>&#13;
</math>s are continuous and <em>F</em> is joint cumulative distribution.</p>&#13;
&#13;
<p>Alternatively, the copula function can be described by individual marginal densities:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign f left-parenthesis x right-parenthesis equals upper C left-parenthesis upper F 1 left-parenthesis x 1 right-parenthesis comma period period period comma upper F Subscript i Baseline left-parenthesis x Subscript i Baseline right-parenthesis right-parenthesis product Underscript j equals 1 Overscript i Endscripts f Subscript j Baseline left-parenthesis x Subscript j Baseline right-parenthesis dollar-sign">&#13;
  <mrow>&#13;
    <mi>f</mi>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <mi>x</mi>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <mo>=</mo>&#13;
    <mi>C</mi>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <msub><mi>F</mi> <mn>1</mn> </msub>&#13;
      <mrow>&#13;
        <mo>(</mo>&#13;
        <msub><mi>x</mi> <mn>1</mn> </msub>&#13;
        <mo>)</mo>&#13;
      </mrow>&#13;
      <mo>,</mo>&#13;
      <mo>.</mo>&#13;
      <mo>.</mo>&#13;
      <mo>.</mo>&#13;
      <mo>,</mo>&#13;
      <msub><mi>F</mi> <mi>i</mi> </msub>&#13;
      <mrow>&#13;
        <mo>(</mo>&#13;
        <msub><mi>x</mi> <mi>i</mi> </msub>&#13;
        <mo>)</mo>&#13;
      </mrow>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <msubsup><mo>∏</mo> <mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow> <mi>i</mi> </msubsup>&#13;
    <msub><mi>f</mi> <mi>j</mi> </msub>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <msub><mi>x</mi> <mi>j</mi> </msub>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="f left-parenthesis x right-parenthesis">&#13;
  <mrow>&#13;
    <mi>f</mi>&#13;
    <mo>(</mo>&#13;
    <mi>x</mi>&#13;
    <mo>)</mo>&#13;
  </mrow>&#13;
</math> denotes multivariate density, and <math alttext="f Subscript j">&#13;
  <msub><mi>f</mi> <mi>j</mi> </msub>&#13;
</math> is marginal density of the <math alttext="j Superscript t h">&#13;
  <msup><mi>j</mi> <mrow><mi>t</mi><mi>h</mi></mrow> </msup>&#13;
</math> asset.</p>&#13;
&#13;
<p>We cannot complete our discussion without stating the assumptions that we need to satisfy for copulas. Here are the assumptions from Bouye (2000):</p>&#13;
<ol>&#13;
<li>&#13;
<p><math alttext="upper C equals upper S 1 times upper S 2">&#13;
  <mrow>&#13;
    <mi>C</mi>&#13;
    <mo>=</mo>&#13;
    <msub><mi>S</mi> <mn>1</mn> </msub>&#13;
    <mo>×</mo>&#13;
    <msub><mi>S</mi> <mn>2</mn> </msub>&#13;
  </mrow>&#13;
</math>, where <math alttext="upper S 1">&#13;
  <msub><mi>S</mi> <mn>1</mn> </msub>&#13;
</math> and <math alttext="upper S 2">&#13;
  <msub><mi>S</mi> <mn>2</mn> </msub>&#13;
</math> are non-empty subsets of [0,1].</p>&#13;
</li>&#13;
<li>&#13;
<p><em>C</em> is an increasing function such that <math alttext="0 less-than-or-equal-to u 1 less-than-or-equal-to u 2 less-than-or-equal-to 1">&#13;
  <mrow>&#13;
    <mn>0</mn>&#13;
    <mo>≤</mo>&#13;
    <msub><mi>u</mi> <mn>1</mn> </msub>&#13;
    <mo>≤</mo>&#13;
    <msub><mi>u</mi> <mn>2</mn> </msub>&#13;
    <mo>≤</mo>&#13;
    <mn>1</mn>&#13;
  </mrow>&#13;
</math> and <math alttext="0 less-than-or-equal-to v 1 less-than-or-equal-to v 2 less-than-or-equal-to 1">&#13;
  <mrow>&#13;
    <mn>0</mn>&#13;
    <mo>≤</mo>&#13;
    <msub><mi>v</mi> <mn>1</mn> </msub>&#13;
    <mo>≤</mo>&#13;
    <msub><mi>v</mi> <mn>2</mn> </msub>&#13;
    <mo>≤</mo>&#13;
    <mn>1</mn>&#13;
  </mrow>&#13;
</math>.</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign upper C left-parenthesis left-bracket u 1 comma v 1 right-bracket times left-bracket u 2 comma v 2 right-bracket right-parenthesis identical-to upper C left-parenthesis u 2 comma v 2 right-parenthesis minus upper C left-parenthesis u 2 comma v 2 right-parenthesis minus upper C left-parenthesis u 1 comma v 2 right-parenthesis plus upper C left-parenthesis u 1 comma u 1 right-parenthesis greater-than-or-equal-to 0 dollar-sign">&#13;
  <mrow>&#13;
    <mi>C</mi>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <mrow>&#13;
        <mo>[</mo>&#13;
        <msub><mi>u</mi> <mn>1</mn> </msub>&#13;
        <mo>,</mo>&#13;
        <msub><mi>v</mi> <mn>1</mn> </msub>&#13;
        <mo>]</mo>&#13;
      </mrow>&#13;
      <mo>×</mo>&#13;
      <mrow>&#13;
        <mo>[</mo>&#13;
        <msub><mi>u</mi> <mn>2</mn> </msub>&#13;
        <mo>,</mo>&#13;
        <msub><mi>v</mi> <mn>2</mn> </msub>&#13;
        <mo>]</mo>&#13;
      </mrow>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <mo>≡</mo>&#13;
    <mi>C</mi>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <msub><mi>u</mi> <mn>2</mn> </msub>&#13;
      <mo>,</mo>&#13;
      <msub><mi>v</mi> <mn>2</mn> </msub>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <mo>-</mo>&#13;
    <mi>C</mi>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <msub><mi>u</mi> <mn>2</mn> </msub>&#13;
      <mo>,</mo>&#13;
      <msub><mi>v</mi> <mn>2</mn> </msub>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <mo>-</mo>&#13;
    <mi>C</mi>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <msub><mi>u</mi> <mn>1</mn> </msub>&#13;
      <mo>,</mo>&#13;
      <msub><mi>v</mi> <mn>2</mn> </msub>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <mo>+</mo>&#13;
    <mi>C</mi>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <msub><mi>u</mi> <mn>1</mn> </msub>&#13;
      <mo>,</mo>&#13;
      <msub><mi>u</mi> <mn>1</mn> </msub>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <mo>≥</mo>&#13;
    <mn>0</mn>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
</li>&#13;
&#13;
</ol>&#13;
<ol start="3">&#13;
<li>&#13;
<p>For every <em>u</em> in  <math alttext="upper S 1">&#13;
  <msub><mi>S</mi> <mn>1</mn> </msub>&#13;
</math> and for every <em>v</em> in <math alttext="upper S 2">&#13;
  <msub><mi>S</mi> <mn>2</mn> </msub>&#13;
</math>: <em>C</em>(<em>u</em>, 1) = <em>u</em> and <em>C</em>(1, <em>v</em>) = <em>v</em>.</p>&#13;
</li>&#13;
&#13;
</ol>&#13;
&#13;
<p>After a long theoretical discussion about copulas, you may be tempted to think about the complexity of its coding in Python. No worries, we have a library for that and it is really easy to apply. The name of the Python library for copulas is called <a data-primary="Copulae library" data-type="indexterm" id="idm45737213592816"/>Copulae, and we will make use of it in the following:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">40</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">from</code><code> </code><code class="nn">copulae.mixtures.gmc.gmc</code><code> </code><code class="kn">import</code><code> </code><code class="n">GaussianMixtureCopula</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO10-1" id="co_liquidity_modeling_CO10-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">41</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">_</code><code class="p">,</code><code> </code><code class="n">dim</code><code> </code><code class="o">=</code><code> </code><code class="n">scaled_liq</code><code class="o">.</code><code class="n">shape</code><code>&#13;
</code><code>         </code><code class="n">gmcm</code><code> </code><code class="o">=</code><code> </code><code class="n">GaussianMixtureCopula</code><code class="p">(</code><code class="n">n_clusters</code><code class="o">=</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">ndim</code><code class="o">=</code><code class="n">dim</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO10-2" id="co_liquidity_modeling_CO10-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">42</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">gmcm_fit</code><code> </code><code class="o">=</code><code> </code><code class="n">gmcm</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">scaled_liq</code><code class="p">,</code><code class="n">method</code><code class="o">=</code><code class="s1">'</code><code class="s1">kmeans</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                             </code><code class="n">criteria</code><code class="o">=</code><code class="s1">'</code><code class="s1">GMCM</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">eps</code><code class="o">=</code><code class="mf">0.0001</code><code class="p">)</code><code> </code><a class="co" href="#callout_liquidity_modeling_CO10-3" id="co_liquidity_modeling_CO10-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>         </code><code class="n">state_prob</code><code> </code><code class="o">=</code><code> </code><code class="n">gmcm_fit</code><code class="o">.</code><code class="n">params</code><code class="o">.</code><code class="n">prob</code><code>&#13;
</code><code>         </code><code class="k">print</code><code class="p">(</code><code class="n">f</code><code class="s1">'</code><code class="s1">The state {np.argmax(state_prob) + 1} is likely to occur</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="k">print</code><code class="p">(</code><code class="n">f</code><code class="s1">'</code><code class="s1">State probabilities based on GMCM are {state_prob}</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">The</code><code> </code><code class="n">state</code><code> </code><code class="mi">2</code><code> </code><code class="ow">is</code><code> </code><code class="n">likely</code><code> </code><code class="n">to</code><code> </code><code class="n">occur</code><code>&#13;
</code><code>         </code><code class="n">State</code><code> </code><code class="n">probabilities</code><code> </code><code class="n">based</code><code> </code><code class="n">on</code><code> </code><code class="n">GMCM</code><code> </code><code class="n">are</code><code> </code><code class="p">[</code><code class="mf">0.3197832</code><code>  </code><code class="mf">0.34146341</code><code> </code><code class="mf">0.</code><code>&#13;
</code><code>         </code><code class="mi">33875339</code><code class="p">]</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO10-1" id="callout_liquidity_modeling_CO10-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Importing <code>GaussianMixtureCopula</code> from <code>copulae</code></p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO10-2" id="callout_liquidity_modeling_CO10-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Configuring GMCM with the number of clusters and dimensions</p></dd>&#13;
<dt><a class="co" href="#co_liquidity_modeling_CO10-3" id="callout_liquidity_modeling_CO10-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Fitting the GMCM</p></dd>&#13;
</dl>&#13;
&#13;
<p>The result suggests that when the correlation is taken into account, State-2 prevails, but the posterior probabilities are very close to each other, implying that when correlation between liquidity measures comes into the picture, commonality in liquidity stands out.<a data-primary="" data-startref="ix_correlation_risk" data-type="indexterm" id="idm45737213331600"/><a data-primary="" data-startref="ix_gmcm_ch7" data-type="indexterm" id="idm45737213330736"/><a data-primary="" data-startref="ix_joint_distr" data-type="indexterm" id="idm45737213281008"/><a data-primary="" data-startref="ix_liquidity_model_gmcm" data-type="indexterm" id="idm45737213280160"/><a data-primary="" data-startref="ix_copula_gmm" data-type="indexterm" id="idm45737213279312"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="pagebreak-before less_space" data-pdf-bookmark="Conclusion" data-type="sect1"><div class="sect1" id="idm45737213758784">&#13;
<h1>Conclusion</h1>&#13;
&#13;
<p>Liquidity risk has been under a microscope for over a decade as it is an important source of risk by itself and also has high correlation with other financial risks.</p>&#13;
&#13;
<p>This chapter introduces a new method for liquidity modeling based on GMM, which allows us to model multivariate data and generate clusters. Given the posterior probability of these clusters, we were able to determine which cluster represented the defining characteristics of the data. However, without considering the correlation structure of the liquidity measures, our model may not have been a good representation of reality. Thus, to address this concern, we introduced GMCM, and the defining cluster was redefined by taking into account the correlation structure among the variables.</p>&#13;
&#13;
<p>After completing the liquidity modeling, we are now ready to discuss another important source of financial risk: <em>operational risk</em>. Operational risk may arise for a variety of reasons, but we will discuss operational risk via fraudulent activities.<a data-primary="" data-startref="ix_liquidity_model_ch7" data-type="indexterm" id="idm45737213275120"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="References" data-type="sect1"><div class="sect1" id="idm45737213274144">&#13;
<h1>References</h1>&#13;
&#13;
<p>Articles cited in this chapter:</p>&#13;
&#13;
<ul class="author-date-bib">&#13;
<li>&#13;
<p>Abdi, Farshid, and Angelo Ranaldo. 2017. “A Simple Estimation of Bid-Ask Spreads from Daily Close, High, and Low Prices.” <em>The Review of Financial Studies</em> 30 (12): 4437-4480.</p>&#13;
</li>&#13;
<li>&#13;
<p>Baker, H. Kent, and Halil Kiymaz, eds. 2013. <em>Market Microstructure in Emerging and Developed Markets: Price Discovery, Information Flows, and Transaction Costs</em>. Hoboken, New Jersey: John Wiley and Sons.</p>&#13;
</li>&#13;
<li>&#13;
<p>Bessembinder, Hendrik, and Kumar Venkataraman. 2010. “Bid–Ask Spreads.” in <em>Encyclopedia of Quantitative Finance</em>, edited b. Rama Cont. Hoboken, NJ: John Wiley and Sons.</p>&#13;
</li>&#13;
<li>&#13;
<p>Blume, Lawrence, David Easley, and Maureen O’Hara. 1994 “Market Statistics and Technical Analysis: The Role of Volume.” The Journal of Finance 49 (1): 153-181.</p>&#13;
</li>&#13;
<li>&#13;
<p>Bouyé, Eric, Valdo Durrleman, Ashkan Nikeghbali, Gaël Riboulet, and Thierry Roncalli. 2000. “Copulas for Finance: A Reading Guide and Some Applications.” Available at SSRN 1032533.</p>&#13;
</li>&#13;
<li>&#13;
<p>Chuck, Prince. 2007. “Citigroup Chief Stays Bullish on Buy-Outs.” <em>Financial Times</em>. <a href="https://oreil.ly/nKOZk"><em class="hyperlink">https://oreil.ly/nKOZk</em></a>.</p>&#13;
</li>&#13;
<li>&#13;
<p>Corwin, Shane A., and Paul Schultz. 2012. “A Simple Way to Estimate Bid‐Ask Spreads from Daily High and Low Prices.” <em>The Journal of Finance</em> 67 (2): 719-760.</p>&#13;
</li>&#13;
<li>&#13;
<p>Florackis, Chris, Andros Gregoriou, and Alexandros Kostakis. 2011. “Trading Frequency and Asset Pricing on the London Stock Exchange: Evidence from a New Price Impact Ratio.” <em>Journal of Banking and Finance</em> 35 (12): 3335-3350.</p>&#13;
</li>&#13;
<li>&#13;
<p>Fraley, Chris, and Adrian E. Raftery. 1998. “How Many Clusters? Which Clustering Method? Answers via Model-Based Cluster Analysis.” The Computer Journal 41 (8): 578-588.</p>&#13;
</li>&#13;
<li>&#13;
<p>Gabrielsen, Alexandros, Massimiliano Marzo, and Paolo Zagaglia. 2011. “Measuring Market Liquidity: An Introductory Survey.” <em>SRN Electronic Journal</em>.</p>&#13;
</li>&#13;
<li>&#13;
<p>Harris, Lawrence. 1990. “Statistical Properties of the Roll Serial Covariance Bid/Ask Spread Estimator.” <em>The Journal of Finance</em> 45 (2): 579-590.</p>&#13;
</li>&#13;
<li>&#13;
<p>Gaygisiz, Esma, Abdullah Karasan, and Alper Hekimoglu. 2021. “Analyses of factors of Market Microstructure: Price impact, liquidity, and Volatility.” <em>Optimization</em> (Forthcoming).</p>&#13;
</li>&#13;
<li>&#13;
<p>Kasa, Siva Rajesh, and Vaibhav Rajan. 2020. “Improved Inference of Gaussian Mixture Copula Model for Clustering and Reproducibility Analysis using Automatic Differentiation.” arXiv preprint arXiv:2010.14359.</p>&#13;
</li>&#13;
<li>&#13;
<p>Kyle, Albert S. 1985. “Continuous Auctions and Insider Trading.” <em>Econometrica</em> 53 (6): 1315-1335.</p>&#13;
</li>&#13;
<li>&#13;
<p>Le, Huong, and Andros Gregoriou. 2020. “How Do You Capture Liquidity? A Review of the Literature on Low‐Frequency Stock Liquidity.” <em>Journal of Economic Surveys</em> 34 (5): 1170-1186.</p>&#13;
</li>&#13;
<li>&#13;
<p>Lou, Xiaoxia, and Tao Shu. 2017. “Price Impact or Trading Volume: Why Is the Amihud (2002) measure Priced?.” <em>The Review of Financial Studies</em> 30 (12): 4481-4520.</p>&#13;
</li>&#13;
<li>&#13;
<p>Nikolaou, Kleopatra. 2009. “Liquidity (Risk) concepts: Definitions and Interactions.” European Central Bank Working Paper Series 1008.</p>&#13;
</li>&#13;
<li>&#13;
<p>Rachev, S. T., W. Sun, and M. stein. 2009. “Copula Concepts in Financial Markets.” <em>Portfolio Institutionell</em> (4): 12-15.</p>&#13;
</li>&#13;
<li>&#13;
<p>Roll, Richard. 1984. “A Simple Implicit Measure of the Effective Bid‐Ask Spread in an Efficient Market.” <em>The Journal of Finance</em> 29 (4): 1127-1139.</p>&#13;
</li>&#13;
<li>&#13;
<p>Sarr, Abdourahmane,  and Tonny Lybek. 2002. “Measuring liquidity in financial markets.” IMF Working Papers (02/232): 1-64.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Books and online sources cited in this chapter:</p>&#13;
&#13;
<ul class="author-date-bib">&#13;
<li>&#13;
<p>Hull, John. 2012. <em>Risk Management and Financial Institutions</em>. Hoboken, New Jersey: John Wiley and Sons.</p>&#13;
</li>&#13;
<li>&#13;
<p>VanderPlas, Jake. 2016. <em>Python Data Science Handbook: Essential Tools for Working with Data</em>. Sebastopol: O’Reilly.</p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45737216974144"><sup><a href="ch07.html#idm45737216974144-marker">1</a></sup> <em>Efficient market</em> refers to how well and fast current prices reflect all available information about the value of the underlying asset(s).</p></div></div></section></body></html>