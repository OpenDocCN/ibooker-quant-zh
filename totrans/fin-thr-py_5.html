<html><head></head><body><div id="sbo-rt-content" class="calibre1"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 5. Static Economy" class="calibre4"><div class="preface" id="static_economy">
<h1 class="calibre11"><span class="firstname">Chapter 5. </span>Static Economy</h1>

<blockquote class="calibre12 pcalibre1 pcalibre2">
<p class="calibre13">A <a data-type="indexterm" data-primary="Harrison and Kreps quote" id="idm44853693489528" class="calibre6"/>securities market model is viable if and only if there exists at least one equivalent martingale measure for it.</p>
<p data-type="attribution" class="pcalibre3 calibre16">Harrison and Kreps (1979)</p>
</blockquote>
<blockquote class="calibre12 pcalibre1 pcalibre2">
<p class="calibre13">The <a data-type="indexterm" data-primary="Delbaen and Schachermayer quote" id="idm44853693486776" class="calibre6"/>central piece of the theory relating the no-arbitrage arguments with martingale theory is the so-called Fundamental Theorem of Asset Pricing.</p>
<p data-type="attribution" class="pcalibre3 calibre16">Delbaen and Schachermayer (2006)</p>
</blockquote>

<p class="author1">This chapter introduces more formalism to model a<a data-type="indexterm" data-primary="general static economy" data-see="static economy" id="idm44853693484584" class="calibre6"/><a data-type="indexterm" data-primary="model economies" data-secondary="static" id="idm44853693483608" class="calibre6"/><a data-type="indexterm" data-primary="static economy" id="idm44853693482664" class="calibre6"/> general static economy. Such an economy is characterized by an arbitrarily large, but still finite, state space. As before, the general static economy is analyzed at two relevant points in time only, for example, today and one year from now. Therefore, this chapter introduces one major generalizationâ€”namely with regard to the state space. The next chapter then generalizes the model economy further with regard to the number of relevant points in time. This enables one to also model dynamics.</p>

<p class="author1">The chapter makes use, as before, of linear algebra and probability theoretical concepts. Books that cover these topics well for the purposes of this chapter are Aleskerov et al. (2011) for linear algebra and Jacod and Protter (2004) for probability theory. A gentle introduction to general static economies and their analysis is found in Milne (1995). Pliska (1997) is a good introductory textbook on the topic that is both accessible and rigorous. Duffie (1988) is an advanced text that covers general static economies in greater detail, providing all the necessary tools from linear algebra and probability in a self-contained fashion.</p>

<p class="author1">Topics covered in this chapter are general discrete probability spaces, financial assets and contingent claims, market completeness, the two Fundamental Theorems of Asset Pricing, replication and arbitrage pricing, Black-Scholes-Merton (1973) and Merton (1976) option pricing, and representative agent pricing with Arrow-Debreu securities.
The following table gives an overview of the topics in finance, mathematics, and Python found in this chapter:</p>
<table class="calibre34">
<thead class="calibre35">
<tr class="calibre36">
<th class="calibre37">Finance</th>
<th class="calibre37">Mathematics</th>
<th class="calibre37">Python</th>
</tr>
</thead>
<tbody class="calibre38">
<tr class="calibre36">
<td class="calibre39"><p class="author1">Uncertainty</p></td>
<td class="calibre39"><p class="author1">State space, algebra, probability measure, probability space</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">NumPy</code>, <code class="calibre40">ndarray</code>, <code class="calibre40">rng.normal</code></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Financial asset, contingent claim</p></td>
<td class="calibre39"><p class="author1">Random variable, expectation</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">rng</code>, <code class="calibre40">mean()</code>, <code class="calibre40">np.dot</code></p></td>
</tr>
<tr class="calibre36">
<td class="calibre39"><p class="author1">Market payoff matrix</p></td>
<td class="calibre39"><p class="author1">Matrix</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">ndarray</code>, <code class="calibre40">mean()</code>, <code class="calibre40">std()</code></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Replication, arbitrage pricing</p></td>
<td class="calibre39"><p class="author1">Solving systems of linear equations, dot product</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">np.maximum</code>, <code class="calibre40">np.linalg.solve</code>, <code class="calibre40">np.dot</code></p></td>
</tr>
<tr class="calibre36">
<td class="calibre39"><p class="author1">Market completeness</p></td>
<td class="calibre39"><p class="author1">Rank, span, vector space</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">ndarray</code>, <code class="calibre40">np.dot</code>,
<span class="firstname"><code class="calibre40">np.linalg.matrix_rank</code></span></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Martingale measure</p></td>
<td class="calibre39"><p class="author1">Probability measure</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">ndarray</code>,
<span class="firstname"><code class="calibre40">scipy.optimize.minimize</code></span></p></td>
</tr>
<tr class="calibre36">
<td class="calibre39"><p class="author1">Black-Scholes-Merton model (1973)</p></td>
<td class="calibre39"><p class="author1">Geometric Brownian motion, normal distribution, Monte Carlo simulation, replication</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">rng.standard_normal</code>,
<span class="firstname"><code class="calibre40">np.linalg.lstsq</code></span></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Merton (1976) model, log-normal jumps</p></td>
<td class="calibre39"><p class="author1">Jump diffusion, Poisson distribution</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">rng.poisson</code>,
<span class="firstname"><code class="calibre40">np.linalg.lstsq</code></span></p></td>
</tr>
</tbody>
</table>

<p class="author1">The major goal of this chapter<a data-type="indexterm" data-primary="generalization, benefits of" id="idm44853693450216" class="calibre6"/> is <em class="calibre7">generalization</em>. Almost all of the concepts and notions presented in this chapter have been introduced in the previous chapters. The enlargement of the state space makes the introduction of a bit more formalism necessary. However, on the Python side, the code is still as concise as experienced before. The benefits of this generalization should be clear. It is simply not realistic to model the possible future share price of, say, the Apple stock with two or three states only. It is much more realistic to assume that the share price can take on a value out of a possible 100, 500, or even more values. This is an important step toward a more realistic financial model.</p>






<section data-type="sect1" data-pdf-bookmark="Uncertainty" class="calibre4"><div class="preface" id="idm44853693448136">
<h1 class="calibre17">Uncertainty</h1>

<p class="author1">Consider<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="uncertainty" id="model-static-uncertainty" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="uncertainty" id="static-uncertainty" class="calibre6"/><a data-type="indexterm" data-primary="uncertainty" data-secondary="in static economy" data-secondary-sortas="static economy" id="uncertainty-static" class="calibre6"/> an economy with a <em class="calibre7">general, discrete state space</em> <math alttext="normal upper Omega">
  <mi>Î©</mi>
</math> with a finite number of elements <math alttext="StartAbsoluteValue normal upper Omega EndAbsoluteValue less-than normal infinity">
  <mrow>
    <mfenced open="|" close="|">
      <mi>Î©</mi>
    </mfenced>
    <mo>&lt;</mo>
    <mi>âˆ</mi>
  </mrow>
</math>. <a data-type="indexterm" data-primary="algebra, defined" data-seealso="linear algebra" id="algebra-define" class="calibre6"/>An <em class="calibre7">algebra</em> <math alttext="script upper F">
  <mi>â„±</mi>
</math> in <math alttext="normal upper Omega">
  <mi>Î©</mi>
</math> is a family of sets for which the following statements hold true:</p>
<ol class="calibre47">
<li class="calibre48">
<p class="author1"><math alttext="normal upper Omega element-of script upper F">
  <mrow>
    <mi>Î©</mi>
    <mo>âˆˆ</mo>
    <mi>â„±</mi>
  </mrow>
</math></p>
</li>
<li class="calibre48">
<p class="author1"><math alttext="double-struck upper E element-of script upper F right double arrow double-struck upper E Superscript c Baseline element-of script upper F">
  <mrow>
    <mi>ğ”¼</mi>
    <mo>âˆˆ</mo>
    <mi>â„±</mi>
    <mo>â‡’</mo>
    <msup><mi>ğ”¼</mi> <mi>c</mi> </msup>
    <mo>âˆˆ</mo>
    <mi>â„±</mi>
  </mrow>
</math></p>
</li>
<li class="calibre48">
<p class="author1"><math alttext="double-struck upper E 1 comma double-struck upper E 2 comma period period period comma double-struck upper E Subscript upper I Baseline element-of script upper F right double arrow union double-struck upper E Subscript i Baseline element-of script upper F">
  <mrow>
    <msub><mi>ğ”¼</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>ğ”¼</mi> <mn>2</mn> </msub>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <msub><mi>ğ”¼</mi> <mi>I</mi> </msub>
    <mo>âˆˆ</mo>
    <mi>â„±</mi>
    <mo>â‡’</mo>
    <msubsup><mo>âˆª</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>I</mi> </msubsup>
    <msub><mi>ğ”¼</mi> <mi>i</mi> </msub>
    <mo>âˆˆ</mo>
    <mi>â„±</mi>
  </mrow>
</math></p>
</li>

</ol>

<p class="author1"><math alttext="double-struck upper E Superscript c">
  <msup><mi>ğ”¼</mi> <mi>c</mi> </msup>
</math> denotes the complement of a set <math alttext="double-struck upper E">
  <mi>ğ”¼</mi>
</math>. The power set <math alttext="normal script upper P left-parenthesis normal upper Omega right-parenthesis">
  <mrow>
    <mi>â„˜</mi>
    <mo>(</mo>
    <mi>Î©</mi>
    <mo>)</mo>
  </mrow>
</math> is the largest algebra, while the set <math alttext="script upper F equals StartSet normal empty-set comma normal upper Omega EndSet">
  <mrow>
    <mi>â„±</mi>
    <mo>=</mo>
    <mo>{</mo>
    <mi>âˆ…</mi>
    <mo>,</mo>
    <mi>Î©</mi>
    <mo>}</mo>
  </mrow>
</math> is the smallest algebra in <math alttext="normal upper Omega">
  <mi>Î©</mi>
</math>. An algebra is a model for <em class="calibre7">observable events</em> in an economy. In this context, a single state of the economy <math alttext="omega element-of normal upper Omega">
  <mrow>
    <mi>Ï‰</mi>
    <mo>âˆˆ</mo>
    <mi>Î©</mi>
  </mrow>
</math> can be interpreted as <a data-type="indexterm" data-primary="algebra, defined" data-seealso="linear algebra" data-startref="algebra-define" id="idm44853693393464" class="calibre6"/><a data-type="indexterm" data-primary="atomic events" id="idm44853693392184" class="calibre6"/>an <em class="calibre7">atomic event</em>.</p>

<p class="author1">A <em class="calibre7">probability</em> assigns<a data-type="indexterm" data-primary="probability, defined" id="idm44853693389976" class="calibre6"/> a real number <math alttext="0 less-than-or-equal-to p Subscript omega Baseline identical-to upper P left-parenthesis StartSet omega EndSet right-parenthesis less-than-or-equal-to 1">
  <mrow>
    <mn>0</mn>
    <mo>â‰¤</mo>
    <msub><mi>p</mi> <mi>Ï‰</mi> </msub>
    <mo>â‰¡</mo>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>{</mo>
        <mi>Ï‰</mi>
        <mo>}</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>â‰¤</mo>
    <mn>1</mn>
  </mrow>
</math> to a state <math alttext="omega element-of normal upper Omega">
  <mrow>
    <mi>Ï‰</mi>
    <mo>âˆˆ</mo>
    <mi>Î©</mi>
  </mrow>
</math> or a real number <math alttext="0 less-than-or-equal-to upper P left-parenthesis double-struck upper E double-struck right-parenthesis less-than-or-equal-to 1">
  <mrow>
    <mn>0</mn>
    <mo>â‰¤</mo>
    <mi>P</mi>
    <mo>(</mo>
    <mi>ğ”¼</mi>
    <mo>)</mo>
    <mo>â‰¤</mo>
    <mn>1</mn>
  </mrow>
</math> to an event <math alttext="double-struck upper E element-of script upper F">
  <mrow>
    <mi>ğ”¼</mi>
    <mo>âˆˆ</mo>
    <mi>â„±</mi>
  </mrow>
</math>. If the probabilities for all states are known, one has <math alttext="upper P left-parenthesis double-struck upper E right-parenthesis equals sigma-summation Underscript omega element-of double-struck upper E Endscripts p Subscript omega">
  <mrow>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>ğ”¼</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub><mo>âˆ‘</mo> <mrow><mi>Ï‰</mi><mo>âˆˆ</mo><mi>ğ”¼</mi></mrow> </msub>
    <msub><mi>p</mi> <mi>Ï‰</mi> </msub>
  </mrow>
</math>.</p>

<p class="author1">A <em class="calibre7">probability measure</em> <math alttext="upper P colon script upper F right-arrow left-bracket 0 comma 1 right-bracket">
  <mrow>
    <mi>P</mi>
    <mo>:</mo>
    <mi>â„±</mi>
    <mo>â†’</mo>
    <mo>[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>]</mo>
  </mrow>
</math> is characterized<a data-type="indexterm" data-primary="probability measure" id="idm44853693356984" class="calibre6"/> by the following characteristics:</p>
<ol class="calibre47">
<li class="calibre48">
<p class="author1"><math alttext="for-all double-struck upper E element-of script upper F colon upper P left-parenthesis double-struck upper E right-parenthesis greater-than-or-equal-to 0">
  <mrow>
    <mo>âˆ€</mo>
    <mi>ğ”¼</mi>
    <mo>âˆˆ</mo>
    <mi>â„±</mi>
    <mo>:</mo>
    <mi>P</mi>
    <mo>(</mo>
    <mi>ğ”¼</mi>
    <mo>)</mo>
    <mo>â‰¥</mo>
    <mn>0</mn>
  </mrow>
</math></p>
</li>
<li class="calibre48">
<p class="author1"><math alttext="upper P left-parenthesis union double-struck upper E Subscript i Baseline right-parenthesis equals sigma-summation Underscript i equals 1 Overscript upper I Endscripts double-struck upper E Subscript i Baseline for disjoint sets double-struck upper E Subscript i Baseline element-of script upper F">
  <mrow>
    <mi>P</mi>
    <mfenced separators="" open="(" close=")">
      <msubsup><mo>âˆª</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>I</mi> </msubsup>
      <msub><mi>ğ”¼</mi> <mi>i</mi> </msub>
    </mfenced>
    <mo>=</mo>
    <msubsup><mo>âˆ‘</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>I</mi> </msubsup>
    <msub><mi>ğ”¼</mi> <mi>i</mi> </msub>
    <mspace width="4.pt"/>
    <mtext>for</mtext>
    <mspace width="4.pt"/>
    <mtext>disjoint</mtext>
    <mspace width="4.pt"/>
    <mtext>sets</mtext>
    <mspace width="4.pt"/>
    <msub><mi>ğ”¼</mi> <mi>i</mi> </msub>
    <mo>âˆˆ</mo>
    <mi>â„±</mi>
  </mrow>
</math></p>
</li>
<li class="calibre48">
<p class="author1"><math alttext="upper P left-parenthesis normal upper Omega right-parenthesis equals 1">
  <mrow>
    <mi>P</mi>
    <mo>(</mo>
    <mi>Î©</mi>
    <mo>)</mo>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math></p>
</li>

</ol>

<p class="author1">Together the three elements <math alttext="StartSet normal upper Omega comma script upper F comma upper P EndSet">
  <mrow>
    <mo>{</mo>
    <mi>Î©</mi>
    <mo>,</mo>
    <mi>â„±</mi>
    <mo>,</mo>
    <mi>P</mi>
    <mo>}</mo>
  </mrow>
</math> form a <em class="calibre7">probability space</em>. A<a data-type="indexterm" data-primary="probability space" id="idm44853693321720" class="calibre6"/> probability space is the formal representation of <em class="calibre7">uncertainty</em> in the model economy.</p>








<section data-type="sect2" data-pdf-bookmark="Random Variables" class="calibre4"><div class="preface" id="idm44853693320280">
<h2 class="calibre55">Random Variables</h2>

<p class="author1">Given<a data-type="indexterm" data-primary="random variables" data-secondary="in static economy" data-secondary-sortas="static economy" id="idm44853693318680" class="calibre6"/> a probability space <math alttext="StartSet normal upper Omega comma script upper F comma upper P EndSet">
  <mrow>
    <mo>{</mo>
    <mi>Î©</mi>
    <mo>,</mo>
    <mi>â„±</mi>
    <mo>,</mo>
    <mi>P</mi>
    <mo>}</mo>
  </mrow>
</math>, a <em class="calibre7">random variable</em> is a <math alttext="script upper F minus">
  <mrow>
    <mi>â„±</mi>
    <mo>-</mo>
  </mrow>
</math>measurable function:</p>
<div data-type="equation" class="calibre42">
<math mode="display">
  <mrow>
    <mi>S</mi>
    <mo>:</mo>
    <mi>Î©</mi>
    <mo>â†’</mo>
    <msub><mi>â„</mi> <mrow><mn>â‰¥0</mn></mrow> </msub>
    <mo>,</mo>
    <mi>Ï‰</mi>
    <mo>â†¦</mo>
    <mi>S</mi>
    <mrow>
      <mo>(</mo>
      <mi>Ï‰</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math></div>

<p class="author1"><math alttext="script upper F minus">
  <mrow>
    <mi>â„±</mi>
    <mo>-</mo>
  </mrow>
</math>measurability implies that for each <math alttext="double-struck upper E element-of left-brace left-bracket a comma b left-bracket colon a comma b element-of double-struck upper R comma a less-than b right-brace">
  <mrow>
    <mi>ğ”¼</mi>
    <mo>âˆˆ</mo>
    <mo>{</mo>
    <mo>[</mo>
    <mi>a</mi>
    <mo>,</mo>
    <mi>b</mi>
    <mo>[</mo>
    <mo>:</mo>
    <mi>a</mi>
    <mo>,</mo>
    <mi>b</mi>
    <mo>âˆˆ</mo>
    <mi>â„</mi>
    <mo>,</mo>
    <mi>a</mi>
    <mo>&lt;</mo>
    <mi>b</mi>
    <mo>}</mo>
  </mrow>
</math>, one has:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S Superscript negative 1 Baseline left-parenthesis double-struck upper E right-parenthesis identical-to StartSet omega element-of normal upper Omega colon upper S left-parenthesis omega right-parenthesis element-of double-struck upper E EndSet element-of script upper F" display="block">
  <mrow>
    <msup><mi>S</mi> <mrow><mo>-</mo><mn>1</mn></mrow> </msup>
    <mrow>
      <mo>(</mo>
      <mi>ğ”¼</mi>
      <mo>)</mo>
    </mrow>
    <mo>â‰¡</mo>
    <mrow>
      <mo>{</mo>
      <mi>Ï‰</mi>
      <mo>âˆˆ</mo>
      <mi>Î©</mi>
      <mo>:</mo>
      <mi>S</mi>
      <mrow>
        <mo>(</mo>
        <mi>Ï‰</mi>
        <mo>)</mo>
      </mrow>
      <mo>âˆˆ</mo>
      <mi>ğ”¼</mi>
      <mo>}</mo>
    </mrow>
    <mo>âˆˆ</mo>
    <mi>â„±</mi>
  </mrow>
</math>
</div>

<p class="author1">If <math alttext="script upper F identical-to normal script upper P left-parenthesis normal upper Omega right-parenthesis">
  <mrow>
    <mi>â„±</mi>
    <mo>â‰¡</mo>
    <mi>â„˜</mi>
    <mo>(</mo>
    <mi>Î©</mi>
    <mo>)</mo>
  </mrow>
</math>, the <em class="calibre7">expectation</em> of a random variable is defined by:</p>
<div data-type="equation" class="calibre42">
<math alttext="bold upper E Superscript upper P Baseline left-parenthesis upper S right-parenthesis equals sigma-summation Underscript omega element-of normal upper Omega Endscripts upper P left-parenthesis omega right-parenthesis dot upper S left-parenthesis omega right-parenthesis" display="block">
  <mrow>
    <msup><mi>ğ„</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>S</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <munder><mo>âˆ‘</mo> <mrow><mi>Ï‰</mi><mo>âˆˆ</mo><mi>Î©</mi></mrow> </munder>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>Ï‰</mi>
      <mo>)</mo>
    </mrow>
    <mo>Â·</mo>
    <mi>S</mi>
    <mrow>
      <mo>(</mo>
      <mi>Ï‰</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">Otherwise, it holds:</p>
<div data-type="equation" class="calibre42">
<math alttext="bold upper E Superscript upper P Baseline left-parenthesis upper S right-parenthesis equals sigma-summation Underscript double-struck upper E element-of script upper F Endscripts upper P left-parenthesis double-struck upper E right-parenthesis dot upper S left-parenthesis double-struck upper E right-parenthesis" display="block">
  <mrow>
    <msup><mi>ğ„</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>S</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <munder><mo>âˆ‘</mo> <mrow><mi>ğ”¼</mi><mo>âˆˆ</mo><mi>â„±</mi></mrow> </munder>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>ğ”¼</mi>
      <mo>)</mo>
    </mrow>
    <mo>Â·</mo>
    <mi>S</mi>
    <mrow>
      <mo>(</mo>
      <mi>ğ”¼</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>
</div></section>













<section data-type="sect2" class="calibre4" data-pdf-bookmark="Numerical Examples"><div class="preface" id="idm44853693244200">
<h2 class="calibre55">Numerical Examples</h2>

<p class="author1">To make a concrete example, assume a state space of <math alttext="normal upper Omega equals StartSet omega 1 comma omega 2 comma omega 3 comma omega 4 EndSet">
  <mrow>
    <mi>Î©</mi>
    <mo>=</mo>
    <mo>{</mo>
    <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mn>3</mn> </msub>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mn>4</mn> </msub>
    <mo>}</mo>
  </mrow>
</math>. Furthermore, assume that an algebra with <math alttext="script upper F equals StartSet normal empty-set comma StartSet omega 1 comma omega 2 EndSet comma StartSet omega 3 comma omega 4 EndSet comma normal upper Omega EndSet">
  <mrow>
    <mi>â„±</mi>
    <mo>=</mo>
    <mo>{</mo>
    <mi>âˆ…</mi>
    <mo>,</mo>
    <mrow>
      <mo>{</mo>
      <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
      <mo>,</mo>
      <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
      <mo>}</mo>
    </mrow>
    <mo>,</mo>
    <mrow>
      <mo>{</mo>
      <msub><mi>Ï‰</mi> <mn>3</mn> </msub>
      <mo>,</mo>
      <msub><mi>Ï‰</mi> <mn>4</mn> </msub>
      <mo>}</mo>
    </mrow>
    <mo>,</mo>
    <mi>Î©</mi>
    <mo>}</mo>
  </mrow>
</math> is given. It is easily verified that this set satisfies the three characteristics of an algebra in <math alttext="normal upper Omega">
  <mi>Î©</mi>
</math>. The probability measure shall be defined by <math alttext="upper P left-parenthesis StartSet omega 1 comma omega 2 EndSet right-parenthesis equals upper P left-parenthesis StartSet omega 3 comma omega 4 EndSet right-parenthesis equals one-half">
  <mrow>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>{</mo>
        <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
        <mo>}</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>{</mo>
        <msub><mi>Ï‰</mi> <mn>3</mn> </msub>
        <mo>,</mo>
        <msub><mi>Ï‰</mi> <mn>4</mn> </msub>
        <mo>}</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>2</mn></mfrac>
  </mrow>
</math>.
Again, it is easy to see that <math alttext="upper P">
  <mi>P</mi>
</math> is indeed a probability measure on <math alttext="script upper F">
  <mi>â„±</mi>
</math> under these assumptions.</p>

<p class="author1">Consider now a function <math alttext="upper T">
  <mi>T</mi>
</math> with <math alttext="upper T left-parenthesis omega 1 right-parenthesis equals 1 comma upper T left-parenthesis omega 2 right-parenthesis equals 2 comma upper T left-parenthesis omega 3 right-parenthesis equals 3">
  <mrow>
    <mi>T</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mi>T</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi>T</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>Ï‰</mi> <mn>3</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mn>3</mn>
  </mrow>
</math>, and <math alttext="upper T left-parenthesis omega 4 right-parenthesis equals 4">
  <mrow>
    <mi>T</mi>
    <mo>(</mo>
    <msub><mi>Ï‰</mi> <mn>4</mn> </msub>
    <mo>)</mo>
    <mo>=</mo>
    <mn>4</mn>
  </mrow>
</math>. This function is <em class="calibre7">not</em> a random variable defined on the probability space since the algebra <math alttext="script upper F">
  <mi>â„±</mi>
</math> does not distinguish, for example, between <math alttext="omega 1">
  <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
</math> and <math alttext="omega 2">
  <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
</math>â€”they are subsumed by the set <math alttext="StartSet omega 1 comma omega 2 EndSet">
  <mrow>
    <mo>{</mo>
    <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
    <mo>}</mo>
  </mrow>
</math>. One could say that the algebra is â€œnot granularâ€ enough.</p>

<p class="author1">Consider another function <math alttext="upper S">
  <mi>S</mi>
</math> with <math alttext="upper S left-parenthesis omega 1 right-parenthesis equals 20 comma upper S left-parenthesis omega 2 right-parenthesis equals 20 comma upper S left-parenthesis omega 3 right-parenthesis equals 5">
  <mrow>
    <mi>S</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mn>20</mn>
    <mo>,</mo>
    <mi>S</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mn>20</mn>
    <mo>,</mo>
    <mi>S</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>Ï‰</mi> <mn>3</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mn>5</mn>
  </mrow>
</math>, and <math alttext="upper S left-parenthesis omega 4 right-parenthesis equals 5">
  <mrow>
    <mi>S</mi>
    <mo>(</mo>
    <msub><mi>Ï‰</mi> <mn>4</mn> </msub>
    <mo>)</mo>
    <mo>=</mo>
    <mn>5</mn>
  </mrow>
</math>. This is now a random variable defined on the probability space with an expectation of:</p>
<div data-type="equation" class="calibre42">
<math alttext="bold upper E Superscript upper P Baseline left-parenthesis upper S right-parenthesis equals sigma-summation Underscript double-struck upper E element-of script upper F Endscripts upper P left-parenthesis double-struck upper E right-parenthesis dot upper S left-parenthesis double-struck upper E right-parenthesis equals one-half dot 20 plus one-half dot 5 equals 12.5" display="block">
  <mrow>
    <msup><mi>ğ„</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>S</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <munder><mo>âˆ‘</mo> <mrow><mi>ğ”¼</mi><mo>âˆˆ</mo><mi>â„±</mi></mrow> </munder>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>ğ”¼</mi>
      <mo>)</mo>
    </mrow>
    <mo>Â·</mo>
    <mi>S</mi>
    <mrow>
      <mo>(</mo>
      <mi>ğ”¼</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>2</mn></mfrac>
    <mo>Â·</mo>
    <mn>20</mn>
    <mo>+</mo>
    <mfrac><mn>1</mn> <mn>2</mn></mfrac>
    <mo>Â·</mo>
    <mn>5</mn>
    <mo>=</mo>
    <mn>12</mn>
    <mo>.</mo>
    <mn>5</mn>
  </mrow>
</math>
</div>

<p class="author1">In general, however, it will be assumed that <math alttext="script upper F identical-to normal script upper P left-parenthesis normal upper Omega right-parenthesis">
  <mrow>
    <mi>â„±</mi>
    <mo>â‰¡</mo>
    <mi>â„˜</mi>
    <mo>(</mo>
    <mi>Î©</mi>
    <mo>)</mo>
  </mrow>
</math>, with <math alttext="upper P">
  <mi>P</mi>
</math> accordingly defined such that the function (random variable) <math alttext="upper T">
  <mi>T</mi>
</math>, for example, also is <math alttext="script upper F minus">
  <mrow>
    <mi>â„±</mi>
    <mo>-</mo>
  </mrow>
</math>measurable with the expectation properly defined.</p>

<p class="author1">With Python, it is efficient to illustrate cases in which <math alttext="normal upper Omega">
  <mi>Î©</mi>
</math> is much larger. The following Python code assumes equal probability for all possible states:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="nn">numpy</code><code class="calibre22"> </code><code class="kn">as</code><code class="calibre22"> </code><code class="nn">np</code><code class="calibre22">
</code><code class="calibre22">        </code><code class="kn">from</code><code class="calibre22"> </code><code class="nn">numpy.random</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="n">default_rng</code><code class="calibre22">
</code><code class="calibre22">        </code><code class="n">np</code><code class="o">.</code><code class="n">set_printoptions</code><code class="p">(</code><code class="n">precision</code><code class="o">=</code><code class="mi">5</code><code class="p">,</code><code class="calibre22"> </code><code class="n">suppress</code><code class="o">=</code><code class="nb">True</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">2</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">rng</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">default_rng</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO1-1" href="ch05_split_000.xhtml#callout_static_economy_CO1-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">3</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">I</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">1000</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO1-2" href="ch05_split_000.xhtml#callout_static_economy_CO1-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">rng</code><code class="o">.</code><code class="n">normal</code><code class="p">(</code><code class="n">loc</code><code class="o">=</code><code class="mi">100</code><code class="p">,</code><code class="calibre22"> </code><code class="n">scale</code><code class="o">=</code><code class="mi">20</code><code class="p">,</code><code class="calibre22"> </code><code class="n">size</code><code class="o">=</code><code class="n">I</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO1-3" href="ch05_split_000.xhtml#callout_static_economy_CO1-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S</code><code class="p">[</code><code class="p">:</code><code class="mi">14</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO1-4" href="ch05_split_000.xhtml#callout_static_economy_CO1-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="calibre22"> </code><code class="mi">76.84901</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">105.79512</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">115.61708</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">110.87947</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">80.77235</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">121.42017</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">               </code><code class="mi">114.02911</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">114.09947</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">114.90125</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">122.08694</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">144.85945</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">87.77014</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">               </code><code class="mi">100.94422</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">135.08469</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO1-5" href="ch05_split_000.xhtml#callout_static_economy_CO1-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">100.88376804485935</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO1-1" href="ch05_split_000.xhtml#co_static_economy_CO1-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Fixes the seed value for the <code class="calibre22">NumPy</code> random number generator for reproducibility of the results.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO1-2" href="ch05_split_000.xhtml#co_static_economy_CO1-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Fixes the number of states in the state space (for the simulations to follow).</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO1-3" href="ch05_split_000.xhtml#co_static_economy_CO1-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Draws <code class="calibre22">I</code> normally distributed (pseudo-)random numbers with mean <code class="calibre22">loc</code> and standard deviation <code class="calibre22">scale</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO1-4" href="ch05_split_000.xhtml#co_static_economy_CO1-5"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Calculates the expectation (mean value) assuming an equal probability for every simulated value (state).</p></dd>
</dl>

<p class="author1">Any other probability measure can, of course, also be chosen:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">P</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">rng</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="n">I</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO2-1" href="ch05_split_000.xhtml#callout_static_economy_CO2-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">P</code><code class="p">[</code><code class="p">:</code><code class="mi">10</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO2-2" href="ch05_split_000.xhtml#callout_static_economy_CO2-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0.34914</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.33408</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.41319</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.06102</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.6339</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.51285</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.51177</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">               </code><code class="mi">0.92149</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.72853</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.58985</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">9</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">P</code><code class="calibre22"> </code><code class="o">/</code><code class="o">=</code><code class="calibre22"> </code><code class="n">P</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO2-3" href="ch05_split_000.xhtml#callout_static_economy_CO2-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">P</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO2-4" href="ch05_split_000.xhtml#callout_static_economy_CO2-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">1.0</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">P</code><code class="p">[</code><code class="p">:</code><code class="mi">10</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO2-5" href="ch05_split_000.xhtml#callout_static_economy_CO2-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0.00072</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.00069</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.00085</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.00013</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.00131</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.00106</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.00106</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="mi">0.0019</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.0015</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.00122</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">12</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">P</code><code class="p">,</code><code class="calibre22"> </code><code class="n">S</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO2-6" href="ch05_split_000.xhtml#callout_static_economy_CO2-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">12</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">100.71981640185018</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO2-1" href="ch05_split_000.xhtml#co_static_economy_CO2-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Draws uniformly distributed random numbers between 0 and 1.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO2-2" href="ch05_split_000.xhtml#co_static_economy_CO2-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Normalizes the values in the <code class="calibre22">ndarray</code> object to sum up to 1.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO2-3" href="ch05_split_000.xhtml#co_static_economy_CO2-5"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The resulting weights according to the random probability measure.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO2-4" href="ch05_split_000.xhtml#co_static_economy_CO2-6"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The expectation as the dot product of the probability vector and the vector representing the random<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="uncertainty" data-startref="model-static-uncertainty" id="idm44853690567752" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="uncertainty" data-startref="static-uncertainty" id="idm44853690566264" class="calibre6"/><a data-type="indexterm" data-primary="uncertainty" data-secondary="in static economy" data-secondary-sortas="static economy" data-startref="uncertainty-static" id="idm44853690565048" class="calibre6"/> variable.</p></dd>
</dl>
<div data-type="note" epub:type="note" class="calibre26"><h1 class="calibre33">Mathematical Techniques</h1>
<p class="author1">In addition to<a data-type="indexterm" data-primary="discrete finance models" id="idm44853690517016" class="calibre6"/><a data-type="indexterm" data-primary="linear algebra" data-secondary="in discrete finance models" data-secondary-sortas="discrete finance models" id="idm44853690516408" class="calibre6"/><a data-type="indexterm" data-primary="probability theory" data-secondary="in discrete finance models" data-secondary-sortas="discrete finance models" id="idm44853690515320" class="calibre6"/> linear algebra, traditional probability theory plays a central role in discrete finance. It allows us to capture and analyze uncertainty and, more specifically, risk in a systematic, well-established way. When moving from discrete finance models to continuous ones, more advanced approaches, such as stochastic calculus, are required. For discrete finance models, standard linear algebra and probability theory prove powerful enough in most cases. For more details on discrete finance, refer to Pliska (1997).</p>
</div>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Financial Assets" class="calibre4"><div class="preface" id="idm44853693447640">
<h1 class="calibre17">Financial Assets</h1>

<p class="author1">Consider<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="financial assets" id="model-static-finasset" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="financial assets" id="static-finasset" class="calibre6"/><a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="in static economy" data-tertiary-sortas="static economy" id="asset-financial-static" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="in static economy" data-secondary-sortas="static economy" id="finasset-static" class="calibre6"/> an economy at two different dates <math alttext="t element-of StartSet 0 comma 1 EndSet">
  <mrow>
    <mi>t</mi>
    <mo>âˆˆ</mo>
    <mo>{</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>}</mo>
  </mrow>
</math>, today and one year from now (or any other time period in the future to this end). Assume that a probability space <math alttext="StartSet normal upper Omega comma script upper F identical-to normal script upper P left-parenthesis normal upper Omega right-parenthesis comma upper P EndSet">
  <mrow>
    <mo>{</mo>
    <mi>Î©</mi>
    <mo>,</mo>
    <mi>â„±</mi>
    <mo>â‰¡</mo>
    <mi>â„˜</mi>
    <mo>(</mo>
    <mi>Î©</mi>
    <mo>)</mo>
    <mo>,</mo>
    <mi>P</mi>
    <mo>}</mo>
  </mrow>
</math> is given that represents <em class="calibre7">uncertainty</em> about the future in the model economy, with <math alttext="StartAbsoluteValue normal upper Omega EndAbsoluteValue identical-to upper I">
  <mrow>
    <mfenced open="|" close="|">
      <mi>Î©</mi>
    </mfenced>
    <mo>â‰¡</mo>
    <mi>I</mi>
  </mrow>
</math> possible future states. In this case, <math alttext="normal upper Omega equals StartSet omega 1 comma omega 2 comma period period period comma omega Subscript upper I Baseline EndSet">
  <mrow>
    <mi>Î©</mi>
    <mo>=</mo>
    <mo>{</mo>
    <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mi>I</mi> </msub>
    <mo>}</mo>
  </mrow>
</math>.</p>

<p class="author1">A traded <em class="calibre7">financial asset</em> is represented by a price process <math alttext="upper S equals left-parenthesis upper S 0 comma upper S 1 right-parenthesis">
  <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mo>(</mo>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>,</mo>
    <msub><mi>S</mi> <mn>1</mn> </msub>
    <mo>)</mo>
  </mrow>
</math>, where the price today is fixed
<math><mrow><msub><mi>S</mi> <mn>0</mn> </msub><mo>âˆˆ</mo><msub><mi>â„</mi> <mrow><mn>&gt;0</mn></mrow> </msub></mrow></math>,
and the price in one year,
<math><mrow><msub><mi>S</mi> <mn>1</mn> </msub><mo>:</mo><mi>Î©</mi><mo>â†’</mo><msub><mi>â„</mi> <mrow><mn>â‰¥0</mn></mrow> </msub></mrow></math>,
is a random variable that is <math alttext="script upper F minus">
  <mrow>
    <mi>â„±</mi>
    <mo>-</mo>
  </mrow>
</math>measurable. Formally, the future price vector of a traded financial asset is a vector with <math alttext="upper I">
  <mi>I</mi>
</math> elements:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S 1 equals Start 4 By 1 Matrix 1st Row  upper S 1 left-parenthesis omega 1 right-parenthesis 2nd Row  upper S 1 left-parenthesis omega 2 right-parenthesis 3rd Row  period period period 4th Row  upper S 1 left-parenthesis omega Subscript upper I Baseline right-parenthesis EndMatrix" display="block">
  <mrow>
    <msub><mi>S</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msub><mi>S</mi> <mn>1</mn> </msub>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <msub><mi>S</mi> <mn>1</mn> </msub>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <msub><mi>S</mi> <mn>1</mn> </msub>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mi>I</mi> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">If there are multiple financial assets traded, say <math alttext="upper K greater-than 1">
  <mrow>
    <mi>K</mi>
    <mo>&gt;</mo>
    <mn>1</mn>
  </mrow>
</math>, they are represented by multiple price processes, <math alttext="upper S Superscript k Baseline equals left-parenthesis upper S 0 Superscript k Baseline comma upper S 1 Superscript k Baseline right-parenthesis comma k equals 1 comma 2 comma period period period comma upper K">
  <mrow>
    <msup><mi>S</mi> <mi>k</mi> </msup>
    <mo>=</mo>
    <mrow>
      <mo>(</mo>
      <msubsup><mi>S</mi> <mn>0</mn> <mi>k</mi> </msubsup>
      <mo>,</mo>
      <msubsup><mi>S</mi> <mn>1</mn> <mi>k</mi> </msubsup>
      <mo>)</mo>
    </mrow>
    <mo>,</mo>
    <mi>k</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <mi>K</mi>
  </mrow>
</math>. The <em class="calibre7">market payoff matrix</em> is then<a data-type="indexterm" data-primary="market payoff matrix" id="idm44853690435432" class="calibre6"/> composed of the future price vectors of the traded financial assets:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M equals Start 4 By 4 Matrix 1st Row 1st Column upper S 1 Superscript 1 Baseline left-parenthesis omega 1 right-parenthesis 2nd Column upper S 1 squared left-parenthesis omega 1 right-parenthesis 3rd Column period period period 4th Column upper S 1 Superscript upper K Baseline left-parenthesis omega 1 right-parenthesis 2nd Row 1st Column upper S 1 Superscript 1 Baseline left-parenthesis omega 2 right-parenthesis 2nd Column upper S 1 squared left-parenthesis omega 2 right-parenthesis 3rd Column period period period 4th Column upper S 1 Superscript upper K Baseline left-parenthesis omega 2 right-parenthesis 3rd Row 1st Column period period period 2nd Column period period period 3rd Column period period period 4th Column period period period 4th Row 1st Column upper S 1 Superscript 1 Baseline left-parenthesis omega 3 right-parenthesis 2nd Column upper S 1 squared left-parenthesis omega 3 right-parenthesis 3rd Column period period period 4th Column upper S 1 Superscript upper K Baseline left-parenthesis omega 3 right-parenthesis EndMatrix" display="block">
  <mrow>
    <mi>â„³</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msubsup><mi>S</mi> <mn>1</mn> <mn>1</mn> </msubsup>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <msubsup><mi>S</mi> <mn>1</mn> <mn>2</mn> </msubsup>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <msubsup><mi>S</mi> <mn>1</mn> <mi>K</mi> </msubsup>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <msubsup><mi>S</mi> <mn>1</mn> <mn>1</mn> </msubsup>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <msubsup><mi>S</mi> <mn>1</mn> <mn>2</mn> </msubsup>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <msubsup><mi>S</mi> <mn>1</mn> <mi>K</mi> </msubsup>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <msubsup><mi>S</mi> <mn>1</mn> <mn>1</mn> </msubsup>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mn>3</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <msubsup><mi>S</mi> <mn>1</mn> <mn>2</mn> </msubsup>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mn>3</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <msubsup><mi>S</mi> <mn>1</mn> <mi>K</mi> </msubsup>
              <mrow>
                <mo>(</mo>
                <msub><mi>Ï‰</mi> <mn>3</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">Denote the <em class="calibre7">set of traded financial assets</em> by <math alttext="script upper S identical-to left-parenthesis upper S Superscript 1 Baseline comma upper S squared comma period period period comma upper S Superscript upper K Baseline right-parenthesis">
  <mrow>
    <mi>ğ’®</mi>
    <mo>â‰¡</mo>
    <mo>(</mo>
    <msup><mi>S</mi> <mn>1</mn> </msup>
    <mo>,</mo>
    <msup><mi>S</mi> <mn>2</mn> </msup>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <msup><mi>S</mi> <mi>K</mi> </msup>
    <mo>)</mo>
  </mrow>
</math>. The <em class="calibre7">static model economy</em> can then be summarized by</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper E equals left-parenthesis StartSet normal upper Omega comma script upper F comma upper P EndSet comma script upper S right-parenthesis" display="block">
  <mrow>
    <mi>â„°</mi>
    <mo>=</mo>
    <mo>(</mo>
    <mo>{</mo>
    <mi>Î©</mi>
    <mo>,</mo>
    <mi>â„±</mi>
    <mo>,</mo>
    <mi>P</mi>
    <mo>}</mo>
    <mo>,</mo>
    <mi>ğ’®</mi>
    <mo>)</mo>
  </mrow>
</math>
</div>

<p class="author1">where it is usually assumed that <math alttext="script upper F identical-to normal script upper P left-parenthesis normal upper Omega right-parenthesis">
  <mrow>
    <mi>â„±</mi>
    <mo>â‰¡</mo>
    <mi>â„˜</mi>
    <mo>(</mo>
    <mi>Î©</mi>
    <mo>)</mo>
  </mrow>
</math>.</p>

<p class="author1">Fixing the number of possible future states to five <math alttext="normal upper Omega equals StartSet omega 1 comma period period period comma omega 5 EndSet">
  <mrow>
    <mi>Î©</mi>
    <mo>=</mo>
    <mo>{</mo>
    <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mn>5</mn> </msub>
    <mo>}</mo>
  </mrow>
</math> with equal probability <math alttext="for-all omega element-of normal upper Omega colon upper P left-parenthesis omega right-parenthesis equals one-fifth">
  <mrow>
    <mo>âˆ€</mo>
    <mi>Ï‰</mi>
    <mo>âˆˆ</mo>
    <mi>Î©</mi>
    <mo>:</mo>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>Ï‰</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>5</mn></mfrac>
  </mrow>
</math> and the number of traded financial assets to five as well, a numerical example in Python illustrates such a static model economy:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">13</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">25</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">25</code><code class="p">)</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">20</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">30</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">15</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">25</code><code class="p">)</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">20</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">)</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">5</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">30</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">15</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO3-1" href="ch05_split_000.xhtml#callout_static_economy_CO3-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">14</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="mi">5</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">10.</code><code class="p">]</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO3-2" href="ch05_split_000.xhtml#callout_static_economy_CO3-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">15</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO3-3" href="ch05_split_000.xhtml#callout_static_economy_CO3-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">15</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">10.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10.</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">16</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="n">axis</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO3-4" href="ch05_split_000.xhtml#callout_static_economy_CO3-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">16</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">11.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">12.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">12.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">12.</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">17</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">mu</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">M</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="n">axis</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO3-5" href="ch05_split_000.xhtml#callout_static_economy_CO3-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">18</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">mu</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO3-6" href="ch05_split_000.xhtml#callout_static_economy_CO3-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">18</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0.1</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.2</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.2</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.2</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="p">(</code><code class="n">M</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO3-7" href="ch05_split_000.xhtml#callout_static_economy_CO3-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="calibre22"> </code><code class="mi">0.1</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">1.5</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">1.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">1.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22">  </code><code class="mi">1.5</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="calibre22"> </code><code class="mi">0.1</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">1.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22">  </code><code class="mi">2.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.5</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">1.5</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="calibre22"> </code><code class="mi">0.1</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">1.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22">  </code><code class="mi">1.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.</code><code class="calibre22"> </code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="calibre22"> </code><code class="mi">0.1</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">0.5</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">2.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.5</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">1.</code><code class="calibre22"> </code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="calibre22"> </code><code class="mi">0.1</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">1.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">1.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">1.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">1.</code><code class="calibre22"> </code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">20</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">sigma</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="n">M</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="n">axis</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO3-8" href="ch05_split_000.xhtml#callout_static_economy_CO3-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">21</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">sigma</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO3-9" href="ch05_split_000.xhtml#callout_static_economy_CO3-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">21</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0.</code><code class="calibre22">     </code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.92736</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1.46969</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.83666</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1.1225</code><code class="calibre22"> </code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO3-1" href="ch05_split_000.xhtml#co_static_economy_CO3-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The assumed market payoff matrix where the columns represent the future, uncertain price vectors of the traded financial assets.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO3-2" href="ch05_split_000.xhtml#co_static_economy_CO3-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The current price vector for the five assets, for each of which the price is fixed to 10.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO3-3" href="ch05_split_000.xhtml#co_static_economy_CO3-4"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This calculates the expected (or average) future price for every traded financial asset.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO3-4" href="ch05_split_000.xhtml#co_static_economy_CO3-5"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This in turn calculates the expected (or average) rates of return.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO3-5" href="ch05_split_000.xhtml#co_static_economy_CO3-7"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The rates of return matrix calculated and printed out.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO3-6" href="ch05_split_000.xhtml#co_static_economy_CO3-8"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The standard deviation of the rates of return or volatility calculated for every traded financial assetâ€”the first one is risk-less; it can be considered to be<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="financial assets" data-startref="model-static-finasset" id="idm44853690217560" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="financial assets" data-startref="static-finasset" id="idm44853690195304" class="calibre6"/><a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="in static economy" data-tertiary-sortas="static economy" data-startref="asset-financial-static" id="idm44853690194088" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="in static economy" data-secondary-sortas="static economy" data-startref="finasset-static" id="idm44853690192328" class="calibre6"/> a bond.</p></dd>
</dl>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Contingent Claims" class="calibre4"><div class="preface" id="idm44853690164360">
<h1 class="calibre17">Contingent Claims</h1>

<p class="author1">Given<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="contingent claims" id="model-static-contingent" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="contingent claims" id="static-contingent" class="calibre6"/><a data-type="indexterm" data-primary="contingent claims" data-secondary="in static economy" data-secondary-sortas="static economy" id="contingent-static" class="calibre6"/> a model economy <math alttext="script upper E">
  <mi>â„°</mi>
</math>, a <em class="calibre7">contingent claim</em> is characterized by a price process <math alttext="upper C equals left-parenthesis upper C 0 comma upper C 1 right-parenthesis">
  <mrow>
    <mi>C</mi>
    <mo>=</mo>
    <mo>(</mo>
    <msub><mi>C</mi> <mn>0</mn> </msub>
    <mo>,</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>)</mo>
  </mrow>
</math>, where <math alttext="upper C 1">
  <msub><mi>C</mi> <mn>1</mn> </msub>
</math> is an <math alttext="script upper F minus">
  <mrow>
    <mi>â„±</mi>
    <mo>-</mo>
  </mrow>
</math>measurable random variable.</p>

<p class="author1">One can think of European call and put options as canonical examples of contingent claims. The payoff of a European call option might, for instance, be defined relative to the second traded financial asset according to <math alttext="upper C 1 equals max left-parenthesis upper S 1 squared minus upper K comma 0 right-parenthesis">
  <mrow>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mo movablelimits="true" form="prefix">max</mo>
    <mrow>
      <mo>(</mo>
      <msubsup><mi>S</mi> <mn>1</mn> <mn>2</mn> </msubsup>
      <mo>-</mo>
      <mi>K</mi>
      <mo>,</mo>
      <mn>0</mn>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>, where
<math><mrow><mi>K</mi><mo>âˆˆ</mo><msub><mi>â„</mi> <mrow><mn>â‰¥0</mn></mrow> </msub></mrow></math>
is the strike price of the option. Since the payoff of the option is â€œderivedâ€ from another asset, one therefore often speaks<a data-type="indexterm" data-primary="derivatives" data-secondary="contingent claims and" id="idm44853690303656" class="calibre6"/><a data-type="indexterm" data-primary="assets" data-secondary="derivative" id="idm44853690122808" class="calibre6"/> of <em class="calibre7">derivative instruments</em>, or <em class="calibre7">derivatives</em> for short.</p>

<p class="author1">If a contingent claim <a data-type="indexterm" data-primary="replication" data-secondary="of contingent claims" data-secondary-sortas="contingent claims" id="replication-contingent" class="calibre6"/>can be <em class="calibre7">replicated</em> by a portfolio <math alttext="phi element-of double-struck upper R Superscript upper K">
  <mrow>
    <mi>Ï•</mi>
    <mo>âˆˆ</mo>
    <msup><mi>â„</mi> <mi>K</mi> </msup>
  </mrow>
</math> of the traded financial assets <math alttext="script upper S">
  <mi>ğ’®</mi>
</math></p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M dot phi equals upper C 1" display="block">
  <mrow>
    <mi>â„³</mi>
    <mo>Â·</mo>
    <mi>Ï•</mi>
    <mo>=</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
  </mrow>
</math>
</div>

<p class="author1">then the <em class="calibre7">arbitrage price</em> of the contingent claim is</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M script 0 dot phi equals upper C 0" display="block">
  <mrow>
    <msub><mi>â„³</mi> <mn mathvariant="script">0</mn> </msub>
    <mo>Â·</mo>
    <mi>Ï•</mi>
    <mo>=</mo>
    <msub><mi>C</mi> <mn>0</mn> </msub>
  </mrow>
</math>
</div>

<p class="author1">where
<math><mrow><msub><mi>â„³</mi> <mn mathvariant="script">0</mn> </msub><mo>=</mo><msup><mfenced separators="" open="(" close=")"><msubsup><mi>S</mi> <mn>0</mn> <mn>1</mn> </msubsup><mo>,</mo><msubsup><mi>S</mi> <mn>0</mn> <mn>2</mn> </msubsup><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msubsup><mi>S</mi> <mn>0</mn> <mi>K</mi> </msubsup></mfenced> <mi>T</mi> </msup><mo>âˆˆ</mo><msubsup><mi>â„</mi> <mrow><mn>&gt;0</mn></mrow> <mi>I</mi> </msubsup></mrow></math>
is the <em class="calibre7">current price vector</em> of the traded financial assets.</p>

<p class="author1">Continuing the Python example from before, replication of contingent claims based on linear algebra methods is illustrated in the following:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">K</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">15</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO4-1" href="ch05_split_000.xhtml#callout_static_economy_CO4-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">23</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO4-2" href="ch05_split_000.xhtml#callout_static_economy_CO4-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">23</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">25</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">20</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">5</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">maximum</code><code class="p">(</code><code class="n">M</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">]</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">K</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO4-3" href="ch05_split_000.xhtml#callout_static_economy_CO4-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C1</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO4-4" href="ch05_split_000.xhtml#callout_static_economy_CO4-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">10</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">5</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">phi</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">solve</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">C1</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO4-5" href="ch05_split_000.xhtml#callout_static_economy_CO4-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">phi</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO4-6" href="ch05_split_000.xhtml#callout_static_economy_CO4-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.5</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.01667</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">0.2</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">0.1</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">allclose</code><code class="p">(</code><code class="n">C1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO4-7" href="ch05_split_000.xhtml#callout_static_economy_CO4-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="nb">True</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">29</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO4-8" href="ch05_split_000.xhtml#callout_static_economy_CO4-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C0</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO4-9" href="ch05_split_000.xhtml#callout_static_economy_CO4-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">2.1666666666666665</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO4-1" href="ch05_split_000.xhtml#co_static_economy_CO4-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The strike price of the European call option, and the payoff vector of the relevant financial asset.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO4-2" href="ch05_split_000.xhtml#co_static_economy_CO4-3"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The call option is written on the second traded financial asset with future payoff of <math alttext="upper S 1 squared equals left-parenthesis 25 comma 20 comma 10 comma 5 comma 0 right-parenthesis">
  <mrow>
    <msubsup><mi>S</mi> <mn>1</mn> <mn>2</mn> </msubsup>
    <mo>=</mo>
    <mrow>
      <mo>(</mo>
      <mn>25</mn>
      <mo>,</mo>
      <mn>20</mn>
      <mo>,</mo>
      <mn>10</mn>
      <mo>,</mo>
      <mn>5</mn>
      <mo>,</mo>
      <mn>0</mn>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO4-3" href="ch05_split_000.xhtml#co_static_economy_CO4-5"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This solves the replication problem given the market payoff matrix.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO4-4" href="ch05_split_000.xhtml#co_static_economy_CO4-7"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Checks whether the replication portfolio indeed replicates the future payoff of the European call option.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO4-5" href="ch05_split_000.xhtml#co_static_economy_CO4-8"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">From the replication portfolio, the arbitrage price follows in combination with the current price vector of the traded financial<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="contingent claims" data-startref="model-static-contingent" id="idm44853689441320" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="contingent claims" data-startref="static-contingent" id="idm44853689439992" class="calibre6"/><a data-type="indexterm" data-primary="contingent claims" data-secondary="in static economy" data-secondary-sortas="static economy" data-startref="contingent-static" id="idm44853689438904" class="calibre6"/><a data-type="indexterm" data-primary="replication" data-secondary="of contingent claims" data-secondary-sortas="contingent claims" data-startref="replication-contingent" id="idm44853689437576" class="calibre6"/> assets.</p></dd>
</dl>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Market Completeness" class="calibre4"><div class="preface" id="idm44853689522728">
<h1 class="calibre17">Market Completeness</h1>

<p class="author1">Market completeness<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="market completeness" id="model-static-completeness" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="market completeness" id="static-completeness" class="calibre6"/><a data-type="indexterm" data-primary="market completeness" data-secondary="in static economy" data-secondary-sortas="static economy" id="market-complete-static" class="calibre6"/><a data-type="indexterm" data-primary="complete market model" data-secondary="in static economy" data-secondary-sortas="static economy" id="complete-market-static" class="calibre6"/><a data-type="indexterm" data-primary="market payoff matrix" data-secondary="market completeness and" id="market-payoff-completeness" class="calibre6"/> of the static model economy can be analyzed based on the <em class="calibre7">rank</em> of the market payoff matrix <math alttext="script upper M">
  <mi>â„³</mi>
</math> as defined by the traded financial assets <math alttext="script upper S">
  <mi>ğ’®</mi>
</math>. The rank of a matrix equals the number of linearly independent (column) vectors (see Aleskerov et al. (2011), section 2.7). Consider the column vectors that represent the future price vectors of the traded financial assets. They<a data-type="indexterm" data-primary="linearly dependent/independent" id="idm44853689425272" class="calibre6"/> are <em class="calibre7">linearly independent</em> if</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M dot phi equals 0" display="block">
  <mrow>
    <mi>â„³</mi>
    <mo>Â·</mo>
    <mi>Ï•</mi>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math>
</div>

<p class="author1">has only one solution, namely the null vector <math alttext="phi equals left-parenthesis 0 comma 0 comma period period period comma 0 right-parenthesis Superscript upper T Baseline element-of double-struck upper R Superscript upper K">
  <mrow>
    <mi>Ï•</mi>
    <mo>=</mo>
    <msup><mrow><mo>(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mn>0</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
    <mo>âˆˆ</mo>
    <msup><mi>â„</mi> <mi>K</mi> </msup>
  </mrow>
</math>.</p>

<p class="author1">On the other hand, <a data-type="indexterm" data-primary="span" data-secondary="of market payoff matrix" data-secondary-sortas="market payoff matrix" id="idm44853689412280" class="calibre6"/>the <em class="calibre7">span</em> of the market payoff matrix <math alttext="script upper M">
  <mi>â„³</mi>
</math> is given by all linear combinations of the column vectors:</p>
<div data-type="equation" class="calibre42">
<math alttext="span left-parenthesis script upper M right-parenthesis equals StartSet phi element-of double-struck upper R Superscript upper K Baseline colon script upper M dot phi EndSet" display="block">
  <mrow>
    <mtext>span</mtext>
    <mrow>
      <mo>(</mo>
      <mi>â„³</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfenced separators="" open="{" close="}">
      <mi>Ï•</mi>
      <mo>âˆˆ</mo>
      <msup><mi>â„</mi> <mi>K</mi> </msup>
      <mo>:</mo>
      <mi>â„³</mi>
      <mo>Â·</mo>
      <mi>Ï•</mi>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">The model economy <math alttext="script upper E">
  <mi>â„°</mi>
</math> is complete if the set of attainable contingent claims satisfies <math alttext="double-struck upper A equals double-struck upper R Superscript upper I">
  <mrow>
    <mi>ğ”¸</mi>
    <mo>=</mo>
    <msup><mi>â„</mi> <mi>I</mi> </msup>
  </mrow>
</math>. However, the set of attainable contingent claims equals by definition the span of the traded financial assets <math alttext="double-struck upper A identical-to span left-parenthesis script upper M right-parenthesis">
  <mrow>
    <mi>ğ”¸</mi>
    <mo>â‰¡</mo>
    <mtext>span</mtext>
    <mo>(</mo>
    <mi>â„³</mi>
    <mo>)</mo>
  </mrow>
</math>. The model economy <math alttext="script upper E">
  <mi>â„°</mi>
</math> therefore is 
<span class="firstname"><em class="calibre7">complete</em></span> if:</p>
<div data-type="equation" class="calibre42">
<math alttext="span left-parenthesis script upper M right-parenthesis equals double-struck upper R Superscript upper I" display="block">
  <mrow>
    <mtext>span</mtext>
    <mrow>
      <mo>(</mo>
      <mi>â„³</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>â„</mi> <mi>I</mi> </msup>
  </mrow>
</math>
</div>

<p class="author1">Under which circumstances is this the case? It is the case if the rank of the matrix is at least as large as the number of future states possible:</p>
<div data-type="equation" class="calibre42">
<math alttext="rank left-parenthesis script upper M right-parenthesis greater-than-or-equal-to upper I" display="block">
  <mrow>
    <mtext>rank</mtext>
    <mo>(</mo>
    <mi>â„³</mi>
    <mo>)</mo>
    <mo>â‰¥</mo>
    <mi>I</mi>
  </mrow>
</math>
</div>

<p class="author1">In other words, the column vectors of <math alttext="script upper M">
  <mi>â„³</mi>
</math> form<a data-type="indexterm" data-primary="basis of vector space" id="idm44853689379240" class="calibre6"/><a data-type="indexterm" data-primary="vector space" data-secondary="basis" id="idm44853689378632" class="calibre6"/><a data-type="indexterm" data-primary="vectors" data-secondary="defined" id="idm44853689377784" class="calibre6"/><a data-type="indexterm" data-primary="vector space" data-secondary="defined" id="idm44853689376936" class="calibre6"/> a <em class="calibre7">basis</em> of the vector space <math alttext="double-struck upper R Superscript upper I">
  <msup><mi>â„</mi> <mi>I</mi> </msup>
</math> (with potentially more basis vectors than required). A <em class="calibre7">vector space</em> <math alttext="double-struck upper V">
  <mi>ğ•</mi>
</math> is a set of elements (called <em class="calibre7">vectors</em>) that is characterized by:</p>
<ol class="calibre47">
<li class="calibre48">
<p class="author1">An addition function mapping two vectors <math alttext="v 1 comma v 2 element-of double-struck upper V">
  <mrow>
    <msub><mi>v</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>v</mi> <mn>2</mn> </msub>
    <mo>âˆˆ</mo>
    <mi>ğ•</mi>
  </mrow>
</math> to another element of the vector space <math alttext="left-parenthesis v 1 plus v 2 right-parenthesis element-of double-struck upper V">
  <mrow>
    <mo>(</mo>
    <msub><mi>v</mi> <mn>1</mn> </msub>
    <mo>+</mo>
    <msub><mi>v</mi> <mn>2</mn> </msub>
    <mo>)</mo>
    <mo>âˆˆ</mo>
    <mi>ğ•</mi>
  </mrow>
</math>.</p>
</li>
<li class="calibre48">
<p class="author1">A scalar multiplication function mapping a scalar <math alttext="alpha element-of double-struck upper R">
  <mrow>
    <mi>Î±</mi>
    <mo>âˆˆ</mo>
    <mi>â„</mi>
  </mrow>
</math> and a vector <math alttext="v element-of double-struck upper V">
  <mrow>
    <mi>v</mi>
    <mo>âˆˆ</mo>
    <mi>ğ•</mi>
  </mrow>
</math> to another element of the vector space <math alttext="left-parenthesis alpha dot v right-parenthesis element-of double-struck upper V">
  <mrow>
    <mo>(</mo>
    <mi>Î±</mi>
    <mo>Â·</mo>
    <mi>v</mi>
    <mo>)</mo>
    <mo>âˆˆ</mo>
    <mi>ğ•</mi>
  </mrow>
</math>.</p>
</li>
<li class="calibre48">
<p class="author1">A special elementâ€”usually called â€œzeroâ€ or â€œneutral elementâ€â€”<math alttext="0 element-of double-struck upper V">
  <mrow>
    <mn>0</mn>
    <mo>âˆˆ</mo>
    <mi>ğ•</mi>
  </mrow>
</math> such that <math alttext="v plus 0 equals v">
  <mrow>
    <mi>v</mi>
    <mo>+</mo>
    <mn>0</mn>
    <mo>=</mo>
    <mi>v</mi>
  </mrow>
</math>.</p>
</li>

</ol>

<p class="author1">It is easy to verify that, for example, the sets <math alttext="double-struck upper R comma double-struck upper R Superscript 5">
  <mrow>
    <mi>â„</mi>
    <mo>,</mo>
    <msup><mi>â„</mi> <mn>5</mn> </msup>
  </mrow>
</math>, or
<math><mrow><msup><mi>â„</mi> <mi>I</mi> </msup><mo>,</mo><mi>I</mi><mo>âˆˆ</mo><msub><mi>â„•</mi> <mrow><mn>&gt;0</mn></mrow> </msub></mrow></math>
are vector spaces.</p>

<p class="author1">Consequently, the model economy is <em class="calibre7">incomplete</em> if:</p>
<div data-type="equation" class="calibre42">
<math alttext="rank left-parenthesis script upper M right-parenthesis less-than upper I" display="block">
  <mrow>
    <mtext>rank</mtext>
    <mo>(</mo>
    <mi>â„³</mi>
    <mo>)</mo>
    <mo>&lt;</mo>
    <mi>I</mi>
  </mrow>
</math>
</div>

<p class="author1">To make things a bit more concrete, consider a state space with three possible future states only, <math alttext="normal upper Omega equals StartSet omega 1 comma omega 2 comma omega 3 EndSet">
  <mrow>
    <mi>Î©</mi>
    <mo>=</mo>
    <mo>{</mo>
    <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mn>3</mn> </msub>
    <mo>}</mo>
  </mrow>
</math>. All random variables, then, are vectors in the vector space <math alttext="double-struck upper R cubed">
  <msup><mi>â„</mi> <mn>3</mn> </msup>
</math>. The following market payoff matrixâ€”resulting from three traded financial assetsâ€”has a rank of 2 only because two-column vectors are linearly dependent. This leads to an incomplete market:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M equals Start 3 By 3 Matrix 1st Row 1st Column 11 2nd Column 20 3rd Column 10 2nd Row 1st Column 11 2nd Column 10 3rd Column 5 3rd Row 1st Column 11 2nd Column 5 3rd Column 2.5 EndMatrix right double arrow rank left-parenthesis script upper M right-parenthesis equals 2" display="block">
  <mrow>
    <mi>â„³</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>20</mn>
          </mtd>
          <mtd>
            <mn>10</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>10</mn>
          </mtd>
          <mtd>
            <mn>5</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>5</mn>
          </mtd>
          <mtd>
            <mrow>
              <mn>2</mn>
              <mo>.</mo>
              <mn>5</mn>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>â‡’</mo>
    <mtext>rank</mtext>
    <mrow>
      <mo>(</mo>
      <mi>â„³</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mn>2</mn>
  </mrow>
</math>
</div>

<p class="author1">It is easily verified that the financial assets 2 and 3 are indeed linearly dependent:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S 1 squared equals Start 3 By 1 Matrix 1st Row  20 2nd Row  10 3rd Row  5 EndMatrix equals 2 dot Start 3 By 1 Matrix 1st Row  10 2nd Row  5 3rd Row  2.5 EndMatrix equals 2 dot upper S 1 cubed" display="block">
  <mrow>
    <msubsup><mi>S</mi> <mn>1</mn> <mn>2</mn> </msubsup>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>20</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>10</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>5</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>=</mo>
    <mn>2</mn>
    <mo>Â·</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>10</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>5</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mn>2</mn>
              <mo>.</mo>
              <mn>5</mn>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>=</mo>
    <mn>2</mn>
    <mo>Â·</mo>
    <msubsup><mi>S</mi> <mn>1</mn> <mn>3</mn> </msubsup>
  </mrow>
</math>
</div>

<p class="author1">By contrast, the market payoff matrix that followsâ€”resulting from a different set of three traded financial assetsâ€”has a rank of 3, leading to a complete market. In such a case, one also speaks of the matrix <a data-type="indexterm" data-primary="full rank" id="idm44853689290520" class="calibre6"/>having <em class="calibre7">full rank</em>:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M equals Start 3 By 3 Matrix 1st Row 1st Column 11 2nd Column 20 3rd Column 10 2nd Row 1st Column 11 2nd Column 10 3rd Column 25 3rd Row 1st Column 11 2nd Column 5 3rd Column 10 EndMatrix right double arrow rank left-parenthesis script upper M right-parenthesis equals 3" display="block">
  <mrow>
    <mi>â„³</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>20</mn>
          </mtd>
          <mtd>
            <mn>10</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>10</mn>
          </mtd>
          <mtd>
            <mn>25</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>5</mn>
          </mtd>
          <mtd>
            <mn>10</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>â‡’</mo>
    <mtext>rank</mtext>
    <mrow>
      <mo>(</mo>
      <mi>â„³</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mn>3</mn>
  </mrow>
</math>
</div>

<p class="author1">Assume next that a probability space is fixed for which the state space has five elements, <math alttext="normal upper Omega equals StartSet omega 1 comma period period period comma omega 5 EndSet">
  <mrow>
    <mi>Î©</mi>
    <mo>=</mo>
    <mo>{</mo>
    <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mn>5</mn> </msub>
    <mo>}</mo>
  </mrow>
</math>. The future (uncertain) price and payoff vectors of the five traded financial assets <math alttext="script upper S">
  <mi>ğ’®</mi>
</math> and all contingent claims, respectively, are now elements of the vector space <math alttext="double-struck upper R Superscript 5">
  <msup><mi>â„</mi> <mn>5</mn> </msup>
</math>. The Python code that follows analyzes contingent claim replication based on such a model economy <math alttext="script upper E">
  <mi>â„°</mi>
</math>. It starts by assuming that all five Arrow-Debreu securities<a data-type="indexterm" data-primary="Arrow-Debreu securities" id="idm44853689262632" class="calibre6"/> are traded and then proceeds to a randomized market payoff matrix:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">31</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">eye</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO5-1" href="ch05_split_000.xhtml#callout_static_economy_CO5-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO5-2" href="ch05_split_000.xhtml#callout_static_economy_CO5-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">1.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1.</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">matrix_rank</code><code class="p">(</code><code class="n">M</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO5-3" href="ch05_split_000.xhtml#callout_static_economy_CO5-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">5</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">34</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">2</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO5-4" href="ch05_split_000.xhtml#callout_static_economy_CO5-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C1</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO5-5" href="ch05_split_000.xhtml#callout_static_economy_CO5-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">10</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">8</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">6</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">4</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">2</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">36</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">solve</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">C1</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO5-6" href="ch05_split_000.xhtml#callout_static_economy_CO5-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">36</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">10.</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">8.</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">6.</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">4.</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">2.</code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO5-1" href="ch05_split_000.xhtml#co_static_economy_CO5-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Creates a two-dimensional <code class="calibre22">ndarray</code> object, here an identity matrix. It can be interpreted as the market payoff matrix resulting from five traded Arrow-Debreu securities. It forms a so-called <em class="calibre7">canonical</em> basis of the vector space <math alttext="double-struck upper R Superscript 5">
  <msup><mi>â„</mi> <mn>5</mn> </msup>
</math>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO5-2" href="ch05_split_000.xhtml#co_static_economy_CO5-3"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Calculates the rank of the matrix, which is also trivial to see for the identity matrix.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO5-3" href="ch05_split_000.xhtml#co_static_economy_CO5-4"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">A contingent claim payoff that is to be replicated by the traded financial assets.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO5-4" href="ch05_split_000.xhtml#co_static_economy_CO5-6"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This solves the replication (representation) problem, which is again trivial in the case of the identity matrix.</p></dd>
</dl>

<p class="author1">Next, a randomized market payoff matrix is generated, which happens to be of full rank as well (no guarantees here in general):</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">37</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">rng</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">default_rng</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO6-1" href="ch05_split_000.xhtml#callout_static_economy_CO6-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">38</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">rng</code><code class="o">.</code><code class="n">integers</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">5</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">5</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO6-2" href="ch05_split_000.xhtml#callout_static_economy_CO6-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO6-3" href="ch05_split_000.xhtml#callout_static_economy_CO6-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">7</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">8</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">6</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">3</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">4</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">6</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">9</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">9</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">6</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">4</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">8</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">9</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">9</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">7</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">7</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">5</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">9</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">7</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">3</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">3</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">40</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">matrix_rank</code><code class="p">(</code><code class="n">M</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO6-4" href="ch05_split_000.xhtml#callout_static_economy_CO6-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">40</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">5</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">41</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">matrix_rank</code><code class="p">(</code><code class="n">M</code><code class="o">.</code><code class="n">T</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO6-5" href="ch05_split_000.xhtml#callout_static_economy_CO6-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">41</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">5</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">42</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">phi</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">solve</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">C1</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO6-6" href="ch05_split_000.xhtml#callout_static_economy_CO6-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">43</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">phi</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO6-7" href="ch05_split_000.xhtml#callout_static_economy_CO6-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">43</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mi">1.16988</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.52471</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">0.3861</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22">  </code><code class="mi">2.56409</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">0.62085</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">44</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO6-8" href="ch05_split_000.xhtml#callout_static_economy_CO6-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">44</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">10.</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">8.</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">6.</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">4.</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">2.</code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO6-1" href="ch05_split_000.xhtml#co_static_economy_CO6-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Fixes the seed for the <code class="calibre22">NumPy</code> random number generator, which allows for reproducibility of the results.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO6-2" href="ch05_split_000.xhtml#co_static_economy_CO6-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Creates a randomized market payoff matrix (<code class="calibre22">ndarray</code> object with shape <code class="calibre22">(5, 5)</code> populated by random integers between 1 and 10).</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO6-3" href="ch05_split_000.xhtml#co_static_economy_CO6-4"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The matrix has full rankâ€”both the column and row vectors are linearly 
<span class="firstname">independent</span>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO6-4" href="ch05_split_000.xhtml#co_static_economy_CO6-6"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The nontrivial solution to the replication problem with the randomized basis for the vector space <math alttext="double-struck upper R Superscript 5">
  <msup><mi>â„</mi> <mn>5</mn> </msup>
</math>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO6-5" href="ch05_split_000.xhtml#co_static_economy_CO6-8"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Checks the solution for achieving perfect<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="market completeness" data-startref="model-static-completeness" id="idm44853688687256" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="market completeness" data-startref="static-completeness" id="idm44853689186216" class="calibre6"/><a data-type="indexterm" data-primary="market completeness" data-secondary="in static economy" data-secondary-sortas="static economy" data-startref="market-complete-static" id="idm44853689185000" class="calibre6"/><a data-type="indexterm" data-primary="complete market model" data-secondary="in static economy" data-secondary-sortas="static economy" data-startref="complete-market-static" id="idm44853689183512" class="calibre6"/><a data-type="indexterm" data-primary="market payoff matrix" data-secondary="market completeness and" data-startref="market-payoff-completeness" id="idm44853688621768" class="calibre6"/> replication.</p></dd>
</dl>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Fundamental Theorems of Asset Pricing" class="calibre4"><div class="preface" id="idm44853689157352">
<h1 class="calibre17">Fundamental Theorems of Asset Pricing</h1>

<p class="author1">Consider the <a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="Fundamental Theorems of Asset Pricing" id="model-static-fundamental" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="Fundamental Theorems of Asset Pricing" id="static-fundamental" class="calibre6"/><a data-type="indexterm" data-primary="Fundamental Theorems of Asset Pricing" data-secondary="in static economy" data-secondary-sortas="static economy" id="fundamental-static" class="calibre6"/><a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="Fundamental Theorems of Asset Pricing" id="asset-fundamental-static" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="Fundamental Theorems of Asset Pricing" id="financial-assets-fundamental" class="calibre6"/>general static model economy <math alttext="script upper E equals left-parenthesis StartSet normal upper Omega comma script upper F comma upper P EndSet comma script upper S right-parenthesis">
  <mrow>
    <mi>â„°</mi>
    <mo>=</mo>
    <mo>(</mo>
    <mo>{</mo>
    <mi>Î©</mi>
    <mo>,</mo>
    <mi>â„±</mi>
    <mo>,</mo>
    <mi>P</mi>
    <mo>}</mo>
    <mo>,</mo>
    <mi>ğ’®</mi>
    <mo>)</mo>
  </mrow>
</math>, with <math alttext="upper I">
  <mi>I</mi>
</math> possible states and <math alttext="upper K">
  <mi>K</mi>
</math> traded financial assets. Assume that the risk-less short rate for lending and borrowing in the economy is
<math><mrow><mi>r</mi><mo>âˆˆ</mo><msub><mi>â„</mi> <mrow><mn>â‰¥0</mn></mrow> </msub></mrow></math>.<sup class="calibre14"><a data-type="noteref" id="idm44853688595608-marker" href="ch05_split_001.xhtml#idm44853688595608" class="calibre15">1</a></sup></p>

<p class="author1">An <em class="calibre7">arbitrage opportunity</em> is<a data-type="indexterm" data-primary="arbitrage opportunities" id="idm44853688778824" class="calibre6"/> a portfolio <math alttext="phi element-of double-struck upper R Superscript upper K">
  <mrow>
    <mi>Ï•</mi>
    <mo>âˆˆ</mo>
    <msup><mi>â„</mi> <mi>K</mi> </msup>
  </mrow>
</math> of the traded financial assets <math alttext="script upper S">
  <mi>ğ’®</mi>
</math> such that the price of the portfolio is zero</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S 0 dot phi equals sigma-summation Underscript k equals 1 Overscript upper K Endscripts upper S 0 Superscript k Baseline dot phi Superscript k Baseline equals 0" display="block">
  <mrow>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>Â·</mo>
    <mi>Ï•</mi>
    <mo>=</mo>
    <munderover><mo>âˆ‘</mo> <mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow> <mi>K</mi> </munderover>
    <msubsup><mi>S</mi> <mn>0</mn> <mi>k</mi> </msubsup>
    <mo>Â·</mo>
    <msup><mi>Ï•</mi> <mi>k</mi> </msup>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math>
</div>

<p class="author1">and the expected payoff is greater than zero:</p>
<div data-type="equation" class="calibre42">
<math alttext="bold upper E Superscript upper P Baseline left-parenthesis script upper M dot phi right-parenthesis greater-than 0" display="block">
  <mrow>
    <msup><mi>ğ„</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>â„³</mi>
      <mo>Â·</mo>
      <mi>Ï•</mi>
      <mo>)</mo>
    </mrow>
    <mo>&gt;</mo>
    <mn>0</mn>
  </mrow>
</math>
</div>

<p class="author1">Denote the <em class="calibre7">set of all arbitrage opportunities</em> by:</p>
<div data-type="equation" class="calibre42">
<math alttext="double-struck upper O identical-to StartSet phi element-of double-struck upper R Superscript upper K Baseline colon upper S 0 dot phi equals 0 comma bold upper E Superscript upper P Baseline left-parenthesis script upper M dot phi right-parenthesis greater-than 0 EndSet" display="block">
  <mrow>
    <mi>ğ•†</mi>
    <mo>â‰¡</mo>
    <mo>{</mo>
    <mi>Ï•</mi>
    <mo>âˆˆ</mo>
    <msup><mi>â„</mi> <mi>K</mi> </msup>
    <mo>:</mo>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>Â·</mo>
    <mi>Ï•</mi>
    <mo>=</mo>
    <mn>0</mn>
    <mo>,</mo>
    <msup><mi>ğ„</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>â„³</mi>
      <mo>Â·</mo>
      <mi>Ï•</mi>
      <mo>)</mo>
    </mrow>
    <mo>&gt;</mo>
    <mn>0</mn>
    <mo>}</mo>
  </mrow>
</math>
</div>

<p class="author1">A <em class="calibre7">martingale measure</em> <math alttext="upper Q">
  <mi>Q</mi>
</math> for <a data-type="indexterm" data-primary="martingale pricing" data-secondary="in static economy" data-secondary-sortas="static economy" id="idm44853688826488" class="calibre6"/>the model economy makes the discounted price processes martingales and therefore satisfies the following condition:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartFraction 1 Over 1 plus r EndFraction dot bold upper E Superscript upper Q Baseline left-parenthesis script upper M right-parenthesis equals upper S 0" display="block">
  <mrow>
    <mfrac><mn>1</mn> <mrow><mn>1</mn><mo>+</mo><mi>r</mi></mrow></mfrac>
    <mo>Â·</mo>
    <msup><mi>ğ„</mi> <mi>Q</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>â„³</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub><mi>S</mi> <mn>0</mn> </msub>
  </mrow>
</math>
</div>

<p class="author1">With these<a data-type="indexterm" data-primary="First Fundamental Theorem of Asset Pricing" id="first-fundamental" class="calibre6"/> definitions, the <em class="calibre7">First Fundamental Theorem of Asset Pricing</em> (see also <a data-type="xref" href="ch02_split_000.xhtml#two_state_economy" class="calibre6">ChapterÂ 2</a>), which relates the existence of a martingale measure to the absence of arbitrage opportunities, can be formulated. For a discussion and proof, refer to Pliska (1997, section 1.3).</p>
<dl class="calibre18">
<dt class="calibre19">First Fundamental Theorem of Asset Pricing (1FTAP)</dt>
<dd class="calibre20">
<div class="preface">
<p class="calibre21">The following statements are equivalent:</p>
<ol class="calibre59">
<li class="calibre48">
<p class="calibre21">A martingale measure <math alttext="upper Q">
  <mi>Q</mi>
</math> exists.</p>
</li>
<li class="calibre48">
<p class="calibre21">The economy is arbitrage-free, it holds <math alttext="double-struck 0 equals normal empty-set">
  <mrow>
    <mn mathvariant="double-struck">0</mn>
    <mo>=</mo>
    <mi>âˆ…</mi>
  </mrow>
</math>.</p>
</li>

</ol>
</div>

</dd>
</dl>

<p class="author1">The derivation of a martingale measure is formally the same as the solution of a replication problem for a contingent claim <math alttext="upper C equals left-parenthesis upper C 0 comma upper C 1 right-parenthesis">
  <mrow>
    <mi>C</mi>
    <mo>=</mo>
    <mo>(</mo>
    <msub><mi>C</mi> <mn>0</mn> </msub>
    <mo>,</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>)</mo>
  </mrow>
</math>, which reads</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M dot phi equals upper C 1" display="block">
  <mrow>
    <mi>â„³</mi>
    <mo>Â·</mo>
    <mi>Ï•</mi>
    <mo>=</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
  </mrow>
</math>
</div>

<p class="author1">and where the replication portfolio <math alttext="phi">
  <mi>Ï•</mi>
</math> needs to be determined. Mathematically, this is equivalent to solving a system of linear equations, as illustrated in <a data-type="xref" href="ch02_split_000.xhtml#two_state_economy" class="calibre6">ChapterÂ 2</a>. Finding a martingale measure can be written as</p>
<div data-type="equation" class="calibre42">
<math alttext="StartFraction 1 Over 1 plus r EndFraction dot bold upper E Superscript upper Q Baseline left-parenthesis script upper M right-parenthesis equals StartFraction 1 Over 1 plus r EndFraction script upper M Superscript upper T Baseline dot upper Q equals script upper M overTilde dot upper Q equals upper S 0" display="block">
  <mrow>
    <mfrac><mn>1</mn> <mrow><mn>1</mn><mo>+</mo><mi>r</mi></mrow></mfrac>
    <mo>Â·</mo>
    <msup><mi>ğ„</mi> <mi>Q</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>â„³</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mrow><mn>1</mn><mo>+</mo><mi>r</mi></mrow></mfrac>
    <msup><mi>â„³</mi> <mi>T</mi> </msup>
    <mo>Â·</mo>
    <mi>Q</mi>
    <mo>=</mo>
    <mover accent="true"><mi>â„³</mi> <mo>Ëœ</mo></mover>
    <mo>Â·</mo>
    <mi>Q</mi>
    <mo>=</mo>
    <msub><mi>S</mi> <mn>0</mn> </msub>
  </mrow>
</math>
</div>

<p class="author1">where <math alttext="script upper M overTilde identical-to StartFraction 1 Over 1 plus r EndFraction script upper M Superscript upper T">
  <mrow>
    <mover accent="true"><mi>â„³</mi> <mo>Ëœ</mo></mover>
    <mo>â‰¡</mo>
    <mfrac><mn>1</mn> <mrow><mn>1</mn><mo>+</mo><mi>r</mi></mrow></mfrac>
    <msup><mi>â„³</mi> <mi>T</mi> </msup>
  </mrow>
</math> and where</p>
<div data-type="equation" class="calibre42">
<math alttext="upper Q equals Start 4 By 1 Matrix 1st Row  upper Q left-parenthesis omega 1 right-parenthesis 2nd Row  upper Q left-parenthesis omega 2 right-parenthesis 3rd Row  period period period 4th Row  upper Q left-parenthesis omega Subscript upper I Baseline right-parenthesis EndMatrix comma for-all omega element-of normal upper Omega colon 0 less-than-or-equal-to upper Q left-parenthesis omega right-parenthesis less-than-or-equal-to 1 comma sigma-summation Underscript omega element-of normal upper Omega Endscripts upper Q left-parenthesis omega right-parenthesis equals 1" display="block">
  <mrow>
    <mi>Q</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mi>Q</mi>
              <mo>(</mo>
              <msub><mi>Ï‰</mi> <mn>1</mn> </msub>
              <mo>)</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mi>Q</mi>
              <mo>(</mo>
              <msub><mi>Ï‰</mi> <mn>2</mn> </msub>
              <mo>)</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mi>Q</mi>
              <mo>(</mo>
              <msub><mi>Ï‰</mi> <mi>I</mi> </msub>
              <mo>)</mo>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>,</mo>
    <mo>âˆ€</mo>
    <mi>Ï‰</mi>
    <mo>âˆˆ</mo>
    <mi>Î©</mi>
    <mo>:</mo>
    <mn>0</mn>
    <mo>â‰¤</mo>
    <mi>Q</mi>
    <mrow>
      <mo>(</mo>
      <mi>Ï‰</mi>
      <mo>)</mo>
    </mrow>
    <mo>â‰¤</mo>
    <mn>1</mn>
    <mo>,</mo>
    <munder><mo>âˆ‘</mo> <mrow><mi>Ï‰</mi><mo>âˆˆ</mo><mi>Î©</mi></mrow> </munder>
    <mi>Q</mi>
    <mrow>
      <mo>(</mo>
      <mi>Ï‰</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>
</div>

<p class="author1">This problem can be considered <a data-type="indexterm" data-primary="dual problem" id="idm44853688541736" class="calibre6"/><a data-type="indexterm" data-primary="replication" data-secondary="dual problem" id="idm44853688541128" class="calibre6"/>the <em class="calibre7">dual problem</em> to the replication problemâ€”albeit under some restrictive constraints. The constraints, resulting from the requirement that the solution be a probability measure, make a different technical approach in Python necessary. The problem of finding a martingale measure can be modeled as a constrained minimization problemâ€”instead of just solving a system of linear equation. The example assumes a state space with five elements and the market payoff structure from before:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">45</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="nn">scipy.optimize</code><code class="calibre22"> </code><code class="kn">as</code><code class="calibre22"> </code><code class="nn">sco</code><code class="calibre22">    </code><a class="calibre6" id="co_static_economy_CO7-1" href="ch05_split_000.xhtml#callout_static_economy_CO7-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">46</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">25</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">25</code><code class="p">)</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">20</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">30</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">15</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">25</code><code class="p">)</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">20</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">)</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">5</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">30</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">15</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-2" href="ch05_split_000.xhtml#callout_static_economy_CO7-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">47</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">matrix_rank</code><code class="p">(</code><code class="n">M</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-3" href="ch05_split_000.xhtml#callout_static_economy_CO7-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">47</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">5</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">48</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">ones</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="mi">10</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-4" href="ch05_split_000.xhtml#callout_static_economy_CO7-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">49</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-5" href="ch05_split_000.xhtml#callout_static_economy_CO7-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">49</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">10.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10.</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">50</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">r</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">0.1</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-6" href="ch05_split_000.xhtml#callout_static_economy_CO7-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">51</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">def</code><code class="calibre22"> </code><code class="nf">E</code><code class="p">(</code><code class="n">Q</code><code class="p">)</code><code class="p">:</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="kn">return</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="o">.</code><code class="n">T</code><code class="p">,</code><code class="calibre22"> </code><code class="n">Q</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">r</code><code class="p">)</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="o">*</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">)</code><code class="calibre22">   </code><a class="calibre6" id="co_static_economy_CO7-7" href="ch05_split_000.xhtml#callout_static_economy_CO7-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">52</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">E</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="mi">5</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">0.2</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">52</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">4.0</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">53</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">cons</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="p">{</code><code class="s">'</code><code class="s">type</code><code class="s">'</code><code class="p">:</code><code class="calibre22"> </code><code class="s">'</code><code class="s">eq</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="s">'</code><code class="s">fun</code><code class="s">'</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">lambda</code><code class="calibre22"> </code><code class="n">Q</code><code class="p">:</code><code class="calibre22"> </code><code class="n">Q</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">}</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-8" href="ch05_split_000.xhtml#callout_static_economy_CO7-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">54</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">bnds</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">5</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="p">[</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="p">]</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-9" href="ch05_split_000.xhtml#callout_static_economy_CO7-9"><img src="Images/9.png" alt="9" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">55</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">bnds</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-10" href="ch05_split_000.xhtml#callout_static_economy_CO7-9"><img src="Images/9.png" alt="9" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">55</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="p">[</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="p">]</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">56</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">res</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">sco</code><code class="o">.</code><code class="n">minimize</code><code class="p">(</code><code class="n">E</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">5</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-11" href="ch05_split_000.xhtml#callout_static_economy_CO7-10"><img src="Images/10.png" alt="10" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">                            </code><code class="n">method</code><code class="o">=</code><code class="s">'</code><code class="s">SLSQP</code><code class="s">'</code><code class="p">,</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-12" href="ch05_split_000.xhtml#callout_static_economy_CO7-11"><img src="Images/11.png" alt="11" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">                            </code><code class="n">constraints</code><code class="o">=</code><code class="n">cons</code><code class="p">,</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-13" href="ch05_split_000.xhtml#callout_static_economy_CO7-12"><img src="Images/12.png" alt="12" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">                            </code><code class="n">bounds</code><code class="o">=</code><code class="n">bnds</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-14" href="ch05_split_000.xhtml#callout_static_economy_CO7-13"><img src="Images/13.png" alt="13" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">57</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">Q</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">res</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-15" href="ch05_split_000.xhtml#callout_static_economy_CO7-14"><img src="Images/14.png" alt="14" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">58</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">Q</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-16" href="ch05_split_000.xhtml#callout_static_economy_CO7-14"><img src="Images/14.png" alt="14" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">58</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0.14667</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.18333</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.275</code><code class="calibre22">  </code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.18333</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.21167</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">59</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="o">.</code><code class="n">T</code><code class="p">,</code><code class="calibre22"> </code><code class="n">Q</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">r</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO7-17" href="ch05_split_000.xhtml#callout_static_economy_CO7-15"><img src="Images/15.png" alt="15" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">59</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">10.</code><code class="calibre22">     </code><code class="p">,</code><code class="calibre22">  </code><code class="mi">9.99998</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">9.99999</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10.00001</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">9.99998</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">60</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">allclose</code><code class="p">(</code><code class="n">M0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="o">.</code><code class="n">T</code><code class="p">,</code><code class="calibre22"> </code><code class="n">Q</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">r</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">60</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="nb">True</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-1" href="ch05_split_000.xhtml#co_static_economy_CO7-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Imports the <code class="calibre22">optimize</code> subpackage from <code class="calibre22">scipy</code> as <code class="calibre22">sco</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-2" href="ch05_split_000.xhtml#co_static_economy_CO7-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Defines the market payoff matrix.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-3" href="ch05_split_000.xhtml#co_static_economy_CO7-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Verifies that the matrix is of full rank.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-4" href="ch05_split_000.xhtml#co_static_economy_CO7-4"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Defines the price vector for the traded financial assetsâ€¦</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-5" href="ch05_split_000.xhtml#co_static_economy_CO7-5"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">â€¦and shows the values, which are all set to 10.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-6" href="ch05_split_000.xhtml#co_static_economy_CO7-6"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Fixes the constant short rate.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-7" href="ch05_split_000.xhtml#co_static_economy_CO7-7"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Defines the objective function that is to be minimized. This approach is necessary because the linear system is to be solved under a constraint and with bounds for all parameters.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-8" href="ch05_split_000.xhtml#co_static_economy_CO7-8"><img src="Images/8.png" alt="8" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The constraint that the single probabilities need to add up to one.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-9" href="ch05_split_000.xhtml#co_static_economy_CO7-9"><img src="Images/9.png" alt="9" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Defines the bounds for every single probability.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-10" href="ch05_split_000.xhtml#co_static_economy_CO7-11"><img src="Images/10.png" alt="10" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The optimization procedure minimizing the function <code class="calibre22">E</code>â€¦</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-11" href="ch05_split_000.xhtml#co_static_economy_CO7-12"><img src="Images/11.png" alt="11" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">â€¦defining the method used,â€¦</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-12" href="ch05_split_000.xhtml#co_static_economy_CO7-13"><img src="Images/12.png" alt="12" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">â€¦providing the constraints to be observed, andâ€¦</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-13" href="ch05_split_000.xhtml#co_static_economy_CO7-14"><img src="Images/13.png" alt="13" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">â€¦providing the bounds for the parameters.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-14" href="ch05_split_000.xhtml#co_static_economy_CO7-15"><img src="Images/14.png" alt="14" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The results vector is the martingale measure.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO7-15" href="ch05_split_000.xhtml#co_static_economy_CO7-17"><img src="Images/15.png" alt="15" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Under the martingale measure, the discounted price processes are<a data-type="indexterm" data-primary="First Fundamental Theorem of Asset Pricing" data-startref="first-fundamental" id="idm44853687785528" class="calibre6"/> martingales.</p></dd>
</dl>

<p class="author1">The second Fundamental Theorem of Asset Pricing also<a data-type="indexterm" data-primary="Second Fundamental Theorem of Asset Pricing" id="idm44853687820344" class="calibre6"/> holds true in the general static model economy <math alttext="script upper E">
  <mi>â„°</mi>
</math>. For a discussion and proof, refer to Pliska (1997, section 1.5).</p>
<dl class="calibre18">
<dt class="calibre19">Second Fundamental Theorem of Asset Pricing (2FTAP)</dt>
<dd class="calibre20">
<div class="preface">
<p class="calibre21">The following statements are equivalent:</p>
<ol class="calibre59">
<li class="calibre48">
<p class="calibre21">The martingale measure <math alttext="upper Q">
  <mi>Q</mi>
</math> is unique.</p>
</li>
<li class="calibre48">
<p class="calibre21">The economy is complete, it holds <math alttext="double-struck upper A equals double-struck upper R Subscript plus Superscript upper I">
  <mrow>
    <mi>ğ”¸</mi>
    <mo>=</mo>
    <msubsup><mi>â„</mi> <mo>+</mo> <mi>I</mi> </msubsup>
  </mrow>
</math>.</p>
</li>

</ol>
</div>

</dd>
</dl>
<div data-type="note" epub:type="note" class="calibre26"><h1 class="calibre33">Fundamental Theorems</h1>
<p class="author1">The<a data-type="indexterm" data-primary="martingale pricing" data-secondary="in fundamental theorems" data-secondary-sortas="fundamental theorems" id="idm44853687773400" class="calibre6"/> quest for valid option pricing models led to the seminal option pricing models of Black and Scholes (1973) and Merton (1973)â€”together Black-Scholes-Merton (1973). The models used in these seminal papers are rather specific in that they assume a geometric Brownian motion as the model for the price process of the only risky asset. Research from the late 1970s and early 1980s, namely from Harrison and Kreps (1979) and Harrison and Pliska (1981), provides a general framework for the pricing of contingent claims. In their general framework, martingale measures and processes that are (semi-)martingales play the central role. The class of (semi-)martingale processes is pretty large and encompasses both the early models (for example, geometric Brownian motion) as well as many more sophisticated financial models proposed and analyzed much later (for example, jump diffusions or stochastic volatility processes). Among others, this is one of the reasons why the presented theorems are called <em class="calibre7">fundamental</em>â€”they apply to a large class of interesting and important<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="Fundamental Theorems of Asset Pricing" data-startref="model-static-fundamental" id="idm44853687770792" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="Fundamental Theorems of Asset Pricing" data-startref="static-fundamental" id="idm44853687769464" class="calibre6"/><a data-type="indexterm" data-primary="Fundamental Theorems of Asset Pricing" data-secondary="in static economy" data-secondary-sortas="static economy" data-startref="fundamental-static" id="idm44853687768376" class="calibre6"/><a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="Fundamental Theorems of Asset Pricing" data-startref="asset-fundamental-static" id="idm44853687767048" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="Fundamental Theorems of Asset Pricing" data-startref="financial-assets-fundamental" id="idm44853687765720" class="calibre6"/> financial models.</p>
</div>
</div></section>













</div></section></div>

<div id="sbo-rt-content" class="calibre1">
<section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 5. Static Economy" class="calibre4">
<div class="preface" id="static_economy">
<section data-type="sect1" data-pdf-bookmark="Black-Scholes-Merton Option Pricing" class="calibre4"><div class="preface" id="idm44853688620200">
<h1 class="calibre17">Black-Scholes-Merton Option Pricing</h1>

<p class="author1">The<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="Black-Scholes-Merton option pricing" id="model-static-black-scholes" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="Black-Scholes-Merton option pricing" id="static-black-scholes" class="calibre6"/><a data-type="indexterm" data-primary="Black-Scholes-Merton option pricing" data-secondary="in static model" data-secondary-sortas="static model" id="black-scholes-static" class="calibre6"/><a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="Black-Scholes-Merton option pricing" id="assets-black-scholes" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="Black-Scholes-Merton option pricing" id="financial-assets-black-scholes" class="calibre6"/> Black-Scholes-Merton (1973) model for option pricing is based on a continuous model economy generally represented by stochastic differential equations (SDEs) with suitable boundary conditions. The SDE used to describe the evolution of the <em class="calibre7">single risky asset</em> (think of a stock or stock index) is the one for a <em class="calibre7">geometric Brownian motion</em>. In addition to the risky asset, another <em class="calibre7">risk-less asset</em> is traded in their model economy and it pays a continuous, risk-less short rate.</p>

<p class="author1">In the static case with two relevant points in time only, say <math alttext="t equals 0">
  <mrow>
    <mi>t</mi>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math> and <math alttext="t equals upper T greater-than 0">
  <mrow>
    <mi>t</mi>
    <mo>=</mo>
    <mi>T</mi>
    <mo>&gt;</mo>
    <mn>0</mn>
  </mrow>
</math>, the future, uncertain value of the risky asset <math alttext="upper S Subscript upper T">
  <msub><mi>S</mi> <mi>T</mi> </msub>
</math> is given by</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S Subscript upper T Baseline equals upper S 0 dot e Superscript left-parenthesis r minus StartFraction sigma squared Over 2 EndFraction right-parenthesis upper T plus sigma StartRoot upper T EndRoot z" display="block">
  <mrow>
    <msub><mi>S</mi> <mi>T</mi> </msub>
    <mo>=</mo>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>Â·</mo>
    <msup><mi>e</mi> <mrow><mfenced separators="" open="(" close=")"><mi>r</mi><mo>-</mo><mfrac><msup><mi>Ïƒ</mi> <mn>2</mn> </msup> <mn>2</mn></mfrac></mfenced><mi>T</mi><mo>+</mo><mi>Ïƒ</mi><msqrt><mi>T</mi></msqrt><mi>z</mi></mrow> </msup>
  </mrow>
</math>
</div>

<p class="author1">where
<math><mrow><msub><mi>S</mi> <mn>0</mn> </msub><mo>âˆˆ</mo><msub><mi>â„</mi> <mrow><mn>&gt;0</mn></mrow> </msub></mrow></math>
is the price of the risky asset today,
<math><mrow><mi>r</mi><mo>âˆˆ</mo><msub><mi>â„</mi> <mrow><mn>â‰¥0</mn></mrow> </msub></mrow></math>
is the constant risk-less short rate,
<math><mrow><mi>Ïƒ</mi><mo>âˆˆ</mo><msub><mi>â„</mi> <mrow><mn>&gt;0</mn></mrow> </msub></mrow></math>
is a constant volatility factor, and <math alttext="z">
  <mi>z</mi>
</math> is a standard normally distributed random variable (see Jacod and Protter (2004), chapter 16).</p>

<p class="author1">In a discrete, numerical context, one can draw, for example, pseudo-random numbers <math alttext="z Subscript i Baseline comma i equals 1 comma 2 comma period period period comma upper I">
  <mrow>
    <msub><mi>z</mi> <mi>i</mi> </msub>
    <mo>,</mo>
    <mi>i</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <mi>I</mi>
  </mrow>
</math> that are standard normally distributed to derive <math alttext="upper I">
  <mi>I</mi>
</math> numerical values for <math alttext="upper S Subscript upper T">
  <msub><mi>S</mi> <mi>T</mi> </msub>
</math> according to the preceding equation:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S Subscript upper T Baseline left-parenthesis z Subscript i Baseline right-parenthesis equals upper S 0 dot e Superscript left-parenthesis r minus StartFraction sigma squared Over 2 EndFraction right-parenthesis upper T plus sigma StartRoot upper T EndRoot z Super Subscript i Superscript Baseline comma i equals 1 comma 2 comma period period period comma upper I" display="block">
  <mrow>
    <msub><mi>S</mi> <mi>T</mi> </msub>
    <mrow>
      <mo>(</mo>
      <msub><mi>z</mi> <mi>i</mi> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>Â·</mo>
    <msup><mi>e</mi> <mrow><mfenced separators="" open="(" close=")"><mi>r</mi><mo>-</mo><mfrac><msup><mi>Ïƒ</mi> <mn>2</mn> </msup> <mn>2</mn></mfrac></mfenced><mi>T</mi><mo>+</mo><mi>Ïƒ</mi><msqrt><mi>T</mi></msqrt><msub><mi>z</mi> <mi>i</mi> </msub></mrow> </msup>
    <mo>,</mo>
    <mi>i</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <mi>I</mi>
  </mrow>
</math>
</div>

<p class="author1">Such a procedure is usually called<a data-type="indexterm" data-primary="Monte Carlo simulation" id="idm44853687701720" class="calibre6"/> a <em class="calibre7">Monte Carlo simulation</em>. To simplify the notation, <math alttext="upper S Subscript upper T">
  <msub><mi>S</mi> <mi>T</mi> </msub>
</math> shall from now on specify the vector of simulated future values of the stock:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S Subscript upper T Baseline identical-to Start 4 By 1 Matrix 1st Row  upper S Subscript upper T Baseline left-parenthesis z 1 right-parenthesis 2nd Row  upper S Subscript upper T Baseline left-parenthesis z 2 right-parenthesis 3rd Row  period period period 4th Row  upper S Subscript upper T Baseline left-parenthesis z Subscript upper I Baseline right-parenthesis EndMatrix" display="block">
  <mrow>
    <msub><mi>S</mi> <mi>T</mi> </msub>
    <mo>â‰¡</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msub><mi>S</mi> <mi>T</mi> </msub>
              <mrow>
                <mo>(</mo>
                <msub><mi>z</mi> <mn>1</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <msub><mi>S</mi> <mi>T</mi> </msub>
              <mrow>
                <mo>(</mo>
                <msub><mi>z</mi> <mn>2</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <msub><mi>S</mi> <mi>T</mi> </msub>
              <mrow>
                <mo>(</mo>
                <msub><mi>z</mi> <mi>I</mi> </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">With these definitions, the model economy is as follows. There is a general probability space <math alttext="StartSet normal upper Omega comma script upper F identical-to normal script upper P left-parenthesis normal upper Omega right-parenthesis comma upper P EndSet">
  <mrow>
    <mo>{</mo>
    <mi>Î©</mi>
    <mo>,</mo>
    <mi>â„±</mi>
    <mo>â‰¡</mo>
    <mi>â„˜</mi>
    <mo>(</mo>
    <mi>Î©</mi>
    <mo>)</mo>
    <mo>,</mo>
    <mi>P</mi>
    <mo>}</mo>
  </mrow>
</math> with <math alttext="upper I">
  <mi>I</mi>
</math> possible future states of the economy. Every state is assumed to be equally likelyâ€”that is, it holds:</p>
<div data-type="equation" class="calibre42">
<math alttext="for-all omega element-of normal upper Omega colon upper P left-parenthesis omega right-parenthesis equals StartFraction 1 Over upper I EndFraction" display="block">
  <mrow>
    <mo>âˆ€</mo>
    <mi>Ï‰</mi>
    <mo>âˆˆ</mo>
    <mi>Î©</mi>
    <mo>:</mo>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>Ï‰</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mi>I</mi></mfrac>
  </mrow>
</math>
</div>

<p class="author1">The set of traded financial assets <math alttext="script upper S">
  <mi>ğ’®</mi>
</math> consists of the risk-less asset called <em class="calibre7">bond</em> with price process <math alttext="upper B equals left-parenthesis upper B 0 comma upper B 0 dot e Superscript r upper T Baseline right-parenthesis">
  <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>B</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msub><mi>B</mi> <mn>0</mn> </msub>
      <mo>Â·</mo>
      <msup><mi>e</mi> <mrow><mi>r</mi><mi>T</mi></mrow> </msup>
    </mfenced>
  </mrow>
</math> and the risky asset called <em class="calibre7">stock</em> (paying no dividends) with price process <math alttext="upper S equals left-parenthesis upper S 0 comma upper S Subscript upper T Baseline right-parenthesis">
  <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mo>(</mo>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>,</mo>
    <msub><mi>S</mi> <mi>T</mi> </msub>
    <mo>)</mo>
  </mrow>
</math> and <math alttext="upper S Subscript upper T">
  <msub><mi>S</mi> <mi>T</mi> </msub>
</math> as defined previously. Together this forms the Black-Scholes-Merton (1973) model economy:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper E Superscript upper B upper S upper M Baseline equals left-parenthesis StartSet normal upper Omega comma script upper F comma upper P EndSet comma script upper S equals StartSet upper B comma upper S EndSet right-parenthesis" display="block">
  <mrow>
    <msup><mi>â„°</mi> <mrow><mi>B</mi><mi>S</mi><mi>M</mi></mrow> </msup>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <mo>{</mo>
      <mi>Î©</mi>
      <mo>,</mo>
      <mi>â„±</mi>
      <mo>,</mo>
      <mi>P</mi>
      <mo>}</mo>
      <mo>,</mo>
      <mi>ğ’®</mi>
      <mo>=</mo>
      <mo>{</mo>
      <mi>B</mi>
      <mo>,</mo>
      <mi>S</mi>
      <mo>}</mo>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">Assume a European call option written on the stock as a contingent claim. The payoff is</p>
<div data-type="equation" class="calibre42">
<math alttext="upper C Subscript upper T Baseline identical-to left-parenthesis upper S Subscript upper T Baseline minus upper K comma 0 right-parenthesis" display="block">
  <mrow>
    <msub><mi>C</mi> <mi>T</mi> </msub>
    <mo>â‰¡</mo>
    <mrow>
      <mo>(</mo>
      <msub><mi>S</mi> <mi>T</mi> </msub>
      <mo>-</mo>
      <mi>K</mi>
      <mo>,</mo>
      <mn>0</mn>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">with strike price
<math><mrow><mi>K</mi><mo>âˆˆ</mo><msub><mi>â„</mi> <mrow><mn>â‰¥0</mn></mrow> </msub></mrow></math>.
The priceâ€”here, the <em class="calibre7">Monte Carlo estimator</em>â€”for the call option is given as the expected (average) discounted payoff:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper C 0 equals e Superscript minus r upper T Baseline StartFraction 1 Over upper I EndFraction sigma-summation Underscript i equals 1 Overscript upper I Endscripts max left-parenthesis upper S Subscript upper T Baseline left-parenthesis z Subscript i Baseline right-parenthesis minus upper K comma 0 right-parenthesis" display="block">
  <mrow>
    <msub><mi>C</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <msup><mi>e</mi> <mrow><mo>-</mo><mi>r</mi><mi>T</mi></mrow> </msup>
    <mfrac><mn>1</mn> <mi>I</mi></mfrac>
    <munderover><mo>âˆ‘</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>I</mi> </munderover>
    <mo movablelimits="true" form="prefix">max</mo>
    <mrow>
      <mo>(</mo>
      <msub><mi>S</mi> <mi>T</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub><mi>z</mi> <mi>i</mi> </msub>
        <mo>)</mo>
      </mrow>
      <mo>-</mo>
      <mi>K</mi>
      <mo>,</mo>
      <mn>0</mn>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">The model economy and the Monte Carloâ€“based pricing approach are straightforward to implement in Python. <a data-type="xref" href="ch05_split_001.xhtml#bsm_01" class="calibre6">FigureÂ 5-1</a> shows the frequency distribution of the simulated stock price values, including the mean and the standard deviation around the mean:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">61</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="nn">math</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">62</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">100</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO8-1" href="ch05_split_001.xhtml#callout_static_economy_CO8-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">r</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">0.05</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO8-2" href="ch05_split_001.xhtml#callout_static_economy_CO8-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">sigma</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">0.2</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO8-3" href="ch05_split_001.xhtml#callout_static_economy_CO8-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">T</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">1.0</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO8-4" href="ch05_split_001.xhtml#callout_static_economy_CO8-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">I</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">10000</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO8-5" href="ch05_split_001.xhtml#callout_static_economy_CO8-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">63</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">rng</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">default_rng</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO8-6" href="ch05_split_001.xhtml#callout_static_economy_CO8-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">64</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">ST</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="p">(</code><code class="n">r</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">sigma</code><code class="calibre22"> </code><code class="o">*</code><code class="o">*</code><code class="calibre22"> </code><code class="mi">2</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">T</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22">
</code><code class="calibre22">              </code><code class="n">sigma</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">math</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">T</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">rng</code><code class="o">.</code><code class="n">standard_normal</code><code class="p">(</code><code class="n">I</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO8-7" href="ch05_split_001.xhtml#callout_static_economy_CO8-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">65</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">ST</code><code class="p">[</code><code class="p">:</code><code class="mi">8</code><code class="p">]</code><code class="o">.</code><code class="n">round</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO8-8" href="ch05_split_001.xhtml#callout_static_economy_CO8-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">65</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="calibre22"> </code><code class="mi">81.7</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">109.2</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">120.5</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">114.9</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">85.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22"> </code><code class="mi">127.7</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">118.6</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">118.6</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">66</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">ST</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO8-9" href="ch05_split_001.xhtml#callout_static_economy_CO8-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">66</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">105.6675325917807</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">67</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">math</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="n">r</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">T</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO8-10" href="ch05_split_001.xhtml#callout_static_economy_CO8-9"><img src="Images/9.png" alt="9" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">67</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">105.12710963760242</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">68</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">from</code><code class="calibre22"> </code><code class="nn">pylab</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="n">mpl</code><code class="p">,</code><code class="calibre22"> </code><code class="n">plt</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s">'</code><code class="s">seaborn</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s">'</code><code class="s">savefig.dpi</code><code class="s">'</code><code class="p">]</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">300</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s">'</code><code class="s">font.family</code><code class="s">'</code><code class="p">]</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="s">'</code><code class="s">serif</code><code class="s">'</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">69</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">ST</code><code class="p">,</code><code class="calibre22"> </code><code class="n">bins</code><code class="o">=</code><code class="mi">35</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">frequency</code><code class="s">'</code><code class="p">)</code><code class="p">;</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">ST</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">color</code><code class="o">=</code><code class="s">'</code><code class="s">r</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">mean</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">ST</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">ST</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">color</code><code class="o">=</code><code class="s">'</code><code class="s">y</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">sd up</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">ST</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">ST</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">color</code><code class="o">=</code><code class="s">'</code><code class="s">y</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">sd down</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">loc</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="p">;</code><code class="calibre22">   </code><a class="calibre6" id="co_static_economy_CO8-11" href="ch05_split_001.xhtml#callout_static_economy_CO8-10"><img src="Images/10.png" alt="10" class="calibre44"/></a></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO8-1" href="ch05_split_001.xhtml#co_static_economy_CO8-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The initial stock price level.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO8-2" href="ch05_split_001.xhtml#co_static_economy_CO8-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The constant short rate.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO8-3" href="ch05_split_001.xhtml#co_static_economy_CO8-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The volatility factor.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO8-4" href="ch05_split_001.xhtml#co_static_economy_CO8-4"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The time horizon in year fractions.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO8-5" href="ch05_split_001.xhtml#co_static_economy_CO8-5"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The number of states and also the number of simulations.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO8-6" href="ch05_split_001.xhtml#co_static_economy_CO8-6"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Fixes the seed value for reproducibility.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO8-7" href="ch05_split_001.xhtml#co_static_economy_CO8-7"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The core line of code: it implements the Monte Carlo simulation with <code class="calibre22">NumPy</code> in vectorized fashion, simulating <code class="calibre22">I</code> values in a single step.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO8-8" href="ch05_split_001.xhtml#co_static_economy_CO8-9"><img src="Images/8.png" alt="8" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The mean value as obtained from the simulated set of stock prices.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO8-9" href="ch05_split_001.xhtml#co_static_economy_CO8-10"><img src="Images/9.png" alt="9" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The theoretically to-be-expected value of the stock price.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO8-10" href="ch05_split_001.xhtml#co_static_economy_CO8-11"><img src="Images/10.png" alt="10" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">These lines of code plot the simulation results as a histogram and add some major statistics.</p></dd>
</dl>

<figure class="calibre50"><div id="bsm_01" class="figure">
<img src="Images/ftwp_0501.png" alt="ftwp 0501" class="calibre58"/>
<h6 class="calibre52"><span class="firstname">Figure 5-1. </span>Frequency distribution of simulated values for the stock price in Black-Scholes-Merton (1973)</h6>
</div></figure>

<p class="author1">Having the simulated stock price values available makes European option pricing only a matter of two more vectorized operations:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">70</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">K</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">105</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO9-1" href="ch05_split_001.xhtml#callout_static_economy_CO9-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">71</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">CT</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">maximum</code><code class="p">(</code><code class="n">ST</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">K</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO9-2" href="ch05_split_001.xhtml#callout_static_economy_CO9-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">72</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">CT</code><code class="p">[</code><code class="p">:</code><code class="mi">8</code><code class="p">]</code><code class="o">.</code><code class="n">round</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">72</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="calibre22"> </code><code class="mi">0.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22">  </code><code class="mi">4.2</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">15.5</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">9.9</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22"> </code><code class="mi">22.7</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">13.6</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">13.6</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">73</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">math</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="o">-</code><code class="n">r</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">T</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">CT</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO9-3" href="ch05_split_001.xhtml#callout_static_economy_CO9-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">74</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C0</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO9-4" href="ch05_split_001.xhtml#callout_static_economy_CO9-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">74</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">8.288763195530931</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO9-1" href="ch05_split_001.xhtml#co_static_economy_CO9-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The strike price of the option.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO9-2" href="ch05_split_001.xhtml#co_static_economy_CO9-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The payoff vector of the option.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO9-3" href="ch05_split_001.xhtml#co_static_economy_CO9-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The Monte Carlo estimator of the option price.</p></dd>
</dl>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Completeness of Black-Scholes-Merton" class="calibre4"><div class="preface" id="idm44853687763672">
<h1 class="calibre17">Completeness of Black-Scholes-Merton</h1>

<p class="author1">What<a data-type="indexterm" data-primary="market completeness" data-secondary="in Black-Scholes-Merton option pricing" data-secondary-sortas="Black-Scholes-Merton option pricing" id="market-complete-black-scholes" class="calibre6"/><a data-type="indexterm" data-primary="complete market model" data-secondary="in Black-Scholes-Merton option pricing" data-secondary-sortas="Black-Scholes-Merton option pricing" id="complete-market-black-scholes" class="calibre6"/> about the completeness of the Black-Scholes-Merton model economy <math alttext="script upper E Superscript upper B upper S upper M">
  <msup><mi>â„°</mi> <mrow><mi>B</mi><mi>S</mi><mi>M</mi></mrow> </msup>
</math>? The previous section derives a Monte Carlo estimator for the (arbitrage) price of a European call option despite the fact that there are many more states of the economy, <math alttext="upper I much-greater-than 2">
  <mrow>
    <mi>I</mi>
    <mo>â‰«</mo>
    <mn>2</mn>
  </mrow>
</math>, than financial assets traded, <math alttext="upper K equals 2">
  <mrow>
    <mi>K</mi>
    <mo>=</mo>
    <mn>2</mn>
  </mrow>
</math>. Two observations can be made:</p>
<dl class="calibre18">
<dt class="calibre19">General incompleteness</dt>
<dd class="calibre20">
<p class="calibre21">In a wider sense, the economy is incomplete because not every contingent claim can be replicated by a portfolio of the traded assets and because there is not a unique martingale measure (see 2FTAP).</p>
</dd>
<dt class="calibre19">Specific completeness</dt>
<dd class="calibre20">
<p class="calibre21">In a narrow sense, the model is complete, because every contingent claim that can be represented as a function of the price vector of the stock <math alttext="upper C 1 equals f left-parenthesis upper S 1 squared right-parenthesis">
  <mrow>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mi>f</mi>
    <mrow>
      <mo>(</mo>
      <msubsup><mi>S</mi> <mn>1</mn> <mn>2</mn> </msubsup>
      <mo>)</mo>
    </mrow>
  </mrow>
</math> is replicable by positions in the bond and the stock.</p>
</dd>
</dl>

<p class="author1">When using Monte Carlo simulation to derive an estimator for the arbitrage price in the previous section, the fact is used that the model economy <math alttext="script upper E Superscript upper B upper S upper M">
  <msup><mi>â„°</mi> <mrow><mi>B</mi><mi>S</mi><mi>M</mi></mrow> </msup>
</math> is complete in the previous specific, narrow sense. The payoff of the European call option only depends on the future price vector of the stock. What is missing so far is the replication portfolio and the resulting arbitrage price calculation to verify that the Monte Carlo simulation approach is justified.</p>

<p class="author1">The <code class="calibre22">NumPy</code> function<a data-type="indexterm" data-primary="NumPy" data-secondary="least-squares approach" id="numpy-least-squares" class="calibre6"/><a data-type="indexterm" data-primary="least-squares approach" id="least-squares" class="calibre6"/> used so far to solve replication <a data-type="indexterm" data-primary="np.linalg.solve function" id="idm44853687145288" class="calibre6"/>problems, <code class="calibre22">np.linalg.solve</code>, requires a square (market payoff) matrix. In the Black-Scholes-Merton economy with only two traded financial assets and many more possible future states, this prerequisite is not given. However, one can use a least-squares approach<a data-type="indexterm" data-primary="np.linalg.lstsq function" id="np.linalg.lstsq2" class="calibre6"/> via <code class="calibre22">np.linalg.lstsq</code> to find a numerical solution to the replication problem:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">75</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">100</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO10-1" href="ch05_split_001.xhtml#callout_static_economy_CO10-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">76</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">B0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">S0</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO10-2" href="ch05_split_001.xhtml#callout_static_economy_CO10-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">77</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">BT</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">ones</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">ST</code><code class="p">)</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">math</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="n">r</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">T</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO10-3" href="ch05_split_001.xhtml#callout_static_economy_CO10-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">78</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">BT</code><code class="p">[</code><code class="p">:</code><code class="mi">4</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO10-4" href="ch05_split_001.xhtml#callout_static_economy_CO10-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">78</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">105.12711</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">105.12711</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">105.12711</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">105.12711</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">79</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">BT</code><code class="p">,</code><code class="calibre22"> </code><code class="n">ST</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">T</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO10-5" href="ch05_split_001.xhtml#callout_static_economy_CO10-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">80</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO10-6" href="ch05_split_001.xhtml#callout_static_economy_CO10-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">80</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">105.12711</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">81.74955</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">105.12711</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">109.19348</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">105.12711</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">120.4628</code><code class="calibre22"> </code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">105.12711</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">71.10624</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">105.12711</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">105.32038</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">105.12711</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">134.77647</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">81</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">phi</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">lstsq</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">CT</code><code class="p">,</code><code class="calibre22"> </code><code class="n">rcond</code><code class="o">=</code><code class="nb">None</code><code class="p">)</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO10-7" href="ch05_split_001.xhtml#callout_static_economy_CO10-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">82</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">phi</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO10-8" href="ch05_split_001.xhtml#callout_static_economy_CO10-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">82</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mi">0.51089</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.59075</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">83</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">CT</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO10-9" href="ch05_split_001.xhtml#callout_static_economy_CO10-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">83</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">1.1798206855928583e-14</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">84</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO10-10" href="ch05_split_001.xhtml#callout_static_economy_CO10-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">84</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">7.9850808951857335</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO10-1" href="ch05_split_001.xhtml#co_static_economy_CO10-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The arbitrarily fixed price for the bond.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO10-2" href="ch05_split_001.xhtml#co_static_economy_CO10-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The price vector today for the two traded financial assets.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO10-3" href="ch05_split_001.xhtml#co_static_economy_CO10-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The future price vector of the bond given the initial price and the short rate.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO10-4" href="ch05_split_001.xhtml#co_static_economy_CO10-5"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The resulting market payoff matrix, which is of rank 2 onlyâ€”compared to 10,000 future states.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO10-5" href="ch05_split_001.xhtml#co_static_economy_CO10-7"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This solves the replication problem through least-squares representation. For the call option replication, the bond is to be shorted (sold), and the stock is to be bought.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO10-6" href="ch05_split_001.xhtml#co_static_economy_CO10-9"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The average replication error, resulting, for example, from floating point inaccuracies and the numerical methods used, is not exactly zero but really close to it.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO10-7" href="ch05_split_001.xhtml#co_static_economy_CO10-10"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This calculates the arbitrage price given the (numerically) optimal replication portfolio. It is close to the Monte Carlo estimator from <a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="Black-Scholes-Merton option pricing" data-startref="model-static-black-scholes" id="idm44853686464536" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="Black-Scholes-Merton option pricing" data-startref="static-black-scholes" id="idm44853686463080" class="calibre6"/><a data-type="indexterm" data-primary="Black-Scholes-Merton option pricing" data-secondary="in static model" data-secondary-sortas="static model" data-startref="black-scholes-static" id="idm44853686461896" class="calibre6"/><a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="Black-Scholes-Merton option pricing" data-startref="assets-black-scholes" id="idm44853686460440" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="Black-Scholes-Merton option pricing" data-startref="financial-assets-black-scholes" id="idm44853686458984" class="calibre6"/><a data-type="indexterm" data-primary="market completeness" data-secondary="in Black-Scholes-Merton option pricing" data-secondary-sortas="Black-Scholes-Merton option pricing" data-startref="market-complete-black-scholes" id="idm44853686457832" class="calibre6"/><a data-type="indexterm" data-primary="complete market model" data-secondary="in Black-Scholes-Merton option pricing" data-secondary-sortas="Black-Scholes-Merton option pricing" data-startref="complete-market-black-scholes" id="idm44853686456440" class="calibre6"/><a data-type="indexterm" data-primary="NumPy" data-secondary="least-squares approach" data-startref="numpy-least-squares" id="idm44853686455048" class="calibre6"/><a data-type="indexterm" data-primary="least-squares approach" data-startref="least-squares" id="idm44853686453832" class="calibre6"/><a data-type="indexterm" data-primary="np.linalg.lstsq function" data-startref="np.linalg.lstsq2" id="idm44853686452888" class="calibre6"/>before.</p></dd>
</dl>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Merton Jump-Diffusion Option Pricing" class="calibre4"><div class="preface" id="idm44853687763416">
<h1 class="calibre17">Merton Jump-Diffusion Option Pricing</h1>

<p class="author1">This<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="Merton jump-diffusion option pricing" id="model-static-jump-diffuse" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="Merton jump-diffusion option pricing" id="static-jump-diffuse" class="calibre6"/><a data-type="indexterm" data-primary="Merton jump-diffusion option pricing" id="merton-jump-diffuse" class="calibre6"/><a data-type="indexterm" data-primary="jump-diffusion option pricing" id="jump-diffuse" class="calibre6"/> section introduces another important model economy that dates back to Merton (1976) and adds a jump component to the stock price model of Black-Scholes-Merton (1973). The random jump component renders the model economy <math alttext="script upper M Superscript upper M Baseline 76">
  <msup><mi>â„³</mi> <mrow><mi>M</mi><mn>76</mn></mrow> </msup>
</math> incomplete in general. However, in the discrete setting of this chapter, one can apply the same numerical approaches for option pricing as introduced for <math alttext="script upper E Superscript upper B upper S upper M">
  <msup><mi>â„°</mi> <mrow><mi>B</mi><mi>S</mi><mi>M</mi></mrow> </msup>
</math> in the previous two sections. The model is called the <em class="calibre7">jump-diffusion</em> model, although a diffusion is only defined in a dynamic context.</p>

<p class="author1">In real financial time series, one observes jumps with some regularities. They might be caused by a stock market crash or by other rare and/or extreme events. The model by Merton (1976) allows us to explicitly model such rare events and their impact on the price of financial instruments. Models without jumps are often not well suited to explain certain characteristics and phenomena as regularly observed in financial time series. The model is also capable of modeling both positive and negative jumps. While a negative jump (large drop) might be observed in practice for stock indices, positive jumps (spikes) occur in practice, for example, in volatility indices.</p>

<p class="author1">The <em class="calibre7">Merton jump-diffusion economy</em> <math alttext="script upper E Superscript upper M Baseline 76">
  <msup><mi>â„°</mi> <mrow><mi>M</mi><mn>76</mn></mrow> </msup>
</math> is the same as the Black-Scholes-Merton economy <math alttext="script upper E Superscript upper B upper S upper M">
  <msup><mi>â„°</mi> <mrow><mi>B</mi><mi>S</mi><mi>M</mi></mrow> </msup>
</math> apart from the future price of the stock at time <math alttext="upper T">
  <mi>T</mi>
</math>, which can be simulated in this economy according to</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S Subscript upper T Baseline left-parenthesis z Subscript i Baseline right-parenthesis equals upper S 0 dot left-parenthesis e Superscript left-parenthesis r minus r Super Subscript j Superscript minus StartFraction sigma squared Over 2 EndFraction right-parenthesis upper T plus sigma StartRoot upper T EndRoot z Super Subscript i Super Superscript 1 Superscript plus Baseline plus left-parenthesis e Superscript mu plus delta z Super Subscript i Super Superscript 2 Superscript Baseline minus 1 right-parenthesis y Subscript i Baseline right-parenthesis comma i equals 1 comma 2 comma period period period comma upper I" display="block">
  <mrow>
    <msub><mi>S</mi> <mi>T</mi> </msub>
    <mrow>
      <mo>(</mo>
      <msub><mi>z</mi> <mi>i</mi> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>Â·</mo>
    <mfenced separators="" open="(" close=")">
      <msup><mi>e</mi> <mrow><mfenced separators="" open="(" close=")"><mi>r</mi><mo>-</mo><msub><mi>r</mi> <mi>j</mi> </msub><mo>-</mo><mfrac><msup><mi>Ïƒ</mi> <mn>2</mn> </msup> <mn>2</mn></mfrac></mfenced><mi>T</mi><mo>+</mo><mi>Ïƒ</mi><msqrt><mi>T</mi></msqrt><msubsup><mi>z</mi> <mi>i</mi> <mn>1</mn> </msubsup><mo>+</mo></mrow> </msup>
      <mo>+</mo>
      <mfenced separators="" open="(" close=")">
        <msup><mi>e</mi> <mrow><mi>Î¼</mi><mo>+</mo><mi>Î´</mi><msubsup><mi>z</mi> <mi>i</mi> <mn>2</mn> </msubsup></mrow> </msup>
        <mo>-</mo>
        <mn>1</mn>
      </mfenced>
      <msub><mi>y</mi> <mi>i</mi> </msub>
    </mfenced>
    <mo>,</mo>
    <mi>i</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <mi>I</mi>
  </mrow>
</math>
</div>

<p class="author1">with the <math alttext="z Subscript i Superscript 1 Baseline comma z Subscript i Superscript 2">
  <mrow>
    <msubsup><mi>z</mi> <mi>i</mi> <mn>1</mn> </msubsup>
    <mo>,</mo>
    <msubsup><mi>z</mi> <mi>i</mi> <mn>2</mn> </msubsup>
  </mrow>
</math> being standard normally distributed and the <math alttext="y Subscript i">
  <msub><mi>y</mi> <mi>i</mi> </msub>
</math> being Poisson distributed with intensity <math alttext="lamda">
  <mi>Î»</mi>
</math> (see Jacod and Protter (2004), chapter 4). The jumps are log-normally distributed with an expected value of <math alttext="mu">
  <mi>Î¼</mi>
</math> and standard deviation of <math alttext="delta">
  <mi>Î´</mi>
</math> (see Jacod and Protter (2004), chapter 7). The expected jump size is:</p>
<div data-type="equation" class="calibre42">
<math alttext="r Subscript j Baseline equals lamda dot left-parenthesis e Superscript mu plus delta squared slash 2 Baseline minus 1 right-parenthesis" display="block">
  <mrow>
    <msub><mi>r</mi> <mi>j</mi> </msub>
    <mo>=</mo>
    <mi>Î»</mi>
    <mo>Â·</mo>
    <mfenced separators="" open="(" close=")">
      <msup><mi>e</mi> <mrow><mi>Î¼</mi><mo>+</mo><msup><mi>Î´</mi> <mn>2</mn> </msup><mo>/</mo><mn>2</mn></mrow> </msup>
      <mo>-</mo>
      <mn>1</mn>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">Implementing and simulating this model in Python requires the definition of additional parameters and the simulation of three random variables. <a data-type="xref" href="ch05_split_001.xhtml#m76_01" class="calibre6">FigureÂ 5-2</a> shows the frequency distribution of the simulated values, which can become negative given the parameters assumed and the Python code used:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">85</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">100</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">100</code><code class="p">)</code><code class="p">)</code><code class="calibre22">   </code><a class="calibre6" id="co_static_economy_CO11-1" href="ch05_split_001.xhtml#callout_static_economy_CO11-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">86</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">r</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">0.05</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">sigma</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">0.2</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">lmbda</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">0.3</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">mu</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">0.3</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">delta</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">0.1</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">rj</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">lmbda</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="p">(</code><code class="n">math</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="n">mu</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">delta</code><code class="calibre22"> </code><code class="o">*</code><code class="o">*</code><code class="calibre22"> </code><code class="mi">2</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">T</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">1.0</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">I</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">10000</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">87</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">BT</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">M0</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">ones</code><code class="p">(</code><code class="n">I</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">math</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="n">r</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">T</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">88</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">z</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">rng</code><code class="o">.</code><code class="n">standard_normal</code><code class="p">(</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code><code class="calibre22"> </code><code class="n">I</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO11-2" href="ch05_split_001.xhtml#callout_static_economy_CO11-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">z</code><code class="calibre22"> </code><code class="o">-</code><code class="o">=</code><code class="calibre22"> </code><code class="n">z</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO11-3" href="ch05_split_001.xhtml#callout_static_economy_CO11-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">z</code><code class="calibre22"> </code><code class="o">/</code><code class="o">=</code><code class="calibre22"> </code><code class="n">z</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO11-4" href="ch05_split_001.xhtml#callout_static_economy_CO11-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">y</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">rng</code><code class="o">.</code><code class="n">poisson</code><code class="p">(</code><code class="n">lmbda</code><code class="p">,</code><code class="calibre22"> </code><code class="n">I</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO11-5" href="ch05_split_001.xhtml#callout_static_economy_CO11-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">89</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">ST</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="p">(</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">np</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="p">(</code><code class="n">r</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">rj</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">sigma</code><code class="calibre22"> </code><code class="o">*</code><code class="o">*</code><code class="calibre22"> </code><code class="mi">2</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">T</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22">
</code><code class="calibre22">                    </code><code class="n">sigma</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">math</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">T</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">z</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">)</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="n">mu</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">delta</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">z</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">y</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO11-6" href="ch05_split_001.xhtml#callout_static_economy_CO11-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">90</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">ST</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">math</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="o">-</code><code class="n">r</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">T</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO11-7" href="ch05_split_001.xhtml#callout_static_economy_CO11-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">90</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">100.53765025420363</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">91</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">ST</code><code class="p">,</code><code class="calibre22"> </code><code class="n">bins</code><code class="o">=</code><code class="mi">35</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">frequency</code><code class="s">'</code><code class="p">)</code><code class="p">;</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">ST</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">color</code><code class="o">=</code><code class="s">'</code><code class="s">r</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">mean</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">ST</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">ST</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">color</code><code class="o">=</code><code class="s">'</code><code class="s">y</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">sd up</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">ST</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">ST</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">color</code><code class="o">=</code><code class="s">'</code><code class="s">y</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">sd down</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">loc</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO11-1" href="ch05_split_001.xhtml#co_static_economy_CO11-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Fixes the initial price vector of the two traded financial assets (bond and stock).</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO11-2" href="ch05_split_001.xhtml#co_static_economy_CO11-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The first set of standard normally distributed random numbers.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO11-3" href="ch05_split_001.xhtml#co_static_economy_CO11-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The second set of standard normally distributed random numbers.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO11-4" href="ch05_split_001.xhtml#co_static_economy_CO11-5"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The set with Poisson distributed random numbers with intensity <code class="calibre22">lambda</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO11-5" href="ch05_split_001.xhtml#co_static_economy_CO11-6"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The simulation of the stock price values at <math alttext="upper T">
  <mi>T</mi>
</math> given the three sets of random 
<span class="firstname">numbers</span>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO11-6" href="ch05_split_001.xhtml#co_static_economy_CO11-7"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Calculates the discounted mean value of the simulated stock price.</p></dd>
</dl>

<figure class="calibre50"><div id="m76_01" class="figure">
<img src="Images/ftwp_0502.png" alt="ftwp 0502" class="calibre58"/>
<h6 class="calibre52"><span class="firstname">Figure 5-2. </span>Frequency distribution of the simulated values for the stock price in Merton (1976)</h6>
</div></figure>

<p class="author1">Adding a maximum function to the stock price, Monte Carlo simulation avoids negative values (see <a data-type="xref" href="ch05_split_001.xhtml#m76_02" class="calibre6">FigureÂ 5-3</a>):</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">92</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">ST</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">maximum</code><code class="p">(</code><code class="n">S0</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="p">(</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">np</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="p">(</code><code class="n">r</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">rj</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">sigma</code><code class="calibre22"> </code><code class="o">*</code><code class="o">*</code><code class="calibre22"> </code><code class="mi">2</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">T</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22">
</code><code class="calibre22">                    </code><code class="n">sigma</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">math</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">T</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">z</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">)</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="n">mu</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">delta</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">z</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">y</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO12-1" href="ch05_split_001.xhtml#callout_static_economy_CO12-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">93</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">ST</code><code class="p">,</code><code class="calibre22"> </code><code class="n">bins</code><code class="o">=</code><code class="mi">35</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">frequency</code><code class="s">'</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_static_economy_CO12-2" href="ch05_split_001.xhtml#callout_static_economy_CO12-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">ST</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">color</code><code class="o">=</code><code class="s">'</code><code class="s">r</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">mean</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">ST</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">ST</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">color</code><code class="o">=</code><code class="s">'</code><code class="s">y</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">sd up</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">ST</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">ST</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">color</code><code class="o">=</code><code class="s">'</code><code class="s">y</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">sd down</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">loc</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO12-1" href="ch05_split_001.xhtml#co_static_economy_CO12-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Maximum functionâ€¦</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_static_economy_CO12-2" href="ch05_split_001.xhtml#co_static_economy_CO12-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">â€¦avoids negative values for the stock price.</p></dd>
</dl>

<figure class="calibre50"><div id="m76_02" class="figure">
<img src="Images/ftwp_0503.png" alt="ftwp 0503" class="calibre58"/>
<h6 class="calibre52"><span class="firstname">Figure 5-3. </span>Simulated values (truncated) for the stock price in Merton (1976)</h6>
</div></figure>

<p class="author1">The final step is the pricing of the European call option through calculation of the Monte Carlo estimator and the approximate replication approach:</p>
<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">94</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">K</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">105</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">95</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">CT</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">maximum</code><code class="p">(</code><code class="n">ST</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">K</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">96</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">math</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="o">-</code><code class="n">r</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">T</code><code class="p">)</code><code class="calibre22">  </code><code class="o">*</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="n">CT</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="manual_co_static_economy_CO13-1" href="ch05_split_001.xhtml#manual_callout_static_economy_CO13-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">97</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C0</code><code class="calibre22">  </code><a class="calibre6" id="manual_co_static_economy_CO13-2" href="ch05_split_001.xhtml#manual_callout_static_economy_CO13-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">97</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">10.306374338651601</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">98</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">BT</code><code class="p">,</code><code class="calibre22"> </code><code class="n">ST</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">T</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">99</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">phi</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">lstsq</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">CT</code><code class="p">,</code><code class="calibre22"> </code><code class="n">rcond</code><code class="o">=</code><code class="o">-</code><code class="mi">1</code><code class="p">)</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="manual_co_static_economy_CO13-3" href="ch05_split_001.xhtml#manual_callout_static_economy_CO13-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">100</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">phi</code><code class="calibre22">  </code><a class="calibre6" id="manual_co_static_economy_CO13-4" href="ch05_split_001.xhtml#manual_callout_static_economy_CO13-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">100</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mi">0.41827</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.51847</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">101</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">CT</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="manual_co_static_economy_CO13-5" href="ch05_split_001.xhtml#manual_callout_static_economy_CO13-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">101</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">1.1823431123048067e-15</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">102</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="manual_co_static_economy_CO13-6" href="ch05_split_001.xhtml#manual_callout_static_economy_CO13-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">102</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">10.020157308565008</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="manual_callout_static_economy_CO13-1" href="ch05_split_001.xhtml#manual_co_static_economy_CO13-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The Monte Carlo estimator for the European call option price.</p></dd>
<dt class="calibre19"><a class="calibre6" id="manual_callout_static_economy_CO13-2" href="ch05_split_001.xhtml#manual_co_static_economy_CO13-3"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The approximate replication portfolio.</p></dd>
<dt class="calibre19"><a class="calibre6" id="manual_callout_static_economy_CO13-3" href="ch05_split_001.xhtml#manual_co_static_economy_CO13-5"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The replication error of the optimal portfolio.</p></dd>
<dt class="calibre19"><a class="calibre6" id="manual_callout_static_economy_CO13-4" href="ch05_split_001.xhtml#manual_co_static_economy_CO13-6"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The arbitrage price according to the optimal portfolio.</p></dd>
</dl>
<div data-type="caution" class="calibre28"><h1 class="calibre49">Incompleteness Through Jumps</h1>
<p class="author1">While <a data-type="indexterm" data-primary="market incompleteness" data-secondary="in Merton jump-diffusion option pricing" data-secondary-sortas="Merton jump-diffusion option pricing" id="idm44853685435448" class="calibre6"/><a data-type="indexterm" data-primary="incomplete market model" data-secondary="in Merton jump-diffusion option pricing" data-secondary-sortas="Merton jump-diffusion option pricing" id="idm44853685434360" class="calibre6"/>the Black-Scholes-Merton (1973) model is complete in a narrow sense, the addition of a jump component in the Merton (1976) jump diffusion model makes it incomplete in a wide sense. This means that even the introduction of additional financial assets cannot make it complete. The fact that the jump component can take on an infinite number of values would require an infinite number of additional financial assets to make the model <a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="Merton jump-diffusion option pricing" data-startref="model-static-jump-diffuse" id="idm44853685432696" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="Merton jump-diffusion option pricing" data-startref="static-jump-diffuse" id="idm44853685431368" class="calibre6"/><a data-type="indexterm" data-primary="Merton jump-diffusion option pricing" data-startref="merton-jump-diffuse" id="idm44853685430280" class="calibre6"/><a data-type="indexterm" data-primary="jump-diffusion option pricing" data-startref="jump-diffuse" id="idm44853685429432" class="calibre6"/>complete.</p>
</div>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Representative Agent Pricing" class="calibre4"><div class="preface" id="idm44853686451384">
<h1 class="calibre17">Representative Agent Pricing</h1>

<p class="author1">Assume again<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="representative agent pricing" id="model-static-representative" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="representative agent pricing" id="static-representative" class="calibre6"/><a data-type="indexterm" data-primary="agents" data-secondary="representative" data-tertiary="static economy pricing" id="agent-representative" class="calibre6"/><a data-type="indexterm" data-primary="representative agents" data-secondary="static economy pricing" id="representative-agent" class="calibre6"/><a data-type="indexterm" data-primary="market payoff matrix" data-secondary="in representative agent pricing" data-secondary-sortas="representative agent pricing" id="market-payoff-representative" class="calibre6"/> the general static economy <math alttext="script upper E">
  <mi>â„°</mi>
</math> now populated by a <em class="calibre7">representative, expected utility maximizing agent</em>. The agent is endowed with initial wealth today of
<math><mrow><mi>w</mi><mo>âˆˆ</mo><msub><mi>â„</mi> <mrow><mn>&gt;0</mn></mrow> </msub></mrow></math>
and has preferences that can be represented by a utility function <math alttext="u colon c right-arrow double-struck upper R comma u left-parenthesis c right-parenthesis right-arrow from bar ln c">
  <mrow>
    <mi>u</mi>
    <mo>:</mo>
    <mi>c</mi>
    <mo>â†’</mo>
    <mi>â„</mi>
    <mo>,</mo>
    <mi>u</mi>
    <mo>(</mo>
    <mi>c</mi>
    <mo>)</mo>
    <mo>â†¦</mo>
    <mo form="prefix">ln</mo>
    <mi>c</mi>
  </mrow>
</math>. Formally, the problem of the agent is the same as in <a data-type="xref" href="ch04_split_000.xhtml#optimality_equilibrium" class="calibre6">ChapterÂ 4</a>:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column Blank 2nd Column max Underscript phi Endscripts 3rd Column bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis script upper M dot phi right-parenthesis right-parenthesis 2nd Row 1st Column w 2nd Column equals 3rd Column script upper M 0 dot phi EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd/>
      <mtd>
        <munder><mo movablelimits="true" form="prefix">max</mo> <mi>Ï•</mi> </munder>
      </mtd>
      <mtd>
        <mrow>
          <msup><mi>ğ„</mi> <mi>P</mi> </msup>
          <mfenced separators="" open="(" close=")">
            <mi>u</mi>
            <mo>(</mo>
            <mi>â„³</mi>
            <mo>Â·</mo>
            <mi>Ï•</mi>
            <mo>)</mo>
          </mfenced>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mi>w</mi>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <msub><mi>â„³</mi> <mn>0</mn> </msub>
          <mo>Â·</mo>
          <mi>Ï•</mi>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">The difference is that there are now potentially many more future states possible and many more financial assets traded.</p>

<p class="author1">Furthermore, assuming that the complete set of Arrow-Debreu<a data-type="indexterm" data-primary="Arrow-Debreu securities" id="idm44853685394296" class="calibre6"/> securitiesâ€”with a net supply of one for each securityâ€”is traded, <math alttext="upper K equals upper I">
  <mrow>
    <mi>K</mi>
    <mo>=</mo>
    <mi>I</mi>
  </mrow>
</math>, the <em class="calibre7">market payoff matrix</em> is:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M equals Start 4 By 4 Matrix 1st Row 1st Column 1 2nd Column 0 3rd Column period period period 4th Column 0 2nd Row 1st Column 0 2nd Column 1 3rd Column period period period 4th Column 0 3rd Row 1st Column period period period 2nd Column period period period 3rd Column period period period 4th Column period period period 4th Row 1st Column 0 2nd Column 0 3rd Column period period period 4th Column 1 EndMatrix" display="block">
  <mrow>
    <mi>â„³</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>1</mn>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mn>1</mn>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mrow>
              <mo>.</mo>
              <mo>.</mo>
              <mo>.</mo>
            </mrow>
          </mtd>
          <mtd>
            <mn>1</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">The optimization problem in unconstrained form is according to the Theorem of Lagrange given by:</p>
<div data-type="equation" class="calibre42">
<math alttext="max Underscript phi comma lamda Endscripts f left-parenthesis phi comma lamda right-parenthesis equals bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis script upper M dot phi right-parenthesis right-parenthesis minus lamda dot left-parenthesis script upper M script 0 dot phi minus w right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><mi>Ï•</mi><mo>,</mo><mi>Î»</mi></mrow> </munder>
    <mi>f</mi>
    <mrow>
      <mo>(</mo>
      <mi>Ï•</mi>
      <mo>,</mo>
      <mi>Î»</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>ğ„</mi> <mi>P</mi> </msup>
    <mfenced separators="" open="(" close=")">
      <mi>u</mi>
      <mo>(</mo>
      <mi>â„³</mi>
      <mo>Â·</mo>
      <mi>Ï•</mi>
      <mo>)</mo>
    </mfenced>
    <mo>-</mo>
    <mi>Î»</mi>
    <mo>Â·</mo>
    <mrow>
      <mo>(</mo>
      <msub><mi>â„³</mi> <mn mathvariant="script">0</mn> </msub>
      <mo>Â·</mo>
      <mi>Ï•</mi>
      <mo>-</mo>
      <mi>w</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">From this, the first-order conditions for all portfolio positions <math alttext="phi Subscript i Baseline comma i equals 1 comma 2 comma period period period comma upper I">
  <mrow>
    <msub><mi>Ï•</mi> <mi>i</mi> </msub>
    <mo>,</mo>
    <mi>i</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <mi>I</mi>
  </mrow>
</math>â€”where <math alttext="i">
  <mi>i</mi>
</math> refers to the Arrow-Debreu security that pays off in state <math alttext="omega Subscript i">
  <msub><mi>Ï‰</mi> <mi>i</mi> </msub>
</math>â€”are:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartFraction normal partial-differential f Over normal partial-differential phi Subscript i Baseline EndFraction equals upper P left-parenthesis omega Subscript i Baseline right-parenthesis minus lamda dot upper S 0 Superscript i Baseline equals 0 comma i equals 1 comma 2 comma period period period comma upper I" display="block">
  <mrow>
    <mfrac><mrow><mi>âˆ‚</mi><mi>f</mi></mrow> <mrow><mi>âˆ‚</mi><msub><mi>Ï•</mi> <mi>i</mi> </msub></mrow></mfrac>
    <mo>=</mo>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>Ï‰</mi> <mi>i</mi> </msub>
      <mo>)</mo>
    </mrow>
    <mo>-</mo>
    <mi>Î»</mi>
    <mo>Â·</mo>
    <msubsup><mi>S</mi> <mn>0</mn> <mi>i</mi> </msubsup>
    <mo>=</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mi>i</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <mi>I</mi>
  </mrow>
</math>
</div>

<p class="author1"><math alttext="upper S 0 Superscript i">
  <msubsup><mi>S</mi> <mn>0</mn> <mi>i</mi> </msubsup>
</math> is the price of the Arrow-Debreu security paying off in state <math alttext="omega Subscript i">
  <msub><mi>Ï‰</mi> <mi>i</mi> </msub>
</math>. The relative prices between all Arrow-Debreu securities are accordingly determined by the probabilities for the respective payoff states to unfold:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartFraction upper S 0 Superscript i Baseline Over upper S 0 Superscript j Baseline EndFraction equals StartFraction upper P left-parenthesis omega Subscript i Baseline right-parenthesis Over upper P left-parenthesis omega Subscript j Baseline right-parenthesis EndFraction comma omega Subscript i Baseline comma omega Subscript j Baseline element-of normal upper Omega" display="block">
  <mrow>
    <mfrac><msubsup><mi>S</mi> <mn>0</mn> <mi>i</mi> </msubsup> <msubsup><mi>S</mi> <mn>0</mn> <mi>j</mi> </msubsup></mfrac>
    <mo>=</mo>
    <mfrac><mrow><mi>P</mi><mo>(</mo><msub><mi>Ï‰</mi> <mi>i</mi> </msub><mo>)</mo></mrow> <mrow><mi>P</mi><mo>(</mo><msub><mi>Ï‰</mi> <mi>j</mi> </msub><mo>)</mo></mrow></mfrac>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mi>i</mi> </msub>
    <mo>,</mo>
    <msub><mi>Ï‰</mi> <mi>j</mi> </msub>
    <mo>âˆˆ</mo>
    <mi>Î©</mi>
  </mrow>
</math>
</div>

<p class="author1">Fixing <math alttext="w equals 1">
  <mrow>
    <mi>w</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>, one obtains for the absolute prices:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S 0 Superscript i Baseline equals upper P left-parenthesis omega Subscript i Baseline right-parenthesis" display="block">
  <mrow>
    <msubsup><mi>S</mi> <mn>0</mn> <mi>i</mi> </msubsup>
    <mo>=</mo>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>Ï‰</mi> <mi>i</mi> </msub>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">In words, the price for the Arrow-Debreu security paying off in state <math alttext="omega Subscript i">
  <msub><mi>Ï‰</mi> <mi>i</mi> </msub>
</math> equals the probability <math alttext="upper P left-parenthesis omega Subscript i Baseline right-parenthesis">
  <mrow>
    <mi>P</mi>
    <mo>(</mo>
    <msub><mi>Ï‰</mi> <mi>i</mi> </msub>
    <mo>)</mo>
  </mrow>
</math> for this state to unfold.</p>

<p class="author1">This little analysis shows that the formalism of solving the representative agent problem for pricing purposes is more or less the same in the general static economy as compared to the simple<a data-type="indexterm" data-primary="model economies" data-secondary="static" data-tertiary="representative agent pricing" data-startref="model-static-representative" id="idm44853685288872" class="calibre6"/><a data-type="indexterm" data-primary="static economy" data-secondary="representative agent pricing" data-startref="static-representative" id="idm44853685287544" class="calibre6"/><a data-type="indexterm" data-primary="agents" data-secondary="representative" data-tertiary="static economy pricing" data-startref="agent-representative" id="idm44853685286456" class="calibre6"/><a data-type="indexterm" data-primary="representative agents" data-secondary="static economy pricing" data-startref="representative-agent" id="idm44853685285128" class="calibre6"/><a data-type="indexterm" data-primary="market payoff matrix" data-secondary="in representative agent pricing" data-secondary-sortas="representative agent pricing" data-startref="market-payoff-representative" id="idm44853685284040" class="calibre6"/> economies of <a data-type="xref" href="ch04_split_000.xhtml#optimality_equilibrium" class="calibre6">ChapterÂ 4</a>.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Conclusions" class="calibre4"><div class="preface" id="idm44853685427736">
<h1 class="calibre17">Conclusions</h1>

<p class="author1">This chapter covers <em class="calibre7">general static economies</em> with a potentially large number of statesâ€”for the Black-Scholes-Merton (1973) model simulation, for example, 10,000 different states are assumed. The additional formalism introduced pays off pretty well because it allows for much more realistic models that can be applied in practice, for instance, to value European put or call options on a stock index or a single stock.</p>

<p class="author1">Python in combination with <code class="calibre22">NumPy</code> proves powerful for the modeling of such economies with much larger market payoff matrices than seen before. Monte Carlo simulation is also accomplished both efficiently and quickly by the use of vectorization techniques. Using least-squares regression techniques, approximate replication portfolios are efficiently derived in such a setting.</p>

<p class="author1">However, static economies are limited per se with regard to what they can model in the financial space. For instance, early exercise features like those seen in the context of American options cannot be accounted for. This shortcoming will be overcome when enlarging the relevant set of points in timeâ€”making thereby the next natural step to dynamic economiesâ€”in the next chapter.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Further Resources" class="calibre4"><div class="preface" id="idm44853685277784">
<h1 class="calibre17">Further Resources</h1>

<p class="author1">Papers cited in this chapter:</p>

<ul class="printings">
<li class="calibre54">
<p class="author1">Black, Fischer and Myron Scholes. 1973. â€œThe Pricing of Options and Corporate Liabilities.â€ <em class="calibre7">Journal of Political Economy</em> 81 (3): 638â€“659.</p>
</li>
<li class="calibre54">
<p class="author1">Harrison, Michael and David Kreps. 1979. â€œMartingales and Arbitrage in Multiperiod Securities Markets.â€ <em class="calibre7">Journal of Economic Theory</em> (20): 381â€“408.</p>
</li>
<li class="calibre54">
<p class="author1">Harrison, Michael and Stanley Pliska. 1981. â€œMartingales and Stochastic Integrals in the Theory of Continuous Trading.â€ <em class="calibre7">Stochastic Processes and their Applications</em> (11): 215â€“260.</p>
</li>
<li class="calibre54">
<p class="author1">Merton, Robert. 1973. â€œTheory of Rational Option Pricing.â€ <em class="calibre7">Bell Journal of Economics and Management Science</em> (4): 141â€“183.</p>
</li>
<li class="calibre54">
<p class="author1">Merton, Robert. 1976. â€œOption Pricing when the Underlying Stock Returns are Discontinuous.â€ <em class="calibre7">Journal of Financial Economics</em> 3 (3): 125â€“144.</p>
</li>
</ul>

<p class="author1">Books cited in this chapter:</p>

<ul class="printings">
<li class="calibre54">
<p class="author1">Aleskerov, Fuad, Hasan Ersel, and Dmitri Piontkovski. 2011. <em class="calibre7">Linear Algebra for Economists</em>. Heidelberg: Springer.</p>
</li>
<li class="calibre54">
<p class="author1">Delbaen, Freddy and Walter Schachermayer. 2006. <em class="calibre7">The Mathematics of Arbitrage</em>. Berlin: Springer Verlag.</p>
</li>
<li class="calibre54">
<p class="author1">Duffie, Darrell. 1988. <em class="calibre7">Security Marketsâ€”Stochastic Models</em>. San Diego: Academic Press.</p>
</li>
<li class="calibre54">
<p class="author1">Jacod, Jean and Philip Protter. 2004. <em class="calibre7">Probability Essentials</em>. Berlin and Heidelberg: Springer.</p>
</li>
<li class="calibre54">
<p class="author1">Milne, Frank. 1995. <em class="calibre7">Finance Theory and Asset Pricing</em>. New York: Oxford University Press.</p>
</li>
<li class="calibre54">
<p class="author1">Pliska, Stanley. 1997. <em class="calibre7">Introduction to Mathematical Finance.</em> Malden and Oxford: Blackwell Publishers.</p>
</li>
</ul>
</div></section>







<div data-type="footnotes" class="calibre30"><p data-type="footnote" id="idm44853688595608" class="calibre31"><sup class="calibre32"><a href="ch05_split_000.xhtml#idm44853688595608-marker" class="calibre15">1</a></sup> The notation is changed here from <math alttext="i">
  <mi>i</mi>
</math> to <math alttext="r">
  <mi>r</mi>
</math> to emphasize that the <em class="calibre7">short rate</em> is meant from now on.</p></div></div></section></div></body></html>