<html><head></head><body><section data-pdf-bookmark="Chapter 3. Descriptive Statistics and Data Analysis" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch03">&#13;
<h1><span class="label">Chapter 3. </span>Descriptive Statistics and Data Analysis</h1>&#13;
&#13;
<p><a contenteditable="false" data-primary="data analysis" data-type="indexterm" id="Chapter_3.html0"/><em>Descriptive statistics</em> is <a contenteditable="false" data-primary="descriptive statistics" data-secondary="defined" data-type="indexterm" id="id374"/>a field that describes data and extracts as much information as possible from it. Basically, descriptive statistics can act like the representative of the data since it summarizes its tendencies, behavior, and trends.</p>&#13;
&#13;
<p class="fix_tracking">Trading and analysis borrows a lot from the metrics used in descriptive statistics. This chapter covers the main concepts of descriptive statistics and data analysis. <a contenteditable="false" data-primary="CPI (consumer price index)" data-type="indexterm" id="Chapter_3.html1a"/><a contenteditable="false" data-primary="consumer price index (CPI)" data-type="indexterm" id="Chapter_3.html1"/>I always found that the best educational tools are practical examples, so I will explain these concepts using an example of an economic time series, the consumer price index (CPI).</p>&#13;
&#13;
<p>The CPI measures the prices paid monthly by urban consumers for a selection of products and services; every month a new observation is released to the public, thus forming a continuous time series. The inflation rate between any two time periods is measured by percentage changes in the price index. For example, if the price of bread last year was $1.00 and the price today is $1.01, then the inflation is 1.00%. The CPI is typically released on a year-on-year basis, which means that it is reported as the difference between the current monthly observation and the observation 12 months ago.</p>&#13;
&#13;
<p>Import the CPI data as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Importing the required library</code>&#13;
<code class="kn">import</code> <code class="nn">pandas_datareader</code> <code class="k">as</code> <code class="nn">pdr</code>&#13;
<code class="c1"># Setting the beginning and end of the historical data</code>&#13;
<code class="n">start_date</code> <code class="o">=</code> <code class="s1">'1950-01-01'</code>&#13;
<code class="n">end_date</code>   <code class="o">=</code> <code class="s1">'2023-01-23'</code>&#13;
<code class="c1"># Creating a dataframe and downloading the CPI data</code>&#13;
<code class="n">cpi</code> <code class="o">=</code> <code class="n">pdr</code><code class="o">.</code><code class="n">DataReader</code><code class="p">(</code><code class="s1">'CPIAUCSL'</code><code class="p">,</code> <code class="s1">'fred'</code><code class="p">,</code> <code class="n">start_date</code><code class="p">,</code> <code class="n">end_date</code><code class="p">)</code>&#13;
<code class="c1"># Printing the latest five observations of the dataframe</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="n">cpi</code><code class="o">.</code><code class="n">tail</code><code class="p">())</code>&#13;
<code class="c1"># Checking if there are nan values in the CPI dataframe</code>&#13;
<code class="n">count_nan</code> <code class="o">=</code> <code class="n">cpi</code><code class="p">[</code><code class="s1">'CPIAUCSL'</code><code class="p">]</code><code class="o">.</code><code class="n">isnull</code><code class="p">()</code><code class="o">.</code><code class="n">sum</code><code class="p">()</code>&#13;
<code class="c1"># Printing the result</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'Number of nan values in the CPI dataframe: '</code> <code class="o">+</code> <code class="nb">str</code><code class="p">(</code><code class="n">count_nan</code><code class="p">))</code>&#13;
<code class="c1"># Transforming the CPI into a year-on-year measure</code>&#13;
<code class="n">cpi</code> <code class="o">=</code> <code class="n">cpi</code><code class="o">.</code><code class="n">pct_change</code><code class="p">(</code><code class="n">periods</code> <code class="o">=</code> <code class="mi">12</code><code class="p">,</code> <code class="n">axis</code> <code class="o">=</code> <code class="mi">0</code><code class="p">)</code> <code class="o">*</code> <code class="mi">100</code>&#13;
<code class="c1"># Dropping the nan values from the rows</code>&#13;
<code class="n">cpi</code> <code class="o">=</code> <code class="n">cpi</code><code class="o">.</code><code class="n">dropna</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>You can download all the code samples throughout the book from the book’s dedicated <a href="https://oreil.ly/5YGHI">GitHub page</a>.</p>&#13;
</div>&#13;
&#13;
<p>The year-on-year change is the most observed transformation on the CPI, as it gives a clear and simple measurement of the change in the overall price level over a sufficient period of time to account for short-term swings and seasonal impacts.</p>&#13;
&#13;
<p>Hence, the yearly change of the CPI serves as a gauge of the general trend in inflation. It is also simple to comprehend and compare across other nations and historical times, making it a popular measure among policymakers and economists (despite the flaw of element weightings in the baskets between countries). The following sections show how to make statistical sense of time series data using the CPI example.</p>&#13;
&#13;
<section data-pdf-bookmark="Measures of Central Tendency" data-type="sect1"><div class="sect1" id="id13">&#13;
<h1>Measures of Central Tendency</h1>&#13;
&#13;
<p><a contenteditable="false" data-primary="central tendency" data-secondary="measures of" data-type="indexterm" id="Chapter_3.html2"/><a contenteditable="false" data-primary="measures of central tendency" data-type="indexterm" id="Chapter_3.html3"/><em>Central tendency</em> refers <a contenteditable="false" data-primary="central tendency" data-secondary="defined" data-type="indexterm" id="id375"/>to the metrics that summarize the dataset into a value that can represent them. <a contenteditable="false" data-primary="mean" data-secondary="as central tendency measure" data-type="indexterm" id="id376"/>The best-known central tendency measure is the mean (average). The <em>mean </em>is simply the sum of the values divided by their quantity. It is the value that represents the data the best. The mathematical formula of the mean is as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="x overbar equals StartFraction 1 Over n EndFraction sigma-summation Underscript n Overscript i equals 1 Endscripts x Subscript i Baseline equals StartFraction 1 Over n EndFraction left-parenthesis x 1 plus period period period plus x Subscript n Baseline right-parenthesis">&#13;
  <mrow>&#13;
    <mover accent="true"><mi>x</mi> <mo>¯</mo></mover>&#13;
    <mo>=</mo>&#13;
    <mstyle displaystyle="false" scriptlevel="0">&#13;
      <mfrac><mn>1</mn> <mi>n</mi></mfrac>&#13;
    </mstyle>&#13;
    <msubsup><mo>∑</mo> <mrow><mi>n</mi></mrow> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> </msubsup>&#13;
    <msub><mi>x</mi> <mi>i</mi> </msub>&#13;
    <mo>=</mo>&#13;
    <mstyle displaystyle="false" scriptlevel="0">&#13;
      <mfrac><mn>1</mn> <mi>n</mi></mfrac>&#13;
    </mstyle>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <msub><mi>x</mi> <mn>1</mn> </msub>&#13;
      <mo>+</mo>&#13;
      <mo lspace="0%" rspace="0%">.</mo>&#13;
      <mo lspace="0%" rspace="0%">.</mo>&#13;
      <mo lspace="0%" rspace="0%">.</mo>&#13;
      <mo>+</mo>&#13;
      <msub><mi>x</mi> <mi>n</mi> </msub>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>Let’s take a simple example of two datasets. Suppose you want to calculate the mean on dataset A and dataset B. How would you do it?</p>&#13;
&#13;
<ul>&#13;
	<li>Dataset A = [1, 2, 3, 4, 5]</li>&#13;
	<li>Dataset B = [1, 1, 1, 1]</li>&#13;
</ul>&#13;
&#13;
<p>Dataset A contains five values (quantity) with a total sum of 15. Using the preceding formula, the mean is equal to 3. Dataset B contains four values with a total sum of 4. This means that the mean is equal to 1.</p>&#13;
&#13;
<p><a data-type="xref" href="#figure-3-1">Figure 3-1</a> shows the US CPI year-on-year values since 2003. The higher dashed line is the monthly mean calculated since 2003. The lower dashed line symbolizes zero, and below it are deflationary periods.</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>When all the values in a dataset are the same, the mean is the same as the values.</p>&#13;
</div>&#13;
&#13;
<figure><div class="figure" id="figure-3-1"><img alt="" class="iimagesdlf_0301png" src="assets/dlff_0301.png"/>&#13;
<h6><span class="label">Figure 3-1. </span>US CPI year-on-year values since 2003, with the higher dashed line <span class="keep-together">representing</span> the mean</h6>&#13;
</div></figure>&#13;
&#13;
<p>You can create <a data-type="xref" href="#figure-3-1">Figure 3-1</a> by using the following code:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Calculating the mean of the CPI over the last 20 years</code>&#13;
<code class="n">cpi_latest</code> <code class="o">=</code> <code class="n">cpi</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="err">–</code><code class="mi">240</code><code class="p">:]</code>&#13;
<code class="n">mean</code> <code class="o">=</code> <code class="n">cpi_latest</code><code class="p">[</code><code class="s2">"CPIAUCSL"</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">()</code>&#13;
<code class="c1"># Printing the result</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'The mean of the dataset: '</code> <code class="o">+</code> <code class="nb">str</code><code class="p">(</code><code class="n">mean</code><code class="p">),</code> <code class="s1">'%'</code><code class="p">)</code>&#13;
<code class="c1"># Importing the required library</code>&#13;
<code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code>&#13;
<code class="c1"># Plotting the latest observations in black with a label</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">cpi_latest</code><code class="p">[:],</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">,</code> <code class="n">linewidth</code> <code class="o">=</code> <code class="mf">1.5</code><code class="p">,</code> &#13;
         <code class="n">label</code> <code class="o">=</code> <code class="s1">'Change in CPI Year-on-Year'</code><code class="p">)</code>&#13;
<code class="c1"># Plotting horizontal lines that represent the mean and the zero threshold</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">axhline</code><code class="p">(</code><code class="n">y</code> <code class="o">=</code> <code class="n">mean</code><code class="p">,</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'red'</code><code class="p">,</code> <code class="n">linestyle</code> <code class="o">=</code> <code class="s1">'dashed'</code><code class="p">,</code> &#13;
         <code class="n">label</code> <code class="o">=</code> <code class="s1">'Mean'</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">axhline</code><code class="p">(</code><code class="n">y</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'blue'</code><code class="p">,</code> <code class="n">linestyle</code> <code class="o">=</code> <code class="s1">'dashed'</code><code class="p">,</code> <code class="n">linewidth</code> <code class="o">=</code> <code class="mi">1</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<p>The output of the mean should be as follows.</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">The</code> <code class="n">mean</code> <code class="n">of</code> <code class="n">the</code> <code class="n">dataset</code><code class="p">:</code> <code class="mf">2.49</code> <code class="o">%</code></pre>&#13;
&#13;
<p>This means that the average yearly inflation is around 2.50%. Even though the Federal Reserve does not have a clearly defined inflation target, it is generally believed that there is a consensus to maintain the annual change in inflation at around 2.00%, which is not far from the historical observations. With the high inflation numbers recorded since 2021 as a result of political and economic turmoil, it becomes necessary to revert back to the mean to stabilize the current situation. This example gives a numerical value to what is referred to as normality (~2.50%) since 2003.</p>&#13;
&#13;
<p>Clearly, with the high inflation numbers (~6.00%) around the beginning of 2023, the situation is a bit far from normality, but how far? This question is answered in the next section, which discusses measures of variability. For now, let’s continue the discussion on central tendency.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="median, defined" data-type="indexterm" id="id377"/>The next measure is the <em>median</em>, which in simple terms is the value that splits the dataset into two equal sides. In other words, if you arrange the dataset in an ascending order, the middle value is the median. The median is used whenever there are many outliers or there is skew in the distribution (which may bias the mean and make it less representative).</p>&#13;
&#13;
<p>There are generally two topics associated with calculating the median. The first one relates to a dataset that contains an even number of values (e.g., 24 observations), and the second one relates to a dataset that contains an uneven number of values (e.g., 47 observations):</p>&#13;
&#13;
<dl>&#13;
	<dt>Calculating the median of an even dataset</dt>&#13;
	<dd><p>If the arranged dataset has an even number of values, the median is the average of the two middle values. </p></dd>&#13;
</dl>&#13;
&#13;
<dl>&#13;
	<dt>Calculating the median of an uneven dataset</dt>&#13;
	<dd><p>If the arranged dataset has an uneven (odd) number of values, the median is simply the middle value. </p></dd>&#13;
</dl>&#13;
&#13;
<p>Let’s take a simple example of two datasets. Suppose you want to calculate the median on dataset A and dataset B. How would you do it?</p>&#13;
&#13;
<ul>&#13;
	<li>Dataset A = [1, 2, 3, 4, 5]</li>&#13;
	<li>Dataset B = [1, 2, 3, 4]</li>&#13;
</ul>&#13;
&#13;
<p>Dataset A contains five values, which is an uneven number. This means that the middle value is the median. In this case, it is 3 (notice how it is also the mean of the <span class="keep-together">dataset).</span> Dataset B contains four values, which is an even number. This means that the average between the two middle values is the median. In this case, it is 2.5, which is the average between 2 and 3.</p>&#13;
&#13;
<p><a data-type="xref" href="#figure-3-2">Figure 3-2</a> shows the US CPI year-on-year values since 2003. The higher dashed line is the monthly median calculated since 2003. The lower dashed line symbolizes zero. Basically, this is like <a data-type="xref" href="#figure-3-1">Figure 3-1</a>, but instead of the mean, the median is plotted.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-2"><img alt="" class="iimagesdlf_0302png" src="assets/dlff_0302.png"/>&#13;
<h6><span class="label">Figure 3-2. </span>US CPI year-on-year values since 2003, with the higher dashed line <span class="keep-together">representing</span> the median</h6>&#13;
</div></figure>&#13;
&#13;
<p>You can create <a data-type="xref" href="#figure-3-2">Figure 3-2</a> by using the following code:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Calculating the median</code>&#13;
<code class="n">median</code> <code class="o">=</code> <code class="n">cpi_latest</code><code class="p">[</code><code class="s2">"CPIAUCSL"</code><code class="p">]</code><code class="o">.</code><code class="n">median</code><code class="p">()</code> &#13;
<code class="c1"># Printing the result</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'The median of the dataset: '</code> <code class="o">+</code> <code class="nb">str</code><code class="p">(</code><code class="n">median</code><code class="p">),</code> <code class="s1">'%'</code><code class="p">)</code>&#13;
<code class="c1"># Plotting the latest observations in black with a label</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">cpi_latest</code><code class="p">[:],</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">,</code> <code class="n">linewidth</code> <code class="o">=</code> <code class="mf">1.5</code><code class="p">,</code> &#13;
         <code class="n">label</code> <code class="o">=</code> <code class="s1">'Change in CPI Year-on-Year'</code><code class="p">)</code>&#13;
<code class="c1"># Plotting horizontal lines that represent the median and the zero threshold</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">axhline</code><code class="p">(</code><code class="n">y</code> <code class="o">=</code> <code class="n">median</code><code class="p">,</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'red'</code><code class="p">,</code> <code class="n">linestyle</code> <code class="o">=</code> <code class="s1">'dashed'</code><code class="p">,</code> &#13;
            <code class="n">label</code> <code class="o">=</code> <code class="s1">'Median'</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">axhline</code><code class="p">(</code><code class="n">y</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'blue'</code><code class="p">,</code> <code class="n">linestyle</code> <code class="o">=</code> <code class="s1">'dashed'</code><code class="p">,</code> <code class="n">linewidth</code> <code class="o">=</code> <code class="mi">1</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<p>The output of the median should be as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">The</code> <code class="n">median</code> <code class="n">of</code> <code class="n">the</code> <code class="n">dataset</code><code class="p">:</code> <code class="mf">2.12</code> <code class="o">%</code></pre>&#13;
&#13;
<p>Clearly, the median is less impacted by the recent outliers that are coming from unusual environments. The median is around 2.12%, which is more in line with the implied target of 2.00%.</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Remember that <a data-type="xref" href="ch06.html#ch06">Chapter 6</a> will give you all you need to know about the Python snippets you are seeing in this chapter, so you don’t need to worry if you are missing out on the coding concepts.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html3" data-type="indexterm" id="id378"/></p>&#13;
</div>&#13;
&#13;
<p><a contenteditable="false" data-primary="mode, defined" data-type="indexterm" id="id379"/>The last central tendency measure in this section is the <em>mode</em>, which is the value that is the most frequently observed (but also the least used in data analysis).</p>&#13;
&#13;
<p>Let’s take a simple example of two datasets. Suppose you want to calculate the mode on the following datasets. How would you do it?</p>&#13;
&#13;
<ul>&#13;
	<li>Dataset A = [1, 2, 2, 4, 5]</li>&#13;
	<li>Dataset B = [1, 2, 3, 4]</li>&#13;
	<li>Dataset C = [1, 1, 2, 2, 3]</li>&#13;
</ul>&#13;
&#13;
<p>Dataset A contains two times the value 2, which makes it the mode. Dataset B doesn’t have a mode, as every value is observed once. Dataset C is <em>multimodal </em>since it contains multiple modes (which are 1 and 2).</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The mode is useful with categorical variables (like credit rankings) as opposed to continuous variables (like price and returns time series).</p>&#13;
</div>&#13;
&#13;
<p>You are unlikely to use the mode to analyze time series, as the mean and the median are more useful. Here are a few examples that use the mean and the median in <span class="keep-together">financial</span> analysis:</p>&#13;
&#13;
<ul>&#13;
	<li>Calculating a moving mean (average) on price data to detect an underlying trend. You will see more about moving averages in <a data-type="xref" href="ch05.html#ch05">Chapter 5</a>.</li>&#13;
	<li>Calculating a rolling median on a price-derived indicator to detect its neutrality zone.</li>&#13;
	<li>Calculating the expected return of a security using the historical mean.</li>&#13;
</ul>&#13;
&#13;
<p class="pagebreak-before">Central tendency metrics are important to understand, especially since the mean and the median are heavily used not only as standalone indicators but also as components in more complex measures.</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The key takeaways from this section are as follows:</p>&#13;
&#13;
<ul>&#13;
	<li>There are mainly three central tendency measures: the mean, the median, and the mode.</li>&#13;
	<li>The mean is the sum divided by the quantity, while the median is the value that splits the data in half. The mode is the value that occurs most frequently in the dataset.</li>&#13;
</ul>&#13;
</div>&#13;
</div></section>&#13;
&#13;
<section data-pdf-bookmark="Measures of Variability" data-type="sect1"><div class="sect1" id="id14">&#13;
<h1>Measures of Variability</h1>&#13;
&#13;
<p><a contenteditable="false" data-primary="central tendency" data-secondary="measures of variability" data-type="indexterm" id="Chapter_3.html4"/><a contenteditable="false" data-primary="descriptive statistics" data-secondary="measures of variability" data-type="indexterm" id="Chapter_3.html5"/><a contenteditable="false" data-primary="measures of variability" data-type="indexterm" id="Chapter_3.html6"/><a contenteditable="false" data-primary="variability, measures of" data-type="indexterm" id="Chapter_3.html7"/><em>Measures of variability</em> describe how spread out the values in a dataset are relative to the central tendency measures (mostly the mean). The best-known measure of variability is the variance.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="variance" data-secondary="defined" data-type="indexterm" id="id380"/>The <em>variance </em>describes the variability of a set of numbers from their mean. The idea behind the variance’s formula is to determine how far away from the mean each data point is, then to square those deviations to make sure all the numbers are positive (this is because distance cannot be negative), and finally to divide the deviations by the number of observations.</p>&#13;
&#13;
<p>The formula to find the variance is as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="sigma squared equals StartFraction 1 Over n EndFraction sigma-summation Underscript n Overscript i equals 1 Endscripts left-parenthesis x Subscript i Baseline minus x overbar right-parenthesis squared">&#13;
  <mrow>&#13;
    <msup><mi>σ</mi> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mstyle displaystyle="false" scriptlevel="0">&#13;
      <mfrac><mn>1</mn> <mi>n</mi></mfrac>&#13;
    </mstyle>&#13;
    <msubsup><mo>∑</mo> <mrow><mi>n</mi></mrow> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> </msubsup>&#13;
    <msup><mrow><mo>(</mo><msub><mi>x</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>This formula calculates the sum of the squared deviations of each data point from the mean, thus giving different distance observations, and then calculates the mean of these distance observations.</p>&#13;
&#13;
<p>Let’s take a simple example of two datasets. Suppose you want to calculate the variance of dataset A and dataset B. How would you do it?</p>&#13;
&#13;
<ul>&#13;
	<li>Dataset A = [1, 2, 3, 4, 5]</li>&#13;
	<li>Dataset B = [5, 5, 5, 5]</li>&#13;
</ul>&#13;
&#13;
<p class="pagebreak-after">The first step is to calculate the mean of the dataset as that is the benchmark from where you will calculate the variability of the data. Dataset A has a mean of 3. The next step calculates the variance:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="left-parenthesis x 1 minus x overbar right-parenthesis squared equals left-parenthesis 1 minus 3 right-parenthesis squared equals 4">&#13;
  <mrow>&#13;
    <msup><mrow><mo>(</mo><msub><mi>x</mi> <mn>1</mn> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <msup><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mn>3</mn><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mn>4</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<p><math alttext="left-parenthesis x 2 minus x overbar right-parenthesis squared equals left-parenthesis 2 minus 3 right-parenthesis squared equals 1">&#13;
  <mrow>&#13;
    <msup><mrow><mo>(</mo><msub><mi>x</mi> <mn>2</mn> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <msup><mrow><mo>(</mo><mn>2</mn><mo>-</mo><mn>3</mn><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mn>1</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<p><math alttext="left-parenthesis x 3 minus x overbar right-parenthesis squared equals left-parenthesis 3 minus 3 right-parenthesis squared equals 0">&#13;
  <mrow>&#13;
    <msup><mrow><mo>(</mo><msub><mi>x</mi> <mn>3</mn> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <msup><mrow><mo>(</mo><mn>3</mn><mo>-</mo><mn>3</mn><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mn>0</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<p><math alttext="left-parenthesis x 4 minus x overbar right-parenthesis squared equals left-parenthesis 4 minus 3 right-parenthesis squared equals 1">&#13;
  <mrow>&#13;
    <msup><mrow><mo>(</mo><msub><mi>x</mi> <mn>4</mn> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <msup><mrow><mo>(</mo><mn>4</mn><mo>-</mo><mn>3</mn><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mn>1</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<p><math alttext="left-parenthesis x 5 minus x overbar right-parenthesis squared equals left-parenthesis 5 minus 3 right-parenthesis squared equals 4">&#13;
  <mrow>&#13;
    <msup><mrow><mo>(</mo><msub><mi>x</mi> <mn>5</mn> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <msup><mrow><mo>(</mo><mn>5</mn><mo>-</mo><mn>3</mn><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mn>4</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>The previous results are summed as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="4 plus 1 plus 0 plus 1 plus 4 equals 10">&#13;
  <mrow>&#13;
    <mn>4</mn>&#13;
    <mo>+</mo>&#13;
    <mn>1</mn>&#13;
    <mo>+</mo>&#13;
    <mn>0</mn>&#13;
    <mo>+</mo>&#13;
    <mn>1</mn>&#13;
    <mo>+</mo>&#13;
    <mn>4</mn>&#13;
    <mo>=</mo>&#13;
    <mn>10</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>And finally, the result is divided by the quantity of the observations to find the <span class="keep-together">variance:</span></p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="sigma squared equals StartFraction 10 Over 5 EndFraction equals 2">&#13;
  <mrow>&#13;
    <msup><mi>σ</mi> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mstyle displaystyle="false" scriptlevel="0">&#13;
      <mfrac><mn>10</mn> <mn>5</mn></mfrac>&#13;
    </mstyle>&#13;
    <mo>=</mo>&#13;
    <mn>2</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>As for dataset B, you should think about it intuitively. If the observations are all equal, they all represent the dataset, which also means that they are their own mean. What would you say about the variance of the data in this case, considering that all the values are equal to the mean?</p>&#13;
&#13;
<p>If your response is that the variance is zero, then you are correct. Mathematically, you can calculate it as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="left-parenthesis x 1 minus x overbar right-parenthesis squared equals left-parenthesis 5 minus 5 right-parenthesis squared equals 0">&#13;
  <mrow>&#13;
    <msup><mrow><mo>(</mo><msub><mi>x</mi> <mn>1</mn> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <msup><mrow><mo>(</mo><mn>5</mn><mo>-</mo><mn>5</mn><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mn>0</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<p><math alttext="left-parenthesis x 2 minus x overbar right-parenthesis squared equals left-parenthesis 5 minus 5 right-parenthesis squared equals 0">&#13;
  <mrow>&#13;
    <msup><mrow><mo>(</mo><msub><mi>x</mi> <mn>2</mn> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <msup><mrow><mo>(</mo><mn>5</mn><mo>-</mo><mn>5</mn><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mn>0</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<p><math alttext="left-parenthesis x 3 minus x overbar right-parenthesis squared equals left-parenthesis 5 minus 5 right-parenthesis squared equals 0">&#13;
  <mrow>&#13;
    <msup><mrow><mo>(</mo><msub><mi>x</mi> <mn>3</mn> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <msup><mrow><mo>(</mo><mn>5</mn><mo>-</mo><mn>5</mn><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mn>0</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<p><math alttext="left-parenthesis x 4 minus x overbar right-parenthesis squared equals left-parenthesis 5 minus 5 right-parenthesis squared equals 0">&#13;
  <mrow>&#13;
    <msup><mrow><mo>(</mo><msub><mi>x</mi> <mn>4</mn> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <msup><mrow><mo>(</mo><mn>5</mn><mo>-</mo><mn>5</mn><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mn>0</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>The previous results sum to zero, and if you divide zero by 4 (the quantity of the dataset), you will get zero. Intuitively, there is no variance because all the values are constant and they do not deviate from their mean:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="sigma squared equals StartFraction 0 Over 4 EndFraction equals 0">&#13;
  <mrow>&#13;
    <msup><mi>σ</mi> <mn>2</mn> </msup>&#13;
    <mo>=</mo>&#13;
    <mstyle displaystyle="false" scriptlevel="0">&#13;
      <mfrac><mn>0</mn> <mn>4</mn></mfrac>&#13;
    </mstyle>&#13;
    <mo>=</mo>&#13;
    <mn>0</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p class="pagebreak-before">Remaining in the inflation example, you can calculate the variance using the <span class="keep-together">following</span> code:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Calculating the variance</code>&#13;
<code class="n">variance</code> <code class="o">=</code> <code class="n">cpi_latest</code><code class="p">[</code><code class="s2">"CPIAUCSL"</code><code class="p">]</code><code class="o">.</code><code class="n">var</code><code class="p">()</code> &#13;
<code class="c1"># Printing the result</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'The variance of the dataset: '</code> <code class="o">+</code> <code class="nb">str</code><code class="p">(</code><code class="n">variance</code><code class="p">),</code> <code class="s1">'%'</code><code class="p">)</code></pre>&#13;
&#13;
<p>The output of the variance should be as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">The</code> <code class="n">variance</code> <code class="n">of</code> <code class="n">the</code> <code class="n">dataset</code><code class="p">:</code> <code class="mf">3.62</code> <code class="o">%</code></pre>&#13;
&#13;
<p>There is a flaw nonetheless, and it is that the variance represents squared values that are not comparable to the mean since they use different units. This is easily fixed by taking the square root of the variance. <a contenteditable="false" data-primary="standard deviation" data-type="indexterm" id="id381"/><a contenteditable="false" data-primary="volatility (standard deviation)" data-type="indexterm" id="id382"/>Doing so brings the next measure of variability, the <em>standard deviation.</em> It is the square root of the variance and is the average deviation of the values from the mean.</p>&#13;
&#13;
<p>A low standard deviation indicates that the values tend to be close to the mean (low volatility), while a high standard deviation indicates that the values are spread out over a wider range relative to their mean (high volatility).</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The terms <em>standard deviation</em> and <em>volatility</em> are used interchangeably. They refer to the same thing.</p>&#13;
</div>&#13;
&#13;
<p>The formula to find the standard deviation is as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="sigma equals StartRoot StartFraction 1 Over n EndFraction sigma-summation Underscript n Overscript i equals 1 Endscripts left-parenthesis x Subscript i Baseline minus x overbar right-parenthesis squared EndRoot">&#13;
  <mrow>&#13;
    <mi>σ</mi>&#13;
    <mo>=</mo>&#13;
    <msqrt>&#13;
      <mrow>&#13;
        <mstyle displaystyle="false" scriptlevel="0">&#13;
          <mfrac><mn>1</mn> <mi>n</mi></mfrac>&#13;
        </mstyle>&#13;
        <msubsup><mo>∑</mo> <mrow><mi>n</mi></mrow> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> </msubsup>&#13;
        <msup><mrow><mo>(</mo><msub><mi>x</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
      </mrow>&#13;
    </msqrt>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>If you consider the previous examples with the variance, then the standard deviation can be found as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="sigma Subscript upper D a t a s e t upper A Baseline equals StartRoot 2 EndRoot equals 1.41">&#13;
  <mrow>&#13;
    <msub><mi>σ</mi> <mrow><mi>D</mi><mi>a</mi><mi>t</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>t</mi><mspace width="0.166667em"/><mi>A</mi></mrow> </msub>&#13;
    <mo>=</mo>&#13;
    <msqrt>&#13;
      <mn>2</mn>&#13;
    </msqrt>&#13;
    <mo>=</mo>&#13;
    <mn>1</mn>&#13;
    <mo lspace="0%" rspace="0%">.</mo>&#13;
    <mn>41</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<p><math alttext="sigma Subscript upper D a t a s e t upper B Baseline equals StartRoot 0 EndRoot equals 0">&#13;
  <mrow>&#13;
    <msub><mi>σ</mi> <mrow><mi>D</mi><mi>a</mi><mi>t</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>t</mi><mspace width="0.166667em"/><mi>B</mi></mrow> </msub>&#13;
    <mo>=</mo>&#13;
    <msqrt>&#13;
      <mn>0</mn>&#13;
    </msqrt>&#13;
    <mo>=</mo>&#13;
    <mn>0</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>Standard deviation is commonly used with the mean since they both use the same units. You will soon understand the importance of this stat when I discuss the normal distribution function in the next section.</p>&#13;
&#13;
<p class="pagebreak-before">You can calculate the standard deviation in Python using the following code:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Calculating the standard deviation</code>&#13;
<code class="n">standard_deviation</code> <code class="o">=</code> <code class="n">cpi_latest</code><code class="p">[</code><code class="s2">"CPIAUCSL"</code><code class="p">]</code><code class="o">.</code><code class="n">std</code><code class="p">()</code> &#13;
<code class="c1"># Printing the result</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'The standard deviation of the dataset: '</code> <code class="o">+</code> &#13;
      <code class="nb">str</code><code class="p">(</code><code class="n">standard_deviation</code><code class="p">),</code> <code class="s1">'%'</code><code class="p">)</code>&#13;
</pre>&#13;
&#13;
<p>The output of the standard deviation should be as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">The</code> <code class="n">standard</code> <code class="n">deviation</code> <code class="n">of</code> <code class="n">the</code> <code class="n">dataset</code><code class="p">:</code> <code class="mf">1.90</code> <code class="o">%</code></pre>&#13;
&#13;
<p>How are you supposed to interpret the standard deviation? On average, the CPI year-on-year values tend to be ±1.90% from the mean of the same period, which is at 2.49%. In <a data-type="xref" href="#measures_of_shape">“Measures of Shape”</a>, you will see how to make better use of standard deviation figures.</p>&#13;
&#13;
<p>The last measure of variability discussed in this section is the range. The <em>range </em>is a very simple stat that shows the distance between the highest value and the lowest value in the dataset. This gives you a quick glance at the two historical extreme values. The formula to find the range is as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="upper R a n g e equals m a x left-parenthesis x right-parenthesis minus m i n left-parenthesis x right-parenthesis">&#13;
  <mrow>&#13;
    <mi>R</mi>&#13;
    <mi>a</mi>&#13;
    <mi>n</mi>&#13;
    <mi>g</mi>&#13;
    <mi>e</mi>&#13;
    <mo>=</mo>&#13;
    <mi>m</mi>&#13;
    <mi>a</mi>&#13;
    <mi>x</mi>&#13;
    <mo>(</mo>&#13;
    <mi>x</mi>&#13;
    <mo>)</mo>&#13;
    <mo>-</mo>&#13;
    <mi>m</mi>&#13;
    <mi>i</mi>&#13;
    <mi>n</mi>&#13;
    <mo>(</mo>&#13;
    <mi>x</mi>&#13;
    <mo>)</mo>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>In Python, you can easily do this, as there are built-in functions that show the maximum and the minimum values given a set of data:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Calculating the range</code>&#13;
<code class="n">range_metric</code> <code class="o">=</code> <code class="nb">max</code><code class="p">(</code><code class="n">cpi</code><code class="p">[</code><code class="s2">"CPIAUCSL"</code><code class="p">])</code> <code class="err">–</code> <code class="nb">min</code><code class="p">(</code><code class="n">cpi</code><code class="p">[</code><code class="s2">"CPIAUCSL"</code><code class="p">])</code>&#13;
<code class="c1"># Printing the result</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'The range of the dataset: '</code> <code class="o">+</code> <code class="nb">str</code><code class="p">(</code><code class="n">range_metric</code><code class="p">),</code> <code class="s1">'%'</code><code class="p">)</code>&#13;
</pre>&#13;
&#13;
<p>The output of the preceding code should be as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">The</code> <code class="nb">range</code> <code class="n">of</code> <code class="n">the</code> <code class="n">dataset</code><code class="p">:</code> <code class="mf">16.5510</code> <code class="o">%</code></pre>&#13;
&#13;
<p><a data-type="xref" href="#figure-3-3">Figure 3-3</a> shows the CPI values since 1951. The diagonal dashed line represents the range, and the horizontal dashed line represents the zero threshold.</p>&#13;
&#13;
<p class="fix_tracking">The range of the CPI shows the size of the variations in inflation measures from one period to another. Yearly changes in inflation numbers vary from one country to another. Generally, developed countries such as France and the United States have stable variations (in times of stability), while emerging and frontier world countries such as Turkey and Argentina have more volatile and more extreme inflation numbers.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-3"><img alt="" class="iimagesdlf_0224png" src="assets/dlff_0303.png"/>&#13;
<h6><span class="label">Figure 3-3. </span>US CPI year-on-year change since 1951, with a diagonal dashed line that represents the range</h6>&#13;
</div></figure>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The key takeaways from this section are as follows:</p>&#13;
&#13;
<ul>&#13;
	<li>The three key variability metrics that you should know are the variance, the standard deviation, and the range.</li>&#13;
	<li>The standard deviation is the square root of the variance. This is done so that it becomes comparable to the mean.</li>&#13;
	<li>The range is the difference between the highest and the lowest values in a dataset. It is a quick snapshot of the overall stretch of the observations.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html7" data-type="indexterm" id="id383"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html6" data-type="indexterm" id="id384"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html5" data-type="indexterm" id="id385"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html4" data-type="indexterm" id="id386"/></li>&#13;
</ul>&#13;
</div>&#13;
</div></section>&#13;
&#13;
<section data-pdf-bookmark="Measures of Shape" data-type="sect1"><div class="sect1" id="measures_of_shape">&#13;
<h1>Measures of Shape</h1>&#13;
&#13;
<p><a contenteditable="false" data-primary="central tendency" data-secondary="measures of shape" data-type="indexterm" id="Chapter_3.html8"/><a contenteditable="false" data-primary="descriptive statistics" data-secondary="measures of shape" data-type="indexterm" id="Chapter_3.html9"/><a contenteditable="false" data-primary="measures of shape" data-type="indexterm" id="Chapter_3.html10"/><a contenteditable="false" data-primary="shape, measures of" data-type="indexterm" id="Chapter_3.html11"/><em>Measures of shape</em> describe the distribution of the values around the central tendency measures in a dataset. The mean and the standard deviation are the two factors that describe the normal distribution. The standard deviation depicts the spread or dispersion of the data, and the mean reflects the distribution’s center.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="probability distribution functions" data-secondary="measure of shape" data-type="indexterm" id="id387"/>A <em>probability distribution</em> is a mathematical function that describes the likelihood of different outcomes or events in a random experiment. In other words, it gives the probabilities of all possible values of a random variable.</p>&#13;
&#13;
<p class="pagebreak-before"><a contenteditable="false" data-primary="discrete distributions" data-type="indexterm" id="id388"/>There are many types of probability distributions, including discrete and continuous distributions. <em>Discrete distributions</em> take on a finite number of values. The best-known discrete distributions are the Bernoulli distribution, binomial distribution, and Poisson distribution.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="continuous distributions" data-type="indexterm" id="id389"/><em>Continuous distributions</em> are used for random variables that can take on any value within a given range (such as stock prices and returns). The best-known distribution is the normal distribution.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="Gaussian (normal) distribution" data-type="indexterm" id="id390"/><a contenteditable="false" data-primary="normal distribution" data-type="indexterm" id="id391"/>The <em>normal distribution</em> (also known as the <em>Gaussian distribution</em>) is a type of continuous probability distribution that is symmetrical around the mean and has a bell shape. It is one of the most widely used distributions in statistical analysis and is often used to describe natural phenomena such as age, weight, and test scores. <a data-type="xref" href="#figure-3-4">Figure 3-4</a> shows the shape of a normal distribution.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-4"><img alt="" class="iimagesdlf_0280png" src="assets/dlff_0304.png"/>&#13;
<h6><span class="label">Figure 3-4. </span>A normal distribution plot with mean = 0 and standard deviation = 1</h6>&#13;
</div></figure>&#13;
&#13;
<p>You can generate <a data-type="xref" href="#figure-3-4">Figure 3-4</a> using the following code block:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Importing libraries</code>&#13;
<code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code>&#13;
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>&#13;
<code class="kn">import</code> <code class="nn">scipy.stats</code> <code class="k">as</code> <code class="nn">stats</code>&#13;
<code class="c1"># Generate data for the plot</code>&#13;
<code class="n">data</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="err">–</code><code class="mi">3</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">num</code> <code class="o">=</code> <code class="mi">1000</code><code class="p">)</code>&#13;
<code class="c1"># Define the mean and standard deviation of the normal distribution</code>&#13;
<code class="n">mean</code> <code class="o">=</code> <code class="mi">0</code>&#13;
<code class="n">std</code> <code class="o">=</code> <code class="mi">1</code>&#13;
<code class="c1"># Generate the function of the normal distribution</code>&#13;
<code class="n">pdf</code> <code class="o">=</code> <code class="n">stats</code><code class="o">.</code><code class="n">norm</code><code class="o">.</code><code class="n">pdf</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">mean</code><code class="p">,</code> <code class="n">std</code><code class="p">)</code>&#13;
<code class="c1"># Plot the normal distribution plot</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">pdf</code><code class="p">,</code> <code class="s1">'-'</code><code class="p">,</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">,</code> <code class="n">lw</code> <code class="o">=</code> <code class="mi">2</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">mean</code><code class="p">,</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">,</code> <code class="n">linestyle</code> <code class="o">=</code> <code class="s1">'--'</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code></pre>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Since normally distributed variables are common, most statistical tests and models assume that the analyzed data is normal. With financial returns, they are assumed normal even though they experience a form of skew and kurtosis, two measures of shape <span class="keep-together">discussed</span> in this section.</p>&#13;
</div>&#13;
&#13;
<p>In a normal distribution, the data is distributed symmetrically around the mean, which also means that the mean is equal to the median and to the mode. Furthermore, around 68% of the data falls within one standard deviation from the mean, around 95% falls within two standard deviations, and around 99.7% falls within three standard deviations. This property makes the normal distribution a useful tool for making inferences.</p>&#13;
&#13;
<p>To sum up, what you should retain from the normal distribution is the following:</p>&#13;
&#13;
<ul>&#13;
	<li>The mean and the standard deviation describe the distribution.</li>&#13;
	<li>The mean splits the distribution halfway, making it equal to the median. Due to the symmetrical property, the mode is also equal to the mean and the median.</li>&#13;
</ul>&#13;
&#13;
<p>Now let’s discuss the measures of shape. The first measure of shape is skewness. <em>Skewness </em>describes a distribution’s asymmetry. It analyzes how far from being symmetrical the distribution deviates.</p>&#13;
&#13;
<p>The skewness of a normal distribution is equal to zero. This means that the distribution is perfectly symmetrical around its mean, with an equal number of data points on either side of the mean.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="positive skew" data-type="indexterm" id="id392"/>A <em>positive skew</em> indicates that the distribution has a long tail to the right, which means that the mean is greater than the median because the mean is sensible to outliers, which will push it upward (therefore, to the right of the <em>x</em>-axis). Similarly, the mode will be the lowest value between the three central tendency measures. <a data-type="xref" href="#figure-3-5">Figure 3-5</a> shows a positive skew.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-5"><img alt="" class="iimagesdlf_11png" src="assets/dlff_0305.png"/>&#13;
<h6><span class="label">Figure 3-5. </span>An example of a positively skewed distribution</h6>&#13;
</div></figure>&#13;
&#13;
<p><a contenteditable="false" data-primary="negative skew" data-type="indexterm" id="id393"/>A <em>negative skew</em> indicates that the distribution has a long tail to the left, which means that the mean is lower than the median. Similarly, the mode will be the greatest value between the three central tendency measures. <a data-type="xref" href="#figure-3-6">Figure 3-6</a> shows a negative skew.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-6"><img alt="" class="iimagesdlf_10png" src="assets/dlff_0306.png"/>&#13;
<h6><span class="label">Figure 3-6. </span>An example of a negatively skewed distribution</h6>&#13;
</div></figure>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>How can skewness be interpreted in the world of financial markets? If the distribution is positively skewed, it means that there are more returns above the mean than below it (the tail of the distribution is longer on the positive side).</p>&#13;
&#13;
<p>If the distribution is negatively skewed, it means that there are more returns below the mean than above it (the tail of the distribution is longer on the negative side).</p>&#13;
&#13;
<p>The skew of a returns series can provide information about the risk and return of an investment. For example, a positively skewed returns series may indicate that the investment has a potential for a few large gains with a risk of frequent small losses.</p>&#13;
</div>&#13;
&#13;
<p>The formula to find skewness is as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="mu overTilde Subscript 3 Baseline equals StartFraction sigma-summation Underscript n equals 1 Overscript i Endscripts left-parenthesis x Subscript i Baseline minus x overbar right-parenthesis cubed Over upper N sigma cubed EndFraction">&#13;
  <mrow>&#13;
    <msub><mover accent="true"><mi>μ</mi> <mo>˜</mo></mover> <mn>3</mn> </msub>&#13;
    <mo>=</mo>&#13;
    <mstyle displaystyle="false" scriptlevel="0">&#13;
      <mfrac><mrow><msubsup><mo>∑</mo> <mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow> <mi>i</mi> </msubsup><msup><mrow><mo>(</mo><msub><mi>x</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>3</mn> </msup></mrow> <mrow><mi>N</mi><msup><mi>σ</mi> <mn>3</mn> </msup></mrow></mfrac>&#13;
    </mstyle>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>Let’s check the skewness of the US CPI year-on-year data since 2003:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Calculating the skew</code>&#13;
<code class="n">skew</code> <code class="o">=</code> <code class="n">cpi_latest</code><code class="p">[</code><code class="s2">"CPIAUCSL"</code><code class="p">]</code><code class="o">.</code><code class="n">skew</code><code class="p">()</code> &#13;
<code class="c1"># Printing the result</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'The skew of the dataset: '</code> <code class="o">+</code> <code class="nb">str</code><code class="p">(</code><code class="n">skew</code><code class="p">))</code>&#13;
</pre>&#13;
&#13;
<p>The output of the preceding code should be as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">The</code> <code class="n">skew</code> <code class="n">of</code> <code class="n">the</code> <code class="n">dataset</code><code class="p">:</code> <code class="mf">1.17</code></pre>&#13;
&#13;
<p>The skew of the data is 1.17, but what does that mean? Let’s chart the distribution of the data to facilitate interpretation. You can do this using the following code snippet:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Plotting the histogram of the data</code>&#13;
<code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">()</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">cpi</code><code class="p">[</code><code class="s1">'CPIAUCSL'</code><code class="p">],</code> <code class="n">bins</code> <code class="o">=</code> <code class="mi">30</code><code class="p">,</code> <code class="n">edgecolor</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">,</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'white'</code><code class="p">)</code>&#13;
<code class="c1"># Add vertical lines for better interpretation</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">mean</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'black'</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">'--'</code><code class="p">,</code> <code class="n">label</code> <code class="o">=</code> <code class="s1">'Mean'</code><code class="p">,</code> &#13;
           <code class="n">linewidth</code> <code class="o">=</code> <code class="mi">2</code><code class="p">)</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">median</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'grey'</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">'-.'</code><code class="p">,</code> <code class="n">label</code> <code class="o">=</code> <code class="s1">'Median'</code><code class="p">,</code> &#13;
           <code class="n">linewidth</code> <code class="o">=</code> <code class="mi">2</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<p><a data-type="xref" href="#figure-3-7">Figure 3-7</a> shows the result of the previous code snippet. The data is clearly positively skewed since the mean is greater than the median and the skewness is positive <span class="keep-together">(above zero).</span></p>&#13;
&#13;
<figure><div class="figure" id="figure-3-7"><img alt="" class="iimagesdlf_0307png" src="assets/dlff_0307.png"/>&#13;
<h6><span class="label">Figure 3-7. </span>Data distribution of the US CPI year-on-year values, indicating positive skew</h6>&#13;
</div></figure>&#13;
&#13;
<p>Remember, skewness is a measure of the asymmetry of a probability distribution. It therefore measures the degree to which the distribution deviates from normality. The rules of thumb to interpret skewness are as follows:</p>&#13;
&#13;
<ul>&#13;
	<li>If skewness is between –0.5 and 0.5, the data is considered symmetrical.</li>&#13;
	<li>If skewness is between –1.0 and –0.5 or between 0.5 and 1.0, the data is <span class="keep-together">considered</span> mildly skewed.</li>&#13;
	<li>If skewness is less than –1.0 or greater than 1.0, the data is considered highly skewed.</li>&#13;
</ul>&#13;
&#13;
<p>What does a positive skew mean? In this case, 1.17 represents highly skewed data (in the positive side), which is in line with a monetary policy that favors inflation as the economy grows (with a few inflationary spikes that cause the skew).</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>It may be interesting to know that with a skewed distribution, the median may be the preferred metric since the mean tends to be pulled by outliers, thus distorting its value.</p>&#13;
</div>&#13;
&#13;
<p><a contenteditable="false" data-primary="kurtosis" data-type="indexterm" id="id394"/>The next measure of shape is <em>kurtosis,</em> which is a description of the peakedness or flatness of a distribution relative to a normal distribution. Kurtosis describes the tails of a distribution, in particular, whether the tails are thicker or thinner than those of a normal distribution.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="mesokurtic distribution" data-type="indexterm" id="id395"/>A normal distribution has a kurtosis of 3, which means it is a <em>mesokurtic</em> distribution. <a contenteditable="false" data-primary="leptokurtic distribution" data-type="indexterm" id="id396"/>If a distribution has a kurtosis greater than 3, it is referred to as <em>leptokurtic</em>, meaning it has a higher peak and fatter tails than a normal distribution. <a contenteditable="false" data-primary="platykurtic distribution" data-type="indexterm" id="id397"/>If a distribution has a kurtosis less than 3, it is referred to as <em>platykurtic</em>, meaning it has a flatter peak and thinner tails than a normal distribution.</p>&#13;
&#13;
<p>The formula to find kurtosis is as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="k equals StartFraction sigma-summation Underscript n equals 1 Overscript i Endscripts left-parenthesis x Subscript i Baseline minus x overbar right-parenthesis Superscript 4 Baseline Over upper N sigma Superscript 4 Baseline EndFraction">&#13;
  <mrow>&#13;
    <mi>k</mi>&#13;
    <mo>=</mo>&#13;
    <mstyle displaystyle="false" scriptlevel="0">&#13;
      <mfrac><mrow><msubsup><mo>∑</mo> <mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow> <mi>i</mi> </msubsup><msup><mrow><mo>(</mo><msub><mi>x</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>4</mn> </msup></mrow> <mrow><mi>N</mi><msup><mi>σ</mi> <mn>4</mn> </msup></mrow></mfrac>&#13;
    </mstyle>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>Sometimes kurtosis is measured as <em>excess kurtosis</em> to give it a starting value of zero (for a normal distribution). This means that the kurtosis measure is subtracted from 3 so as to calculate the excess kurtosis. Let’s calculate excess kurtosis for the US CPI year-on-year data:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Calculating the excess kurtosis</code>&#13;
<code class="n">excess_kurtosis</code> <code class="o">=</code> <code class="n">cpi_latest</code><code class="p">[</code><code class="s2">"CPIAUCSL"</code><code class="p">]</code><code class="o">.</code><code class="n">kurtosis</code><code class="p">()</code> &#13;
<code class="c1"># Printing the result</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'The excess kurtosis of the dataset: '</code> <code class="o">+</code> <code class="nb">str</code><code class="p">(</code><code class="n">excess_kurtosis</code><code class="p">))</code>&#13;
</pre>&#13;
&#13;
<p>The output of the preceding code should be as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">The</code> <code class="n">excess</code> <code class="n">kurtosis</code> <code class="n">of</code> <code class="n">the</code> <code class="n">dataset</code><code class="p">:</code> <code class="mf">2.15</code></pre>&#13;
&#13;
<p>In the case of the US CPI year-on-year values of the past 20 years, excess kurtosis is 2.15, which is more in line with a leptokurtic (peakier with fatter tails) distribution. A positive value indicates a distribution more peaked than normal, and a negative <span class="keep-together">kurtosis</span> indicates a shape flatter than normal.</p>&#13;
&#13;
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id398">&#13;
<h1>Understanding Inflation</h1>&#13;
<p><a contenteditable="false" data-primary="inflation" data-type="indexterm" id="id399"/>Independent from statistics, it is interesting to know the terminology of what you are analyzing. <em>Inflation</em> is a decrease in purchasing power of the economic agents (such as households). A decrease in purchasing power means that agents can buy less over time with the same amount of money. This is also referred to as a general price increase. Inflation in the economic sense has the following forms:</p>&#13;
&#13;
<dl>&#13;
 <dt>Inflation</dt>&#13;
 <dd><p>Controlled inflation is associated with steady economic growth and expansion. It is a desired attribute for a growing economy. Regulators monitor inflation and try to stabilize it to prevent social and economic distress.</p></dd>&#13;
 &#13;
<dt class="pagebreak-before less_space">Deflation</dt>&#13;
<dd><p><a contenteditable="false" data-primary="deflation" data-type="indexterm" id="id400"/>Whenever inflation is in the negative territory, it is referred to as deflation. Deflation is very dangerous for the economy, and as tempting as it may be for <span class="keep-together">consumers</span> who see a price decrease, deflation is a growth killer and may cause extended economic gluts that lead to unemployment and bearish stock markets.</p></dd>&#13;
&#13;
<dt>Stagflation</dt>&#13;
<dd><p><a contenteditable="false" data-primary="stagflation" data-type="indexterm" id="id401"/>This occurs when inflation is either high or rising while economic growth is slowing down. Simultaneously, unemployment remains high. It is one of the worst possible case scenarios.</p></dd>&#13;
&#13;
<dt>Disinflation</dt>&#13;
<dd><p><a contenteditable="false" data-primary="disinflation" data-type="indexterm" id="id402"/>This is a decrease in inflation but in the positive territory. For example, if this year’s inflation is 2% while last year’s inflation was 3%, you can say that there was disinflation on a yearly basis.</p></dd>&#13;
&#13;
<dt>Hyperinflation</dt>&#13;
<dd><p><a contenteditable="false" data-primary="hyperinflation" data-type="indexterm" id="id403"/>This is the nightmarish scenario that occurs when inflation goes out of control and experiences astronomical percent changes, such as a percentage change in the millions from year to year (as has famously occurred in Zimbabwe, <span class="keep-together">Yugoslavia,</span> and Greece).</p></dd>&#13;
</dl>&#13;
</div></aside>&#13;
&#13;
<p><a contenteditable="false" data-primary="quantiles" data-type="indexterm" id="Chapter_3.html12"/>The final metric we will discuss in the descriptive statistics category is quantiles. <em>Quantiles </em>are measures of both shape and variability since they provide information about the distribution of values (shape) and about the dispersion of those values (variability). The most used type of quantiles is the quartile.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="quartiles" data-type="indexterm" id="id404"/><em>Quartiles</em> divide the dataset into four equal parts. This is done by arranging the data in order and then performing the split. Consider <a data-type="xref" href="#table-3-1">Table 3-1</a> as an example.</p>&#13;
&#13;
<table id="table-3-1">&#13;
	<caption><span class="label">Table 3-1. </span>Numbers in ascending order</caption>&#13;
	<thead>&#13;
		<tr>&#13;
			<th>Value</th>&#13;
		</tr>&#13;
	</thead>&#13;
	<tbody>&#13;
		<tr>&#13;
			<td>1</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td>2</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td>4</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td>5</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td>7</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td>8</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td>9</td>&#13;
		</tr>&#13;
	</tbody>&#13;
</table>&#13;
&#13;
<p class="pagebreak-before">The quartiles are as follows:</p>&#13;
&#13;
<ul>&#13;
	<li>The lower quartile (Q1) is the first quarter, which in this case is 2.</li>&#13;
	<li>The middle quartile (Q2) is also the median, which in this case is 5.</li>&#13;
	<li>The upper quartile (Q3) in this case is 8.</li>&#13;
</ul>&#13;
&#13;
<p>Mathematically, you can calculate Q1 and Q3 using the following formulas:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="upper Q 1 equals left-parenthesis StartFraction n plus 1 Over 4 EndFraction right-parenthesis">&#13;
  <mrow>&#13;
    <msub><mi>Q</mi> <mn>1</mn> </msub>&#13;
    <mo>=</mo>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <mfrac><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow> <mn>4</mn></mfrac>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<p><math alttext="upper Q 3 equals 3 left-parenthesis StartFraction n plus 1 Over 4 EndFraction right-parenthesis">&#13;
  <mrow>&#13;
    <msub><mi>Q</mi> <mn>3</mn> </msub>&#13;
    <mo>=</mo>&#13;
    <mn>3</mn>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <mfrac><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow> <mn>4</mn></mfrac>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>Keep in mind that the results of the formulas give you the ranking of the values but not the values themselves:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="upper Q 1 equals left-parenthesis StartFraction 7 plus 1 Over 4 EndFraction right-parenthesis equals 2 Superscript n d Baseline t e r m equals 2">&#13;
  <mrow>&#13;
    <msub><mi>Q</mi> <mn>1</mn> </msub>&#13;
    <mo>=</mo>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <mfrac><mrow><mn>7</mn><mo>+</mo><mn>1</mn></mrow> <mn>4</mn></mfrac>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <mo>=</mo>&#13;
    <msup><mn>2</mn> <mrow><mi>n</mi><mi>d</mi></mrow> </msup>&#13;
    <mspace width="0.222222em"/>&#13;
    <mi>t</mi>&#13;
    <mi>e</mi>&#13;
    <mi>r</mi>&#13;
    <mi>m</mi>&#13;
    <mo>=</mo>&#13;
    <mn>2</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<p><math alttext="upper Q 3 equals 3 left-parenthesis StartFraction 7 plus 1 Over 4 EndFraction right-parenthesis equals 6 Superscript t h Baseline t e r m equals 8">&#13;
  <mrow>&#13;
    <msub><mi>Q</mi> <mn>3</mn> </msub>&#13;
    <mo>=</mo>&#13;
    <mn>3</mn>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <mfrac><mrow><mn>7</mn><mo>+</mo><mn>1</mn></mrow> <mn>4</mn></mfrac>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <mo>=</mo>&#13;
    <msup><mn>6</mn> <mrow><mi>t</mi><mi>h</mi></mrow> </msup>&#13;
    <mspace width="0.222222em"/>&#13;
    <mi>t</mi>&#13;
    <mi>e</mi>&#13;
    <mi>r</mi>&#13;
    <mi>m</mi>&#13;
    <mo>=</mo>&#13;
    <mn>8</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p><a contenteditable="false" data-primary="interquartile range (IQR)" data-type="indexterm" id="id405"/>The <em>interquartile range</em> (IQR) is the difference between Q3 and Q1 and provides a measure of the spread of the middle 50% of the values in a dataset. The IQR is robust to outliers (since it relies on middle values) and provides a brief summary of the spread of the bulk of the values. The IQR of the data in <a data-type="xref" href="#table-3-1">Table 3-1</a> is 6 as per the <span class="keep-together">following</span> formula:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="upper I upper Q upper R equals upper Q 3 minus upper Q 1">&#13;
  <mrow>&#13;
    <mi>I</mi>&#13;
    <mi>Q</mi>&#13;
    <mi>R</mi>&#13;
    <mo>=</mo>&#13;
    <msub><mi>Q</mi> <mn>3</mn> </msub>&#13;
    <mo>-</mo>&#13;
    <msub><mi>Q</mi> <mn>1</mn> </msub>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<p><math alttext="upper I upper Q upper R equals 8 minus 2 equals 6">&#13;
  <mrow>&#13;
    <mi>I</mi>&#13;
    <mi>Q</mi>&#13;
    <mi>R</mi>&#13;
    <mo>=</mo>&#13;
    <mn>8</mn>&#13;
    <mo>-</mo>&#13;
    <mn>2</mn>&#13;
    <mo>=</mo>&#13;
    <mn>6</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>The IQR is a valuable indicator and can be used as an input or a risk metric in many different models. It can also be used to detect outliers in the data since it is immune to them. Also, the IQR can help evaluate the current volatility of the analyzed asset, which in turn can be used with other methods to create more powerful models. As understood, the IQR outperforms the range metric in terms of usefulness and interpretation as the former is prone to outliers.</p>&#13;
&#13;
<p>Be careful when calculating quartiles, as there are many methods that use different calculations for the same dataset. Most importantly, make sure you use the same method throughout your analyses. <a contenteditable="false" data-primary="Tukey's hinges" data-type="indexterm" id="id406"/>The method used to calculate the quartiles in <a data-type="xref" href="#table-3-1">Table 3-1</a> is called the <em>Tukey’s hinges</em> method.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html12" data-type="indexterm" id="id407"/></p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The key takeaways from this section are the following:</p>&#13;
&#13;
<ul>&#13;
	<li>The normal distribution is a continuous probability distribution that has a bell-shaped curve. The majority of the data clusters around the mean. The mean, median, and mode of a normal distribution curve are all equal.</li>&#13;
	<li>Skewness measures the asymmetry of a probability <span class="keep-together">distribution.</span></li>&#13;
	<li>Kurtosis measures the peakedness of a probability distribution. Excess kurtosis is commonly used to describe the current probability distribution.</li>&#13;
	<li>Quantiles divide the arranged dataset into equal parts. The most commonly used quantiles are quartiles that divide the data into four equal parts.</li>&#13;
	<li>The IQR is the difference between the third quartile and the first quartile. It is immune to outliers and thus is very helpful in data analysis.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html11" data-type="indexterm" id="id408"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html10" data-type="indexterm" id="id409"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html9" data-type="indexterm" id="id410"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html8" data-type="indexterm" id="id411"/></li>&#13;
</ul>&#13;
</div>&#13;
</div></section>&#13;
&#13;
<section data-pdf-bookmark="Visualizing Data" data-type="sect1"><div class="sect1" id="id16">&#13;
<h1>Visualizing Data</h1>&#13;
&#13;
<p><a contenteditable="false" data-primary="data" data-secondary="visualizing" data-type="indexterm" id="Chapter_3.html13"/><a contenteditable="false" data-primary="data science" data-secondary="visualizing data" data-type="indexterm" id="Chapter_3.html15"/><a contenteditable="false" data-primary="descriptive statistics" data-secondary="visualizing data" data-type="indexterm" id="Chapter_3.html16"/><a contenteditable="false" data-primary="visualization" data-secondary="of data" data-type="indexterm" id="Chapter_3.html17"/>In <a data-type="xref" href="ch01.html#ch01">Chapter 1</a>, I presented the six steps in the data science process. Step 4 was data visualization. This section will show you a few ways to present data in a clear visual manner that allows you to interpret it.</p>&#13;
&#13;
<p>Many types of statistical plots are commonly used to visualize data. Let’s discuss some of them.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="scatterplots" data-type="indexterm" id="id412"/><em>Scatterplots</em> are used to graph the relationship between two variables through points that correspond to the intersection between the variables. To create a scatterplot, use the following code on the CPI data:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Importing the required library</code>&#13;
<code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code>&#13;
<code class="c1"># Resetting the index</code>&#13;
<code class="n">cpi</code> <code class="o">=</code> <code class="n">cpi</code><code class="o">.</code><code class="n">reset_index</code><code class="p">()</code>&#13;
<code class="c1"># Creating the chart</code>&#13;
<code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">()</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">cpi</code><code class="p">[</code><code class="s1">'DATE'</code><code class="p">],</code> <code class="n">cpi</code><code class="p">[</code><code class="s1">'CPIAUCSL'</code><code class="p">],</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">,</code> &#13;
           <code class="n">s</code> <code class="o">=</code> <code class="mi">8</code><code class="p">,</code>  <code class="n">label</code> <code class="o">=</code> <code class="s1">'Change in CPI Year-on-Year'</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<p class="pagebreak-before"><a data-type="xref" href="#figure-3-8">Figure 3-8</a> shows the result of a scatterplot in time. This means that you have the CPI data as the first variable (<em>y</em>-axis) and time as the second variable (<em>x</em>-axis). However, scatterplots are more commonly used to compare variables; thus, removing the time variable can give more insights.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-8"><img alt="" class="iimagesdlf_0228png" src="assets/dlff_0308.png"/>&#13;
<h6><span class="label">Figure 3-8. </span>Scatterplot of US CPI data versus the time axis</h6>&#13;
</div></figure>&#13;
&#13;
<p>Compare the UK CPI year-on-year change with the US CPI year-on-year change. Notice the positive association between the two in <a data-type="xref" href="#figure-3-9">Figure 3-9</a>, as higher values of one are correlated with higher values of the other. Correlation is a key measure that you will see in detail in the next section. The code to plot <a data-type="xref" href="#figure-3-9">Figure 3-9</a> is as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Setting the beginning and end of the historical data</code>&#13;
<code class="n">start_date</code> <code class="o">=</code> <code class="s1">'1995-01-01'</code>&#13;
<code class="n">end_date</code>   <code class="o">=</code> <code class="s1">'2022-12-01'</code>&#13;
<code class="c1"># Creating a dataframe and downloading the CPI data</code>&#13;
<code class="n">cpi_us</code> <code class="o">=</code> <code class="n">pdr</code><code class="o">.</code><code class="n">DataReader</code><code class="p">(</code><code class="s1">'CPIAUCSL'</code><code class="p">,</code> <code class="s1">'fred'</code><code class="p">,</code> <code class="n">start_date</code><code class="p">,</code> <code class="n">end_date</code><code class="p">)</code>&#13;
<code class="n">cpi_uk</code> <code class="o">=</code> <code class="n">pdr</code><code class="o">.</code><code class="n">DataReader</code><code class="p">(</code><code class="s1">'GBRCPIALLMINMEI'</code><code class="p">,</code> <code class="s1">'fred'</code><code class="p">,</code> <code class="n">start_date</code><code class="p">,</code> <code class="n">end_date</code><code class="p">)</code>&#13;
<code class="c1"># Dropping the NaN values from the rows</code>&#13;
<code class="n">cpi_us</code> <code class="o">=</code> <code class="n">cpi_us</code><code class="o">.</code><code class="n">dropna</code><code class="p">()</code>&#13;
<code class="n">cpi_uk</code> <code class="o">=</code> <code class="n">cpi_uk</code><code class="o">.</code><code class="n">dropna</code><code class="p">()</code>&#13;
<code class="c1"># Transforming the CPI into a year-on-year measure</code>&#13;
<code class="n">cpi_us</code> <code class="o">=</code> <code class="n">cpi_us</code><code class="o">.</code><code class="n">pct_change</code><code class="p">(</code><code class="n">periods</code> <code class="o">=</code> <code class="mi">12</code><code class="p">,</code> <code class="n">axis</code> <code class="o">=</code> <code class="mi">0</code><code class="p">)</code> <code class="o">*</code> <code class="mi">100</code>&#13;
<code class="n">cpi_us</code> <code class="o">=</code> <code class="n">cpi_us</code><code class="o">.</code><code class="n">dropna</code><code class="p">()</code>&#13;
<code class="n">cpi_uk</code> <code class="o">=</code> <code class="n">cpi_uk</code><code class="o">.</code><code class="n">pct_change</code><code class="p">(</code><code class="n">periods</code> <code class="o">=</code> <code class="mi">12</code><code class="p">,</code> <code class="n">axis</code> <code class="o">=</code> <code class="mi">0</code><code class="p">)</code> <code class="o">*</code> <code class="mi">100</code>&#13;
<code class="n">cpi_uk</code> <code class="o">=</code> <code class="n">cpi_uk</code><code class="o">.</code><code class="n">dropna</code><code class="p">()</code>&#13;
<code class="c1"># Creating the chart</code>&#13;
<code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">()</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">cpi_us</code><code class="p">[</code><code class="s1">'CPIAUCSL'</code><code class="p">],</code> <code class="n">cpi_uk</code><code class="p">[</code><code class="s1">'GBRCPIALLMINMEI'</code><code class="p">],</code> &#13;
           <code class="n">color</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">,</code> <code class="n">s</code> <code class="o">=</code> <code class="mi">8</code><code class="p">,</code> <code class="n">label</code> <code class="o">=</code> <code class="s1">'Change in CPI Year-on-Year'</code><code class="p">)</code>&#13;
<code class="c1"># Adding a few aesthetic elements to the chart</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">set_xlabel</code><code class="p">(</code><code class="s1">'US CPI'</code><code class="p">)</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">set_ylabel</code><code class="p">(</code><code class="s1">'UK CPI'</code><code class="p">)</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="n">x</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'black'</code><code class="p">,</code> <code class="n">linestyle</code> <code class="o">=</code> <code class="s1">'dashed'</code><code class="p">,</code> <code class="n">linewidth</code> <code class="o">=</code> <code class="mi">1</code><code class="p">)</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">axhline</code><code class="p">(</code><code class="n">y</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'black'</code><code class="p">,</code> <code class="n">linestyle</code> <code class="o">=</code> <code class="s1">'dashed'</code><code class="p">,</code> <code class="n">linewidth</code> <code class="o">=</code> <code class="mi">1</code><code class="p">)</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">set_ylim</code><code class="p">(</code><code class="o">-</code><code class="mi">2</code><code class="p">,)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<figure><div class="figure" id="figure-3-9"><img alt="" class="iimagesdlf_0229png" src="assets/dlff_0309.png"/>&#13;
<h6><span class="label">Figure 3-9. </span>Scatterplot of UK CPI data versus US CPI data</h6>&#13;
</div></figure>&#13;
&#13;
<p>Scatterplots are good when visualizing the correlation between data. They are also easy to draw and interpret. Generally, when the points are scattered in such a way that a diagonal upward-sloping line can be drawn to represent them, the correlation is assumed to be positive, since whenever variables on the <em>x</em>-axis increase, variables on the <em>y</em>-axis also increase.</p>&#13;
&#13;
<p>On the other hand, when a diagonal downward-sloping line can be drawn to represent the different variables, a negative correlation may exist. A negative correlation implies that whenever variables on the <em>x</em>-axis move, it is likely that variables on the <span class="keep-together"><em>y</em>-axis</span> move in the opposite way.</p>&#13;
&#13;
<p class="pagebreak-before"><a data-type="xref" href="#figure-3-10">Figure 3-10</a> shows a best-fit line between the two inflation datasets from <a data-type="xref" href="#figure-3-9">Figure 3-9</a>. Notice how it is upward sloping.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-10"><img alt="" class="iimagesdlf_4png" src="assets/dlff_0310.png"/>&#13;
<h6><span class="label">Figure 3-10. </span>Scatterplot of UK CPI data versus US CPI data with a best-fit line</h6>&#13;
</div></figure>&#13;
&#13;
<p>Let’s now move to another charting method. <em>Line plots</em>, the most basic type of plot, are essentially scatterplots that are joined and are mostly charted against the time axis (<em>x</em>-axis). You saw line plots in Figures <a data-type="xref" data-xrefstyle="select:labelnumber" href="#figure-3-1">3-1</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#figure-3-2">3-2</a>.</p>&#13;
&#13;
<p>The advantage of line plots is their simplicity and ease of implementation. They also show the evolution of the series through time, which helps in detecting trends and patterns. In <a data-type="xref" href="ch05.html#ch05">Chapter 5</a>, you will learn about candlestick plots, a more elaborate way to plot financial time series. <a data-type="xref" href="#figure-3-11">Figure 3-11</a> shows a basic line plot of US CPI data <span class="keep-together">since 1951.</span></p>&#13;
&#13;
<figure><div class="figure" id="figure-3-11"><img alt="" class="iimagesdlf_1png" src="assets/dlff_0311.png"/>&#13;
<h6><span class="label">Figure 3-11. </span>Line plot of US CPI data versus the time axis</h6>&#13;
</div></figure>&#13;
&#13;
<p>To create <a data-type="xref" href="#figure-3-11">Figure 3-11</a>, you can use the following code snippet:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Creating the chart</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">cpi</code><code class="p">[</code><code class="s1">'DATE'</code><code class="p">],</code> <code class="n">cpi</code><code class="p">[</code><code class="s1">'CPIAUCSL'</code><code class="p">],</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">,</code> &#13;
         <code class="n">label</code> <code class="o">=</code> <code class="s1">'Change in CPI Year-on-Year'</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<p>Next up are <em>bar plots</em>, which display the distribution of variables (generally, categorical). <a data-type="xref" href="#figure-3-12">Figure 3-12</a> shows a bar plot of the US CPI data since the beginning of 2022.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-12"><img alt="" class="iimagesdlf_0312png" src="assets/dlff_0312.png"/>&#13;
<h6><span class="label">Figure 3-12. </span>Bar plot of US CPI data versus the time axis</h6>&#13;
</div></figure>&#13;
&#13;
<p>To create <a data-type="xref" href="#figure-3-12">Figure 3-12</a>, you can use the following code snippet:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Taking the values of the previous twelve months</code>&#13;
<code class="n">cpi_one_year</code> <code class="o">=</code> <code class="n">cpi</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="o">-</code><code class="mi">12</code><code class="p">:]</code>&#13;
<code class="c1"># Creating the chart</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">bar</code><code class="p">(</code><code class="n">cpi_one_year</code><code class="p">[</code><code class="s1">'DATE'</code><code class="p">],</code> <code class="n">cpi_one_year</code><code class="p">[</code><code class="s1">'CPIAUCSL'</code><code class="p">],</code> &#13;
        <code class="n">color</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">,</code> <code class="n">label</code> <code class="o">=</code> <code class="s1">'Change in CPI Year-on-Year'</code><code class="p">,</code> <code class="n">width</code> <code class="o">=</code> <code class="mi">7</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<p>Bar plots can be limited for plotting continuous data such as the US CPI or stock <span class="keep-together">prices</span>. They can also be misleading when the scale is off. Bar plots are also not recommended for large datasets since they clutter up the space. For the latter reason, histograms are a better fit.</p>&#13;
&#13;
<p>A <em>histogram </em>is a specific sort of bar chart that is used to display the frequency distribution of continuous data by using bars to represent statistical information. It indicates the number of observations that fall into the class or bin of values. An example of a histogram is shown in <a data-type="xref" href="#figure-3-13">Figure 3-13</a> (also see <a data-type="xref" href="#figure-3-7">Figure 3-7</a>).</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-13"><img alt="" class="iimagesdlf_2png" src="assets/dlff_0313.png"/>&#13;
<h6><span class="label">Figure 3-13. </span>Histogram plot of US CPI data</h6>&#13;
</div></figure>&#13;
&#13;
<p>To create <a data-type="xref" href="#figure-3-13">Figure 3-13</a>, you can use the following code snippet:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Creating the chart</code>&#13;
<code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">()</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">cpi</code><code class="p">[</code><code class="s1">'CPIAUCSL'</code><code class="p">],</code> <code class="n">bins</code> <code class="o">=</code> <code class="mi">30</code><code class="p">,</code> <code class="n">edgecolor</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">,</code> &#13;
        <code class="n">color</code> <code class="o">=</code> <code class="s1">'white'</code><code class="p">,</code> <code class="n">label</code> <code class="o">=</code> <code class="s1">'Change in CPI Year-on-Year'</code><code class="p">,)</code>&#13;
<code class="c1"># Add vertical lines for better interpretation</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<p>Notice how the bar plot is charted against the time axis, but the histogram plot does not have a time horizon because it is a group of values with the aim of showing the overall distribution points. Visually, you can see the positive skewness of the <span class="keep-together">distribution.</span></p>&#13;
&#13;
<p>Another classic plotting technique in statistics is the <em>box and whisker plot</em>. It is used to visualize the distribution of continuous variables while including the median and the quartiles, as well as the outliers. The way to understand the box and whisker plot is as follows:</p>&#13;
&#13;
<ul>&#13;
	<li>&#13;
	<p>The box represents the IQR. The box is drawn between the first quartile and the third quartile. The height of the box indicates the spread of the data in this range.</p>&#13;
	</li>&#13;
	<li>&#13;
	<p>The line inside the box represents the median.</p>&#13;
	</li>&#13;
	<li>&#13;
	<p>The whiskers extend from the top and bottom of the box to the highest and lowest data points that are still within 1.5 times the IQR. These data points are called <em>outliers </em>and are represented as individual points on the plot.</p>&#13;
	</li>&#13;
</ul>&#13;
&#13;
<p><a data-type="xref" href="#figure-3-14">Figure 3-14</a> shows a box and whisker plot on the US CPI data since 1950.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-14"><img alt="" class="iimagesdlf_080png" src="assets/dlff_0314.png"/>&#13;
<h6><span class="label">Figure 3-14. </span>Box and whisker plot of US CPI data</h6>&#13;
</div></figure>&#13;
&#13;
<p>You can also plot the data without the outliers (any value that lies more than 1.5 times the length of the box from either end of the box). To create <a data-type="xref" href="#figure-3-14">Figure 3-14</a>, you can use the following code snippet:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Creating the chart</code>&#13;
<code class="n">cpi_latest</code> <code class="o">=</code> <code class="n">cpi</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="err">–</code><code class="mi">240</code><code class="p">:]</code>&#13;
<code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">()</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">boxplot</code><code class="p">(</code><code class="n">cpi_latest</code><code class="p">[</code><code class="s1">'CPIAUCSL'</code><code class="p">])</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<p>To remove the outliers from the plot, you simply use the following tweak:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Replace the corresponding code line with the following</code>&#13;
<code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">()</code>&#13;
<code class="n">ax</code><code class="o">.</code><code class="n">boxplot</code><code class="p">(</code><code class="n">cpi_latest</code><code class="p">[</code><code class="s1">'CPIAUCSL'</code><code class="p">],</code> <code class="n">showfliers</code> <code class="o">=</code> <code class="kc">False</code><code class="p">)</code></pre>&#13;
&#13;
<p>This will give you <a data-type="xref" href="#figure-3-15">Figure 3-15</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-15"><img alt="" class="iimagesdlf_081png" src="assets/dlff_0315.png"/>&#13;
<h6><span class="label">Figure 3-15. </span>Box and whisker plot of US CPI data with no outliers</h6>&#13;
</div></figure>&#13;
&#13;
<p>Many more data visualization techniques exist, such as <em>heatmaps </em>(commonly used with correlation data and temperature mapping) and <em>pie charts </em>(commonly used for budgeting and segmentation). Which technique to use depends on what you need to understand and what fits better with your needs. For example, a line plot is better suited for time series that only have one feature (e.g., only the close price of a certain security is available). A histogram plot is better suited for use with probability <span class="keep-together">distribution</span> data.</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The key takeaways from this section are the following:</p>&#13;
&#13;
<ul>&#13;
	<li>Which data visualization technique to use depends on the type of analysis and interpretation you want to perform. Some plots are better suited for use with certain types of data. </li>&#13;
	<li>Data visualization helps with the initial interpretation before confirming it numerically.</li>&#13;
	<li>You are more likely to use line plots and candlestick plots when dealing with financial time series.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html17" data-type="indexterm" id="id413"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html16" data-type="indexterm" id="id414"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html15" data-type="indexterm" id="id415"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html13" data-type="indexterm" id="id416"/></li>&#13;
</ul>&#13;
</div>&#13;
</div></section>&#13;
&#13;
<section class="pagebreak-before" data-pdf-bookmark="Correlation" data-type="sect1"><div class="sect1" id="correlation">&#13;
<h1 class="less_space">Correlation</h1>&#13;
&#13;
<p><a contenteditable="false" data-primary="correlation" data-type="indexterm" id="Chapter_3.html19"/><a contenteditable="false" data-primary="descriptive statistics" data-secondary="correlation" data-type="indexterm" id="Chapter_3.html20"/><em>Correlation </em>is a measure used to calculate the degree of the linear relationship between two variables. It is a number between –1.0 and 1.0, with –1.0 designating a strong negative relationship between the variables and 1.0 designating a strong <span class="keep-together">positive</span> relationship.</p>&#13;
&#13;
<p>A value of zero indicates that there is no linear association between the variables. However, correlation does not imply causation. Two variables are said to be <span class="keep-together">correlated</span> if they move in the same direction, but this does not imply that one causes the other to move or that they move as a result of the same events.</p>&#13;
&#13;
<p>Most people agree that some assets have natural correlations. For instance, because they are both part of the same industry and are affected by the same trends and events, the stocks of Apple and Microsoft are positively connected (which means their general trend is in the same direction). <a data-type="xref" href="#figure-3-16">Figure 3-16</a> shows the chart between the two stocks. Notice how they move together.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-16"><img alt="" class="iimagesdlf_0569png" src="assets/dlff_0316.png"/>&#13;
<h6><span class="label">Figure 3-16. </span>Apple and Microsoft stock prices since 2021</h6>&#13;
</div></figure>&#13;
&#13;
<p>The tops and bottoms of both stocks occur at almost the exact same time. Similarly, as the United States and the UK have similar economic drivers and impacts, they are also likely to have positively correlated inflation numbers, as you saw earlier in the chapter.</p>&#13;
&#13;
<p>Checking for correlation is done through visual interpretation and mathematical formulas. Before seeing an example, let’s discuss the roots of calculating correlation so that you know where it comes from and what its limitations are.</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Simply put, to calculate correlation, you need to measure how close the points in a scatterplot of the two variables are to a straight line. <a contenteditable="false" data-primary="linear correlation" data-type="indexterm" id="id417"/>The more they look like a straight line, the more they are positively correlated, hence the term <em>linear correlation</em>.</p>&#13;
</div>&#13;
&#13;
<p>There are two main methods for calculating correlation: the Spearman method and the Pearson method.<sup><a data-type="noteref" href="ch03.html#id418" id="id418-marker">1</a></sup></p>&#13;
&#13;
<p><a contenteditable="false" data-primary="Pearson correlation coefficient" data-type="indexterm" id="id419"/>The <em>Pearson</em> correlation coefficient is a measure of the linear association between two variables calculated from the standard deviation and the covariance between them.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="covariance" data-type="indexterm" id="id420"/><em>Covariance </em>calculates the average of the difference between the means of the two variables. If the two variables have a tendency to move together, the covariance is positive, and if the two variables typically move in opposite directions, the covariance is negative. It ranges between positive infinity and negative infinity.</p>&#13;
&#13;
<p>The formula for calculating the covariance between variables <em>x </em>and <em>y </em>is as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="c o v Subscript x y Baseline equals StartFraction sigma-summation Underscript i equals 1 Overscript n Endscripts left-parenthesis x Subscript i Baseline minus x overbar right-parenthesis left-parenthesis y Subscript i Baseline minus y overbar right-parenthesis Over n EndFraction">&#13;
  <mrow>&#13;
    <mi>c</mi>&#13;
    <mi>o</mi>&#13;
    <msub><mi>v</mi> <mrow><mi>x</mi><mi>y</mi></mrow> </msub>&#13;
    <mo>=</mo>&#13;
    <mstyle displaystyle="false" scriptlevel="0">&#13;
      <mfrac><mrow><msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup><mrow><mo>(</mo><msub><mi>x</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow><mrow><mo>(</mo><msub><mi>y</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>y</mi> <mo>¯</mo></mover><mo>)</mo></mrow></mrow> <mi>n</mi></mfrac>&#13;
    </mstyle>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>Therefore, covariance is the sum of the products of the average deviations between the variables and their respective means (i.e., covariance measures the degree of their association). An average is taken to normalize this calculation. The Pearson <span class="keep-together">correlation</span> coefficient is calculated as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="r Subscript x y Baseline equals StartFraction sigma-summation Underscript i equals 1 Overscript n Endscripts left-parenthesis x Subscript i Baseline minus x overbar right-parenthesis left-parenthesis y Subscript i Baseline minus y overbar right-parenthesis Over StartRoot sigma-summation Underscript i equals 1 Overscript n Endscripts left-parenthesis x Subscript i Baseline minus x overbar right-parenthesis squared EndRoot StartRoot sigma-summation Underscript i equals 1 Overscript n Endscripts left-parenthesis y Subscript i Baseline minus y overbar right-parenthesis squared EndRoot EndFraction">&#13;
  <mrow>&#13;
    <msub><mi>r</mi> <mrow><mi>x</mi><mi>y</mi></mrow> </msub>&#13;
    <mo>=</mo>&#13;
    <mstyle displaystyle="false" scriptlevel="0">&#13;
      <mfrac><mrow><msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup><mrow><mo>(</mo><msub><mi>x</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow><mrow><mo>(</mo><msub><mi>y</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>y</mi> <mo>¯</mo></mover><mo>)</mo></mrow></mrow> <mrow><msqrt><mrow><msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup><msup><mrow><mo>(</mo><msub><mi>x</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>x</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup></mrow></msqrt><msqrt><mrow><msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup><msup><mrow><mo>(</mo><msub><mi>y</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>y</mi> <mo>¯</mo></mover><mo>)</mo></mrow> <mn>2</mn> </msup></mrow></msqrt></mrow></mfrac>&#13;
    </mstyle>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>Simplifying the previous correlation formula gives you the following:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="r Subscript x y Baseline equals StartFraction c o v Subscript x y Baseline Over sigma Subscript x Baseline sigma Subscript y Baseline EndFraction">&#13;
  <mrow>&#13;
    <msub><mi>r</mi> <mrow><mi>x</mi><mi>y</mi></mrow> </msub>&#13;
    <mo>=</mo>&#13;
    <mstyle displaystyle="false" scriptlevel="0">&#13;
      <mfrac><mrow><mi>c</mi><mi>o</mi><msub><mi>v</mi> <mrow><mi>x</mi><mi>y</mi></mrow> </msub></mrow> <mrow><msub><mi>σ</mi> <mi>x</mi> </msub><msub><mi>σ</mi> <mi>y</mi> </msub></mrow></mfrac>&#13;
    </mstyle>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>Therefore, the Pearson correlation coefficient is simply the covariance between two variables divided by the product of their standard deviation. Let’s calculate the correlation between the US CPI year-on-year values and the UK CPI year-on-year values. The intuition is that the correlation is above zero, as the UK and the US are <span class="keep-together">economically</span> related. The following code block calculates the Pearson correlation coefficient for the two time series:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Importing the required libraries</code>&#13;
<code class="kn">import</code> <code class="nn">pandas_datareader</code> <code class="k">as</code> <code class="nn">pdr</code>&#13;
<code class="kn">import</code> <code class="nn">pandas</code> <code class="k">as</code> <code class="nn">pd</code>&#13;
<code class="c1"># Setting the beginning and end of the historical data</code>&#13;
<code class="n">start_date</code> <code class="o">=</code> <code class="s1">'1995-01-01'</code>&#13;
<code class="n">end_date</code>   <code class="o">=</code> <code class="s1">'2022-12-01'</code>&#13;
<code class="c1"># Creating a dataframe and downloading the CPI data</code>&#13;
<code class="n">cpi_us</code> <code class="o">=</code> <code class="n">pdr</code><code class="o">.</code><code class="n">DataReader</code><code class="p">(</code><code class="s1">'CPIAUCSL'</code><code class="p">,</code> <code class="s1">'fred'</code><code class="p">,</code> <code class="n">start_date</code><code class="p">,</code> <code class="n">end_date</code><code class="p">)</code>&#13;
<code class="n">cpi_uk</code> <code class="o">=</code> <code class="n">pdr</code><code class="o">.</code><code class="n">DataReader</code><code class="p">(</code><code class="s1">'GBRCPIALLMINMEI'</code><code class="p">,</code> <code class="s1">'fred'</code><code class="p">,</code> <code class="n">start_date</code><code class="p">,</code> <code class="n">end_date</code><code class="p">)</code>&#13;
<code class="c1"># Dropping the nan values from the rows</code>&#13;
<code class="n">cpi_us</code> <code class="o">=</code> <code class="n">cpi_us</code><code class="o">.</code><code class="n">dropna</code><code class="p">()</code>&#13;
<code class="n">cpi_uk</code> <code class="o">=</code> <code class="n">cpi_uk</code><code class="o">.</code><code class="n">dropna</code><code class="p">()</code>&#13;
<code class="c1"># Transforming the US CPI into a year-on-year measure</code>&#13;
<code class="n">cpi_us</code> <code class="o">=</code> <code class="n">cpi_us</code><code class="o">.</code><code class="n">pct_change</code><code class="p">(</code><code class="n">periods</code> <code class="o">=</code> <code class="mi">12</code><code class="p">,</code> <code class="n">axis</code> <code class="o">=</code> <code class="mi">0</code><code class="p">)</code> <code class="o">*</code> <code class="mi">100</code>&#13;
<code class="n">cpi_us</code> <code class="o">=</code> <code class="n">cpi_us</code><code class="o">.</code><code class="n">dropna</code><code class="p">()</code>&#13;
<code class="c1"># Transforming the UK CPI into a year-on-year measure</code>&#13;
<code class="n">cpi_uk</code> <code class="o">=</code> <code class="n">cpi_uk</code><code class="o">.</code><code class="n">pct_change</code><code class="p">(</code><code class="n">periods</code> <code class="o">=</code> <code class="mi">12</code><code class="p">,</code> <code class="n">axis</code> <code class="o">=</code> <code class="mi">0</code><code class="p">)</code> <code class="o">*</code> <code class="mi">100</code>&#13;
<code class="n">cpi_uk</code> <code class="o">=</code> <code class="n">cpi_uk</code><code class="o">.</code><code class="n">dropna</code><code class="p">()</code>&#13;
<code class="c1"># Joining both CPI data into one dataframe</code>&#13;
<code class="n">combined_cpi_data</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">concat</code><code class="p">([</code><code class="n">cpi_us</code><code class="p">[</code><code class="s1">'CPIAUCSL'</code><code class="p">],</code> &#13;
                               <code class="n">cpi_uk</code><code class="p">[</code><code class="s1">'GBRCPIALLMINMEI'</code><code class="p">]],</code> <code class="n">axis</code> <code class="o">=</code> <code class="mi">1</code><code class="p">)</code>&#13;
<code class="c1"># Calculating Pearson correlation</code>&#13;
<code class="n">combined_cpi_data</code><code class="o">.</code><code class="n">corr</code><code class="p">(</code><code class="n">method</code> <code class="o">=</code> <code class="s1">'pearson'</code><code class="p">)</code>&#13;
</pre>&#13;
&#13;
<p>The output is as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
                 <code class="n">CPIAUCSL</code>  <code class="n">GBRCPIALLMINMEI</code>&#13;
<code class="n">CPIAUCSL</code>         <code class="mf">1.000000</code>         <code class="mf">0.732164</code>&#13;
<code class="n">GBRCPIALLMINMEI</code>  <code class="mf">0.732164</code>         <code class="mf">1.000000</code></pre>&#13;
&#13;
<p>The correlation between the two is a whopping 0.73. This is in line with the expectations. Pearson correlation is usually used with variables that have proportional changes and are normally distributed.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="Spearman's rank correlation" data-type="indexterm" id="Chapter_3.html21"/><em>Spearman’s rank correlation</em> is a nonparametric rank correlation that measures the strength of the relationship between the variables. It is suitable for variables that do not follow a normal distribution.</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Remember, financial returns are not normally distributed but are sometimes treated that way for simplicity.</p>&#13;
</div>&#13;
&#13;
<p>Unlike Pearson correlation, Spearman’s rank correlation takes into account the order of the values, rather than the actual values. To calculate Spearman’s rank correlation, follow these steps:</p>&#13;
&#13;
<ol>&#13;
	<li>&#13;
	<p>Rank the values of each variable. This is done by inputting 1 instead of the smallest variable and inputting the length of the dataset instead of the largest number.</p>&#13;
	</li>&#13;
	<li>&#13;
	<p>Calculate the difference in ranks. Mathematically, the difference in ranks is represented by the letter <em>d</em> in the mathematical formula to come. Then, calculate their squared differences.</p>&#13;
	</li>&#13;
	<li>&#13;
	<p>Sum the squared differences you have calculated from step 2.</p>&#13;
	</li>&#13;
	<li>&#13;
	<p>Use the following formula to calculate Spearman’s rank correlation:</p>&#13;
	<div data-type="equation">&#13;
<p><math alttext="rho equals 1 minus StartFraction 6 sigma-summation Underscript i equals 1 Overscript n Endscripts d Subscript i Superscript 2 Baseline Over n cubed minus n EndFraction">&#13;
  <mrow>&#13;
    <mi>ρ</mi>&#13;
    <mo>=</mo>&#13;
    <mn>1</mn>&#13;
    <mo>-</mo>&#13;
    <mfrac><mrow><mn>6</mn><msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup><msubsup><mi>d</mi> <mrow><mi>i</mi></mrow> <mn>2</mn> </msubsup></mrow> <mrow><msup><mi>n</mi> <mn>3</mn> </msup><mo>-</mo><mi>n</mi></mrow></mfrac>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
	</li>&#13;
</ol>&#13;
&#13;
&#13;
&#13;
<p>As with Pearson correlation, Spearman’s rank correlation also ranges from –1.00 to 1.00 with the same interpretation.</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Strong positive correlations are generally upward of 0.70, while strong negative correlations are generally downward of –0.70.</p>&#13;
</div>&#13;
&#13;
<p>The following code block calculates Spearman’s rank correlation coefficient for the two time series:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Calculating Spearman's rank correlation</code>&#13;
<code class="n">combined_cpi_data</code><code class="o">.</code><code class="n">corr</code><code class="p">(</code><code class="n">method</code> <code class="o">=</code> <code class="s1">'spearman'</code><code class="p">)</code>&#13;
</pre>&#13;
&#13;
<p>The output is as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
                 <code class="n">CPIAUCSL</code>  <code class="n">GBRCPIALLMINMEI</code>&#13;
<code class="n">CPIAUCSL</code>         <code class="mf">1.000000</code>         <code class="mf">0.472526</code>&#13;
<code class="n">GBRCPIALLMINMEI</code>  <code class="mf">0.472526</code>         <code class="mf">1.000000</code></pre>&#13;
&#13;
<p>Let’s answer a very important question after getting this difference in results. Why are the two measures so different?</p>&#13;
&#13;
<p>The first thing to keep in mind is what they measure. Pearson correlation measures the linear relationship (trend) between the variables while Spearman’s rank correlation measures the monotonic trend. The word <em>monotonic </em>refers to moving in the same direction but not exactly at the same rate or magnitude. Also, Spearman’s rank correlation transforms the data to an ordinal type (through the ranks) as opposed to Pearson correlation, which uses the actual values.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html21" data-type="indexterm" id="id421"/></p>&#13;
&#13;
<p><a contenteditable="false" data-primary="autocorrelation" data-type="indexterm" id="id422"/><a contenteditable="false" data-primary="serial correlation (autocorrelation)" data-type="indexterm" id="id423"/><em>Autocorrelation</em> (also referred to as <em>serial correlation</em>) is a statistical method used to look at the relationship between a given time series and a lagged version of it. It is generally used to predict future values through patterns in data, such as seasonality or trends. Autocorrelation is therefore the values’ relationship with the previous <span class="keep-together">values—</span>for example, comparing each day’s Microsoft stock price to the preceding day and seeing if there is a discernible correlation there. Algorithmically speaking, this can be represented as shown in <a data-type="xref" href="#table-3-2">Table 3-2</a>.</p>&#13;
&#13;
<table id="table-3-2">&#13;
	<caption><span class="label">Table 3-2. </span>Lagged values</caption>&#13;
	<thead>&#13;
		<tr>&#13;
			<th>     t</th>&#13;
			<th>     t–1</th>&#13;
		</tr>&#13;
	</thead>&#13;
	<tbody>&#13;
		<tr>&#13;
			<td class="xl65"> $       1.25</td>&#13;
			<td class="xl65"> $       1.65</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td class="xl65"> $       1.77</td>&#13;
			<td class="xl65"> $       1.25</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td class="xl65"> $       1.78</td>&#13;
			<td class="xl65"> $       1.77</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td class="xl65"> $       1.25</td>&#13;
			<td class="xl65"> $       1.78</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td class="xl65"> $       1.90</td>&#13;
			<td class="xl65"> $       1.25</td>&#13;
		</tr>&#13;
	</tbody>&#13;
</table>&#13;
&#13;
<p>Each row represents a time period. Column <em>t </em>is the current price and column <em>t-1</em> is the previous price put on the row that represents the present. This is done when creating machine learning models to understand the relationship between the current values and the previous ones at every time step (row).</p>&#13;
&#13;
<p>Positive autocorrelation frequently occurs in trending assets and is associated with the idea of persistence (trend following). Negative autocorrelation is exhibited in ranging markets and is associated with the idea of antipersistence (mean reversion).</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Measures of short-term correlation between different time series (e.g., NVIDIA and Oracle stocks) are typically computed using returns (such as differences) on prices rather than real prices. However, it is possible to utilize the prices directly to identify long-term trends.</p>&#13;
</div>&#13;
&#13;
<p class="fix_tracking">The following code block calculates the autocorrelation of the US CPI year-on-year <span class="keep-together">values:</span></p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Creating a dataframe and downloading the CPI data</code>&#13;
<code class="n">cpi</code> <code class="o">=</code> <code class="n">pdr</code><code class="o">.</code><code class="n">DataReader</code><code class="p">(</code><code class="s1">'CPIAUCSL'</code><code class="p">,</code> <code class="s1">'fred'</code><code class="p">,</code> <code class="n">start_date</code><code class="p">,</code> <code class="n">end_date</code><code class="p">)</code>&#13;
<code class="c1"># Transforming the US CPI into a year-on-year measure</code>&#13;
<code class="n">cpi</code> <code class="o">=</code> <code class="n">cpi</code><code class="o">.</code><code class="n">pct_change</code><code class="p">(</code><code class="n">periods</code> <code class="o">=</code> <code class="mi">12</code><code class="p">,</code> <code class="n">axis</code> <code class="o">=</code> <code class="mi">0</code><code class="p">)</code> <code class="o">*</code> <code class="mi">100</code>&#13;
<code class="n">cpi</code> <code class="o">=</code> <code class="n">cpi</code><code class="o">.</code><code class="n">dropna</code><code class="p">()</code>&#13;
<code class="c1"># Transforming the data frame to a series structure</code>&#13;
<code class="n">cpi</code> <code class="o">=</code> <code class="n">cpi</code><code class="o">.</code><code class="n">iloc</code><code class="p">[:,</code><code class="mi">0</code><code class="p">]</code>&#13;
<code class="c1"># Calculating autocorrelation with a lag of 1</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'Correlation with a lag of 1 = '</code><code class="p">,</code> <code class="nb">round</code><code class="p">(</code><code class="n">cpi</code><code class="o">.</code><code class="n">autocorr</code><code class="p">(</code><code class="n">lag</code> <code class="o">=</code> <code class="mi">1</code><code class="p">),</code> <code class="mi">2</code><code class="p">))</code>&#13;
<code class="c1"># Calculating autocorrelation with a lag of 6</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'Correlation with a lag of 6 = '</code><code class="p">,</code> <code class="nb">round</code><code class="p">(</code><code class="n">cpi</code><code class="o">.</code><code class="n">autocorr</code><code class="p">(</code><code class="n">lag</code> <code class="o">=</code> <code class="mi">6</code><code class="p">),</code> <code class="mi">2</code><code class="p">))</code>&#13;
<code class="c1"># Calculating autocorrelation with a lag of 12</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'Correlation with a lag of 12 = '</code><code class="p">,</code> <code class="nb">round</code><code class="p">(</code><code class="n">cpi</code><code class="o">.</code><code class="n">autocorr</code><code class="p">(</code><code class="n">lag</code> <code class="o">=</code> <code class="mi">12</code><code class="p">),</code> <code class="mi">2</code><code class="p">))</code>&#13;
</pre>&#13;
&#13;
<p>A lag of 12 means that every data value is compared to the data from 12 periods ago and then a correlation measure is calculated. The output of the code is as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">Correlation</code> <code class="k">with</code> <code class="n">a</code> <code class="n">lag</code> <code class="n">of</code> <code class="mi">1</code> <code class="o">=</code>  <code class="mf">0.97</code>&#13;
<code class="n">Correlation</code> <code class="k">with</code> <code class="n">a</code> <code class="n">lag</code> <code class="n">of</code> <code class="mi">6</code> <code class="o">=</code>  <code class="mf">0.65</code>&#13;
<code class="n">Correlation</code> <code class="k">with</code> <code class="n">a</code> <code class="n">lag</code> <code class="n">of</code> <code class="mi">12</code> <code class="o">=</code>  <code class="mf">0.17</code></pre>&#13;
&#13;
<p>Now, before proceeding to the next section, let’s revert back to information theory and discuss one interesting correlation coefficient that is able to pick up on nonlinear relationships.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="maximal information coefficient (MIC)" data-type="indexterm" id="Chapter_3.html22"/>The <em>maximal information coefficient</em> (MIC) is a nonparametric measure of association between two variables designed to handle large and complex data. It is generally seen as a more robust alternative to traditional measures of correlation, such as Pearson correlation and Spearman’s rank correlation. Introduced by David N. Reshef et al.,<sup><a data-type="noteref" href="ch03.html#id424" id="id424-marker">2</a></sup> the MIC uses concepts from information theory that you saw in <a data-type="xref" href="ch02.html#ch02">Chapter 2</a>.</p>&#13;
&#13;
<p>The MIC measures the strength of the association between two variables by counting the number of cells in a contingency table that are maximally informative about the relationship between the variables. The MIC value ranges from 0 to 1, with higher values indicating stronger associations. It can handle high-dimensional data and can identify nonlinear relationships between variables.</p>&#13;
&#13;
<p>It is, however, nondirectional, which means that values close to 1 only suggest a strong correlation between the two variables; they do not say whether the correlation is positive or negative. In other words, the mutual information between the two variables within each bin is calculated after the range of each variable has been divided into a set of bins. The strength of the association between the two variables is then estimated using the maximum mutual information value across all bins.</p>&#13;
&#13;
<p>Let’s check out a practical example that showcases the strength of the MIC in detecting nonlinear relationships. The following example simulates two wave series (sine and cosine). Intuitively, looking at <a data-type="xref" href="#figure-3-17">Figure 3-17</a>, it seems that there is a lag–lead <span class="keep-together">relationship</span> between the two. </p>&#13;
&#13;
<figure><div class="figure" id="figure-3-17"><img alt="" class="iimagesdlf_0230png" src="assets/dlff_0317.png"/>&#13;
<h6><span class="label">Figure 3-17. </span>The two wave series showing a form of nonlinear relationship</h6>&#13;
</div></figure>&#13;
&#13;
<p>The following Python code snippet creates the two time series and plots <a data-type="xref" href="#figure-3-17">Figure 3-17</a>:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Importing the required libraries</code>&#13;
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>&#13;
<code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code>&#13;
<code class="c1"># Setting the range of the data</code>&#13;
<code class="n">data_range</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">30</code><code class="p">,</code> <code class="mf">0.1</code><code class="p">)</code>&#13;
<code class="c1"># Creating the sine and the cosine waves</code>&#13;
<code class="n">sine</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">data_range</code><code class="p">)</code>&#13;
<code class="n">cosine</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">data_range</code><code class="p">)</code>&#13;
<code class="c1"># Plotting</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sine</code><code class="p">,</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">,</code> <code class="n">label</code> <code class="o">=</code> <code class="s1">'Sine Function'</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">cosine</code><code class="p">,</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'grey'</code><code class="p">,</code> <code class="n">linestyle</code> <code class="o">=</code> <code class="s1">'dashed'</code><code class="p">,</code> &#13;
         <code class="n">label</code> <code class="o">=</code> <code class="s1">'Cosine Function'</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<p>Now the job is to calculate the three correlation measures and analyze their results. For simplicity, the code will be omitted from this section and will be shared in <a data-type="xref" href="ch06.html#ch06">Chapter 6</a>, as there are a few things to understand in Python first. The results are <span class="keep-together">as follows:</span></p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">Correlation</code> <code class="o">|</code> <code class="n">Pearson</code><code class="p">:</code>  <code class="mf">0.035</code>&#13;
<code class="n">Correlation</code> <code class="o">|</code> <code class="n">Spearman</code><code class="p">:</code>  <code class="mf">0.027</code>&#13;
<code class="n">Correlation</code> <code class="o">|</code> <code class="n">MIC</code><code class="p">:</code> <code class="mf">0.602</code></pre>&#13;
&#13;
<p class="pagebreak-before">Let’s interpret the results:</p>&#13;
&#13;
<ul>&#13;
	<li><em>Pearson correlation</em>: Notice the absence of any type of correlation here due to it missing out on the nonlinear association.</li>&#13;
	<li><em>Spearman’s rank correlation</em>: The same situation applies here with an extremely weak correlation.</li>&#13;
	<li><em>MIC</em>: The measure returned a strong relationship of 0.60 between the two, which is closer to reality. It seems that the MIC states that both waves have a strong, albeit nonlinear, relationship.</li>&#13;
</ul>&#13;
&#13;
<p>The MIC is useful in economic analysis, financial analysis, and even finding trading signals if used properly. Nonlinear relationships are abundant in such complex fields, and being able to detect them may provide a sizable edge.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html22" data-type="indexterm" id="id425"/></p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The key takeaways from this section are the following:</p>&#13;
&#13;
<ul>&#13;
	<li>Correlation is a measure that is used to calculate the degree of the linear relationship between variables. It is a number between –1.0 and 1.0, with –1.0 designating a strong negative relationship between the variables and 1.0 designating a strong positive relationship.</li>&#13;
	<li>There are two main types of correlation: Spearman’s rank correlation and Pearson correlation. Both have their advantages and limitations.</li>&#13;
	<li>Autocorrelation is the correlation of the variable with its own lagged values. For example, if the autocorrelation of Walmart’s stock returns is positive, it denotes a trending configuration.</li>&#13;
	<li>Correlation measures can also refer to nonlinear relationships when you use the right tool, for example, the MIC.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html20" data-type="indexterm" id="id426"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html19" data-type="indexterm" id="id427"/></li>&#13;
</ul>&#13;
</div>&#13;
</div></section>&#13;
&#13;
<section data-pdf-bookmark="The Concept of Stationarity" data-type="sect1"><div class="sect1" id="id18">&#13;
<h1>The Concept of Stationarity</h1>&#13;
&#13;
<p><a contenteditable="false" data-primary="descriptive statistics" data-secondary="regression analysis and statistical inference" data-type="indexterm" id="Chapter_3.html23"/><a contenteditable="false" data-primary="descriptive statistics" data-secondary="stationarity" data-type="indexterm" id="Chapter_3.html24"/><a contenteditable="false" data-primary="regression analysis" data-type="indexterm" id="Chapter_3.html25"/><a contenteditable="false" data-primary="stationarity" data-type="indexterm" id="Chapter_3.html26"/><a contenteditable="false" data-primary="statistical analysis, stationarity and" data-type="indexterm" id="Chapter_3.html27"/><a contenteditable="false" data-primary="statistical inference" data-type="indexterm" id="Chapter_3.html28"/>Stationarity is a key concept in statistical analysis and machine learning. <em>Stationarity </em>occurs when the statistical characteristics of the time series (mean, variance, etc.) are constant over time. In other words, no discernable trend is detectable when plotting the data across time.</p>&#13;
&#13;
<p>The different learning models rely on data stationarity, as it is one of the basics of <span class="keep-together">statistical</span> modeling, and this is mainly for simplicity. In finance, price time series are not stationary, as they show trends with varying variance (volatility). Take a look at <a data-type="xref" href="#figure-3-18">Figure 3-18</a> and see if you can detect a trend. Would you say that this time series <span class="keep-together">is stationary?</span></p>&#13;
&#13;
<figure><div class="figure" id="figure-3-18"><img alt="" class="iimagesdlf_0211png" src="assets/dlff_0318.png"/>&#13;
<h6><span class="label">Figure 3-18. </span>Simulated data with a varying mean across time</h6>&#13;
</div></figure>&#13;
&#13;
<p>Naturally, the answer is no, as a rising trend is clearly in progress. States like this are undesirable for statistical analyses and machine learning. Luckily, there are transformations that you can apply to the time series to make them stationary. But first, let’s see how to check for stationarity the mathematical way, as the visual way does not prove anything. The right way to deal with data stationarity problems is to follow these steps:</p>&#13;
&#13;
<ol>&#13;
	<li>Check for stationarity using the different statistical tests that you will see in this section.</li>&#13;
	<li>If the tests show data stationarity, you are ready to use the data for the algorithms. If the tests show that the data is not stationary, you have to proceed to step 3.</li>&#13;
	<li>Subtract every value from the value before it (difference the values).</li>&#13;
	<li>Recheck for stationarity using the same tests on the new transformed data.</li>&#13;
	<li>If the test shows data stationarity, then you have successfully transformed your data. Otherwise, redo the transformation and check again until you have <span class="keep-together">stationary</span> data.</li>&#13;
</ol>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Ascending or descending time series have varying mean and variances through time and are therefore most likely nonstationary. There are exceptions to this, and you will see why later.</p>&#13;
</div>&#13;
&#13;
<p>Remember, the aim of stationarity is stable and constant mean and variance over time. Therefore, when you look at <a data-type="xref" href="#figure-3-19">Figure 3-19</a>, what can you infer?</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-19"><img alt="" src="assets/dlff_0319.png"/>&#13;
<h6><span class="label">Figure 3-19. </span>Simulated data with a mean around zero across time</h6>&#13;
</div></figure>&#13;
&#13;
<p>Visually, it looks like the data does not have a trend, and it also looks like it fluctuates around a stable mean with stable variance around it. The first impression is that the data is stationary. Of course, this must be proved through statistical tests.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="augmented Dickey–Fuller (ADF) test" data-type="indexterm" id="Chapter_3.html29"/><a contenteditable="false" data-primary="ADF (augmented Dickey–Fuller) test" data-type="indexterm" id="Chapter_3.html29a"/>The first and most basic test is the <em>augmented Dickey—Fuller </em>(ADF) test. This tests for stationarity using hypothesis testing.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="unit root" data-type="indexterm" id="id428"/>The ADF test searches for a unit root in the data. A <em>unit root </em>is a property of nonstationary data, and in the context of time series analysis, it refers to a characteristic of a stochastic process where the series has a root equal to 1. In simpler terms, it means that its statistical properties, such as the mean and variance, change over time. Here’s what you need to know:</p>&#13;
&#13;
<ul>&#13;
	<li>The null hypothesis assumes the presence of a unit root. This means that if you are trying to prove that the data is stationary, you are looking to reject the null hypothesis (as seen in <a data-type="xref" href="ch02.html#sampling_and_hypothesis_testing">“Sampling and Hypothesis Testing”</a>).</li>&#13;
	<li>The alternative hypothesis is therefore the absence of a unit root and the <span class="keep-together">stationarity</span> of the data.</li>&#13;
	<li>The p-value obtained from the test must be less than the significance level chosen (in most cases, it is 5%).</li>&#13;
</ul>&#13;
&#13;
<p>Let’s test the US CPI year-on-year data for stationarity. The following code snippet checks for stationarity using the ADF test:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Importing the required library</code>&#13;
<code class="kn">from</code> <code class="nn">statsmodels.tsa.stattools</code> <code class="kn">import</code> <code class="n">adfuller</code>&#13;
<code class="c1"># Applying the ADF test on the CPI data</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'p-value: </code><code class="si">%f</code><code class="s1">'</code> <code class="o">%</code> <code class="n">adfuller</code><code class="p">(</code><code class="n">cpi</code><code class="p">)[</code><code class="mi">1</code><code class="p">])</code>&#13;
</pre>&#13;
&#13;
<p>The output of the code is as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="p">:</code> <code class="mf">0.0152</code></pre>&#13;
&#13;
<p>Assuming a 5% significance level, it seems that it is possible to accept that the year-on-year data is stationary (however, if you want to be stricter and use a 1% significance level, then the p-value suggests that the data is nonstationary). Either way, even looking at the chart can make you scratch your head. Remember that in <a data-type="xref" href="#figure-3-11">Figure 3-11</a>, the yearly changes in the US CPI seem to be stable but do not resemble stationary data. This is why numerical and statistical tests are used.</p>&#13;
&#13;
<p>Now, let’s apply the code on the raw US CPI data and not take the year-on-year changes. Here’s the code:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Creating a dataframe and downloading the CPI data</code>&#13;
<code class="n">cpi</code> <code class="o">=</code> <code class="n">pdr</code><code class="o">.</code><code class="n">DataReader</code><code class="p">(</code><code class="s1">'CPIAUCSL'</code><code class="p">,</code> <code class="s1">'fred'</code><code class="p">,</code> <code class="n">start_date</code><code class="p">,</code> <code class="n">end_date</code><code class="p">)</code>&#13;
<code class="c1"># Applying the ADF test on the CPI data</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'p-value: </code><code class="si">%f</code><code class="s1">'</code> <code class="o">%</code> <code class="n">adfuller</code><code class="p">(</code><code class="n">cpi</code><code class="p">)[</code><code class="mi">1</code><code class="p">])</code>&#13;
</pre>&#13;
&#13;
<p>The output of the code is as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="p">:</code> <code class="mf">0.999</code>&#13;
</pre>&#13;
&#13;
<p>Clearly, the p-value is greater than all the significance levels, which means that the time series is nonstationary. Let’s sum up these results:</p>&#13;
&#13;
<ul>&#13;
	<li>It seems that you can reject the null hypothesis using a 5% significance level when it comes to the year-on-year changes in the US CPI data. The dataset is assumed to be stationary.</li>&#13;
	<li>It seems that you cannot reject the null hypothesis using a 5% significance level when it comes to the raw values of the US CPI data. The dataset is assumed to be nonstationary.</li>&#13;
</ul>&#13;
&#13;
<p>This becomes obvious when you plot the raw values of the US CPI data, as shown in <a data-type="xref" href="#figure-3-20">Figure 3-20</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-20"><img alt="" class="iimagesdlf_5png" src="assets/dlff_0320.png"/>&#13;
<h6><span class="label">Figure 3-20. </span>Absolute values of the US CPI data showing a clearly trending nature</h6>&#13;
</div></figure>&#13;
&#13;
<p><a contenteditable="false" data-primary="Kwiatkowski–Phillips–Schmidt–Shin (KPSS) test" data-type="indexterm" id="Chapter_3.html30"/>The other test that you must be aware of is the <em>Kwiatkowski–Phillips–Schmidt–Shin</em> (KPSS) test, which is also a statistical test with the aim of determining whether the time series is stationary or nonstationary. However, the KPSS test can detect stationarity in trending time series, which makes it a powerful tool.</p>&#13;
&#13;
<p>Trending time series can actually be stationary on the condition they have a stable mean.</p>&#13;
&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p>The ADF test has a null hypothesis that argues for nonstationarity and an alternative hypothesis that argues for stationarity. The KPSS test has a null hypothesis that argues for stationarity and an alternative hypothesis that argues for nonstationarity.</p>&#13;
</div>&#13;
&#13;
<p>Before analyzing the inflation data, let’s see how a trending time series can be stationary. Remember that stationarity refers to a stable mean and standard deviation, so if somehow you have a gradually ascending or descending time series with stable statistical properties, it may be stationary. The next code snippet simulates a sine wave and then adds a touch of trending to it:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Importing the required libraries</code>&#13;
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>&#13;
<code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code>&#13;
<code class="c1"># Creating the first time series using sine waves</code>&#13;
<code class="n">length</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">pi</code> <code class="o">*</code> <code class="mi">2</code> <code class="o">*</code> <code class="mi">5</code>&#13;
<code class="n">sinewave</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="n">length</code><code class="p">,</code> <code class="n">length</code> <code class="o">/</code> <code class="mi">1000</code><code class="p">))</code>&#13;
<code class="c1"># Creating the second time series using trending sine waves</code>&#13;
<code class="n">sinewave_ascending</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="n">length</code><code class="p">,</code> <code class="n">length</code> <code class="o">/</code> <code class="mi">1000</code><code class="p">))</code>&#13;
<code class="c1"># Defining the trend variable</code>&#13;
<code class="n">a</code> <code class="o">=</code> <code class="mf">0.01</code>&#13;
<code class="c1"># Looping to add a trend factor</code>&#13;
<code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">sinewave_ascending</code><code class="p">)):</code> &#13;
    <code class="n">sinewave_ascending</code><code class="p">[</code><code class="n">i</code><code class="p">]</code> <code class="o">=</code> <code class="n">a</code> <code class="o">+</code> <code class="n">sinewave_ascending</code><code class="p">[</code><code class="n">i</code><code class="p">]</code>&#13;
    <code class="n">a</code> <code class="o">=</code> <code class="mf">0.01</code> <code class="o">+</code> <code class="n">a</code>&#13;
</pre>&#13;
&#13;
<p>Plotting the two series, as shown in <a data-type="xref" href="#figure-3-21">Figure 3-21</a>, shows that the trending sine wave seems to be stable. But let’s prove this through statistical tests.</p>&#13;
&#13;
<figure><div class="figure" id="figure-3-21"><img alt="" class="iimagesdlf_6png" src="assets/dlff_0321.png"/>&#13;
<h6><span class="label">Figure 3-21. </span>A normal sine wave simulated series with a trending sine wave</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-type="xref" href="#figure-3-21">Figure 3-21</a> is generated using the following code (make sure you have defined the series using the previous code block):</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Plotting the series</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sinewave</code><code class="p">,</code> <code class="n">label</code> <code class="o">=</code> <code class="s1">'Sine Wave'</code><code class="p">,</code> <code class="n">color</code> <code class="o">=</code> <code class="s1">'black'</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sinewave_ascending</code><code class="p">,</code> <code class="n">label</code> <code class="o">=</code> <code class="s1">'Ascending Sine Wave'</code><code class="p">,</code> &#13;
         <code class="n">color</code> <code class="o">=</code> <code class="s1">'grey'</code><code class="p">)</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code>&#13;
</pre>&#13;
&#13;
<p>Let’s try the ADF test on both series and see what the results are:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># ADF testing | Normal sine wave</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'p-value: </code><code class="si">%f</code><code class="s1">'</code> <code class="o">%</code> <code class="n">adfuller</code><code class="p">(</code><code class="n">sinewave</code><code class="p">)[</code><code class="mi">1</code><code class="p">])</code>&#13;
<code class="c1"># ADF testing | Ascending sine wave</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'p-value: </code><code class="si">%f</code><code class="s1">'</code> <code class="o">%</code> <code class="n">adfuller</code><code class="p">(</code><code class="n">sinewave_ascending</code><code class="p">)[</code><code class="mi">1</code><code class="p">])</code>&#13;
</pre>&#13;
&#13;
<p>The output is as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="p">:</code> <code class="mf">0.000000</code> <code class="c1"># For the sine wave</code>&#13;
<code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="p">:</code> <code class="mf">0.989341</code> <code class="c1"># For the ascending sine wave</code>&#13;
</pre>&#13;
&#13;
<p>Clearly, the ADF test is consistent with the idea that trending markets cannot be stationary.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html30" data-type="indexterm" id="id429"/> But what about the KPSS test? The following code uses the KPSS test on the same data to check for stationarity:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Importing the KPSS library</code><code>&#13;
</code><code class="kn">from</code><code> </code><code class="nn">statsmodels</code><code class="nn">.</code><code class="nn">tsa</code><code class="nn">.</code><code class="nn">stattools</code><code> </code><code class="kn">import</code><code> </code><code class="n">kpss</code><code>&#13;
</code><code class="c1"># KPSS testing | Normal sine wave</code><code>&#13;
</code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">p-value: </code><code class="si">%f</code><code class="s1">'</code><code> </code><code class="o">%</code><code> </code><code class="n">kpss</code><code class="p">(</code><code class="n">sinewave</code><code class="p">)</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code>&#13;
</code><code class="c1"># KPSS testing | Ascending sine wave</code><code>&#13;
</code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">p-value: </code><code class="si">%f</code><code class="s1">'</code><code> </code><code class="o">%</code><code> </code><code class="n">kpss</code><code class="p">(</code><code class="n">sinewave_ascending</code><code class="p">)</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code>&#13;
</code><code class="c1"># KPSS testing while taking into account the trend | Ascending sine wave</code><code>&#13;
</code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">p-value: </code><code class="si">%f</code><code class="s1">'</code><code> </code><code class="o">%</code><code> </code><code class="n">kpss</code><code class="p">(</code><code class="n">sinewave_ascending</code><code class="p">,</code><code> </code><code class="n">regression</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">ct</code><code class="s1">'</code><code class="p">)</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code>&#13;
</code><strong><code class="sd">'''&#13;
The 'ct' argument is used to check if the dataset is stationary &#13;
around a trend. By default, the argument is 'c' which is used&#13;
to check if the data is stationary around a constant.&#13;
'''</code></strong><code>&#13;
</code></pre>&#13;
&#13;
<p>The output is as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="p">:</code> <code class="mf">0.10</code> <code class="c1"># For the sine wave</code>&#13;
<code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="p">:</code> <code class="mf">0.01</code> <code class="c1"># For the ascending sine wave without trend consideration</code>&#13;
<code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="p">:</code> <code class="mf">0.10</code> <code class="c1"># For the ascending sine wave with trend consideration</code>&#13;
</pre>&#13;
&#13;
<p>Remember that the null hypothesis of the KPSS test is that the data is stationary; therefore, if the p-value is greater than the significance level, the data is considered stationary since it is not possible to reject the null hypothesis.</p>&#13;
&#13;
<p>The KPSS statistic, when taking into account the trend, states that the ascending sine wave is a stationary time series. This is a basic example of how you can find stationary data in trending time series.</p>&#13;
&#13;
<p>Let’s test the US CPI year-on-year data for stationarity. The following code snippet checks for stationarity using the KPSS test:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="c1"># Applying the KPSS (no trend consideration) test on the CPI data</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'p-value: </code><code class="si">%f</code><code class="s1">'</code> <code class="o">%</code> <code class="n">kpss</code><code class="p">(</code><code class="n">cpi</code><code class="p">)[</code><code class="mi">1</code><code class="p">])</code>&#13;
<code class="c1"># Applying the KPSS (with trend consideration) test on the CPI data</code>&#13;
<code class="nb">print</code><code class="p">(</code><code class="s1">'p-value: </code><code class="si">%f</code><code class="s1">'</code> <code class="o">%</code> <code class="n">kpss</code><code class="p">(</code><code class="n">cpi</code><code class="p">,</code> <code class="n">regression</code> <code class="o">=</code> <code class="s1">'ct'</code><code class="p">)[</code><code class="mi">1</code><code class="p">])</code>&#13;
</pre>&#13;
&#13;
<p>The output of the code is as follows:</p>&#13;
&#13;
<pre data-code-language="python" data-executable="true" data-type="programlisting">&#13;
<code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="p">:</code> <code class="mf">0.010000</code> <code class="c1"># without trend consideration</code>&#13;
<code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="p">:</code> <code class="mf">0.010000</code> <code class="c1"># with trend consideration</code>&#13;
</pre>&#13;
&#13;
<p>It seems that the results from the KPSS test contradict the results from the ADF test. This may happen from time to time, and differencing may solve the issue (bear in mind that the year-on-year data is already a differenced time series from the absolute CPI values, but some time series may need more than one differencing to become stationary, and it also depends on the period of differencing). The safest solution in this case is to transform the data again.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html29a" data-type="indexterm" id="id430"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html29" data-type="indexterm" id="id431"/></p>&#13;
&#13;
<p>Before finishing this section on stationarity, let’s discuss a complex topic that you will see in action in <a data-type="xref" href="ch09.html#ch09">Chapter 9</a>. Transforming the data may cause the unusual problem of memory loss. In his book <em>Advances in Financial Machine Learning</em> (Wiley), Marcos López de Prado proposed a technique called fractional differentiation with the aim of making data stationary while preserving some memory.</p>&#13;
&#13;
<p>When a nonstationary time series is differenced to make it stationary, memory loss occurs, which is another way of saying that the autocorrelation between the values is greatly reduced, thus removing the trend component and the DNA of the underlying asset. The degree of differencing and the persistence of the autocorrelation structure in the original series determines how much memory loss occurs.</p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The key takeaways from this section are the following:</p>&#13;
&#13;
<ul>&#13;
	<li>Stationarity refers to the concept of stable mean and variance through time. It is a desired characteristic, as most machine learning models rely on it.</li>&#13;
	<li>Financial price time series are most likely nonstationary and require first-order differencing to become stationary and ready for statistical modeling. Some may even require a <span class="keep-together">second</span> order transformation to become stationary.</li>&#13;
	<li>The ADF and KPSS tests check for stationarity in the data, with the latter being able to check for stationarity in trending data.</li>&#13;
	<li>Trending data may be stationary. Although this characteristic is rare, the KPSS test can detect the stationarity, while the ADF test cannot.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html28" data-type="indexterm" id="id432"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html27" data-type="indexterm" id="id433"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html26" data-type="indexterm" id="id434"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html25" data-type="indexterm" id="id435"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html24" data-type="indexterm" id="id436"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html23" data-type="indexterm" id="id437"/></li>&#13;
</ul>&#13;
</div>&#13;
</div></section>&#13;
&#13;
<section data-pdf-bookmark="Regression Analysis and Statistical Inference" data-type="sect1"><div class="sect1" id="regression_analysis">&#13;
<h1>Regression Analysis and Statistical Inference</h1>&#13;
&#13;
<p>Whereas descriptive statistics describe data and extract as much information as possible from it, inferential statistics uses the data or a sample of the data to make inferences (forecasts). The main tool in statistical inference is linear regression.</p>&#13;
&#13;
<p><a contenteditable="false" data-primary="linear regression, defined" data-type="indexterm" id="id438"/><em>Linear regression</em> is a basic machine learning algorithm you will see in this book in <a data-type="xref" href="ch07.html#ch07">Chapter 7</a>, when we cover the other machine learning algorithms. Hence, we will only briefly discuss regression analysis in this section. The most basic form of a linear regression equation is as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="y equals alpha plus beta x plus epsilon">&#13;
  <mrow>&#13;
    <mi>y</mi>&#13;
    <mo>=</mo>&#13;
    <mi>α</mi>&#13;
    <mo>+</mo>&#13;
    <mi>β</mi>&#13;
    <mi>x</mi>&#13;
    <mo>+</mo>&#13;
    <mi>ϵ</mi>&#13;
  </mrow>&#13;
</math></p>&#13;
&#13;
<ul class="simplelist">&#13;
<li class="pagebreak-before less_space"><p><em>y</em> is the dependent variable; it is what you want to forecast</p></li>&#13;
<li><p><em>x</em> is the independent variable; it is what you use as an input to forecast <em>y</em></p></li>&#13;
<li><p>α is the expected value of the dependent variable when the independent <span class="keep-together">variables</span> are equal to zero</p></li>&#13;
<li><p>β represents the change in the dependent variable per unit change in the independent variable</p></li>&#13;
<li><p><math alttext="epsilon">&#13;
  <mi>ϵ</mi>&#13;
</math> is the residual or the unexplained variation</p></li>&#13;
</ul>&#13;
</div>&#13;
&#13;
<p>The basic linear regression equation states that a dependent variable (what you want to forecast) is explained by a constant, a sensitivity-adjusted variable, and a residual (error term to account for unexplained variations). Consider <a data-type="xref" href="#table-3-3">Table 3-3</a>.</p>&#13;
&#13;
<table id="table-3-3">&#13;
	<caption><span class="label">Table 3-3. </span>Predicting <em><span class="plain">y</span></em> given <em><span class="plain">x</span></em></caption>&#13;
	<thead>&#13;
		<tr>&#13;
			<th>y</th>&#13;
			<th>x</th>&#13;
		</tr>&#13;
	</thead>&#13;
	<tbody>&#13;
		<tr>&#13;
			<td class="right">100</td>&#13;
			<td class="right">49</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td class="right">200</td>&#13;
			<td class="right">99</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td class="right">300</td>&#13;
			<td class="right">149</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td class="right">400</td>&#13;
			<td class="right">199</td>&#13;
		</tr>&#13;
		<tr>&#13;
			<td class="right">?</td>&#13;
			<td class="right">249</td>&#13;
		</tr>&#13;
	</tbody>&#13;
</table>&#13;
&#13;
<p>The linear equation to predict <em>y</em> given <em>x</em> is as follows:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="y Subscript i Baseline equals 2 plus 2 x Subscript i">&#13;
  <mrow>&#13;
    <msub><mi>y</mi> <mi>i</mi> </msub>&#13;
    <mo>=</mo>&#13;
    <mn>2</mn>&#13;
    <mo>+</mo>&#13;
    <mn>2</mn>&#13;
    <msub><mi>x</mi> <mi>i</mi> </msub>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>Therefore, the latest <em>y</em> given <em>x</em> = 249 should be 500:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="y Subscript i Baseline equals 2 plus 2 x Subscript i Baseline equals 2 plus left-parenthesis 2 times 249 right-parenthesis equals 500">&#13;
  <mrow>&#13;
    <msub><mi>y</mi> <mi>i</mi> </msub>&#13;
    <mo>=</mo>&#13;
    <mn>2</mn>&#13;
    <mo>+</mo>&#13;
    <mn>2</mn>&#13;
    <msub><mi>x</mi> <mi>i</mi> </msub>&#13;
    <mo>=</mo>&#13;
    <mn>2</mn>&#13;
    <mo>+</mo>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <mn>2</mn>&#13;
      <mo>×</mo>&#13;
      <mn>249</mn>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <mo>=</mo>&#13;
    <mn>500</mn>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p>Notice how linear regression perfectly captures the linear relationship between the two variables since there is no residual (unexplained variations). When a linear regression perfectly captures the relationship between two variables, it means that their coordinate points are perfectly aligned on a linear line across the <em>x</em>-axis.</p>&#13;
&#13;
<p>A multiple linear regression can take the following form:</p>&#13;
&#13;
<div data-type="equation">&#13;
<p><math alttext="y Subscript i Baseline equals alpha plus beta 1 x 1 plus period period period plus beta Subscript n Baseline x Subscript n Baseline plus epsilon Subscript i Baseline">&#13;
  <mrow>&#13;
    <msub><mi>y</mi> <mi>i</mi> </msub>&#13;
    <mo>=</mo>&#13;
    <mi>α</mi>&#13;
    <mo>+</mo>&#13;
    <msub><mi>β</mi> <mn>1</mn> </msub>&#13;
    <msub><mi>x</mi> <mn>1</mn> </msub>&#13;
    <mo>+</mo>&#13;
    <mo lspace="0%" rspace="0%">.</mo>&#13;
    <mo lspace="0%" rspace="0%">.</mo>&#13;
    <mo lspace="0%" rspace="0%">.</mo>&#13;
    <mo>+</mo>&#13;
    <msub><mi>β</mi> <mi>n</mi> </msub>&#13;
    <msub><mi>x</mi> <mi>n</mi> </msub>&#13;
    <mo>+</mo>&#13;
    <msub><mi>ϵ</mi> <mi>i</mi> </msub>&#13;
  </mrow>&#13;
</math></p>&#13;
</div>&#13;
&#13;
<p class="pagebreak-before">This basically means that the dependent variable <em>y</em> may be impacted by more than one variable. For instance, if you want to estimate housing prices, you may want to take into account the number of rooms, the surface area, the neighborhood, and any other variable that is likely to impact the price.  Similarly, if you want to predict <span class="keep-together">commodity</span> prices, you may want to take into account the different macroeconomic factors, exchange rates, and any other alternative data.</p>&#13;
&#13;
<p>It is important to understand what every variable refers to. Linear regression makes a few assumptions:</p>&#13;
&#13;
<dl>&#13;
	<dt>Linear relationship</dt>&#13;
	<dd><p>The relationship between the dependent variable and the independent variable(s) should be linear, meaning that a straight line across the plane can describe the relationship. This is rare in real life when dealing with complex variables.</p></dd>&#13;
</dl>&#13;
&#13;
<dl>&#13;
	<dt>Independence of variables</dt>&#13;
	<dd><p>The observations should be independent of each other, meaning that the value of one observation does not influence the value of another observation.</p></dd>&#13;
</dl>&#13;
&#13;
<dl>&#13;
	<dt>Homoscedasticity</dt>&#13;
	<dd><p>The variance of the residuals (the difference between the predicted and actual values of the dependent variable) should be constant across all levels of the <span class="keep-together">independent</span> variable(s).</p></dd>&#13;
</dl>&#13;
&#13;
<dl>&#13;
	<dt>Normality of the residuals</dt>&#13;
	<dd><p>The residuals should be normally distributed, meaning that the majority of the residuals are close to zero and the distribution is symmetrical.</p></dd>&#13;
</dl>&#13;
&#13;
<p>In the case of a multiple linear regression, you can add a new assumption: the absence of <em>multicollinearity</em>. The independent variables should not be highly <span class="keep-together">correlated</span> with each other; otherwise, it can make it difficult to determine the unique effect of each independent variable on the dependent variable. In other words, this prevents <span class="keep-together">redundancy.</span></p>&#13;
&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The key takeaways from this section are the following:</p>&#13;
&#13;
<ul>&#13;
	<li>Linear regression is part of the inferential statistics field, and it is a linear equation that describes the relationship between variables.</li>&#13;
	<li>Linear regression interprets and predicts data following an equation that you obtain when you train past data and expect the relationship to hold in the future. <a contenteditable="false" data-primary="" data-startref="Chapter_3.html2" data-type="indexterm" id="id439"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html1" data-type="indexterm" id="id440"/><a contenteditable="false" data-primary="" data-startref="Chapter_3.html1a" data-type="indexterm" id="id441"/></li>&#13;
</ul>&#13;
</div>&#13;
</div></section>&#13;
&#13;
<section class="pagebreak-before" data-pdf-bookmark="Summary" data-type="sect1"><div class="sect1" id="id20">&#13;
<h1 class="less_space">Summary</h1>&#13;
&#13;
<p>Being able to perform data analysis is key to deploying the right algorithms so that you can predict the future values of a time series. Understanding data is done through a wide selection of tools coming from the statistics world. Make sure that you understand what stationarity and correlation are, as they offer extremely valuable insights in modeling.<a contenteditable="false" data-primary="" data-startref="Chapter_3.html0" data-type="indexterm" id="id442"/></p>&#13;
</div></section>&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="id418"><sup><a href="ch03.html#id418-marker">1</a></sup> Among others, but these two ways are the most popular representations.</p><p data-type="footnote" id="id424"><sup><a href="ch03.html#id424-marker">2</a></sup> David N. Reshef et al., “Detecting Novel Associations in Large Data Sets,” <em>Science</em> 334, no. 6062 (December 2011): 1518-24.</p></div></div></section></body></html>