<html><head></head><body><section data-pdf-bookmark="Chapter 9. FX Trading with FXCM" data-type="chapter" epub:type="chapter"><div class="chapter" id="fxcm_platform">&#13;
<h1><span class="label">Chapter 9. </span>FX Trading with FXCM</h1>&#13;
&#13;
<blockquote class="align_me_right">&#13;
<p><a data-primary="Carter, Graydon" data-type="indexterm" id="idm45785350125352"/>Financial <a data-primary="FX trading" data-seealso="EUR/USD exchange rate" data-type="indexterm" id="ix_09_forex_with_fxcm_-asciidoc0"/><a data-primary="FXCM" data-secondary="FX trading" data-type="indexterm" id="ix_09_forex_with_fxcm_-asciidoc1"/>institutions like to call what they do trading. Let’s be honest. It’s not trading; it’s betting.</p>&#13;
<p data-type="attribution">Graydon Carter</p>&#13;
</blockquote>&#13;
&#13;
<p>This chapter introduces the trading platform from FXCM Group, LLC (“FXCM” afterwards), with its RESTful and streaming application programming interface (API) as well as the Python wrapper package <code>fcxmpy</code>. Similar to Oanda, it is a platform well suited for the deployment of automated, algorithmic trading strategies, even for retail traders with smaller capital positions. FXCM offers to retail and institutional traders a number of financial products that can be traded both via traditional trading applications and programmatically via their API. The focus of the products lies on currency pairs as well as contracts for difference (CFDs) on, among other things, major stock indices and commodities. In this context, also refer to <a data-type="xref" href="ch08.html#cfds">“Contracts for Difference (CFDs)”</a> and <a data-type="xref" href="#disclaimer">“Disclaimer”</a>.</p>&#13;
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="disclaimer">&#13;
<h5>Disclaimer</h5>&#13;
<p><a data-primary="CFD (contracts for difference)" data-secondary="risks of trading on margin" data-type="indexterm" id="idm45785350880776"/><a data-primary="leveraged trading, risks of" data-type="indexterm" id="idm45785350879768"/><a data-primary="margin trading" data-type="indexterm" id="idm45785350879080"/>Trading forex/CFDs on margin carries a high level of risk and may not be suitable for all investors as you could sustain losses in excess of deposits. Leverage can work against you. The products are intended for retail and professional clients. Due to the certain restrictions imposed by the local law and regulation, German resident retail client(s) could sustain a total loss of deposited funds but are not subject to subsequent payment obligations beyond the deposited funds. Be aware of and fully understand all risks associated with the market and trading. Prior to trading any products, carefully consider your financial situation and experience level. Any opinions, news, research, analyses, prices, or other information is provided as general market commentary and does not constitute investment advice. The market commentary has not been prepared in accordance with legal requirements designed to promote the independence of investment research, and it is therefore not subject to any prohibition on dealing ahead of dissemination. Neither the trading platforms nor the author will accept liability for any loss or damage, including and without limitation to any loss of profit, which may arise directly or indirectly from use of or reliance on such information.</p>&#13;
</div></aside>&#13;
&#13;
<p>With regard to the platform criteria as discussed in <a data-type="xref" href="ch08.html#trading_oanda">Chapter 8</a>, FXCM offers the &#13;
<span class="keep-together">following:</span></p>&#13;
<dl>&#13;
<dt>Instruments</dt>&#13;
<dd>&#13;
<p>FX products (for example, the trading of currency pairs), contracts for difference (CFDs) on stock indices, commodities, or rates products.</p>&#13;
</dd>&#13;
<dt>Strategies</dt>&#13;
<dd>&#13;
<p>FXCM allows for, among other things, (leveraged) long and short positions, market entry orders, and stop loss orders and take profit targets.</p>&#13;
</dd>&#13;
<dt>Costs</dt>&#13;
<dd>&#13;
<p>In addition to the bid-ask spread, a fixed fee is generally due for every trade with FXCM. Different pricing models are available.</p>&#13;
</dd>&#13;
<dt>Technology</dt>&#13;
<dd>&#13;
<p>FXCM provides the algorithmic trader with a modern RESTful API that can be accessed by, for example, the use of the Python wrapper package <code>fxcmpy</code>. Standard trading applications for desktop computers, tablets, and smartphones are also available.</p>&#13;
</dd>&#13;
<dt>Jurisdiction</dt>&#13;
<dd>&#13;
<p>FXCM is active in a number of countries globally (for instance, in the United Kingdom or Germany). Depending on the country itself, certain products might not be available/offered due to regulations and restrictions.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>This chapter covers the basic functionalities of the FXCM trading API and the <code>fxcmpy</code> Python package required to implement an automated, algorithmic trading strategy programmatically. It is structured as follows. <a data-type="xref" href="#tp_start">“Getting Started”</a> shows how to set up everything to work with the FXCM REST API for algorithmic trading. <a data-type="xref" href="#tp_data">“Retrieving Data”</a> shows how to retrieve and work with financial data (down to the tick level). <a data-type="xref" href="#tp_api">“Working with the API”</a> is at the core in that it illustrates typical tasks implemented using the RESTful API, such as retrieving historical and streaming data, placing orders, or looking up account information.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="pagebreak-before less_space" data-pdf-bookmark="Getting Started" data-type="sect1"><div class="sect1" id="tp_start">&#13;
<h1>Getting Started</h1>&#13;
&#13;
<p><a data-primary="FXCM" data-secondary="getting started" data-type="indexterm" id="idm45785351538568"/>A detailed documentation of the FXCM API is found under <a href="https://oreil.ly/Df_7e"><em class="hyperlink">https://oreil.ly/Df_7e</em></a>. <a data-primary="fxcmpy wrapper package" data-secondary="installing" data-type="indexterm" id="idm45785351536376"/>To install the Python wrapper package <code>fxcmpy</code>, execute the following on the shell:</p>&#13;
&#13;
<pre data-type="programlisting">pip install fxcmpy</pre>&#13;
&#13;
<p>The documentation of the <code>fxcmpy</code> package is found under <a href="http://fxcmpy.tpq.io"><em class="hyperlink">http://fxcmpy.tpq.io</em></a>.</p>&#13;
&#13;
<p>To get started with the the FXCM trading API and the <code>fxcmpy</code> package, a free demo account with FXCM is sufficient. One can open such an account under <a href="https://oreil.ly/v9H6z">FXCM Demo Account</a>.<sup><a data-type="noteref" href="ch09.html#idm45785351530440" id="idm45785351530440-marker">1</a></sup> The next step is to create a unique API token (for example, <code>YOUR_FXCM_API_TOKEN</code>) from within the demo account. A connection to the API is then opened, for example, via the following:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="kn">import</code> <code class="nn">fxcmpy</code>&#13;
<code class="n">api</code> <code class="o">=</code> <code class="n">fxcmpy</code><code class="o">.</code><code class="n">fxcmpy</code><code class="p">(</code><code class="n">access_token</code><code class="o">=</code><code class="n">YOUR_FXCM_API_TOKEN</code><code class="p">,</code> <code class="n">log_level</code><code class="o">=</code><code class="s1">'error'</code><code class="p">)</code></pre>&#13;
&#13;
<p>Alternatively, you can use the configuration file as created in <a data-type="xref" href="ch08.html#trading_oanda">Chapter 8</a> to connect to the API. This file’s content should be amended as follows:</p>&#13;
&#13;
<pre data-type="programlisting">[FXCM]&#13;
log_level = error&#13;
log_file = PATH_TO_AND_NAME_OF_LOG_FILE&#13;
access_token = YOUR_FXCM_API_TOKEN</pre>&#13;
&#13;
<p>One can then connect to the API via the following:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="kn">import</code> <code class="nn">fxcmpy</code>&#13;
<code class="n">api</code> <code class="o">=</code> <code class="n">fxcmpy</code><code class="o">.</code><code class="n">fxcmpy</code><code class="p">(</code><code class="n">config_file</code><code class="o">=</code><code class="s1">'pyalgo.cfg'</code><code class="p">)</code></pre>&#13;
&#13;
<p>By default, the server connects to the demo server. However, by the use of the <code>server</code> parameter, the connection can be made to the live trading server (if such an account exists):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">api</code><code> </code><code class="o">=</code><code> </code><code class="n">fxcmpy</code><code class="o">.</code><code class="n">fxcmpy</code><code class="p">(</code><code class="n">config_file</code><code class="o">=</code><code class="s1">'</code><code class="s1">pyalgo.cfg</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">server</code><code class="o">=</code><code class="s1">'</code><code class="s1">demo</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO1-1" id="co_fx_trading_with_fxcm_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code class="n">api</code><code> </code><code class="o">=</code><code> </code><code class="n">fxcmpy</code><code class="o">.</code><code class="n">fxcmpy</code><code class="p">(</code><code class="n">config_file</code><code class="o">=</code><code class="s1">'</code><code class="s1">pyalgo.cfg</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">server</code><code class="o">=</code><code class="s1">'</code><code class="s1">real</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO1-2" id="co_fx_trading_with_fxcm_CO1-2"><img alt="2" src="assets/2.png"/></a></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO1-1" id="callout_fx_trading_with_fxcm_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Connects to the demo server.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO1-2" id="callout_fx_trading_with_fxcm_CO1-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Connects to the live trading server.</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Retrieving Data" data-type="sect1"><div class="sect1" id="tp_data">&#13;
<h1>Retrieving Data</h1>&#13;
&#13;
<p><a data-primary="FXCM" data-secondary="retrieving data" data-type="indexterm" id="ix_09_forex_with_fxcm_-asciidoc2"/>FXCM provides access to historical market price data sets, such as tick data, in a pre-packaged variant. This means that one can retrieve, for instance, compressed files from FXCM servers that contain tick data for the EUR/USD exchange rate for week 10 of 2020. The retrieval of historical candles data from the API is explained in the subsequent section.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Retrieving Tick Data" data-type="sect2"><div class="sect2" id="idm45785350988952">&#13;
<h2>Retrieving Tick Data</h2>&#13;
&#13;
<p><a data-primary="FXCM" data-secondary="retrieving tick data" data-type="indexterm" id="ix_09_forex_with_fxcm_-asciidoc3"/>For a number of currency pairs, FXCM provides historical tick data. <a data-primary="fxcmpy wrapper package" data-secondary="tick data retrieval" data-type="indexterm" id="idm45785350985992"/>The <code>fxcmpy</code> package makes retrieval of such tick data and working with it convenient. First, some imports:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">time</code>&#13;
        <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code>&#13;
        <code class="kn">import</code> <code class="nn">pandas</code> <code class="kn">as</code> <code class="nn">pd</code>&#13;
        <code class="kn">import</code> <code class="nn">datetime</code> <code class="kn">as</code> <code class="nn">dt</code>&#13;
        <code class="kn">from</code> <code class="nn">pylab</code> <code class="kn">import</code> <code class="n">mpl</code><code class="p">,</code> <code class="n">plt</code>&#13;
        <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn'</code><code class="p">)</code>&#13;
        <code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s1">'savefig.dpi'</code><code class="p">]</code> <code class="o">=</code> <code class="mi">300</code>&#13;
        <code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s1">'font.family'</code><code class="p">]</code> <code class="o">=</code> <code class="s1">'serif'</code></pre>&#13;
&#13;
<p>Second is a look at the available <code>symbols</code> (currency pairs) for which tick data is &#13;
<span class="keep-together">available:</span></p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">fxcmpy</code> <code class="kn">import</code> <code class="n">fxcmpy_tick_data_reader</code> <code class="k">as</code> <code class="n">tdr</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="k">print</code><code class="p">(</code><code class="n">tdr</code><code class="o">.</code><code class="n">get_available_symbols</code><code class="p">())</code>&#13;
        <code class="p">(</code><code class="s1">'AUDCAD'</code><code class="p">,</code> <code class="s1">'AUDCHF'</code><code class="p">,</code> <code class="s1">'AUDJPY'</code><code class="p">,</code> <code class="s1">'AUDNZD'</code><code class="p">,</code> <code class="s1">'CADCHF'</code><code class="p">,</code> <code class="s1">'EURAUD'</code><code class="p">,</code> <code class="s1">'EURCHF'</code><code class="p">,</code>&#13;
         <code class="s1">'EURGBP'</code><code class="p">,</code> <code class="s1">'EURJPY'</code><code class="p">,</code> <code class="s1">'EURUSD'</code><code class="p">,</code> <code class="s1">'GBPCHF'</code><code class="p">,</code> <code class="s1">'GBPJPY'</code><code class="p">,</code> <code class="s1">'GBPNZD'</code><code class="p">,</code> <code class="s1">'GBPUSD'</code><code class="p">,</code>&#13;
         <code class="s1">'GBPCHF'</code><code class="p">,</code> <code class="s1">'GBPJPY'</code><code class="p">,</code> <code class="s1">'GBPNZD'</code><code class="p">,</code> <code class="s1">'NZDCAD'</code><code class="p">,</code> <code class="s1">'NZDCHF'</code><code class="p">,</code> <code class="s1">'NZDJPY'</code><code class="p">,</code> <code class="s1">'NZDUSD'</code><code class="p">,</code>&#13;
         <code class="s1">'USDCAD'</code><code class="p">,</code> <code class="s1">'USDCHF'</code><code class="p">,</code> <code class="s1">'USDJPY'</code><code class="p">)</code></pre>&#13;
&#13;
<p>The following code retrieves one week’s worth of tick data for a single symbol. The resulting pandas <code>DataFrame</code> object has more than 4.5 million data rows:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">start</code><code> </code><code class="o">=</code><code> </code><code class="n">dt</code><code class="o">.</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2020</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">25</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO2-1" id="co_fx_trading_with_fxcm_CO2-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>        </code><code class="n">stop</code><code> </code><code class="o">=</code><code> </code><code class="n">dt</code><code class="o">.</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2020</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">30</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO2-1" id="co_fx_trading_with_fxcm_CO2-2"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">td</code><code> </code><code class="o">=</code><code> </code><code class="n">tdr</code><code class="p">(</code><code class="s1">'</code><code class="s1">EURUSD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">start</code><code class="p">,</code><code> </code><code class="n">stop</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO2-1" id="co_fx_trading_with_fxcm_CO2-3"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">td</code><code class="o">.</code><code class="n">get_raw_data</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO2-2" id="co_fx_trading_with_fxcm_CO2-4"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>        </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>        </code><code class="n">Index</code><code class="p">:</code><code> </code><code class="mi">4504288</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mo">03</code><code class="o">/</code><code class="mi">22</code><code class="o">/</code><code class="mi">2020</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">12</code><code class="p">:</code><code class="mf">02.256</code><code> </code><code class="n">to</code><code> </code><code class="mo">03</code><code class="o">/</code><code class="mi">27</code><code class="o">/</code><code class="mi">2020</code><code>&#13;
</code><code>         </code><code class="mi">20</code><code class="p">:</code><code class="mi">59</code><code class="p">:</code><code class="mf">00.022</code><code>&#13;
</code><code>        </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">2</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>         </code><code class="c1">#   Column  Dtype</code><code>&#13;
</code><code>        </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>         </code><code class="mi">0</code><code>   </code><code class="n">Bid</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>         </code><code class="mi">1</code><code>   </code><code class="n">Ask</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>        </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code><code>&#13;
</code><code>        </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">103.1</code><code class="o">+</code><code> </code><code class="n">MB</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">td</code><code class="o">.</code><code class="n">get_data</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO2-3" id="co_fx_trading_with_fxcm_CO2-5"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>        </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>        </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">4504288</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">22</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">12</code><code class="p">:</code><code class="mf">02.256000</code><code> </code><code class="n">to</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">27</code><code> </code><code class="mi">20</code><code class="p">:</code><code class="mi">59</code><code class="p">:</code><code class="mf">00.022000</code><code>&#13;
</code><code>        </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">2</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>         </code><code class="c1">#   Column  Dtype</code><code>&#13;
</code><code>        </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>         </code><code class="mi">0</code><code>   </code><code class="n">Bid</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>         </code><code class="mi">1</code><code>   </code><code class="n">Ask</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>        </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code><code>&#13;
</code><code>        </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">103.1</code><code> </code><code class="n">MB</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">td</code><code class="o">.</code><code class="n">get_data</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code>                              </code><code class="n">Bid</code><code>      </code><code class="n">Ask</code><code>&#13;
</code><code>        </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">22</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">12</code><code class="p">:</code><code class="mf">02.256</code><code>  </code><code class="mf">1.07006</code><code>  </code><code class="mf">1.07050</code><code>&#13;
</code><code>        </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">22</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">12</code><code class="p">:</code><code class="mf">02.258</code><code>  </code><code class="mf">1.07002</code><code>  </code><code class="mf">1.07050</code><code>&#13;
</code><code>        </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">22</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">12</code><code class="p">:</code><code class="mf">02.259</code><code>  </code><code class="mf">1.07003</code><code>  </code><code class="mf">1.07033</code><code>&#13;
</code><code>        </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">22</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">12</code><code class="p">:</code><code class="mf">02.653</code><code>  </code><code class="mf">1.07003</code><code>  </code><code class="mf">1.07034</code><code>&#13;
</code><code>        </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">22</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">12</code><code class="p">:</code><code class="mf">02.749</code><code>  </code><code class="mf">1.07000</code><code>  </code><code class="mf">1.07034</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO2-1" id="callout_fx_trading_with_fxcm_CO2-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>This retrieves the data file, unpacks it, and stores the raw data in a <code>DataFrame</code> object (as an attribute to the resulting object).</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO2-4" id="callout_fx_trading_with_fxcm_CO2-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p><a data-primary=".get_raw_data() method" data-primary-sortas="get_raw_data" data-type="indexterm" id="idm45785351878280"/>The <code>.get_raw_data()</code> method returns the <code>DataFrame</code> object with the raw data for which the index values are still <code>str</code> objects.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO2-5" id="callout_fx_trading_with_fxcm_CO2-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p><a data-primary=".get_data() method" data-primary-sortas="get_data" data-type="indexterm" id="idm45785351977944"/>The <code>.get_data()</code> method returns a <code>DataFrame</code> object for which the index has been transformed to a <code>DatetimeIndex</code>.<sup><a data-type="noteref" href="ch09.html#idm45785350353608" id="idm45785350353608-marker">2</a></sup></p></dd>&#13;
</dl>&#13;
&#13;
<p>Since the tick data is stored in a <code>DataFrame</code> object, it is straightforward to pick a sub-set of the data and to implement typical financial analytics tasks on it. <a data-primary="EUR/USD exchange rate" data-secondary="historical tick data for" data-type="indexterm" id="idm45785350351544"/><a data-type="xref" href="#fxcm_01">Figure 9-1</a> shows a plot of the mid prices derived for the sub-set and a simple moving average (SMA):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">9</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sub</code><code> </code><code class="o">=</code><code> </code><code class="n">td</code><code class="o">.</code><code class="n">get_data</code><code class="p">(</code><code class="n">start</code><code class="o">=</code><code class="s1">'</code><code class="s1">2020-03-25 12:00:00</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                          </code><code class="n">end</code><code class="o">=</code><code class="s1">'</code><code class="s1">2020-03-25 12:15:00</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO3-1" id="co_fx_trading_with_fxcm_CO3-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sub</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code>                              </code><code class="n">Bid</code><code>     </code><code class="n">Ask</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">25</code><code> </code><code class="mi">12</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mf">00.067</code><code>  </code><code class="mf">1.08109</code><code>  </code><code class="mf">1.0811</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">25</code><code> </code><code class="mi">12</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mf">00.072</code><code>  </code><code class="mf">1.08110</code><code>  </code><code class="mf">1.0811</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">25</code><code> </code><code class="mi">12</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mf">00.074</code><code>  </code><code class="mf">1.08109</code><code>  </code><code class="mf">1.0811</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">25</code><code> </code><code class="mi">12</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mf">00.078</code><code>  </code><code class="mf">1.08111</code><code>  </code><code class="mf">1.0811</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">25</code><code> </code><code class="mi">12</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mf">00.121</code><code>  </code><code class="mf">1.08112</code><code>  </code><code class="mf">1.0811</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sub</code><code class="p">[</code><code class="s1">'</code><code class="s1">Mid</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">sub</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="n">axis</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO3-2" id="co_fx_trading_with_fxcm_CO3-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">12</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sub</code><code class="p">[</code><code class="s1">'</code><code class="s1">SMA</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">sub</code><code class="p">[</code><code class="s1">'</code><code class="s1">Mid</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">rolling</code><code class="p">(</code><code class="mi">1000</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO3-3" id="co_fx_trading_with_fxcm_CO3-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">13</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sub</code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">Mid</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">SMA</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">lw</code><code class="o">=</code><code class="mf">1.5</code><code class="p">)</code><code class="p">;</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO3-1" id="callout_fx_trading_with_fxcm_CO3-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Picks a sub-set of the complete data set.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO3-2" id="callout_fx_trading_with_fxcm_CO3-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Calculates the mid prices from the bid and ask prices.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO3-3" id="callout_fx_trading_with_fxcm_CO3-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Derives SMA values over intervals of 1,000 ticks.<a data-startref="ix_09_forex_with_fxcm_-asciidoc3" data-type="indexterm" id="idm45785346871080"/></p></dd>&#13;
</dl>&#13;
&#13;
<figure><div class="figure" id="fxcm_01">&#13;
<img alt="pfat 0901" src="assets/pfat_0901.png"/>&#13;
<h6><span class="label">Figure 9-1. </span>Historical mid tick prices for EUR/USD and SMA</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Retrieving Candles Data" data-type="sect2"><div class="sect2" id="idm45785350988360">&#13;
<h2>Retrieving Candles Data</h2>&#13;
&#13;
<p><a data-primary="FXCM" data-secondary="retrieving candles data" data-type="indexterm" id="ix_09_forex_with_fxcm_-asciidoc4"/>In addition, FXCM provides access to historical candles data (beyond the API). Candles data is data for certain homogeneous time intervals (“bars”) with open, high, low, and close values for both bid and ask prices.</p>&#13;
&#13;
<p>First is a look at the available symbols for which candles data is provided:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">fxcmpy</code> <code class="kn">import</code> <code class="n">fxcmpy_candles_data_reader</code> <code class="k">as</code> <code class="n">cdr</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="k">print</code><code class="p">(</code><code class="n">cdr</code><code class="o">.</code><code class="n">get_available_symbols</code><code class="p">())</code>&#13;
         <code class="p">(</code><code class="s1">'AUDCAD'</code><code class="p">,</code> <code class="s1">'AUDCHF'</code><code class="p">,</code> <code class="s1">'AUDJPY'</code><code class="p">,</code> <code class="s1">'AUDNZD'</code><code class="p">,</code> <code class="s1">'CADCHF'</code><code class="p">,</code> <code class="s1">'EURAUD'</code><code class="p">,</code> <code class="s1">'EURCHF'</code><code class="p">,</code>&#13;
          <code class="s1">'EURGBP'</code><code class="p">,</code> <code class="s1">'EURJPY'</code><code class="p">,</code> <code class="s1">'EURUSD'</code><code class="p">,</code> <code class="s1">'GBPCHF'</code><code class="p">,</code> <code class="s1">'GBPJPY'</code><code class="p">,</code> <code class="s1">'GBPNZD'</code><code class="p">,</code> <code class="s1">'GBPUSD'</code><code class="p">,</code>&#13;
          <code class="s1">'GBPCHF'</code><code class="p">,</code> <code class="s1">'GBPJPY'</code><code class="p">,</code> <code class="s1">'GBPNZD'</code><code class="p">,</code> <code class="s1">'NZDCAD'</code><code class="p">,</code> <code class="s1">'NZDCHF'</code><code class="p">,</code> <code class="s1">'NZDJPY'</code><code class="p">,</code> <code class="s1">'NZDUSD'</code><code class="p">,</code>&#13;
          <code class="s1">'USDCAD'</code><code class="p">,</code> <code class="s1">'USDCHF'</code><code class="p">,</code> <code class="s1">'USDJPY'</code><code class="p">)</code></pre>&#13;
&#13;
<p class="pagebreak-before">Second, the data retrieval itself. It is similar to the the tick data retrieval. The only difference is that a <code>period</code> value, or the bar length, needs to be specified (for example, <code>m1</code> for one minute, <code>H1</code> for one hour, or <code>D1</code> for one day):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">16</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">start</code><code> </code><code class="o">=</code><code> </code><code class="n">dt</code><code class="o">.</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2020</code><code class="p">,</code><code> </code><code class="mi">4</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">stop</code><code> </code><code class="o">=</code><code> </code><code class="n">dt</code><code class="o">.</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2020</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">17</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">period</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">H1</code><code class="s1">'</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO4-1" id="co_fx_trading_with_fxcm_CO4-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">18</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">candles</code><code> </code><code class="o">=</code><code> </code><code class="n">cdr</code><code class="p">(</code><code class="s1">'</code><code class="s1">EURUSD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">start</code><code class="p">,</code><code> </code><code class="n">stop</code><code class="p">,</code><code> </code><code class="n">period</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">candles</code><code class="o">.</code><code class="n">get_data</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">20</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>         </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">600</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">03</code><code class="o">-</code><code class="mi">29</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code> </code><code class="n">to</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">20</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>         </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">8</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>          </code><code class="c1">#   Column    Non-Null Count  Dtype</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>    </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>          </code><code class="mi">0</code><code>   </code><code class="n">BidOpen</code><code>   </code><code class="mi">600</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">1</code><code>   </code><code class="n">BidHigh</code><code>   </code><code class="mi">600</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">2</code><code>   </code><code class="n">BidLow</code><code>    </code><code class="mi">600</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">3</code><code>   </code><code class="n">BidClose</code><code>  </code><code class="mi">600</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">4</code><code>   </code><code class="n">AskOpen</code><code>   </code><code class="mi">600</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">5</code><code>   </code><code class="n">AskHigh</code><code>   </code><code class="mi">600</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">6</code><code>   </code><code class="n">AskLow</code><code>    </code><code class="mi">600</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">7</code><code>   </code><code class="n">AskClose</code><code>  </code><code class="mi">600</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>         </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">8</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">42.2</code><code> </code><code class="n">KB</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">21</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">data</code><code class="o">.</code><code class="n">columns</code><code class="p">[</code><code class="p">:</code><code class="mi">4</code><code class="p">]</code><code class="p">]</code><code class="o">.</code><code class="n">tail</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO4-2" id="co_fx_trading_with_fxcm_CO4-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">21</code><code class="p">]</code><code class="p">:</code><code>                      </code><code class="n">BidOpen</code><code>  </code><code class="n">BidHigh</code><code>   </code><code class="n">BidLow</code><code>  </code><code class="n">BidClose</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">16</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1.09976</code><code>  </code><code class="mf">1.09996</code><code>  </code><code class="mf">1.09850</code><code>   </code><code class="mf">1.09874</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">17</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1.09874</code><code>  </code><code class="mf">1.09888</code><code>  </code><code class="mf">1.09785</code><code>   </code><code class="mf">1.09818</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">18</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1.09818</code><code>  </code><code class="mf">1.09820</code><code>  </code><code class="mf">1.09757</code><code>   </code><code class="mf">1.09766</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1.09766</code><code>  </code><code class="mf">1.09816</code><code>  </code><code class="mf">1.09747</code><code>   </code><code class="mf">1.09793</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">20</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1.09793</code><code>  </code><code class="mf">1.09812</code><code>  </code><code class="mf">1.09730</code><code>   </code><code class="mf">1.09788</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">data</code><code class="o">.</code><code class="n">columns</code><code class="p">[</code><code class="mi">4</code><code class="p">:</code><code class="p">]</code><code class="p">]</code><code class="o">.</code><code class="n">tail</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO4-3" id="co_fx_trading_with_fxcm_CO4-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code>                      </code><code class="n">AskOpen</code><code>  </code><code class="n">AskHigh</code><code>   </code><code class="n">AskLow</code><code>  </code><code class="n">AskClose</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">16</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1.09980</code><code>  </code><code class="mf">1.09998</code><code>  </code><code class="mf">1.09853</code><code>   </code><code class="mf">1.09876</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">17</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1.09876</code><code>  </code><code class="mf">1.09891</code><code>  </code><code class="mf">1.09786</code><code>   </code><code class="mf">1.09818</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">18</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1.09818</code><code>  </code><code class="mf">1.09822</code><code>  </code><code class="mf">1.09758</code><code>   </code><code class="mf">1.09768</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1.09768</code><code>  </code><code class="mf">1.09818</code><code>  </code><code class="mf">1.09748</code><code>   </code><code class="mf">1.09795</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">20</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1.09795</code><code>  </code><code class="mf">1.09856</code><code>  </code><code class="mf">1.09733</code><code>   </code><code class="mf">1.09841</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO4-1" id="callout_fx_trading_with_fxcm_CO4-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Specifies the <code>period</code> value.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO4-2" id="callout_fx_trading_with_fxcm_CO4-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Open, high, low, and close values for the <em>bid</em> prices.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO4-3" id="callout_fx_trading_with_fxcm_CO4-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Open, high, low, and close values for the <em>ask</em> prices.</p></dd>&#13;
</dl>&#13;
&#13;
<p><a data-primary="EUR/USD exchange rate" data-secondary="historical candles data for" data-type="indexterm" id="idm45785346324168"/>To conclude this section, the Python code that follows and calculates mid close prices, calculates two SMAs, and plots the results (see <a data-type="xref" href="#fxcm_02">Figure 9-2</a>):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">23</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">MidClose</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">BidClose</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">AskClose</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="n">axis</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO5-1" id="co_fx_trading_with_fxcm_CO5-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">SMA1</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">MidClose</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">rolling</code><code class="p">(</code><code class="mi">30</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO5-2" id="co_fx_trading_with_fxcm_CO5-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>         </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">SMA2</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">MidClose</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">rolling</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO5-2" id="co_fx_trading_with_fxcm_CO5-3"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">MidClose</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">SMA1</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">SMA2</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="p">;</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO5-1" id="callout_fx_trading_with_fxcm_CO5-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Calculates the mid close prices from the bid and ask close prices.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO5-2" id="callout_fx_trading_with_fxcm_CO5-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Calculates two SMAs: one for a shorter time interval, and one for a longer one<a data-startref="ix_09_forex_with_fxcm_-asciidoc4" data-type="indexterm" id="idm45785346520152"/>.<a data-startref="ix_09_forex_with_fxcm_-asciidoc2" data-type="indexterm" id="idm45785346519352"/></p></dd>&#13;
</dl>&#13;
&#13;
<figure><div class="figure" id="fxcm_02">&#13;
<img alt="pfat 0902" src="assets/pfat_0902.png"/>&#13;
<h6><span class="label">Figure 9-2. </span>Historical hourly mid close prices for EUR/USD and two SMAs</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Working with the API" data-type="sect1"><div class="sect1" id="tp_api">&#13;
<h1>Working with the API</h1>&#13;
&#13;
<p><a data-primary="FXCM" data-secondary="working with the API" data-type="indexterm" id="ix_09_forex_with_fxcm_-asciidoc5"/>While the previous sections retrieve historical tick data and candles data pre-packaged from FXCM servers, this section shows how to retrieve historical data via the API. However, a connection object to the FXCM API is needed. Therefore, first, here is the import of the <code>fxcmpy</code> package, the connection to the API (based on the unique API token), and a look at the available instruments. There might be more instruments available as compared to the pre-packaged data sets:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">fxcmpy</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">fxcmpy</code><code class="o">.</code><code class="n">__version__</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">1.2.6</code><code class="s1">'</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code> </code><code class="o">=</code><code> </code><code class="n">fxcmpy</code><code class="o">.</code><code class="n">fxcmpy</code><code class="p">(</code><code class="n">config_file</code><code class="o">=</code><code class="s1">'</code><code class="s1">../pyalgo.cfg</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO6-1" id="co_fx_trading_with_fxcm_CO6-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">29</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">instruments</code><code> </code><code class="o">=</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_instruments</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">print</code><code class="p">(</code><code class="n">instruments</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="p">[</code><code class="s1">'</code><code class="s1">EUR/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USD/JPY</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">GBP/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USD/CHF</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">EUR/CHF</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">AUD/USD</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">USD/CAD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">NZD/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">EUR/GBP</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">EUR/JPY</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">GBP/JPY</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">CHF/JPY</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">GBP/CHF</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">EUR/AUD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">EUR/CAD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">AUD/CAD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">AUD/JPY</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">CAD/JPY</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">NZD/JPY</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">GBP/CAD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">GBP/NZD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">GBP/AUD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">AUD/NZD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USD/SEK</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">EUR/SEK</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">EUR/NOK</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USD/NOK</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USD/MXN</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">AUD/CHF</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">EUR/NZD</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">USD/ZAR</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USD/HKD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ZAR/JPY</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USD/TRY</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">EUR/TRY</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">NZD/CHF</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">CAD/CHF</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">NZD/CAD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">TRY/JPY</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USD/ILS</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USD/CNH</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">AUS200</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">ESP35</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">FRA40</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">GER30</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">HKG33</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">JPN225</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">NAS100</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">SPX500</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">UK100</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">US30</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">Copper</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">CHN50</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">EUSTX50</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USDOLLAR</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">US2000</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">USOil</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">UKOil</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">SOYF</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">NGAS</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USOilSpot</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">UKOilSpot</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">WHEATF</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">CORNF</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">Bund</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">XAU/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">XAG/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">EMBasket</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">JPYBasket</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">BTC/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">BCH/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ETH/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">LTC/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">XRP/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">CryptoMajor</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">EOS/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">XLM/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ESPORTS</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">BIOTECH</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">CANNABIS</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">FAANG</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">CHN.TECH</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">CHN.ECOMM</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">USEquities</code><code class="s1">'</code><code class="p">]</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO6-1" id="callout_fx_trading_with_fxcm_CO6-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>This connects to the API; adjust the path/filename.</p></dd>&#13;
</dl>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Retrieving Historical Data" data-type="sect2"><div class="sect2" id="idm45785343821736">&#13;
<h2>Retrieving Historical Data</h2>&#13;
&#13;
<p><a data-primary="EUR/USD exchange rate" data-secondary="historical ask close prices" data-type="indexterm" id="ix_09_forex_with_fxcm_-asciidoc6"/><a data-primary="FXCM" data-secondary="retrieving historical data" data-type="indexterm" id="ix_09_forex_with_fxcm_-asciidoc7"/>Once connected, data retrieval for specific time intervals is accomplished via a single method call. <a data-primary=".get_candles() method" data-primary-sortas="get_candles" data-type="indexterm" id="idm45785343832552"/>When using the <code>.get_candles()</code> method, the parameter <code>period</code> can be one of <code>m1</code>, <code>m5</code>, <code>m15</code>, <code>m30</code>, <code>H1</code>, <code>H2</code>, <code>H3</code>, <code>H4</code>, <code>H6</code>, <code>H8</code>, <code>D1</code>, <code>W1</code>, or <code>M1</code>. <a data-type="xref" href="#fxcm_03">Figure 9-3</a> shows one-minute bar ask close prices for the <code>EUR/USD</code> instrument (currency pair):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">31</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">candles</code><code> </code><code class="o">=</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_candles</code><code class="p">(</code><code class="s1">'</code><code class="s1">USD/JPY</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">period</code><code class="o">=</code><code class="s1">'</code><code class="s1">D1</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">number</code><code class="o">=</code><code class="mi">10</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO7-1" id="co_fx_trading_with_fxcm_CO7-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">candles</code><code class="p">[</code><code class="n">candles</code><code class="o">.</code><code class="n">columns</code><code class="p">[</code><code class="p">:</code><code class="mi">4</code><code class="p">]</code><code class="p">]</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO7-1" id="co_fx_trading_with_fxcm_CO7-2"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code>                      </code><code class="n">bidopen</code><code>  </code><code class="n">bidclose</code><code>  </code><code class="n">bidhigh</code><code>   </code><code class="n">bidlow</code><code>&#13;
</code><code>         </code><code class="n">date</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mo">07</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">105.538</code><code>   </code><code class="mf">105.898</code><code>  </code><code class="mf">106.051</code><code>  </code><code class="mf">105.452</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">09</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">105.871</code><code>   </code><code class="mf">105.846</code><code>  </code><code class="mf">105.871</code><code>  </code><code class="mf">105.844</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">10</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">105.846</code><code>   </code><code class="mf">105.914</code><code>  </code><code class="mf">106.197</code><code>  </code><code class="mf">105.702</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">11</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">105.914</code><code>   </code><code class="mf">106.466</code><code>  </code><code class="mf">106.679</code><code>  </code><code class="mf">105.870</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">12</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">106.466</code><code>   </code><code class="mf">106.848</code><code>  </code><code class="mf">107.009</code><code>  </code><code class="mf">106.434</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">13</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">106.848</code><code>   </code><code class="mf">106.893</code><code>  </code><code class="mf">107.044</code><code>  </code><code class="mf">106.560</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">106.893</code><code>   </code><code class="mf">106.535</code><code>  </code><code class="mf">107.033</code><code>  </code><code class="mf">106.429</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">17</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">106.559</code><code>   </code><code class="mf">105.960</code><code>  </code><code class="mf">106.648</code><code>  </code><code class="mf">105.937</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">18</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">105.960</code><code>   </code><code class="mf">105.378</code><code>  </code><code class="mf">106.046</code><code>  </code><code class="mf">105.277</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">105.378</code><code>   </code><code class="mf">105.528</code><code>  </code><code class="mf">105.599</code><code>  </code><code class="mf">105.097</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">candles</code><code class="p">[</code><code class="n">candles</code><code class="o">.</code><code class="n">columns</code><code class="p">[</code><code class="mi">4</code><code class="p">:</code><code class="p">]</code><code class="p">]</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO7-1" id="co_fx_trading_with_fxcm_CO7-3"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code>                      </code><code class="n">askopen</code><code>  </code><code class="n">askclose</code><code>  </code><code class="n">askhigh</code><code>   </code><code class="n">asklow</code><code>  </code><code class="n">tickqty</code><code>&#13;
</code><code>         </code><code class="n">date</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mo">07</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">105.557</code><code>   </code><code class="mf">105.969</code><code>  </code><code class="mf">106.062</code><code>  </code><code class="mf">105.484</code><code>   </code><code class="mi">253759</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">09</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">105.983</code><code>   </code><code class="mf">105.952</code><code>  </code><code class="mf">105.989</code><code>  </code><code class="mf">105.925</code><code>       </code><code class="mi">20</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">10</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">105.952</code><code>   </code><code class="mf">105.986</code><code>  </code><code class="mf">106.209</code><code>  </code><code class="mf">105.715</code><code>   </code><code class="mi">161841</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">11</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">105.986</code><code>   </code><code class="mf">106.541</code><code>  </code><code class="mf">106.689</code><code>  </code><code class="mf">105.929</code><code>   </code><code class="mi">243813</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">12</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">106.541</code><code>   </code><code class="mf">106.950</code><code>  </code><code class="mf">107.022</code><code>  </code><code class="mf">106.447</code><code>   </code><code class="mi">248989</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">13</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">106.950</code><code>   </code><code class="mf">106.983</code><code>  </code><code class="mf">107.056</code><code>  </code><code class="mf">106.572</code><code>   </code><code class="mi">214735</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">106.983</code><code>   </code><code class="mf">106.646</code><code>  </code><code class="mf">107.044</code><code>  </code><code class="mf">106.442</code><code>   </code><code class="mi">164244</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">17</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">106.680</code><code>   </code><code class="mf">106.047</code><code>  </code><code class="mf">106.711</code><code>  </code><code class="mf">105.948</code><code>   </code><code class="mi">163629</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">18</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">106.047</code><code>   </code><code class="mf">105.431</code><code>  </code><code class="mf">106.101</code><code>  </code><code class="mf">105.290</code><code>   </code><code class="mi">215574</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">105.431</code><code>   </code><code class="mf">105.542</code><code>  </code><code class="mf">105.612</code><code>  </code><code class="mf">105.109</code><code>   </code><code class="mi">151255</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">34</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">start</code><code> </code><code class="o">=</code><code> </code><code class="n">dt</code><code class="o">.</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2019</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO7-2" id="co_fx_trading_with_fxcm_CO7-4"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>         </code><code class="n">end</code><code> </code><code class="o">=</code><code> </code><code class="n">dt</code><code class="o">.</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2020</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO7-2" id="co_fx_trading_with_fxcm_CO7-5"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">candles</code><code> </code><code class="o">=</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_candles</code><code class="p">(</code><code class="s1">'</code><code class="s1">EUR/GBP</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">period</code><code class="o">=</code><code class="s1">'</code><code class="s1">D1</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                   </code><code class="n">start</code><code class="o">=</code><code class="n">start</code><code class="p">,</code><code> </code><code class="n">stop</code><code class="o">=</code><code class="n">end</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO7-2" id="co_fx_trading_with_fxcm_CO7-6"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">36</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">candles</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO7-2" id="co_fx_trading_with_fxcm_CO7-7"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>         </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>         </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">438</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2019</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">02</code><code> </code><code class="mi">22</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code> </code><code class="n">to</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">06</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>         </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">9</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>          </code><code class="c1">#   Column    Non-Null Count  Dtype</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>    </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>          </code><code class="mi">0</code><code>   </code><code class="n">bidopen</code><code>   </code><code class="mi">438</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">1</code><code>   </code><code class="n">bidclose</code><code>  </code><code class="mi">438</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">2</code><code>   </code><code class="n">bidhigh</code><code>   </code><code class="mi">438</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">3</code><code>   </code><code class="n">bidlow</code><code>    </code><code class="mi">438</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">4</code><code>   </code><code class="n">askopen</code><code>   </code><code class="mi">438</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">5</code><code>   </code><code class="n">askclose</code><code>  </code><code class="mi">438</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">6</code><code>   </code><code class="n">askhigh</code><code>   </code><code class="mi">438</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">7</code><code>   </code><code class="n">asklow</code><code>    </code><code class="mi">438</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">8</code><code>   </code><code class="n">tickqty</code><code>   </code><code class="mi">438</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>&#13;
</code><code>         </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">8</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">int64</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">34.2</code><code> </code><code class="n">KB</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">37</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">candles</code><code> </code><code class="o">=</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_candles</code><code class="p">(</code><code class="s1">'</code><code class="s1">EUR/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">period</code><code class="o">=</code><code class="s1">'</code><code class="s1">m1</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">number</code><code class="o">=</code><code class="mi">250</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO7-3" id="co_fx_trading_with_fxcm_CO7-8"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">38</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">candles</code><code class="p">[</code><code class="s1">'</code><code class="s1">askclose</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO7-1" id="callout_fx_trading_with_fxcm_CO7-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Retrieves the 10 most recent end-of-day prices.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO7-4" id="callout_fx_trading_with_fxcm_CO7-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Retrieves end-of-day prices for a whole year.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO7-8" id="callout_fx_trading_with_fxcm_CO7-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Retrieves the most recent one-minute bar prices available.</p></dd>&#13;
</dl>&#13;
<div data-type="caution">&#13;
<p>Historical data retrieved from the FXCM RESTful API can change with the pricing model of the account. In particular, the average bid-ask spreads can be higher or lower for different pricing models offered by FXCM to different groups of traders.<a data-startref="ix_09_forex_with_fxcm_-asciidoc7" data-type="indexterm" id="idm45785345606712"/><a data-startref="ix_09_forex_with_fxcm_-asciidoc6" data-type="indexterm" id="idm45785345606040"/></p>&#13;
</div>&#13;
&#13;
<figure><div class="figure" id="fxcm_03">&#13;
<img alt="pfat 0903" src="assets/pfat_0903.png"/>&#13;
<h6><span class="label">Figure 9-3. </span>Historical ask close prices for EUR/USD (minute bars)</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Retrieving Streaming Data" data-type="sect2"><div class="sect2" id="tp_streaming">&#13;
<h2>Retrieving Streaming Data</h2>&#13;
&#13;
<p><a data-primary="EUR/USD exchange rate" data-secondary="retrieving streaming data for" data-type="indexterm" id="idm45785345293128"/><a data-primary="FXCM" data-secondary="retrieving streaming data" data-type="indexterm" id="idm45785345291960"/>While <em>historical</em> data is important to, for example, backtest algorithmic trading strategies, continuous access to <em>real-time or streaming</em> data (during trading hours) is required to deploy and automate algorithmic trading strategies. Similar to the Oanda API, the FXCM API therefore also allows for the subscription to real-time data streams for all instruments. <a data-primary="callback functions" data-type="indexterm" id="idm45785345618392"/><a data-primary="fxcmpy wrapper package" data-secondary="callback functions" data-type="indexterm" id="idm45785345617688"/>The <code>fxcmpy</code> wrapper package supports this functionality in that it allows one to provide user-defined functions (so called <em>callback functions</em>) to process the subscribed real-time data stream.</p>&#13;
&#13;
<p>The following Python code presents such a simple callback function—it only prints out selected elements of the data set retrieved—and uses it to process data retrieved in real time, after a subscription for the desired instrument (here <code>EUR/USD</code>):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">output</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="n">dataframe</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>             </code><code class="k">print</code><code class="p">(</code><code class="s1">'</code><code class="si">%3d</code><code class="s1"> | </code><code class="si">%s</code><code class="s1"> | </code><code class="si">%s</code><code class="s1"> | </code><code class="si">%6.5f</code><code class="s1">, </code><code class="si">%6.5f</code><code class="s1">'</code><code>&#13;
</code><code>                   </code><code class="o">%</code><code> </code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">dataframe</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">Symbol</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>                      </code><code class="n">pd</code><code class="o">.</code><code class="n">to_datetime</code><code class="p">(</code><code class="nb">int</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">Updated</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">unit</code><code class="o">=</code><code class="s1">'</code><code class="s1">ms</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                      </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">Rates</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">Rates</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO8-1" id="co_fx_trading_with_fxcm_CO8-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">40</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">subscribe_market_data</code><code class="p">(</code><code class="s1">'</code><code class="s1">EUR/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="p">(</code><code class="n">output</code><code class="p">,</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO8-2" id="co_fx_trading_with_fxcm_CO8-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>           </code><code class="mi">2</code><code> </code><code class="o">|</code><code> </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">|</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">14</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">36.204000</code><code> </code><code class="o">|</code><code> </code><code class="mf">1.19319</code><code class="p">,</code><code> </code><code class="mf">1.19331</code><code>&#13;
</code><code>           </code><code class="mi">3</code><code> </code><code class="o">|</code><code> </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">|</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">14</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">37.005000</code><code> </code><code class="o">|</code><code> </code><code class="mf">1.19320</code><code class="p">,</code><code> </code><code class="mf">1.19331</code><code>&#13;
</code><code>           </code><code class="mi">4</code><code> </code><code class="o">|</code><code> </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">|</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">14</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">37.940000</code><code> </code><code class="o">|</code><code> </code><code class="mf">1.19323</code><code class="p">,</code><code> </code><code class="mf">1.19333</code><code>&#13;
</code><code>           </code><code class="mi">5</code><code> </code><code class="o">|</code><code> </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">|</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">14</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">38.429000</code><code> </code><code class="o">|</code><code> </code><code class="mf">1.19321</code><code class="p">,</code><code> </code><code class="mf">1.19332</code><code>&#13;
</code><code>           </code><code class="mi">6</code><code> </code><code class="o">|</code><code> </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">|</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">14</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">38.915000</code><code> </code><code class="o">|</code><code> </code><code class="mf">1.19323</code><code class="p">,</code><code> </code><code class="mf">1.19334</code><code>&#13;
</code><code>           </code><code class="mi">7</code><code> </code><code class="o">|</code><code> </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">|</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">14</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">39.436000</code><code> </code><code class="o">|</code><code> </code><code class="mf">1.19321</code><code class="p">,</code><code> </code><code class="mf">1.19332</code><code>&#13;
</code><code>           </code><code class="mi">8</code><code> </code><code class="o">|</code><code> </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">|</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">14</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">39.883000</code><code> </code><code class="o">|</code><code> </code><code class="mf">1.19317</code><code class="p">,</code><code> </code><code class="mf">1.19328</code><code>&#13;
</code><code>           </code><code class="mi">9</code><code> </code><code class="o">|</code><code> </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">|</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">14</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">40.437000</code><code> </code><code class="o">|</code><code> </code><code class="mf">1.19317</code><code class="p">,</code><code> </code><code class="mf">1.19328</code><code>&#13;
</code><code>          </code><code class="mi">10</code><code> </code><code class="o">|</code><code> </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">|</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">14</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">40.810000</code><code> </code><code class="o">|</code><code> </code><code class="mf">1.19318</code><code class="p">,</code><code> </code><code class="mf">1.19329</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">41</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_last_price</code><code class="p">(</code><code class="s1">'</code><code class="s1">EUR/USD</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO8-3" id="co_fx_trading_with_fxcm_CO8-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">41</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">Bid</code><code>     </code><code class="mf">1.19318</code><code>&#13;
</code><code>         </code><code class="n">Ask</code><code>     </code><code class="mf">1.19329</code><code>&#13;
</code><code>         </code><code class="n">High</code><code>    </code><code class="mf">1.19534</code><code>&#13;
</code><code>         </code><code class="n">Low</code><code>     </code><code class="mf">1.19217</code><code>&#13;
</code><code>         </code><code class="n">Name</code><code class="p">:</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">14</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">40.810000</code><code class="p">,</code><code> </code><code class="n">dtype</code><code class="p">:</code><code> </code><code class="n">float64</code><code>&#13;
</code><code>&#13;
</code><code>          </code><code class="mi">11</code><code> </code><code class="o">|</code><code> </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">|</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">19</code><code> </code><code class="mi">14</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">41.410000</code><code> </code><code class="o">|</code><code> </code><code class="mf">1.19319</code><code class="p">,</code><code> </code><code class="mf">1.19329</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">42</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">unsubscribe_market_data</code><code class="p">(</code><code class="s1">'</code><code class="s1">EUR/USD</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO8-4" id="co_fx_trading_with_fxcm_CO8-4"><img alt="4" src="assets/4.png"/></a></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO8-1" id="callout_fx_trading_with_fxcm_CO8-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>This is the callback function that prints out certain elements of the retrieved data set.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO8-2" id="callout_fx_trading_with_fxcm_CO8-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Here is the subscription to a specific real-time data stream. Data is processed asynchronously as long as there is no “unsubscribe” event.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO8-3" id="callout_fx_trading_with_fxcm_CO8-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p><a data-primary=".get_last_price() method" data-primary-sortas="get_last_price" data-type="indexterm" id="idm45785344187880"/>During the subscription, the <code>.get_last_price()</code> method returns the last available data set.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO8-4" id="callout_fx_trading_with_fxcm_CO8-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>This unsubscribes from the real-time data stream.</p></dd>&#13;
</dl>&#13;
<div data-type="tip"><h1>Callback Functions</h1>&#13;
<p>Callback functions are a flexible way to process real-time streaming data based on a Python function or even multiple such functions. They can be used for simple tasks, such as the printing of incoming data, or complex tasks, such as generating trading signals based on online trading algorithms.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Placing Orders" data-type="sect2"><div class="sect2" id="idm45785343179192">&#13;
<h2>Placing Orders</h2>&#13;
&#13;
<p><a data-primary="EUR/USD exchange rate" data-secondary="placing orders" data-type="indexterm" id="ix_09_forex_with_fxcm_-asciidoc8"/><a data-primary="FXCM" data-secondary="placing orders" data-type="indexterm" id="ix_09_forex_with_fxcm_-asciidoc9"/>The FXCM API allows for the placement and management of all types of orders that are also available via the trading application of FXCM (such as entry orders or trailing stop loss orders).<sup><a data-type="noteref" href="ch09.html#idm45785344248888" id="idm45785344248888-marker">3</a></sup> However, the following code illustrates basic market buy and sell orders only since they are generally sufficient to at least get started with algorithmic trading.</p>&#13;
&#13;
<p class="pagebreak-before">The following code first verifies that there are no open positions and then opens different positions via the <a data-primary=".create_market_buy_order() method" data-primary-sortas="create_market_buy_order" data-type="indexterm" id="idm45785343343944"/><code>.create_market_buy_order()</code> method:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">43</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_open_positions</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO9-1" id="co_fx_trading_with_fxcm_CO9-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">43</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">Empty</code><code> </code><code class="n">DataFrame</code><code>&#13;
</code><code>         </code><code class="n">Columns</code><code class="p">:</code><code> </code><code class="p">[</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="n">Index</code><code class="p">:</code><code> </code><code class="p">[</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">44</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">order</code><code> </code><code class="o">=</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">create_market_buy_order</code><code class="p">(</code><code class="s1">'</code><code class="s1">EUR/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">100</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO9-2" id="co_fx_trading_with_fxcm_CO9-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">45</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sel</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">tradeId</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">amountK</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">currency</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                </code><code class="s1">'</code><code class="s1">grossPL</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">isBuy</code><code class="s1">'</code><code class="p">]</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO9-3" id="co_fx_trading_with_fxcm_CO9-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">46</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_open_positions</code><code class="p">(</code><code class="p">)</code><code class="p">[</code><code class="n">sel</code><code class="p">]</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO9-3" id="co_fx_trading_with_fxcm_CO9-4"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">46</code><code class="p">]</code><code class="p">:</code><code>      </code><code class="n">tradeId</code><code>  </code><code class="n">amountK</code><code> </code><code class="n">currency</code><code>  </code><code class="n">grossPL</code><code>  </code><code class="n">isBuy</code><code>&#13;
</code><code>         </code><code class="mi">0</code><code>  </code><code class="mi">169122817</code><code>      </code><code class="mi">100</code><code>  </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">-</code><code class="mf">9.21945</code><code>   </code><code class="bp">True</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">47</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">order</code><code> </code><code class="o">=</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">create_market_buy_order</code><code class="p">(</code><code class="s1">'</code><code class="s1">EUR/GBP</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">50</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO9-4" id="co_fx_trading_with_fxcm_CO9-5"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">48</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_open_positions</code><code class="p">(</code><code class="p">)</code><code class="p">[</code><code class="n">sel</code><code class="p">]</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">48</code><code class="p">]</code><code class="p">:</code><code>      </code><code class="n">tradeId</code><code>  </code><code class="n">amountK</code><code> </code><code class="n">currency</code><code>  </code><code class="n">grossPL</code><code>  </code><code class="n">isBuy</code><code>&#13;
</code><code>         </code><code class="mi">0</code><code>  </code><code class="mi">169122817</code><code>      </code><code class="mi">100</code><code>  </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">-</code><code class="mf">8.38125</code><code>   </code><code class="bp">True</code><code>&#13;
</code><code>         </code><code class="mi">1</code><code>  </code><code class="mi">169122819</code><code>       </code><code class="mi">50</code><code>  </code><code class="n">EUR</code><code class="o">/</code><code class="n">GBP</code><code> </code><code class="o">-</code><code class="mf">9.40900</code><code>   </code><code class="bp">True</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO9-1" id="callout_fx_trading_with_fxcm_CO9-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Shows the open positions for the connected (default) account.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO9-2" id="callout_fx_trading_with_fxcm_CO9-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Opens a position of 100,000 in the <code>EUR/USD</code> currency pair.<sup><a data-type="noteref" href="ch09.html#idm45785343218824" id="idm45785343218824-marker">4</a></sup></p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO9-3" id="callout_fx_trading_with_fxcm_CO9-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Shows the open positions for selected elements only.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO9-5" id="callout_fx_trading_with_fxcm_CO9-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Opens another position of 50,000 in the <code>EUR/GBP</code> currency pair.</p></dd>&#13;
</dl>&#13;
&#13;
<p>While the <code>.create_market_buy_order()</code> opens or increases positions, the <code>.create_market_sell_order()</code> allows one to close or decrease positions. There are also more general methods that allow the closing out of positions, as the following code illustrates:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">49</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">order</code><code> </code><code class="o">=</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">create_market_sell_order</code><code class="p">(</code><code class="s1">'</code><code class="s1">EUR/USD</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">25</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO10-1" id="co_fx_trading_with_fxcm_CO10-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">50</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">order</code><code> </code><code class="o">=</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">create_market_buy_order</code><code class="p">(</code><code class="s1">'</code><code class="s1">EUR/GBP</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">50</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO10-2" id="co_fx_trading_with_fxcm_CO10-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">51</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_open_positions</code><code class="p">(</code><code class="p">)</code><code class="p">[</code><code class="n">sel</code><code class="p">]</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO10-3" id="co_fx_trading_with_fxcm_CO10-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">51</code><code class="p">]</code><code class="p">:</code><code>      </code><code class="n">tradeId</code><code>  </code><code class="n">amountK</code><code> </code><code class="n">currency</code><code>   </code><code class="n">grossPL</code><code>  </code><code class="n">isBuy</code><code>&#13;
</code><code>         </code><code class="mi">0</code><code>  </code><code class="mi">169122817</code><code>      </code><code class="mi">100</code><code>  </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code>  </code><code class="o">-</code><code class="mf">7.54306</code><code>   </code><code class="bp">True</code><code>&#13;
</code><code>         </code><code class="mi">1</code><code>  </code><code class="mi">169122819</code><code>       </code><code class="mi">50</code><code>  </code><code class="n">EUR</code><code class="o">/</code><code class="n">GBP</code><code> </code><code class="o">-</code><code class="mf">11.62340</code><code>   </code><code class="bp">True</code><code>&#13;
</code><code>         </code><code class="mi">2</code><code>  </code><code class="mi">169122834</code><code>       </code><code class="mi">25</code><code>  </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code>  </code><code class="o">-</code><code class="mf">2.30463</code><code>  </code><code class="bp">False</code><code>&#13;
</code><code>         </code><code class="mi">3</code><code>  </code><code class="mi">169122835</code><code>       </code><code class="mi">50</code><code>  </code><code class="n">EUR</code><code class="o">/</code><code class="n">GBP</code><code>  </code><code class="o">-</code><code class="mf">9.96292</code><code>   </code><code class="bp">True</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">52</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">close_all_for_symbol</code><code class="p">(</code><code class="s1">'</code><code class="s1">EUR/GBP</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO10-4" id="co_fx_trading_with_fxcm_CO10-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">53</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_open_positions</code><code class="p">(</code><code class="p">)</code><code class="p">[</code><code class="n">sel</code><code class="p">]</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">53</code><code class="p">]</code><code class="p">:</code><code>      </code><code class="n">tradeId</code><code>  </code><code class="n">amountK</code><code> </code><code class="n">currency</code><code>  </code><code class="n">grossPL</code><code>  </code><code class="n">isBuy</code><code>&#13;
</code><code>         </code><code class="mi">0</code><code>  </code><code class="mi">169122817</code><code>      </code><code class="mi">100</code><code>  </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">-</code><code class="mf">5.02858</code><code>   </code><code class="bp">True</code><code>&#13;
</code><code>         </code><code class="mi">1</code><code>  </code><code class="mi">169122834</code><code>       </code><code class="mi">25</code><code>  </code><code class="n">EUR</code><code class="o">/</code><code class="n">USD</code><code> </code><code class="o">-</code><code class="mf">3.14257</code><code>  </code><code class="bp">False</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">54</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">close_all</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO10-5" id="co_fx_trading_with_fxcm_CO10-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">55</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_open_positions</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">55</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">Empty</code><code> </code><code class="n">DataFrame</code><code>&#13;
</code><code>         </code><code class="n">Columns</code><code class="p">:</code><code> </code><code class="p">[</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="n">Index</code><code class="p">:</code><code> </code><code class="p">[</code><code class="p">]</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO10-1" id="callout_fx_trading_with_fxcm_CO10-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Reduces the position in the <code>EUR/USD</code> currency pair.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO10-2" id="callout_fx_trading_with_fxcm_CO10-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Increases the position in the <code>EUR/GBP</code> currency pair.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO10-3" id="callout_fx_trading_with_fxcm_CO10-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>For <code>EUR/GBP</code> there are now two open long positions; contrary to the <code>EUR/USD</code> position, it is not netted.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO10-4" id="callout_fx_trading_with_fxcm_CO10-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>The <code>.close_all_for_symbol()</code> method closes all positions for the specified symbol.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO10-5" id="callout_fx_trading_with_fxcm_CO10-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p><a data-primary=".close_all() method" data-primary-sortas="close_all" data-type="indexterm" id="idm45785346038792"/>The <code>.close_all()</code> method closes all open positions at once.</p></dd>&#13;
</dl>&#13;
<div data-type="note" epub:type="note">&#13;
<p>By default, FXCM sets up demo accounts as <em>hedge accounts</em>. This means that going long, say EUR/USD, with 10,000 and going short the same instrument with 10,000 leads to two different open positions. The default with Oanda are <em>net accounts</em> that net orders and positions for the same instrument.<a data-startref="ix_09_forex_with_fxcm_-asciidoc9" data-type="indexterm" id="idm45785346277272"/><a data-startref="ix_09_forex_with_fxcm_-asciidoc8" data-type="indexterm" id="idm45785346276552"/></p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Account Information" data-type="sect2"><div class="sect2" id="idm45785346275608">&#13;
<h2>Account Information</h2>&#13;
&#13;
<p><a data-primary="FXCM" data-secondary="retrieving account information" data-type="indexterm" id="idm45785346274552"/>Beyond, for example, open positions, the FXCM API allows one to retrieve more general account informationm, as well. For example, one can look up the default account (if there are multiple accounts) or an overview equity and margin situation:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">56</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_default_account</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO11-1" id="co_fx_trading_with_fxcm_CO11-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">56</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mi">1233279</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">57</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">api</code><code class="o">.</code><code class="n">get_accounts</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">T</code><code>  </code><a class="co" href="#callout_fx_trading_with_fxcm_CO11-2" id="co_fx_trading_with_fxcm_CO11-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">57</code><code class="p">]</code><code class="p">:</code><code>                           </code><code class="mi">0</code><code>&#13;
</code><code>         </code><code class="n">t</code><code>                         </code><code class="mi">6</code><code>&#13;
</code><code>         </code><code class="n">ratePrecision</code><code>             </code><code class="mi">0</code><code>&#13;
</code><code>         </code><code class="n">accountId</code><code>           </code><code class="mi">1233279</code><code>&#13;
</code><code>         </code><code class="n">balance</code><code>             </code><code class="mf">47555.2</code><code>&#13;
</code><code>         </code><code class="n">usdMr</code><code>                     </code><code class="mi">0</code><code>&#13;
</code><code>         </code><code class="n">mc</code><code>                        </code><code class="n">N</code><code>&#13;
</code><code>         </code><code class="n">mcDate</code><code>&#13;
</code><code>         </code><code class="n">accountName</code><code>        </code><code class="mo">0123327</code><code class="mi">9</code><code>&#13;
</code><code>         </code><code class="n">usdMr3</code><code>                    </code><code class="mi">0</code><code>&#13;
</code><code>         </code><code class="n">hedging</code><code>                   </code><code class="n">Y</code><code>&#13;
</code><code>         </code><code class="n">usableMargin3</code><code>       </code><code class="mf">47555.2</code><code>&#13;
</code><code>         </code><code class="n">usableMarginPerc</code><code>        </code><code class="mi">100</code><code>&#13;
</code><code>         </code><code class="n">usableMargin3Perc</code><code>       </code><code class="mi">100</code><code>&#13;
</code><code>         </code><code class="n">equity</code><code>              </code><code class="mf">47555.2</code><code>&#13;
</code><code>         </code><code class="n">usableMargin</code><code>        </code><code class="mf">47555.2</code><code>&#13;
</code><code>         </code><code class="n">bus</code><code>                    </code><code class="mi">1000</code><code>&#13;
</code><code>         </code><code class="n">dayPL</code><code>                </code><code class="mf">653.16</code><code>&#13;
</code><code>         </code><code class="n">grossPL</code><code>                   </code><code class="mi">0</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO11-1" id="callout_fx_trading_with_fxcm_CO11-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Shows the default <code>accountId</code> value.</p></dd>&#13;
<dt><a class="co" href="#co_fx_trading_with_fxcm_CO11-2" id="callout_fx_trading_with_fxcm_CO11-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Shows for all accounts the financial situation and some parameters.<a data-startref="ix_09_forex_with_fxcm_-asciidoc5" data-type="indexterm" id="idm45785346091304"/></p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Conclusions" data-type="sect1"><div class="sect1" id="idm45785346090200">&#13;
<h1>Conclusions</h1>&#13;
&#13;
<p>This chapter is about the RESTful API of FXCM for algorithmic trading and covers the following topics:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Setting everything up for API usage</p>&#13;
</li>&#13;
<li>&#13;
<p>Retrieving historical tick data</p>&#13;
</li>&#13;
<li>&#13;
<p>Retrieving historical candles data</p>&#13;
</li>&#13;
<li>&#13;
<p>Retrieving streaming data in real-time</p>&#13;
</li>&#13;
<li>&#13;
<p>Placing market buy and sell orders</p>&#13;
</li>&#13;
<li>&#13;
<p>Looking up account information</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Beyond these aspects, the FXCM API and the <code>fxcmpy</code> wrapper package provide, of course, more functionality. However, the topics of this chapter are the basic building blocks needed to get started with algorithmic trading.</p>&#13;
&#13;
<p>With Oanda and FXCM, algorithmic traders have two trading platforms (brokers) available that provide a wide-ranging spectrum of financial instruments and appropriate APIs to implement automated, algorithmic trading strategies. Some important aspects are added to the mix in <a data-type="xref" href="ch10.html#automated_trading">Chapter 10</a>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="References and Further Resources" data-type="sect1"><div class="sect1" id="idm45785343041192">&#13;
<h1>References and Further Resources</h1>&#13;
&#13;
<p>The following resources cover the FXCM trading API and the Python wrapper &#13;
<span class="keep-together">package:</span></p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Trading API: <a href="https://fxcm.github.io/rest-api-docs"><em class="hyperlink">https://fxcm.github.io/rest-api-docs</em></a></p>&#13;
</li>&#13;
<li>&#13;
<p><code>fxcmpy</code> package<a data-startref="ix_09_forex_with_fxcm_-asciidoc1" data-type="indexterm" id="idm45785343036152"/><a data-startref="ix_09_forex_with_fxcm_-asciidoc0" data-type="indexterm" id="idm45785343035352"/>: <a href="http://fxcmpy.tpq.io"><em class="hyperlink">http://fxcmpy.tpq.io</em></a></p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45785351530440"><sup><a href="ch09.html#idm45785351530440-marker">1</a></sup> Note that FXCM demo accounts are only offered for certain countries.</p><p data-type="footnote" id="idm45785350353608"><sup><a href="ch09.html#idm45785350353608-marker">2</a></sup> The <code>DatetimeIndex</code> conversion is time consuming, which is why there are two different methods related to tick data retrieval.</p><p data-type="footnote" id="idm45785344248888"><sup><a href="ch09.html#idm45785344248888-marker">3</a></sup> See the documentation under <a href="http://fxcmpy.tpq.io"><em class="hyperlink">http://fxcmpy.tpq.io</em></a>.</p><p data-type="footnote" id="idm45785343218824"><sup><a href="ch09.html#idm45785343218824-marker">4</a></sup> Quantities are in 1,000s of the instrument for currency pairs. Also, note that different accounts might have different leverage ratios. This implies that the same position might require more or less equity (margin) depending on the relevant leverage ratio. Adjust the example quantities to lower values if necessary. See <a href="https://oreil.ly/xUHMP"><em class="hyperlink">https://oreil.ly/xUHMP</em></a>.</p></div></div></section></body></html>