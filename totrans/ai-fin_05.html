<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 3. Normative Finance"><div class="chapter" id="normative_finance">
<h1><span class="label">Chapter 3. </span>Normative Finance</h1>

<blockquote>
<p class="align_me_right">The CAPM is based on many unrealistic assumptions. For example, the assumption that investors care only about the mean and variance of one-period portfolio returns is extreme.</p>
<p data-type="attribution">Eugene Fama and Kenneth French (2004)</p>
</blockquote>
<blockquote>
<p>[S]ciences that involve human beings rather than elementary particles have proven more resistant to elegant mathematics.</p>
<p data-type="attribution">Alon Halevy et al. (2009)</p>
</blockquote>

<p><a data-type="indexterm" data-primary="normative financial theories and models" id="ix_norm_fin_theory_ch3"/>This chapter reviews major normative financial theories and models. Simply speaking and for the purposes of this book, a <em>normative theory</em> is one that is based on assumptions (mathematically, axioms) and derives insights, results, and more from the set of relevant assumptions. <a data-type="indexterm" data-primary="positive versus normative financial theory" id="idm45625332592504"/>On the other hand, a <em>positive theory</em> is one that is based on observation, experiments, data, relationships, and the like and describes phenomena given the insights gained from the available information and the derived results. Rubinstein (2006) provides a detailed historical account of the origins of the theories and models presented in this chapter.</p>

<p><a data-type="xref" href="#uncertainty_risk">“Uncertainty and Risk”</a> introduces central notions from financial modeling, such as uncertainty, risk, traded assets, and so on. <a data-type="xref" href="#eu_theory">“Expected Utility Theory”</a> discusses the major economic paradigm for decision making under uncertainty: <em>expected utility theory</em> (EUT). In its modern form, EUT dates back to von Neumann and Morgenstern (1944). <a data-type="xref" href="#mvp_theory">“Mean-Variance Portfolio Theory”</a> introduces the mean-variance portfolio (MVP) theory according to Markowitz (1952). <a data-type="xref" href="#cap_model">“Capital Asset Pricing Model”</a> analyzes the <em>capital asset pricing model</em> (CAPM) according to Sharpe (1964) and Lintner (1965). <a data-type="xref" href="#ap_theory">“Arbitrage Pricing Theory”</a> sketches the <em>arbitrage pricing theory</em> (APT) according to Ross (1971, 1976).</p>

<p>This chapter’s purpose is to set the stage for the rest of the book in the form of central normative financial theories. This is important because generations of economists, financial analysts, asset managers, traders, bankers, accountants, and others have been trained in these theories. In that sense, it is safe to say that finance as both a theoretical and practical discipline has been shaped by these theories to a large extent.</p>






<section data-type="sect1" data-pdf-bookmark="Uncertainty and Risk"><div class="sect1" id="uncertainty_risk">
<h1>Uncertainty and Risk</h1>

<p><a data-type="indexterm" data-primary="normative financial theories and models" data-secondary="uncertainty and risk" id="ix_norm_fin_uncertain"/><a data-type="indexterm" data-primary="uncertainty and risk" data-seealso="risk management" id="idm45625332673128"/>At its core, financial theory deals with investment, trading, and valuation in the presence of uncertainty and risk. This section introduces on a somewhat formal level 
<span class="keep-together">central</span> notions related to these topics. The focus is on fundamental concepts from probability theory that build the backbone of quantitative finance.<sup><a data-type="noteref" id="idm45625332671048-marker" href="ch03.xhtml#idm45625332671048">1</a></sup></p>








<section data-type="sect2" data-pdf-bookmark="Definitions"><div class="sect2" id="idm45625332670360">
<h2>Definitions</h2>

<p>Assume an economy for which activity is only observed at two points in time: today, <math alttext="t equals 0">
  <mrow>
    <mi>t</mi>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math>,  and one year later, <math alttext="t equals 1">
  <mrow>
    <mi>t</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>. <a data-type="indexterm" data-primary="static economy" id="idm45625332663624"/>The financial theories discussed later in this chapter are to a large extent based on such a <em>static economy</em>.<sup><a data-type="noteref" id="idm45625332662264-marker" href="ch03.xhtml#idm45625332662264">2</a></sup></p>

<p>At <math alttext="t equals 0">
  <mrow>
    <mi>t</mi>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math>, there is no uncertainty whatsoever. <a data-type="indexterm" data-primary="state space" id="idm45625332657928"/>At <math alttext="t equals 1">
  <mrow>
    <mi>t</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>, the economy can take on a finite number <math alttext="upper S">
  <mi>S</mi>
</math> of possible states <math alttext="omega element-of normal upper Omega equals StartSet omega 1 comma omega 2 comma ellipsis comma omega Subscript upper S Baseline EndSet">
  <mrow>
    <mi>ω</mi>
    <mo>∈</mo>
    <mi>Ω</mi>
    <mo>=</mo>
    <mo>{</mo>
    <msub><mi>ω</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>ω</mi> <mn>2</mn> </msub>
    <mo>,</mo>
    <mo>...</mo>
    <mo>,</mo>
    <msub><mi>ω</mi> <mi>S</mi> </msub>
    <mo>}</mo>
  </mrow>
</math>. <math alttext="normal upper Omega">
  <mi>Ω</mi>
</math> is called the <em>state space</em>, and it holds <math alttext="StartAbsoluteValue normal upper Omega EndAbsoluteValue equals upper S">
  <mrow>
    <mo>|</mo>
    <mi>Ω</mi>
    <mo>|</mo>
    <mo>=</mo>
    <mi>S</mi>
  </mrow>
</math> for its cardinality.</p>

<p>An <em>algebra</em> <math alttext="script upper F">
  <mi>ℱ</mi>
</math> in <math alttext="normal upper Omega">
  <mi>Ω</mi>
</math> is a family of sets with the following:</p>
<ol>
<li>
<p><math alttext="normal upper Omega element-of script upper F">
  <mrow>
    <mi>Ω</mi>
    <mo>∈</mo>
    <mi>ℱ</mi>
  </mrow>
</math></p>
</li>
<li>
<p><math alttext="double-struck upper E element-of script upper F right double arrow double-struck upper E Superscript c Baseline element-of script upper F">
  <mrow>
    <mi>𝔼</mi>
    <mo>∈</mo>
    <mi>ℱ</mi>
    <mo>⇒</mo>
    <msup><mi>𝔼</mi> <mi>c</mi> </msup>
    <mo>∈</mo>
    <mi>ℱ</mi>
  </mrow>
</math></p>
</li>
<li>
<p><math alttext="double-struck upper E 1 comma double-struck upper E 2 comma period period period comma double-struck upper E Subscript upper I Baseline element-of script upper F right double arrow union double-struck upper E Subscript i Baseline element-of script upper F">
  <mrow>
    <msub><mi>𝔼</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>𝔼</mi> <mn>2</mn> </msub>
    <mo>,</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>.</mo>
    <mo>,</mo>
    <msub><mi>𝔼</mi> <mi>I</mi> </msub>
    <mo>∈</mo>
    <mi>ℱ</mi>
    <mo>⇒</mo>
    <msubsup><mo>∪</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>I</mi> </msubsup>
    <msub><mi>𝔼</mi> <mi>i</mi> </msub>
    <mo>∈</mo>
    <mi>ℱ</mi>
  </mrow>
</math></p>
</li>

</ol>

<p><math alttext="double-struck upper E Superscript c">
  <msup><mi>𝔼</mi> <mi>c</mi> </msup>
</math> denotes the complement of a set <math alttext="double-struck upper E">
  <mi>𝔼</mi>
</math>. The power set <math alttext="normal script upper P left-parenthesis normal upper Omega right-parenthesis">
  <mrow>
    <mi>℘</mi>
    <mo>(</mo>
    <mi>Ω</mi>
    <mo>)</mo>
  </mrow>
</math> is the largest algebra, while the set <math alttext="script upper F equals StartSet normal empty-set comma normal upper Omega EndSet">
  <mrow>
    <mi>ℱ</mi>
    <mo>=</mo>
    <mo>{</mo>
    <mi>∅</mi>
    <mo>,</mo>
    <mi>Ω</mi>
    <mo>}</mo>
  </mrow>
</math> is the smallest algebra in <math alttext="normal upper Omega">
  <mi>Ω</mi>
</math>. An algebra is a model for <em>observable events</em> in an economy. In this context, a single state of the economy <math alttext="omega element-of normal upper Omega">
  <mrow>
    <mi>ω</mi>
    <mo>∈</mo>
    <mi>Ω</mi>
  </mrow>
</math> can be interpreted as an <em>atomic event</em>.</p>

<p><a data-type="indexterm" data-primary="probability" id="idm45625332821240"/>A <em>probability</em> assigns a real number <math alttext="0 less-than-or-equal-to p Subscript omega Baseline identical-to upper P left-parenthesis StartSet omega EndSet right-parenthesis less-than-or-equal-to 1">
  <mrow>
    <mn>0</mn>
    <mo>≤</mo>
    <msub><mi>p</mi> <mi>ω</mi> </msub>
    <mo>≡</mo>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>{</mo>
        <mi>ω</mi>
        <mo>}</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>≤</mo>
    <mn>1</mn>
  </mrow>
</math> to a state <math alttext="omega element-of normal upper Omega">
  <mrow>
    <mi>ω</mi>
    <mo>∈</mo>
    <mi>Ω</mi>
  </mrow>
</math> or a real number <math alttext="0 less-than-or-equal-to upper P left-parenthesis double-struck upper E double-struck right-parenthesis less-than-or-equal-to 1">
  <mrow>
    <mn>0</mn>
    <mo>≤</mo>
    <mi>P</mi>
    <mo>(</mo>
    <mi>𝔼</mi>
    <mo>)</mo>
    <mo>≤</mo>
    <mn>1</mn>
  </mrow>
</math> to an event <math alttext="double-struck upper E element-of script upper F">
  <mrow>
    <mi>𝔼</mi>
    <mo>∈</mo>
    <mi>ℱ</mi>
  </mrow>
</math>. If the probabilities for all states are known, it holds <math alttext="upper P left-parenthesis double-struck upper E right-parenthesis equals sigma-summation Underscript omega element-of double-struck upper E Endscripts p Subscript omega">
  <mrow>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>𝔼</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub><mo>∑</mo> <mrow><mi>ω</mi><mo>∈</mo><mi>𝔼</mi></mrow> </msub>
    <msub><mi>p</mi> <mi>ω</mi> </msub>
  </mrow>
</math>.</p>
<div style="page-break-after: always;"/>

<p><a data-type="indexterm" data-primary="probability measure" id="idm45625332793320"/>A <em>probability measure</em> <math alttext="upper P colon script upper F right-arrow left-bracket 0 comma 1 right-bracket">
  <mrow>
    <mi>P</mi>
    <mo>:</mo>
    <mi>ℱ</mi>
    <mo>→</mo>
    <mo>[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>]</mo>
  </mrow>
</math> is characterized by the following:</p>
<ol>
<li>
<p><math alttext="for-all double-struck upper E element-of script upper F colon upper P left-parenthesis double-struck upper E right-parenthesis greater-than-or-equal-to 0">
  <mrow>
    <mo>∀</mo>
    <mi>𝔼</mi>
    <mo>∈</mo>
    <mi>ℱ</mi>
    <mo>:</mo>
    <mi>P</mi>
    <mo>(</mo>
    <mi>𝔼</mi>
    <mo>)</mo>
    <mo>≥</mo>
    <mn>0</mn>
  </mrow>
</math></p>
</li>
<li>
<p><math alttext="upper P left-parenthesis union double-struck upper E Subscript i Baseline right-parenthesis equals sigma-summation Underscript i equals 1 Overscript upper I Endscripts double-struck upper E Subscript i Baseline for disjoint sets double-struck upper E Subscript i Baseline element-of script upper F">
  <mrow>
    <mi>P</mi>
    <mfenced separators="" open="(" close=")">
      <msubsup><mo>∪</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>I</mi> </msubsup>
      <msub><mi>𝔼</mi> <mi>i</mi> </msub>
    </mfenced>
    <mo>=</mo>
    <msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>I</mi> </msubsup>
    <msub><mi>𝔼</mi> <mi>i</mi> </msub>
    <mspace width="4.pt"/>
    <mtext>for</mtext>
    <mspace width="4.pt"/>
    <mtext>disjoint</mtext>
    <mspace width="4.pt"/>
    <mtext>sets</mtext>
    <mspace width="4.pt"/>
    <msub><mi>𝔼</mi> <mi>i</mi> </msub>
    <mo>∈</mo>
    <mi>ℱ</mi>
  </mrow>
</math></p>
</li>
<li>
<p><math alttext="upper P left-parenthesis normal upper Omega right-parenthesis equals 1">
  <mrow>
    <mi>P</mi>
    <mo>(</mo>
    <mi>Ω</mi>
    <mo>)</mo>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math></p>
</li>

</ol>

<p><a data-type="indexterm" data-primary="probability space" id="idm45625332757288"/>Together the three elements <math alttext="StartSet normal upper Omega comma script upper F comma upper P EndSet">
  <mrow>
    <mo>{</mo>
    <mi>Ω</mi>
    <mo>,</mo>
    <mi>ℱ</mi>
    <mo>,</mo>
    <mi>P</mi>
    <mo>}</mo>
  </mrow>
</math> form a <em>probability space</em>. A probability space is the formal representation for <em>uncertainty</em> in the model economy. If the probability measure <math alttext="upper P">
  <mi>P</mi>
</math> is fixed, the economy is said to be under <em>risk</em>. <a data-type="indexterm" data-primary="symmetric information, economy" id="idm45625332749464"/>If it is known to all agents in the economy, the economy is said to have <em>symmetric information</em>.</p>

<p><a data-type="indexterm" data-primary="random variable" id="idm45625332747960"/>Given a probability space <math alttext="StartSet normal upper Omega comma script upper F comma upper P EndSet">
  <mrow>
    <mo>{</mo>
    <mi>Ω</mi>
    <mo>,</mo>
    <mi>ℱ</mi>
    <mo>,</mo>
    <mi>P</mi>
    <mo>}</mo>
  </mrow>
</math>, a <em>random variable</em> is a function <math alttext="upper S colon normal upper Omega right-arrow double-struck upper R Subscript plus Baseline comma omega right-arrow from bar upper S left-parenthesis omega right-parenthesis">
  <mrow>
    <mi>S</mi>
    <mo>:</mo>
    <mi>Ω</mi>
    <mo>→</mo>
    <msub><mi>ℝ</mi> <mo>+</mo> </msub>
    <mo>,</mo>
    <mi>ω</mi>
    <mo>↦</mo>
    <mi>S</mi>
    <mrow>
      <mo>(</mo>
      <mi>ω</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math> that is <math alttext="script upper F minus">
  <mrow>
    <mi>ℱ</mi>
    <mo>-</mo>
  </mrow>
</math>measurable. This implies that for each <math alttext="double-struck upper E element-of left-brace left-bracket a comma b left-bracket colon a comma b element-of double-struck upper R comma a less-than b right-brace">
  <mrow>
    <mi>𝔼</mi>
    <mo>∈</mo>
    <mo>{</mo>
    <mo>[</mo>
    <mi>a</mi>
    <mo>,</mo>
    <mi>b</mi>
    <mo>[</mo>
    <mo>:</mo>
    <mi>a</mi>
    <mo>,</mo>
    <mi>b</mi>
    <mo>∈</mo>
    <mi>ℝ</mi>
    <mo>,</mo>
    <mi>a</mi>
    <mo>&lt;</mo>
    <mi>b</mi>
    <mo>}</mo>
  </mrow>
</math> one has the following:</p>
<div data-type="equation">
<math alttext="upper S Superscript negative 1 Baseline left-parenthesis double-struck upper E right-parenthesis identical-to StartSet omega element-of normal upper Omega colon upper S left-parenthesis omega right-parenthesis element-of double-struck upper E EndSet element-of script upper F" display="block">
  <mrow>
    <msup><mi>S</mi> <mrow><mo>-</mo><mn>1</mn></mrow> </msup>
    <mrow>
      <mo>(</mo>
      <mi>𝔼</mi>
      <mo>)</mo>
    </mrow>
    <mo>≡</mo>
    <mrow>
      <mo>{</mo>
      <mi>ω</mi>
      <mo>∈</mo>
      <mi>Ω</mi>
      <mo>:</mo>
      <mi>S</mi>
      <mrow>
        <mo>(</mo>
        <mi>ω</mi>
        <mo>)</mo>
      </mrow>
      <mo>∈</mo>
      <mi>𝔼</mi>
      <mo>}</mo>
    </mrow>
    <mo>∈</mo>
    <mi>ℱ</mi>
  </mrow>
</math>
</div>

<p>If <math alttext="script upper F identical-to normal script upper P left-parenthesis normal upper Omega right-parenthesis">
  <mrow>
    <mi>ℱ</mi>
    <mo>≡</mo>
    <mi>℘</mi>
    <mo>(</mo>
    <mi>Ω</mi>
    <mo>)</mo>
  </mrow>
</math>, the <em>expectation</em> of a random variable is defined by the following:</p>
<div data-type="equation">
<math alttext="bold upper E Superscript upper P Baseline left-parenthesis upper S right-parenthesis equals sigma-summation Underscript omega element-of normal upper Omega Endscripts upper P left-parenthesis omega right-parenthesis dot upper S left-parenthesis omega right-parenthesis" display="block">
  <mrow>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>S</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <munder><mo>∑</mo> <mrow><mi>ω</mi><mo>∈</mo><mi>Ω</mi></mrow> </munder>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>ω</mi>
      <mo>)</mo>
    </mrow>
    <mo>·</mo>
    <mi>S</mi>
    <mrow>
      <mo>(</mo>
      <mi>ω</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p>Otherwise, it is defined by:</p>
<div data-type="equation">
<math alttext="bold upper E Superscript upper P Baseline left-parenthesis upper S right-parenthesis equals sigma-summation Underscript double-struck upper E element-of script upper F Endscripts upper P left-parenthesis double-struck upper E right-parenthesis dot upper S left-parenthesis double-struck upper E right-parenthesis" display="block">
  <mrow>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>S</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <munder><mo>∑</mo> <mrow><mi>𝔼</mi><mo>∈</mo><mi>ℱ</mi></mrow> </munder>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>𝔼</mi>
      <mo>)</mo>
    </mrow>
    <mo>·</mo>
    <mi>S</mi>
    <mrow>
      <mo>(</mo>
      <mi>𝔼</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p><a data-type="indexterm" data-primary="perfect financial economy" id="idm45625332391688"/>In general, it is assumed that a financial economy is <em>perfect</em>. This means, among other things, that there are no transaction costs, available assets have fixed prices and are available in infinite quantities, everything happens at the speed of light, and agents have complete, symmetric information.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Numerical Example"><div class="sect2" id="idm45625332669832">
<h2>Numerical Example</h2>

<p>Assume now a simple <em>static</em> economy under <em>risk</em> <math alttext="StartSet normal upper Omega comma script upper F comma upper P EndSet">
  <mrow>
    <mo>{</mo>
    <mi>Ω</mi>
    <mo>,</mo>
    <mi>ℱ</mi>
    <mo>,</mo>
    <mi>P</mi>
    <mo>}</mo>
  </mrow>
</math> for which the following holds:</p>
<ol>
<li>
<p><math alttext="normal upper Omega identical-to StartSet u comma d EndSet">
  <mrow>
    <mi>Ω</mi>
    <mo>≡</mo>
    <mo>{</mo>
    <mi>u</mi>
    <mo>,</mo>
    <mi>d</mi>
    <mo>}</mo>
  </mrow>
</math></p>
</li>
<li>
<p><math alttext="script upper F identical-to normal script upper P left-parenthesis normal upper Omega right-parenthesis">
  <mrow>
    <mi>ℱ</mi>
    <mo>≡</mo>
    <mi>℘</mi>
    <mo>(</mo>
    <mi>Ω</mi>
    <mo>)</mo>
  </mrow>
</math></p>
</li>
<li>
<p><math alttext="upper P identical-to StartSet upper P left-parenthesis StartSet u EndSet right-parenthesis equals one-half comma upper P left-parenthesis StartSet d EndSet right-parenthesis equals one-half EndSet">
  <mrow>
    <mi>P</mi>
    <mo>≡</mo>
    <mo>{</mo>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>{</mo>
        <mi>u</mi>
        <mo>}</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>2</mn></mfrac>
    <mo>,</mo>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>{</mo>
        <mi>d</mi>
        <mo>}</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>2</mn></mfrac>
    <mo>}</mo>
  </mrow>
</math></p>
</li>

</ol>










<section data-type="sect3" data-pdf-bookmark="Traded assets"><div class="sect3" id="idm45625332358808">
<h3>Traded assets</h3>

<p><a data-type="indexterm" data-primary="traded assets, in static economy" id="idm45625332357368"/>In the economy, two assets are traded. The first is a risky asset, the <em>stock</em>, with a certain price today of <math alttext="upper S 0 equals 10">
  <mrow>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mn>10</mn>
  </mrow>
</math> and an uncertain payoff tomorrow in the form of the 
<span class="keep-together">random</span> variable:</p>
<div data-type="equation">
<math alttext="upper S 1 equals StartLayout Enlarged left-brace 1st Row 1st Column upper S 1 Superscript u Baseline equals 20 2nd Column if omega equals u 2nd Row 1st Column upper S 1 Superscript d Baseline equals 5 2nd Column if omega equals d EndLayout" display="block">
  <mrow>
    <msub><mi>S</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mfenced separators="" open="{" close="">
      <mtable>
        <mtr>
          <mtd columnalign="left">
            <mrow>
              <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
              <mo>=</mo>
              <mn>20</mn>
            </mrow>
          </mtd>
          <mtd columnalign="left">
            <mrow>
              <mtext>if</mtext>
              <mspace width="4.pt"/>
              <mi>ω</mi>
              <mo>=</mo>
              <mi>u</mi>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd columnalign="left">
            <mrow>
              <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
              <mo>=</mo>
              <mn>5</mn>
            </mrow>
          </mtd>
          <mtd columnalign="left">
            <mrow>
              <mtext>if</mtext>
              <mspace width="4.pt"/>
              <mi>ω</mi>
              <mo>=</mo>
              <mi>d</mi>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p>The second is a risk-less asset, the <em>bond</em>, with a certain price today of <math alttext="upper B 0 equals 10">
  <mrow>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mn>10</mn>
  </mrow>
</math> and a certain payoff tomorrow of the following:</p>
<div data-type="equation">
<math alttext="upper B 1 equals StartLayout Enlarged left-brace 1st Row 1st Column upper B 1 Superscript u Baseline equals 11 2nd Column if omega equals u 2nd Row 1st Column upper B 1 Superscript d Baseline equals 11 2nd Column if omega equals d EndLayout" display="block">
  <mrow>
    <msub><mi>B</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mfenced separators="" open="{" close="">
      <mtable>
        <mtr>
          <mtd columnalign="left">
            <mrow>
              <msubsup><mi>B</mi> <mn>1</mn> <mi>u</mi> </msubsup>
              <mo>=</mo>
              <mn>11</mn>
            </mrow>
          </mtd>
          <mtd columnalign="left">
            <mrow>
              <mtext>if</mtext>
              <mspace width="4.pt"/>
              <mi>ω</mi>
              <mo>=</mo>
              <mi>u</mi>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd columnalign="left">
            <mrow>
              <msubsup><mi>B</mi> <mn>1</mn> <mi>d</mi> </msubsup>
              <mo>=</mo>
              <mn>11</mn>
            </mrow>
          </mtd>
          <mtd columnalign="left">
            <mrow>
              <mtext>if</mtext>
              <mspace width="4.pt"/>
              <mi>ω</mi>
              <mo>=</mo>
              <mi>d</mi>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p>Formally, the model economy can then be written as <math alttext="script upper M squared equals left-parenthesis StartSet normal upper Omega comma script upper F comma upper P EndSet comma double-struck upper A right-parenthesis">
  <mrow>
    <msup><mi>ℳ</mi> <mn mathvariant="script">2</mn> </msup>
    <mo>=</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>{</mo>
        <mi>Ω</mi>
        <mo>,</mo>
        <mi>ℱ</mi>
        <mo>,</mo>
        <mi>P</mi>
        <mo>}</mo>
      </mrow>
      <mo>,</mo>
      <mi>𝔸</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>, where <math alttext="double-struck upper A">
  <mi>𝔸</mi>
</math> represents the tradable assets in the form of the price vector <math alttext="upper M 0 equals left-parenthesis upper S 0 comma upper B 0 right-parenthesis Superscript upper T">
  <mrow>
    <msub><mi>M</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <msup><mrow><mo>(</mo><msub><mi>S</mi> <mn>0</mn> </msub><mo>,</mo><msub><mi>B</mi> <mn>0</mn> </msub><mo>)</mo></mrow> <mi>T</mi> </msup>
  </mrow>
</math> today and the market payoff matrix tomorrow of the following:</p>
<div data-type="equation">
<math alttext="upper M 1 equals Start 2 By 2 Matrix 1st Row 1st Column upper S 1 Superscript u Baseline 2nd Column upper B 1 Superscript u Baseline 2nd Row 1st Column upper S 1 Superscript d Baseline 2nd Column upper B 1 Superscript d EndMatrix" display="block">
  <mrow>
    <msub><mi>M</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
          </mtd>
          <mtd>
            <msubsup><mi>B</mi> <mn>1</mn> <mi>u</mi> </msubsup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
          </mtd>
          <mtd>
            <msubsup><mi>B</mi> <mn>1</mn> <mi>d</mi> </msubsup>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Arbitrage pricing"><div class="sect3" id="idm45625332927496">
<h3>Arbitrage pricing</h3>

<p><a data-type="indexterm" data-primary="normative financial theories and models" data-secondary="arbitrage pricing theory" id="ix_norm_fin_APT_ch3"/><a data-type="indexterm" data-primary="APT (arbitrage pricing theory)" data-secondary="risk measures and" id="ix_APT_risk_meas"/><a data-type="indexterm" data-primary="uncertainty and risk" data-secondary="arbitrage pricing theory" id="ix_uncertain_risk_APT"/><a data-type="indexterm" data-primary="European call option" id="idm45625332922280"/>In such an economy, one can, for example, address the problem of deriving the fair value of a <em>European call option</em> on the stock with a strike price of <math alttext="upper K equals">
  <mrow>
    <mi>K</mi>
    <mo>=</mo>
  </mrow>
</math> 14.5. The arbitrage-free value of the European call option <math alttext="upper C 0">
  <msub><mi>C</mi> <mn>0</mn> </msub>
</math> is derived by replicating the option’s payoff <math alttext="upper C 1">
  <msub><mi>C</mi> <mn>1</mn> </msub>
</math> through a portfolio <math alttext="phi">
  <mi>ϕ</mi>
</math> of the stock and the bond. The price of the replicating portfolio must also be the price of the European call option. Otherwise, (infinite) arbitrage profits would be possible. In Python, making use of such a replication argument, this is easily accomplished:<sup><a data-type="noteref" id="idm45625332913576-marker" href="ch03.xhtml#idm45625332913576">3</a></sup></p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">numpy</code><code> </code><code class="kn">as</code><code> </code><code class="nn">np</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">2</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">S0</code><code> </code><code class="o">=</code><code> </code><code class="mi">10</code><code>  </code><a class="co" id="co_normative_finance_CO1-1" href="#callout_normative_finance_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>        </code><code class="n">B0</code><code> </code><code class="o">=</code><code> </code><code class="mi">10</code><code>  </code><a class="co" id="co_normative_finance_CO1-2" href="#callout_normative_finance_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">3</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">S1</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">20</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO1-3" href="#callout_normative_finance_CO1-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>        </code><code class="n">B1</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code> </code><code class="mi">11</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO1-4" href="#callout_normative_finance_CO1-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">M0</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">S0</code><code class="p">,</code><code> </code><code class="n">B0</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" id="co_normative_finance_CO1-5" href="#callout_normative_finance_CO1-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>        </code><code class="n">M0</code><code>  </code><a class="co" id="co_normative_finance_CO1-6" href="#callout_normative_finance_CO1-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">10</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">M1</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">S1</code><code class="p">,</code><code> </code><code class="n">B1</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">T</code><code>  </code><a class="co" id="co_normative_finance_CO1-7" href="#callout_normative_finance_CO1-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>        </code><code class="n">M1</code><code>  </code><a class="co" id="co_normative_finance_CO1-8" href="#callout_normative_finance_CO1-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">20</code><code class="p">,</code><code> </code><code class="mi">11</code><code class="p">]</code><code class="p">,</code><code>
</code><code>               </code><code class="p">[</code><code> </code><code class="mi">5</code><code class="p">,</code><code> </code><code class="mi">11</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">K</code><code> </code><code class="o">=</code><code> </code><code class="mf">14.5</code><code>  </code><a class="co" id="co_normative_finance_CO1-9" href="#callout_normative_finance_CO1-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">C1</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">maximum</code><code class="p">(</code><code class="n">S1</code><code> </code><code class="o">-</code><code> </code><code class="n">K</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code> </code><a class="co" id="co_normative_finance_CO1-10" href="#callout_normative_finance_CO1-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>        </code><code class="n">C1</code><code>  </code><a class="co" id="co_normative_finance_CO1-11" href="#callout_normative_finance_CO1-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">5.5</code><code class="p">,</code><code> </code><code class="mf">0.</code><code> </code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">phi</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">solve</code><code class="p">(</code><code class="n">M1</code><code class="p">,</code><code> </code><code class="n">C1</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO1-12" href="#callout_normative_finance_CO1-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a><code>
</code><code>        </code><code class="n">phi</code><code>  </code><a class="co" id="co_normative_finance_CO1-13" href="#callout_normative_finance_CO1-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code> </code><code class="mf">0.36666667</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">0.16666667</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">9</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">allclose</code><code class="p">(</code><code class="n">C1</code><code class="p">,</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M1</code><code class="p">,</code><code> </code><code class="n">phi</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO1-14" href="#callout_normative_finance_CO1-8"><img src="Images/8.png" alt="8" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">9</code><code class="p">]</code><code class="p">:</code><code> </code><code class="bp">True</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">C0</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M0</code><code class="p">,</code><code> </code><code class="n">phi</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO1-15" href="#callout_normative_finance_CO1-9"><img src="Images/9.png" alt="9" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">C0</code><code>  </code><a class="co" id="co_normative_finance_CO1-16" href="#callout_normative_finance_CO1-9"><img src="Images/9.png" alt="9" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">2.0</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO1-1" href="#co_normative_finance_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The prices of the stock and bond today.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO1-2" href="#co_normative_finance_CO1-3"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>The uncertain payoff of the stock and bond tomorrow.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO1-3" href="#co_normative_finance_CO1-5"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>The market price vector.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO1-4" href="#co_normative_finance_CO1-7"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>The market payoff matrix.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO1-5" href="#co_normative_finance_CO1-9"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>The strike price of the option.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO1-6" href="#co_normative_finance_CO1-10"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>The uncertain payoff of the option.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO1-7" href="#co_normative_finance_CO1-12"><img src="Images/7.png" alt="7" width="12" height="12"/></a></dt>
<dd><p>The replication portfolio <math alttext="phi">
  <mi>ϕ</mi>
</math>.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO1-8" href="#co_normative_finance_CO1-14"><img src="Images/8.png" alt="8" width="12" height="12"/></a></dt>
<dd><p>A check whether its payoff is the same as the option’s payoff.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO1-9" href="#co_normative_finance_CO1-15"><img src="Images/9.png" alt="9" width="12" height="12"/></a></dt>
<dd><p>The price of the replication portfolio is the arbitrage-free price of the option.</p></dd>
</dl>
<div data-type="note" epub:type="note"><h1>Arbitrage Pricing</h1>
<p>Arbitrage pricing theory, as illustrated in the preceding example, can be considered one of the strongest financial theories with some of the most robust mathematical results, such as the <em>fundamental theorem of asset pricing (FTAP)</em>.<sup><a data-type="noteref" id="idm45625331905816-marker" href="ch03.xhtml#idm45625331905816">4</a></sup> Among other reasons, this is due to the fact that prices of options, for example, can be derived from other observable market parameters, say, the share price of the stock on which the option is written. Arbitrage pricing in that sense does not take care of how to come up with a fair share price in the first place, but simply takes it as an input. Therefore, arbitrage pricing works already with few and mild assumptions, such as <em>absence of arbitrage</em>, which cannot be said of many other financial theories. Note that not even the probability measure is used to derive the arbitrage price.<a data-type="indexterm" data-primary="" data-startref="ix_norm_fin_uncertain" id="idm45625331904136"/><a data-type="indexterm" data-primary="" data-startref="ix_uncertain_risk_APT" id="idm45625331802760"/><a data-type="indexterm" data-primary="" data-startref="ix_APT_risk_meas" id="idm45625331801816"/><a data-type="indexterm" data-primary="" data-startref="ix_norm_fin_APT_ch3" id="idm45625331800872"/></p>
</div>
</div></section>



</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Expected Utility Theory"><div class="sect1" id="eu_theory">
<h1>Expected Utility Theory</h1>

<p><a data-type="indexterm" data-primary="uncertainty and risk" data-secondary="expected utility theory" id="ix_uncertain_risk_EUT"/><a data-type="indexterm" data-primary="EUT (expected utility theory)" id="ix_EUT_gen"/>Expected utility theory (EUT) is a cornerstone of financial theory. Since its formulation in the 1940s, it has been one of the central paradigms for modeling decision making under uncertainty.<sup><a data-type="noteref" id="idm45625331795688-marker" href="ch03.xhtml#idm45625331795688">5</a></sup> Basically every introductory textbook about financial theory and the theory of investments provides an account of EUT. One of the reasons is that other central results in finance can be derived from the EUT paradigm.</p>








<section data-type="sect2" data-pdf-bookmark="Assumptions and Results"><div class="sect2" id="idm45625331794552">
<h2>Assumptions and Results</h2>

<p><a data-type="indexterm" data-primary="von Neumann, John" id="ix_vonneumann"/><a data-type="indexterm" data-primary="Morgenstern, Oskar" id="ix_morgenstern"/><a data-type="indexterm" data-primary="axiomatic theory, EUT as" id="ix_axiom_EUT_as"/>EUT is an axiomatic theory, dating back to the seminal work of von Neumann and Morgenstern (1944). <em>Axiomatic</em> here means that major results of the theory can be deduced from a small number of axioms only. For a survey of axiomatic utility theory, different variants, and applications, see Fishburn (1968).</p>










<section data-type="sect3" data-pdf-bookmark="Axioms and normative theory"><div class="sect3" id="idm45625331789352">
<h3>Axioms and normative theory</h3>

<p><a data-type="indexterm" data-primary="axioms, in finance" id="idm45625331788120"/>On <a href="https://oreil.ly/pZqal">Wolfram MathWorld</a>, you find the following definition for <em>axiom</em>: “An axiom is a proposition regarded as self-evidently true without proof.”</p>

<p>EUT is generally based on a small set of major axioms with regard to the <em>preferences</em> of an agent when faced with choice under uncertainty. Although the definition of axiom suggests otherwise, not all of the axioms are regarded as “self-evidently true without proof” by all economists.</p>
<div style="page-break-after: always;"/>

<p>Von Neumann and Morgenstern (1944, p. 25) comment on the choice of axioms:</p>
<blockquote>
<p>A choice of axioms is not a purely objective task. It is usually expected to achieve some definite aim—some specific theorem or theorems are to be derivable from the axioms—and to this extent the problem is exact and objective. But beyond this there are always other important desiderata of a less exact nature: The axioms should not be too numerous, their system is to be as simple and transparent as possible, and each axiom should have an immediate intuitive meaning by which its appropriateness may be judged directly.</p></blockquote>

<p>In that sense, a set of axioms constitutes a <em>normative theory</em> of (the parts of) the world to be modeled by the theory. The set of axioms collects the minimum set of assumptions that should be satisfied a priori and not through some formal proof or similar. Before listing a set of axioms that leads to EUT, here are some words about the 
<span class="keep-together">preferences</span> of an agent themselves, formally <math alttext="succeeds-above-single-line-equals">
  <mo>⪰</mo>
</math>, when presented with choice under 
<span class="keep-together">uncertainty</span>.</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Preferences of an agent"><div class="sect3" id="idm45625331779064">
<h3>Preferences of an agent</h3>

<p><a data-type="indexterm" data-primary="agents" data-secondary="preferences in normative finance" id="idm45625331777832"/>Assume an agent with preferences <math alttext="succeeds-above-single-line-equals">
  <mo>⪰</mo>
</math> is faced with the problem of investing in the two traded assets of the model economy <math alttext="script upper M squared">
  <msup><mi>ℳ</mi> <mn mathvariant="script">2</mn> </msup>
</math>. For example, the agent might have the option to choose between portfolio <math alttext="phi Subscript upper A">
  <msub><mi>ϕ</mi> <mi>A</mi> </msub>
</math> leading to a future payoff <math alttext="upper A equals phi Subscript upper A Baseline dot upper M 1">
  <mrow>
    <mi>A</mi>
    <mo>=</mo>
    <msub><mi>ϕ</mi> <mi>A</mi> </msub>
    <mo>·</mo>
    <msub><mi>M</mi> <mn>1</mn> </msub>
  </mrow>
</math> or portfolio <math alttext="phi Subscript upper B">
  <msub><mi>ϕ</mi> <mi>B</mi> </msub>
</math> leading to a future payoff <math alttext="upper B equals phi Subscript upper B Baseline dot upper M 1">
  <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <msub><mi>ϕ</mi> <mi>B</mi> </msub>
    <mo>·</mo>
    <msub><mi>M</mi> <mn>1</mn> </msub>
  </mrow>
</math>.
The agent’s preferences <math alttext="succeeds-above-single-line-equals">
  <mo>⪰</mo>
</math> are assumed to be defined over the future payoffs and not over the portfolios. If the agent (strongly) prefers payoff <math alttext="upper A">
  <mi>A</mi>
</math> over <math alttext="upper B">
  <mi>B</mi>
</math>, one writes <math alttext="upper A succeeds upper B">
  <mrow>
    <mi>A</mi>
    <mo>≻</mo>
    <mi>B</mi>
  </mrow>
</math> and <math alttext="upper A precedes upper B">
  <mrow>
    <mi>A</mi>
    <mo>≺</mo>
    <mi>B</mi>
  </mrow>
</math> in the other case. If the agent is indifferent to the two payoffs, one writes <math alttext="upper A tilde upper B">
  <mrow>
    <mi>A</mi>
    <mo>∼</mo>
    <mi>B</mi>
  </mrow>
</math>. Given these descriptions, one possible set of axioms leading to EUT is as 
<span class="keep-together">follows:</span></p>
<dl>
<dt>Completeness</dt>
<dd>
<p>The agent can rank <em>all</em> payoffs relative to one another. One of the following must hold true: <math alttext="upper A succeeds upper B">
  <mrow>
    <mi>A</mi>
    <mo>≻</mo>
    <mi>B</mi>
  </mrow>
</math>, <math alttext="upper A precedes upper B">
  <mrow>
    <mi>A</mi>
    <mo>≺</mo>
    <mi>B</mi>
  </mrow>
</math>, or <math alttext="upper A tilde upper B">
  <mrow>
    <mi>A</mi>
    <mo>∼</mo>
    <mi>B</mi>
  </mrow>
</math>.</p>
</dd>
<dt>Transitivity</dt>
<dd>
<p>If there is a third portfolio <math alttext="phi Subscript upper C">
  <msub><mi>ϕ</mi> <mi>C</mi> </msub>
</math> with future payoff <math alttext="upper C equals phi Subscript upper C Baseline dot upper M 1">
  <mrow>
    <mi>C</mi>
    <mo>=</mo>
    <msub><mi>ϕ</mi> <mi>C</mi> </msub>
    <mo>·</mo>
    <msub><mi>M</mi> <mn>1</mn> </msub>
  </mrow>
</math>, it follows from <math alttext="upper A succeeds upper B">
  <mrow>
    <mi>A</mi>
    <mo>≻</mo>
    <mi>B</mi>
  </mrow>
</math> and <math alttext="upper B succeeds upper C">
  <mrow>
    <mi>B</mi>
    <mo>≻</mo>
    <mi>C</mi>
  </mrow>
</math> that <math alttext="upper A succeeds upper C">
  <mrow>
    <mi>A</mi>
    <mo>≻</mo>
    <mi>C</mi>
  </mrow>
</math>.</p>
</dd>
<dt>Continuity</dt>
<dd>
<p>If <math alttext="upper A succeeds upper B succeeds upper C">
  <mrow>
    <mi>A</mi>
    <mo>≻</mo>
    <mi>B</mi>
    <mo>≻</mo>
    <mi>C</mi>
  </mrow>
</math>, then there exists a number <math alttext="alpha element-of left-bracket 0 comma 1 right-bracket">
  <mrow>
    <mi>α</mi>
    <mo>∈</mo>
    <mo>[</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>]</mo>
  </mrow>
</math> such that <math alttext="upper B tilde alpha upper A plus left-parenthesis 1 minus alpha right-parenthesis upper C">
  <mrow>
    <mi>B</mi>
    <mo>∼</mo>
    <mi>α</mi>
    <mi>A</mi>
    <mo>+</mo>
    <mo>(</mo>
    <mn>1</mn>
    <mo>-</mo>
    <mi>α</mi>
    <mo>)</mo>
    <mi>C</mi>
  </mrow>
</math>.</p>
</dd>
<dt>Independence</dt>
<dd>
<p>From <math alttext="upper A tilde upper B">
  <mrow>
    <mi>A</mi>
    <mo>∼</mo>
    <mi>B</mi>
  </mrow>
</math> it follows that <math alttext="alpha upper A plus left-parenthesis 1 minus alpha right-parenthesis upper C tilde alpha upper B plus left-parenthesis 1 minus alpha right-parenthesis upper C">
  <mrow>
    <mi>α</mi>
    <mi>A</mi>
    <mo>+</mo>
    <mo>(</mo>
    <mn>1</mn>
    <mo>-</mo>
    <mi>α</mi>
    <mo>)</mo>
    <mi>C</mi>
    <mo>∼</mo>
    <mi>α</mi>
    <mi>B</mi>
    <mo>+</mo>
    <mo>(</mo>
    <mn>1</mn>
    <mo>-</mo>
    <mi>α</mi>
    <mo>)</mo>
    <mi>C</mi>
  </mrow>
</math>. Similarly, from <math alttext="upper A succeeds upper B">
  <mrow>
    <mi>A</mi>
    <mo>≻</mo>
    <mi>B</mi>
  </mrow>
</math> it follows that <math alttext="alpha upper A plus left-parenthesis 1 minus alpha right-parenthesis upper C succeeds alpha upper B plus left-parenthesis 1 minus alpha right-parenthesis upper C">
  <mrow>
    <mi>α</mi>
    <mi>A</mi>
    <mo>+</mo>
    <mo>(</mo>
    <mn>1</mn>
    <mo>-</mo>
    <mi>α</mi>
    <mo>)</mo>
    <mi>C</mi>
    <mo>≻</mo>
    <mi>α</mi>
    <mi>B</mi>
    <mo>+</mo>
    <mo>(</mo>
    <mn>1</mn>
    <mo>-</mo>
    <mi>α</mi>
    <mo>)</mo>
    <mi>C</mi>
  </mrow>
</math>.</p>
</dd>
<dt>Dominance</dt>
<dd>
<p>If <math alttext="upper C 1 equals alpha 1 upper A plus left-parenthesis 1 minus alpha 1 right-parenthesis upper C">
  <mrow>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <msub><mi>α</mi> <mn>1</mn> </msub>
    <mi>A</mi>
    <mo>+</mo>
    <mrow>
      <mo>(</mo>
      <mn>1</mn>
      <mo>-</mo>
      <msub><mi>α</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mi>C</mi>
  </mrow>
</math> and <math alttext="upper C 2 equals alpha 2 upper A plus left-parenthesis 1 minus alpha 2 right-parenthesis upper C">
  <mrow>
    <msub><mi>C</mi> <mn>2</mn> </msub>
    <mo>=</mo>
    <msub><mi>α</mi> <mn>2</mn> </msub>
    <mi>A</mi>
    <mo>+</mo>
    <mrow>
      <mo>(</mo>
      <mn>1</mn>
      <mo>-</mo>
      <msub><mi>α</mi> <mn>2</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mi>C</mi>
  </mrow>
</math>, it follows from <math alttext="upper A succeeds upper C">
  <mrow>
    <mi>A</mi>
    <mo>≻</mo>
    <mi>C</mi>
  </mrow>
</math> and <math alttext="upper C 1 succeeds upper C 2">
  <mrow>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>≻</mo>
    <msub><mi>C</mi> <mn>2</mn> </msub>
  </mrow>
</math> that <math alttext="alpha 1 greater-than alpha 2">
  <mrow>
    <msub><mi>α</mi> <mn>1</mn> </msub>
    <mo>&gt;</mo>
    <msub><mi>α</mi> <mn>2</mn> </msub>
  </mrow>
</math>.<a data-type="indexterm" data-primary="" data-startref="ix_axiom_EUT_as" id="idm45625331649304"/></p>
</dd>
</dl>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Utility functions"><div class="sect3" id="idm45625331648168">
<h3>Utility functions</h3>

<p>A <em>utility function</em> is a way to represent the preferences <math alttext="succeeds-above-single-line-equals">
  <mo>⪰</mo>
</math> of an agent in a mathematical and numerical way in that such a function assigns a numerical value to a certain payoff. In this context, the absolute value is not relevant. It is rather the ordering that the values induce that is of interest.<sup><a data-type="noteref" id="idm45625331644552-marker" href="ch03.xhtml#idm45625331644552">6</a></sup> Assume that <math alttext="double-struck upper X">
  <mi>𝕏</mi>
</math> represents all possible payoffs over which the agent can express her preferences. A utility function <math alttext="upper U">
  <mi>U</mi>
</math> is then defined as follows:</p>
<div data-type="equation">
<math alttext="upper U colon double-struck upper X right-arrow double-struck upper R Subscript plus Baseline comma x right-arrow from bar upper U left-parenthesis x right-parenthesis" display="block">
  <mrow>
    <mi>U</mi>
    <mo>:</mo>
    <mi>𝕏</mi>
    <mo>→</mo>
    <msub><mi>ℝ</mi> <mo>+</mo> </msub>
    <mo>,</mo>
    <mi>x</mi>
    <mo>↦</mo>
    <mi>U</mi>
    <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p>If <math alttext="upper U">
  <mi>U</mi>
</math> represents the preferences <math alttext="succeeds-above-single-line-equals">
  <mo>⪰</mo>
</math> of an agent, then the following relationships hold true:</p>
<div data-type="equation">
<math alttext="StartLayout 1st Row 1st Column upper A succeeds upper B right double arrow upper U left-parenthesis upper A right-parenthesis greater-than upper U left-parenthesis upper B right-parenthesis 2nd Column left-parenthesis strongly prefers right-parenthesis 2nd Row 1st Column upper A succeeds-above-single-line-equals upper B right double arrow upper U left-parenthesis upper A right-parenthesis greater-than-or-equal-to upper U left-parenthesis upper B right-parenthesis 2nd Column left-parenthesis weakly prefers right-parenthesis 3rd Row 1st Column upper A precedes upper B right double arrow upper U left-parenthesis upper A right-parenthesis less-than upper U left-parenthesis upper B right-parenthesis 2nd Column left-parenthesis strongly does not prefer right-parenthesis 4th Row 1st Column upper A precedes-above-single-line-equals upper B right double arrow upper U left-parenthesis upper A right-parenthesis less-than-or-equal-to upper U left-parenthesis upper B right-parenthesis 2nd Column left-parenthesis weakly does not prefer right-parenthesis 5th Row 1st Column upper A tilde upper B right double arrow upper U left-parenthesis upper A right-parenthesis equals upper U left-parenthesis upper B right-parenthesis 2nd Column left-parenthesis is indifferent right-parenthesis EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <mi>A</mi>
          <mo>≻</mo>
          <mi>B</mi>
          <mo>⇒</mo>
          <mi>U</mi>
          <mo>(</mo>
          <mi>A</mi>
          <mo>)</mo>
          <mo>&gt;</mo>
          <mi>U</mi>
          <mo>(</mo>
          <mi>B</mi>
          <mo>)</mo>
        </mrow>
      </mtd>
      <mtd>
        <mrow>
          <mtext>(strongly</mtext>
          <mspace width="4.pt"/>
          <mtext>prefers)</mtext>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mi>A</mi>
          <mo>⪰</mo>
          <mi>B</mi>
          <mo>⇒</mo>
          <mi>U</mi>
          <mo>(</mo>
          <mi>A</mi>
          <mo>)</mo>
          <mo>≥</mo>
          <mi>U</mi>
          <mo>(</mo>
          <mi>B</mi>
          <mo>)</mo>
        </mrow>
      </mtd>
      <mtd>
        <mrow>
          <mtext>(weakly</mtext>
          <mspace width="4.pt"/>
          <mtext>prefers)</mtext>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mi>A</mi>
          <mo>≺</mo>
          <mi>B</mi>
          <mo>⇒</mo>
          <mi>U</mi>
          <mo>(</mo>
          <mi>A</mi>
          <mo>)</mo>
          <mo>&lt;</mo>
          <mi>U</mi>
          <mo>(</mo>
          <mi>B</mi>
          <mo>)</mo>
        </mrow>
      </mtd>
      <mtd>
        <mrow>
          <mtext>(strongly</mtext>
          <mspace width="4.pt"/>
          <mtext>does</mtext>
          <mspace width="4.pt"/>
          <mtext>not</mtext>
          <mspace width="4.pt"/>
          <mtext>prefer)</mtext>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mi>A</mi>
          <mo>⪯</mo>
          <mi>B</mi>
          <mo>⇒</mo>
          <mi>U</mi>
          <mo>(</mo>
          <mi>A</mi>
          <mo>)</mo>
          <mo>≤</mo>
          <mi>U</mi>
          <mo>(</mo>
          <mi>B</mi>
          <mo>)</mo>
        </mrow>
      </mtd>
      <mtd>
        <mrow>
          <mtext>(weakly</mtext>
          <mspace width="4.pt"/>
          <mtext>does</mtext>
          <mspace width="4.pt"/>
          <mtext>not</mtext>
          <mspace width="4.pt"/>
          <mtext>prefer)</mtext>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mi>A</mi>
          <mo>∼</mo>
          <mi>B</mi>
          <mo>⇒</mo>
          <mi>U</mi>
          <mo>(</mo>
          <mi>A</mi>
          <mo>)</mo>
          <mo>=</mo>
          <mi>U</mi>
          <mo>(</mo>
          <mi>B</mi>
          <mo>)</mo>
        </mrow>
      </mtd>
      <mtd>
        <mrow>
          <mtext>(is</mtext>
          <mspace width="4.pt"/>
          <mtext>indifferent)</mtext>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p>A utility function <math alttext="upper U">
  <mi>U</mi>
</math> is only determined up to a positive linear transformation. Therefore, if <math alttext="upper U">
  <mi>U</mi>
</math> represents the preferences <math alttext="succeeds-above-single-line-equals">
  <mo>⪰</mo>
</math>, then <math alttext="upper V equals a plus b upper U">
  <mrow>
    <mi>V</mi>
    <mo>=</mo>
    <mi>a</mi>
    <mo>+</mo>
    <mi>b</mi>
    <mi>U</mi>
  </mrow>
</math> with <math alttext="a comma b greater-than 0">
  <mrow>
    <mi>a</mi>
    <mo>,</mo>
    <mi>b</mi>
    <mo>&gt;</mo>
    <mn>0</mn>
  </mrow>
</math> does so as well. Regarding utility functions, von Neumann and Morgenstern (1944, p. 25) summarize as follows: “So we see: If such a numerical valuation of utilities exists at all, then it is determined up to a linear transformation. I.e. then utility is a number up to a linear transformation.”</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Expected utility functions"><div class="sect3" id="idm45625331561960">
<h3>Expected utility functions</h3>

<p><a data-type="indexterm" data-primary="utility functions, normative finance" id="idm45625331560712"/>Von Neumann and Morgenstern (1944) show that if the preferences of an agent <math alttext="succeeds-above-single-line-equals">
  <mo>⪰</mo>
</math> satisfy the preceding five axioms, then there exists an <em>expected utility function</em> of the form:</p>
<div data-type="equation">
<math alttext="upper U colon double-struck upper X right-arrow double-struck upper R Subscript plus Baseline comma x right-arrow from bar bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis x right-parenthesis right-parenthesis equals sigma-summation Underscript omega Overscript normal upper Omega Endscripts upper P left-parenthesis omega right-parenthesis u left-parenthesis x left-parenthesis omega right-parenthesis right-parenthesis" display="block">
  <mrow>
    <mi>U</mi>
    <mo>:</mo>
    <mi>𝕏</mi>
    <mo>→</mo>
    <msub><mi>ℝ</mi> <mo>+</mo> </msub>
    <mo>,</mo>
    <mi>x</mi>
    <mo>↦</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>u</mi>
      <mrow>
        <mo>(</mo>
        <mi>x</mi>
        <mo>)</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <munderover><mo>∑</mo> <mrow><mi>ω</mi></mrow> <mi>Ω</mi> </munderover>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>ω</mi>
      <mo>)</mo>
    </mrow>
    <mi>u</mi>
    <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mrow>
        <mo>(</mo>
        <mi>ω</mi>
        <mo>)</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p><a data-type="indexterm" data-primary="Bernoulli utility" id="idm45625331537592"/>Here, <math alttext="u colon double-struck upper R right-arrow double-struck upper R comma x right-arrow from bar u left-parenthesis x right-parenthesis">
  <mrow>
    <mi>u</mi>
    <mo>:</mo>
    <mi>ℝ</mi>
    <mo>→</mo>
    <mi>ℝ</mi>
    <mo>,</mo>
    <mi>x</mi>
    <mo>↦</mo>
    <mi>u</mi>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
  </mrow>
</math> is a monotonically increasing, state-independent function, often called <em>Bernoulli utility</em>, such as <math alttext="u left-parenthesis x right-parenthesis equals ln left-parenthesis x right-parenthesis comma u left-parenthesis x right-parenthesis equals x">
  <mrow>
    <mi>u</mi>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
    <mo>=</mo>
    <mo form="prefix">ln</mo>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
    <mo>,</mo>
    <mi>u</mi>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
    <mo>=</mo>
    <mi>x</mi>
  </mrow>
</math>, or <math alttext="u left-parenthesis x right-parenthesis equals x squared">
  <mrow>
    <mi>u</mi>
    <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>x</mi> <mn>2</mn> </msup>
  </mrow>
</math>.</p>

<p>In words, the expected utility function <math alttext="upper U">
  <mi>U</mi>
</math> first applies a function <math alttext="u">
  <mi>u</mi>
</math> to the payoff <math alttext="x left-parenthesis omega right-parenthesis">
  <mrow>
    <mi>x</mi>
    <mo>(</mo>
    <mi>ω</mi>
    <mo>)</mo>
  </mrow>
</math> in a certain state and then uses the probabilities for a given state to occur <math alttext="upper P left-parenthesis omega right-parenthesis">
  <mrow>
    <mi>P</mi>
    <mo>(</mo>
    <mi>ω</mi>
    <mo>)</mo>
  </mrow>
</math> to weigh the single utilities. In the special case of linear Bernoulli utility <math alttext="u left-parenthesis x right-parenthesis equals x">
  <mrow>
    <mi>u</mi>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
    <mo>=</mo>
    <mi>x</mi>
  </mrow>
</math>, the expected utility is simply the expected value of the state-dependent payoff, <math alttext="upper U left-parenthesis x right-parenthesis equals bold upper E Superscript upper P Baseline left-parenthesis x right-parenthesis">
  <mrow>
    <mi>U</mi>
    <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>.</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Risk aversion"><div class="sect3" id="idm45625331495736">
<h3>Risk aversion</h3>

<p><a data-type="indexterm" data-primary="risk aversion, normative finance" id="idm45625331494264"/>In finance, the concept of <em>risk aversion</em> is important. <a data-type="indexterm" data-primary="ARA (absolute risk aversion)" id="idm45625331492856"/>The most commonly used measure of risk aversion is the <a data-type="indexterm" data-primary="Arrow-Pratt absolute risk aversion" id="idm45625331491976"/>Arrow-Pratt measure of <em>absolute risk aversion</em> (ARA), which dates back to Pratt (1964). Assume that an agent’s state-independent Bernoulli utility function is <math alttext="u left-parenthesis x right-parenthesis">
  <mrow>
    <mi>u</mi>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
  </mrow>
</math>. Then the Arrow-Pratt measure of ARA is defined by the following:</p>
<div data-type="equation">
<math alttext="upper A upper R upper A left-parenthesis x right-parenthesis equals minus StartFraction u double-prime left-parenthesis x right-parenthesis Over u prime left-parenthesis x right-parenthesis EndFraction comma x greater-than-or-equal-to 0" display="block">
  <mrow>
    <mi>A</mi>
    <mi>R</mi>
    <mi>A</mi>
    <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mo>-</mo>
    <mfrac><mrow><msup><mi>u</mi> <mrow><mo>'</mo><mo>'</mo></mrow> </msup><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow> <mrow><msup><mi>u</mi> <mo>'</mo> </msup><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></mfrac>
    <mo>,</mo>
    <mi>x</mi>
    <mo>≥</mo>
    <mn>0</mn>
  </mrow>
</math>
</div>

<p>The following three cases can be distinguished according to this measure:</p>
<div data-type="equation">
<math alttext="upper A upper R upper A left-parenthesis x right-parenthesis equals minus StartFraction u double-prime left-parenthesis x right-parenthesis Over u prime left-parenthesis x right-parenthesis EndFraction StartLayout Enlarged left-brace 1st Row 1st Column Blank 2nd Column greater-than 3rd Column 0 4th Column risk hyphen averse 2nd Row 1st Column Blank 2nd Column equals 3rd Column 0 4th Column risk hyphen neutral 3rd Row 1st Column Blank 2nd Column less-than 3rd Column 0 4th Column risk hyphen loving EndLayout" display="block">
  <mrow>
    <mi>A</mi>
    <mi>R</mi>
    <mi>A</mi>
    <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mo>-</mo>
    <mfrac><mrow><msup><mi>u</mi> <mrow><mo>'</mo><mo>'</mo></mrow> </msup><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow> <mrow><msup><mi>u</mi> <mo>'</mo> </msup><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></mfrac>
    <mfenced separators="" open="{" close="">
      <mtable>
        <mtr>
          <mtd/>
          <mtd columnalign="left">
            <mo>&gt;</mo>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mtext>risk-averse</mtext>
          </mtd>
        </mtr>
        <mtr>
          <mtd/>
          <mtd columnalign="left">
            <mo>=</mo>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mtext>risk-neutral</mtext>
          </mtd>
        </mtr>
        <mtr>
          <mtd/>
          <mtd columnalign="left">
            <mo>&lt;</mo>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mtext>risk-loving</mtext>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p>In financial theories and models, risk aversion and risk neutrality in general are assumed to be appropriate cases. In gambling, risk-loving agents probably can be found as well.<a data-type="indexterm" data-primary="" data-startref="ix_morgenstern" id="idm45625331448584"/><a data-type="indexterm" data-primary="" data-startref="ix_vonneumann" id="idm45625331447608"/></p>

<p>Consider the three Bernoulli functions previously mentioned: <math alttext="u left-parenthesis x right-parenthesis equals ln left-parenthesis x right-parenthesis comma u left-parenthesis x right-parenthesis equals x">
  <mrow>
    <mi>u</mi>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
    <mo>=</mo>
    <mo form="prefix">ln</mo>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
    <mo>,</mo>
    <mi>u</mi>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
    <mo>=</mo>
    <mi>x</mi>
  </mrow>
</math>, or <math alttext="u left-parenthesis x right-parenthesis equals x squared">
  <mrow>
    <mi>u</mi>
    <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>x</mi> <mn>2</mn> </msup>
  </mrow>
</math>. It is easily verified that they model risk-averse, risk-neutral, and risk-loving agents, respectively. Consider, for example, <math alttext="u left-parenthesis x right-parenthesis equals x squared">
  <mrow>
    <mi>u</mi>
    <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>x</mi> <mn>2</mn> </msup>
  </mrow>
</math>:</p>
<div data-type="equation">
<math alttext="minus StartFraction u double-prime left-parenthesis x right-parenthesis Over u prime left-parenthesis x right-parenthesis EndFraction equals minus StartFraction 2 Over 2 x EndFraction less-than 0 comma x greater-than 0 right double arrow risk hyphen loving" display="block">
  <mrow>
    <mo>-</mo>
    <mfrac><mrow><msup><mi>u</mi> <mrow><mo>'</mo><mo>'</mo></mrow> </msup><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow> <mrow><msup><mi>u</mi> <mo>'</mo> </msup><mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></mfrac>
    <mo>=</mo>
    <mo>-</mo>
    <mfrac><mn>2</mn> <mrow><mn>2</mn><mi>x</mi></mrow></mfrac>
    <mo>&lt;</mo>
    <mn>0</mn>
    <mo>,</mo>
    <mi>x</mi>
    <mo>&gt;</mo>
    <mn>0</mn>
    <mo>⇒</mo>
    <mtext>risk-loving</mtext>
  </mrow>
</math>
</div>
</div></section>



</div></section>













<section data-type="sect2" data-pdf-bookmark="Numerical Example"><div class="sect2" id="idm45625331413000">
<h2>Numerical Example</h2>

<p>The application of EUT is easily illustrated in Python. Assume the example model economy from the previous section <math alttext="script upper M squared">
  <msup><mi>ℳ</mi> <mn mathvariant="script">2</mn> </msup>
</math>. Assume that an agent with preferences <math alttext="succeeds-above-single-line-equals">
  <mo>⪰</mo>
</math> decides according to the EUT between different future payoffs. The Bernoulli utility of the agent is given by <math alttext="u left-parenthesis x right-parenthesis equals StartRoot x EndRoot">
  <mrow>
    <mi>u</mi>
    <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msqrt>
      <mi>x</mi>
    </msqrt>
  </mrow>
</math>. In the example, payoff <math alttext="upper A 1">
  <msub><mi>A</mi> <mn>1</mn> </msub>
</math> resulting from portfolio <math alttext="phi Subscript upper A">
  <msub><mi>ϕ</mi> <mi>A</mi> </msub>
</math> is preferred over the payoff <math alttext="upper D 1">
  <msub><mi>D</mi> <mn>1</mn> </msub>
</math> resulting from portfolio <math alttext="phi Subscript upper D">
  <msub><mi>ϕ</mi> <mi>D</mi> </msub>
</math>.</p>
<div style="page-break-after: always;"/>

<p>The following code illustrates this application:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">u</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO2-1" href="#callout_normative_finance_CO2-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">12</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">phi_A</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mf">0.75</code><code class="p">,</code><code> </code><code class="mf">0.25</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO2-2" href="#callout_normative_finance_CO2-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">phi_D</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mf">0.25</code><code class="p">,</code><code> </code><code class="mf">0.75</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO2-3" href="#callout_normative_finance_CO2-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">13</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M0</code><code class="p">,</code><code> </code><code class="n">phi_A</code><code class="p">)</code><code> </code><code class="o">==</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M0</code><code class="p">,</code><code> </code><code class="n">phi_D</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO2-4" href="#callout_normative_finance_CO2-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">13</code><code class="p">]</code><code class="p">:</code><code> </code><code class="bp">True</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">14</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">A1</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M1</code><code class="p">,</code><code> </code><code class="n">phi_A</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO2-5" href="#callout_normative_finance_CO2-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">A1</code><code>  </code><a class="co" id="co_normative_finance_CO2-6" href="#callout_normative_finance_CO2-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">14</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">17.75</code><code class="p">,</code><code>  </code><code class="mf">6.5</code><code> </code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">15</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">D1</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M1</code><code class="p">,</code><code> </code><code class="n">phi_D</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO2-7" href="#callout_normative_finance_CO2-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">D1</code><code>  </code><a class="co" id="co_normative_finance_CO2-8" href="#callout_normative_finance_CO2-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">15</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">13.25</code><code class="p">,</code><code>  </code><code class="mf">9.5</code><code> </code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">16</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">P</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code><code> </code><code class="mf">0.5</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO2-9" href="#callout_normative_finance_CO2-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">17</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">EUT</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">P</code><code class="p">,</code><code> </code><code class="n">u</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO2-10" href="#callout_normative_finance_CO2-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">18</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">EUT</code><code class="p">(</code><code class="n">A1</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO2-11" href="#callout_normative_finance_CO2-8"><img src="Images/8.png" alt="8" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">18</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">3.381292321692286</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">EUT</code><code class="p">(</code><code class="n">D1</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO2-12" href="#callout_normative_finance_CO2-8"><img src="Images/8.png" alt="8" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">3.3611309730623735</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO2-1" href="#co_normative_finance_CO2-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The risk-averse Bernoulli utility function</p></dd>
<dt><a class="co" id="callout_normative_finance_CO2-2" href="#co_normative_finance_CO2-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Two portfolios with different weights</p></dd>
<dt><a class="co" id="callout_normative_finance_CO2-3" href="#co_normative_finance_CO2-4"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Shows that the cost to set up each portfolio is the same</p></dd>
<dt><a class="co" id="callout_normative_finance_CO2-4" href="#co_normative_finance_CO2-5"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>The uncertain payoff of one portfolio…</p></dd>
<dt><a class="co" id="callout_normative_finance_CO2-5" href="#co_normative_finance_CO2-7"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>…and the other one</p></dd>
<dt><a class="co" id="callout_normative_finance_CO2-6" href="#co_normative_finance_CO2-9"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>The probability measure</p></dd>
<dt><a class="co" id="callout_normative_finance_CO2-7" href="#co_normative_finance_CO2-10"><img src="Images/7.png" alt="7" width="12" height="12"/></a></dt>
<dd><p>The expected utility function</p></dd>
<dt><a class="co" id="callout_normative_finance_CO2-8" href="#co_normative_finance_CO2-11"><img src="Images/8.png" alt="8" width="12" height="12"/></a></dt>
<dd><p>The utility values for the two uncertain payoffs</p></dd>
</dl>

<p>A typical problem in this context is to derive an optimal portfolio (that is, one that maximizes the expected utility) given a fixed budget of the agent <math alttext="w greater-than 0">
  <mrow>
    <mi>w</mi>
    <mo>&gt;</mo>
    <mn>0</mn>
  </mrow>
</math>. The following Python code models this problem and solves it exactly. Of its available budget, the agent puts roughly 60% in the risky asset and roughly 40% in the risk-less asset. The results are mainly driven by the particular form of the Bernoulli utility function:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">20</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">from</code><code> </code><code class="nn">scipy.optimize</code><code> </code><code class="kn">import</code><code> </code><code class="n">minimize</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">21</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">w</code><code> </code><code class="o">=</code><code> </code><code class="mi">10</code><code>  </code><a class="co" id="co_normative_finance_CO3-1" href="#callout_normative_finance_CO3-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">cons</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="s1">'</code><code class="s1">type</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">eq</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">fun</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="k">lambda</code><code> </code><code class="n">phi</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M0</code><code class="p">,</code><code> </code><code class="n">phi</code><code class="p">)</code><code> </code><code class="o">-</code><code> </code><code class="n">w</code><code class="p">}</code><code>  </code><a class="co" id="co_normative_finance_CO3-2" href="#callout_normative_finance_CO3-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">23</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">EUT_</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M1</code><code class="p">,</code><code> </code><code class="n">phi</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO3-3" href="#callout_normative_finance_CO3-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">EUT</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO3-4" href="#callout_normative_finance_CO3-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">opt</code><code> </code><code class="o">=</code><code> </code><code class="n">minimize</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">phi</code><code class="p">:</code><code> </code><code class="o">-</code><code class="n">EUT_</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">,</code><code>  </code><a class="co" id="co_normative_finance_CO3-5" href="#callout_normative_finance_CO3-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>                        </code><code class="n">x0</code><code class="o">=</code><code class="n">phi_A</code><code class="p">,</code><code>  </code><a class="co" id="co_normative_finance_CO3-6" href="#callout_normative_finance_CO3-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code>                        </code><code class="n">constraints</code><code class="o">=</code><code class="n">cons</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO3-7" href="#callout_normative_finance_CO3-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">opt</code><code>  </code><a class="co" id="co_normative_finance_CO3-8" href="#callout_normative_finance_CO3-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code>      </code><code class="n">fun</code><code class="p">:</code><code> </code><code class="o">-</code><code class="mf">3.385015999493397</code><code>
</code><code>              </code><code class="n">jac</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mf">1.69249132</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">1.69253424</code><code class="p">]</code><code class="p">)</code><code>
</code><code>          </code><code class="n">message</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Optimization terminated successfully.</code><code class="s1">'</code><code>
</code><code>             </code><code class="n">nfev</code><code class="p">:</code><code> </code><code class="mi">16</code><code>
</code><code>              </code><code class="n">nit</code><code class="p">:</code><code> </code><code class="mi">4</code><code>
</code><code>             </code><code class="n">njev</code><code class="p">:</code><code> </code><code class="mi">4</code><code>
</code><code>           </code><code class="n">status</code><code class="p">:</code><code> </code><code class="mi">0</code><code>
</code><code>          </code><code class="n">success</code><code class="p">:</code><code> </code><code class="bp">True</code><code>
</code><code>                </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">0.61122474</code><code class="p">,</code><code> </code><code class="mf">0.38877526</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">EUT_</code><code class="p">(</code><code class="n">opt</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO3-9" href="#callout_normative_finance_CO3-8"><img src="Images/8.png" alt="8" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">3.385015999493397</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO3-1" href="#co_normative_finance_CO3-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The fixed budget of the agent</p></dd>
<dt><a class="co" id="callout_normative_finance_CO3-2" href="#co_normative_finance_CO3-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>The budget constraint for use with <code>minimize</code><sup><a data-type="noteref" id="idm45625330715848-marker" href="ch03.xhtml#idm45625330715848">7</a></sup></p></dd>
<dt><a class="co" id="callout_normative_finance_CO3-3" href="#co_normative_finance_CO3-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>The expected utility function defined over portfolios</p></dd>
<dt><a class="co" id="callout_normative_finance_CO3-4" href="#co_normative_finance_CO3-5"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Minimizing <code>-EUT_(phi)</code> maximizes <code>EUT_(phi)</code></p></dd>
<dt><a class="co" id="callout_normative_finance_CO3-5" href="#co_normative_finance_CO3-6"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>The initial guess for the optimization</p></dd>
<dt><a class="co" id="callout_normative_finance_CO3-6" href="#co_normative_finance_CO3-7"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>The budget constraint applied</p></dd>
<dt><a class="co" id="callout_normative_finance_CO3-7" href="#co_normative_finance_CO3-8"><img src="Images/7.png" alt="7" width="12" height="12"/></a></dt>
<dd><p>The optimal results, including the optimal portfolio under <code>x</code></p></dd>
<dt><a class="co" id="callout_normative_finance_CO3-8" href="#co_normative_finance_CO3-9"><img src="Images/8.png" alt="8" width="12" height="12"/></a></dt>
<dd><p>The optimal (highest) expected utility given the budget of <math alttext="w equals 10">
  <mrow>
    <mi>w</mi>
    <mo>=</mo>
    <mn>10</mn>
  </mrow>
</math><a data-type="indexterm" data-primary="" data-startref="ix_EUT_gen" id="idm45625330853992"/><a data-type="indexterm" data-primary="" data-startref="ix_uncertain_risk_EUT" id="idm45625330853016"/></p></dd>
</dl>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Mean-Variance Portfolio Theory"><div class="sect1" id="mvp_theory">
<h1>Mean-Variance Portfolio Theory</h1>

<p><a data-type="indexterm" data-primary="portfolios" data-secondary="MVP theory" id="ix_portfolio_MVP_ch3"/><a data-type="indexterm" data-primary="uncertainty and risk" data-secondary="mean-variance portfolio theory" id="ix_uncertain_risk_MVP"/><a data-type="indexterm" data-primary="MVP (mean-variance portfolio) theory" data-secondary="risk measures and" id="ix_MVP_risk_meas_ch3"/><a data-type="indexterm" data-primary="normative financial theories and models" data-secondary="mean-variance portfolio theory" id="ix_norm_fin_MVP_ch3"/><a data-type="indexterm" data-primary="MVP (mean-variance portfolio) theory" id="ix_MVP_gen"/>Mean-variance portfolio (MVP) theory, according to Markowitz (1952), is another cornerstone in financial theory. It is one of the first theories of investment under uncertainty that focused on statistical measures only for the construction of stock investment portfolios. MVP completely abstracts from, say, fundamentals of a 
<span class="keep-together">company</span> that might drive its stock performance or assumptions about the future competitiveness of a company that might be important for the growth prospects of a company. Basically, the only input data that counts is the time series of share prices and statistics derived therefrom, such as the (historical) annualized mean return and the (historical) annualized variance of the returns.</p>








<section data-type="sect2" data-pdf-bookmark="Assumptions and Results"><div class="sect2" id="idm45625330843128">
<h2>Assumptions and Results</h2>

<p><a data-type="indexterm" data-primary="expected returns" data-secondary="under MVP theory" data-secondary-sortas="MVP theory" id="idm45625330841688"/>The central assumption of MVP, according to Markowitz (1952), is that investors <em>only</em> care about expected returns and the variance of these returns:</p>
<blockquote>
<p>We next consider the rule that the investor does (or should) consider expected return a desirable thing and variance of return an undesirable thing. This rule has many sound points, both as a maxim for, and hypothesis about, investment behavior.</p>

<p>The portfolio with maximum expected return is not necessarily the one with minimum variance. There is a rate at which the investor can gain expected return by taking on variance, or reduce variance by giving up expected return.</p></blockquote>

<p>This approach to investors’ preferences is quite different to the approach that defines an agent’s preferences and utility function over payoffs directly. MVP rather assumes that an agent’s preferences and utility function can be defined over the first and second moment of the returns an investment portfolio is expected to yield.</p>
<div data-type="caution"><h1>Implicitly Assumed Normal Distribution</h1>
<p><a data-type="indexterm" data-primary="MVP (mean-variance portfolio) theory" data-secondary="versus EUT" data-secondary-sortas="EUT" id="idm45625330698232"/><a data-type="indexterm" data-primary="normally distributed returns" id="idm45625330696920"/><a data-type="indexterm" data-primary="returns" data-seealso="expected returns" id="idm45625330696232"/><a data-type="indexterm" data-primary="returns" data-secondary="normally distributed" id="idm45625330695288"/><a data-type="indexterm" data-primary="EUT (expected utility theory)" data-secondary="versus MVP and CAPM" data-secondary-sortas="MVP and CAPM" id="idm45625330694344"/><a data-type="indexterm" data-primary="implicitly assumed normal distribution" id="idm45625330693112"/>In general, MVP theory, focusing on one period portfolio risk and return only, is not compatible with standard EUT. One way of resolving this issue is to assume that returns of risky assets are normally distributed such that the first and second moments are sufficient to describe the full distribution of an asset’s returns. This is something almost never observed in real financial data, as the next chapter illustrates. The other way is to assume a particular quadratic Bernoulli utility function, as shown in the next section.</p>
</div>










<section data-type="sect3" data-pdf-bookmark="Portfolio statistics"><div class="sect3" id="idm45625330691496">
<h3>Portfolio statistics</h3>

<p>Assume a static economy <math alttext="script upper M Superscript upper N Baseline equals left-parenthesis StartSet normal upper Omega comma script upper F comma upper P EndSet comma double-struck upper A right-parenthesis">
  <mrow>
    <msup><mi>ℳ</mi> <mi>N</mi> </msup>
    <mo>=</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>{</mo>
        <mi>Ω</mi>
        <mo>,</mo>
        <mi>ℱ</mi>
        <mo>,</mo>
        <mi>P</mi>
        <mo>}</mo>
      </mrow>
      <mo>,</mo>
      <mi>𝔸</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>, for which the set of tradable assets <math alttext="double-struck upper A">
  <mi>𝔸</mi>
</math> consists of <math alttext="upper N">
  <mi>N</mi>
</math> risky assets, <math alttext="upper A Superscript 1 Baseline comma upper A squared comma ellipsis comma upper A Superscript upper N">
  <mrow>
    <msup><mi>A</mi> <mn>1</mn> </msup>
    <mo>,</mo>
    <msup><mi>A</mi> <mn>2</mn> </msup>
    <mo>,</mo>
    <mo>...</mo>
    <mo>,</mo>
    <msup><mi>A</mi> <mi>N</mi> </msup>
  </mrow>
</math>. With <math alttext="upper A 0 Superscript n">
  <msubsup><mi>A</mi> <mn>0</mn> <mi>n</mi> </msubsup>
</math> being the fixed price of asset <math alttext="n">
  <mi>n</mi>
</math> today and <math alttext="upper A 1 Superscript n">
  <msubsup><mi>A</mi> <mn>1</mn> <mi>n</mi> </msubsup>
</math> being its payoff in one year, the (simple) net returns vector <math alttext="r Superscript n">
  <msup><mi>r</mi> <mi>n</mi> </msup>
</math> of asset <math alttext="n">
  <mi>n</mi>
</math> is defined by the following:</p>
<div data-type="equation">
<math alttext="r Superscript n Baseline equals StartFraction upper A 1 Superscript n Baseline Over upper A 0 Superscript n Baseline EndFraction minus 1" display="block">
  <mrow>
    <msup><mi>r</mi> <mi>n</mi> </msup>
    <mo>=</mo>
    <mfrac><msubsup><mi>A</mi> <mn>1</mn> <mi>n</mi> </msubsup> <msubsup><mi>A</mi> <mn>0</mn> <mi>n</mi> </msubsup></mfrac>
    <mo>-</mo>
    <mn>1</mn>
  </mrow>
</math>
</div>

<p>For all future states having the same probability to unfold, the <em>expected return</em> of asset <math alttext="n">
  <mi>n</mi>
</math> is given by:</p>
<div data-type="equation">
<math alttext="mu Superscript n Baseline equals StartFraction 1 Over StartAbsoluteValue normal upper Omega EndAbsoluteValue EndFraction sigma-summation Underscript omega Overscript normal upper Omega Endscripts r Superscript n Baseline left-parenthesis omega right-parenthesis" display="block">
  <mrow>
    <msup><mi>μ</mi> <mi>n</mi> </msup>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mrow><mo>|</mo><mi>Ω</mi><mo>|</mo></mrow></mfrac>
    <munderover><mo>∑</mo> <mrow><mi>ω</mi></mrow> <mi>Ω</mi> </munderover>
    <msup><mi>r</mi> <mi>n</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>ω</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p>Accordingly, the <em>vector of expected returns</em> is given by the following:</p>
<div data-type="equation">
<math alttext="mu equals Start 4 By 1 Matrix 1st Row  mu Superscript 1 Baseline 2nd Row  mu squared 3rd Row   ellipsis 4th Row  mu Superscript upper N EndMatrix" display="block">
  <mrow>
    <mi>μ</mi>
    <mo>=</mo>
    <mfenced open="[" close="]">
      <mtable>
        <mtr>
          <mtd>
            <msup><mi>μ</mi> <mn>1</mn> </msup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msup><mi>μ</mi> <mn>2</mn> </msup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mo>⋮</mo>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msup><mi>μ</mi> <mi>N</mi> </msup>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p>A <em>portfolio</em> (vector) <math alttext="phi equals left-parenthesis phi Superscript 1 Baseline comma phi squared comma ellipsis comma phi Superscript upper N Baseline right-parenthesis Superscript upper T">
  <mrow>
    <mi>ϕ</mi>
    <mo>=</mo>
    <msup><mfenced separators="" open="(" close=")"><msup><mi>ϕ</mi> <mn>1</mn> </msup><mo>,</mo><msup><mi>ϕ</mi> <mn>2</mn> </msup><mo>,</mo><mo>...</mo><mo>,</mo><msup><mi>ϕ</mi> <mi>N</mi> </msup></mfenced> <mi>T</mi> </msup>
  </mrow>
</math>, with <math alttext="phi Subscript n Baseline greater-than-or-equal-to 0">
  <mrow>
    <msub><mi>ϕ</mi> <mi>n</mi> </msub>
    <mo>≥</mo>
    <mn>0</mn>
  </mrow>
</math> and <math alttext="sigma-summation Underscript n Overscript upper N Endscripts phi Superscript n Baseline equals 1">
  <mrow>
    <msubsup><mo>∑</mo> <mi>n</mi> <mi>N</mi> </msubsup>
    <msup><mi>ϕ</mi> <mi>n</mi> </msup>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>, assigns weights to each asset in the portfolio.<sup><a data-type="noteref" id="idm45625330610520-marker" href="ch03.xhtml#idm45625330610520">8</a></sup></p>

<p>The <em>expected return of the portfolio</em> is then given by the dot product of the portfolio weights vector and the vector of expected returns:</p>
<div data-type="equation">
<math alttext="mu Superscript p h i Baseline equals phi dot mu" display="block">
  <mrow>
    <msup><mi>μ</mi> <mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow> </msup>
    <mo>=</mo>
    <mi>ϕ</mi>
    <mo>·</mo>
    <mi>μ</mi>
  </mrow>
</math>
</div>

<p>Now define the <em>covariance</em> between assets <math alttext="n">
  <mi>n</mi>
</math> and <math alttext="m">
  <mi>m</mi>
</math> by the following:</p>
<div data-type="equation">
<math alttext="sigma Subscript m n Baseline equals sigma-summation Underscript omega Overscript normal upper Omega Endscripts left-parenthesis r Superscript m Baseline left-parenthesis omega right-parenthesis minus mu Superscript m Baseline right-parenthesis left-parenthesis r Superscript n Baseline left-parenthesis omega right-parenthesis minus mu Superscript n Baseline right-parenthesis" display="block">
  <mrow>
    <msub><mi>σ</mi> <mrow><mi>m</mi><mi>n</mi></mrow> </msub>
    <mo>=</mo>
    <munderover><mo>∑</mo> <mrow><mi>ω</mi></mrow> <mi>Ω</mi> </munderover>
    <mfenced separators="" open="(" close=")">
      <msup><mi>r</mi> <mi>m</mi> </msup>
      <mrow>
        <mo>(</mo>
        <mi>ω</mi>
        <mo>)</mo>
      </mrow>
      <mo>-</mo>
      <msup><mi>μ</mi> <mi>m</mi> </msup>
    </mfenced>
    <mfenced separators="" open="(" close=")">
      <msup><mi>r</mi> <mi>n</mi> </msup>
      <mrow>
        <mo>(</mo>
        <mi>ω</mi>
        <mo>)</mo>
      </mrow>
      <mo>-</mo>
      <msup><mi>μ</mi> <mi>n</mi> </msup>
    </mfenced>
  </mrow>
</math>
</div>
<div style="page-break-after: always;"/>

<p><a data-type="indexterm" data-primary="covariance matrix, MVP theory" id="idm45625330580552"/>The <em>covariance matrix</em> then is given by:</p>
<div data-type="equation">
<math alttext="normal upper Sigma equals Start 4 By 4 Matrix 1st Row 1st Column sigma 11 2nd Column sigma 12 3rd Column  ellipsis 4th Column sigma Subscript 1 n Baseline 2nd Row 1st Column sigma 21 2nd Column sigma 22 3rd Column  ellipsis 4th Column sigma Subscript 2 n Baseline 3rd Row 1st Column  ellipsis 2nd Column  ellipsis 3rd Column  ellipsis 4th Column  ellipsis 4th Row 1st Column sigma Subscript n Baseline 1 Baseline 2nd Column sigma Subscript n Baseline 2 Baseline 3rd Column  ellipsis 4th Column sigma Subscript n n EndMatrix" display="block">
  <mrow>
    <mi>Σ</mi>
    <mo>=</mo>
    <mfenced open="[" close="]">
      <mtable>
        <mtr>
          <mtd>
            <msub><mi>σ</mi> <mn>11</mn> </msub>
          </mtd>
          <mtd>
            <msub><mi>σ</mi> <mn>12</mn> </msub>
          </mtd>
          <mtd>
            <mo>...</mo>
          </mtd>
          <mtd>
            <msub><mi>σ</mi> <mrow><mn>1</mn><mi>n</mi></mrow> </msub>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub><mi>σ</mi> <mn>21</mn> </msub>
          </mtd>
          <mtd>
            <msub><mi>σ</mi> <mn>22</mn> </msub>
          </mtd>
          <mtd>
            <mo>...</mo>
          </mtd>
          <mtd>
            <msub><mi>σ</mi> <mrow><mn>2</mn><mi>n</mi></mrow> </msub>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mo>⋮</mo>
          </mtd>
          <mtd>
            <mo>⋮</mo>
          </mtd>
          <mtd>
            <mo>⋱</mo>
          </mtd>
          <mtd>
            <mo>⋮</mo>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub><mi>σ</mi> <mrow><mi>n</mi><mn>1</mn></mrow> </msub>
          </mtd>
          <mtd>
            <msub><mi>σ</mi> <mrow><mi>n</mi><mn>2</mn></mrow> </msub>
          </mtd>
          <mtd>
            <mo>...</mo>
          </mtd>
          <mtd>
            <msub><mi>σ</mi> <mrow><mi>n</mi><mi>n</mi></mrow> </msub>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p><a data-type="indexterm" data-primary="expected variance of portfolio, MVP theory" id="idm45625330549176"/>The <em>expected variance of the portfolio</em> is then in turn given by the double dot product:</p>
<div data-type="equation">
<math alttext="phi Superscript p h i Baseline equals phi Superscript upper T Baseline dot normal upper Sigma dot phi" display="block">
  <mrow>
    <msup><mi>φ</mi> <mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow> </msup>
    <mo>=</mo>
    <msup><mi>ϕ</mi> <mi>T</mi> </msup>
    <mo>·</mo>
    <mi>Σ</mi>
    <mo>·</mo>
    <mi>ϕ</mi>
  </mrow>
</math>
</div>

<p><a data-type="indexterm" data-primary="expected volatility in MVP theory" id="idm45625330539960"/>The <em>expected volatility of the portfolio</em> accordingly is the following:</p>
<div data-type="equation">
<math alttext="sigma Superscript p h i Baseline equals StartRoot phi Superscript p h i Baseline EndRoot" display="block">
  <mrow>
    <msup><mi>σ</mi> <mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow> </msup>
    <mo>=</mo>
    <msqrt>
      <msup><mi>φ</mi> <mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow> </msup>
    </msqrt>
  </mrow>
</math>
</div>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Sharpe ratio"><div class="sect3" id="idm45625330690968">
<h3>Sharpe ratio</h3>

<p><a data-type="indexterm" data-primary="Sharpe ratio" id="idm45625330530424"/>Sharpe (1966) introduces a measure to judge the risk-adjusted performance of mutual funds and other portfolios, or even single risky assets. In its simplest form, it relates the (expected, realized) return of a portfolio to its (expected, realized) volatility. Formally, the <em>Sharpe ratio</em> therefore can be defined by the following:</p>
<div data-type="equation">
<math alttext="pi Superscript p h i Baseline equals StartFraction mu Superscript p h i Baseline Over sigma Superscript p h i Baseline EndFraction" display="block">
  <mrow>
    <msup><mi>π</mi> <mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow> </msup>
    <mo>=</mo>
    <mfrac><msup><mi>μ</mi> <mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow> </msup> <msup><mi>σ</mi> <mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow> </msup></mfrac>
  </mrow>
</math>
</div>

<p><a data-type="indexterm" data-primary="returns" data-secondary="excess return of portfolio" id="idm45625330520072"/><a data-type="indexterm" data-primary="risk premium of portfolio, MVP theory" id="idm45625330518920"/><a data-type="indexterm" data-primary="excess return of portfolio, MVP theory" id="idm45625330518232"/>If <math alttext="r">
  <mi>r</mi>
</math> represents the risk-less short rate, the <em>risk premium</em> or <em>excess return</em> of a portfolio <math alttext="p h i">
  <mrow>
    <mi>p</mi>
    <mi>h</mi>
    <mi>i</mi>
  </mrow>
</math> over a risk-free alternative is defined by <math alttext="mu Superscript p h i Baseline minus r">
  <mrow>
    <msup><mi>μ</mi> <mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow> </msup>
    <mo>-</mo>
    <mi>r</mi>
  </mrow>
</math>. In another version of the Sharpe ratio, this risk premium is the numerator:</p>
<div data-type="equation">
<math alttext="pi Superscript p h i Baseline equals StartFraction mu Superscript p h i Baseline minus r Over sigma Superscript p h i Baseline EndFraction" display="block">
  <mrow>
    <msup><mi>π</mi> <mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow> </msup>
    <mo>=</mo>
    <mfrac><mrow><msup><mi>μ</mi> <mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow> </msup><mo>-</mo><mi>r</mi></mrow> <msup><mi>σ</mi> <mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow> </msup></mfrac>
  </mrow>
</math>
</div>

<p>If the risk-less short rate is relatively low, the two versions do not yield too different numerical results if the same risk-less short rate is applied. In particular, when ranking different portfolios according to the Sharpe ratio, the two versions should generate the same ranking order, everything else equal.</p>
</div></section>



</div></section>













<section data-type="sect2" data-pdf-bookmark="Numerical Example"><div class="sect2" id="idm45625330498792">
<h2>Numerical Example</h2>

<p>Getting back to the static model economy <math alttext="script upper M squared">
  <msup><mi>ℳ</mi> <mn>2</mn> </msup>
</math>, the basic notions of MVP can again be easily illustrated by the use of Python.</p>










<section data-type="sect3" data-pdf-bookmark="Portfolio statistics"><div class="sect3" id="idm45625330495384">
<h3>Portfolio statistics</h3>

<p>First, here is the derivation of the portfolio <em>expected return</em>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rS</code><code> </code><code class="o">=</code><code> </code><code class="n">S1</code><code> </code><code class="o">/</code><code> </code><code class="n">S0</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code>  </code><a class="co" id="co_normative_finance_CO4-1" href="#callout_normative_finance_CO4-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">rS</code><code>  </code><a class="co" id="co_normative_finance_CO4-2" href="#callout_normative_finance_CO4-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code> </code><code class="mf">1.</code><code> </code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">0.5</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rB</code><code> </code><code class="o">=</code><code> </code><code class="n">B1</code><code> </code><code class="o">/</code><code> </code><code class="n">B0</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code>  </code><a class="co" id="co_normative_finance_CO4-3" href="#callout_normative_finance_CO4-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">rB</code><code>  </code><a class="co" id="co_normative_finance_CO4-4" href="#callout_normative_finance_CO4-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">0.1</code><code class="p">,</code><code> </code><code class="mf">0.1</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">29</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">mu</code><code class="p">(</code><code class="n">rX</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">P</code><code class="p">,</code><code> </code><code class="n">rX</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO4-5" href="#callout_normative_finance_CO4-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">mu</code><code class="p">(</code><code class="n">rS</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO4-6" href="#callout_normative_finance_CO4-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.25</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">31</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">mu</code><code class="p">(</code><code class="n">rB</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO4-7" href="#callout_normative_finance_CO4-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">31</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.10000000000000009</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rM</code><code> </code><code class="o">=</code><code> </code><code class="n">M1</code><code> </code><code class="o">/</code><code> </code><code class="n">M0</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code>  </code><a class="co" id="co_normative_finance_CO4-8" href="#callout_normative_finance_CO4-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">rM</code><code>  </code><a class="co" id="co_normative_finance_CO4-9" href="#callout_normative_finance_CO4-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code> </code><code class="mf">1.</code><code> </code><code class="p">,</code><code>  </code><code class="mf">0.1</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="o">-</code><code class="mf">0.5</code><code class="p">,</code><code>  </code><code class="mf">0.1</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">mu</code><code class="p">(</code><code class="n">rM</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO4-10" href="#callout_normative_finance_CO4-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">0.25</code><code class="p">,</code><code> </code><code class="mf">0.1</code><code> </code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO4-1" href="#co_normative_finance_CO4-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Return vector of the risky asset</p></dd>
<dt><a class="co" id="callout_normative_finance_CO4-2" href="#co_normative_finance_CO4-3"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Return vector of the risk-less asset</p></dd>
<dt><a class="co" id="callout_normative_finance_CO4-3" href="#co_normative_finance_CO4-5"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Expected return function</p></dd>
<dt><a class="co" id="callout_normative_finance_CO4-4" href="#co_normative_finance_CO4-6"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Expected returns of the traded assets</p></dd>
<dt><a class="co" id="callout_normative_finance_CO4-5" href="#co_normative_finance_CO4-8"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>Return matrix for the traded assets</p></dd>
<dt><a class="co" id="callout_normative_finance_CO4-6" href="#co_normative_finance_CO4-10"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>Expected return vector</p></dd>
</dl>
<div style="page-break-after: always;"/>

<p>Second, the <em>variance</em> and <em>volatility</em>, as well as the <em>covariance matrix</em>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">34</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">var</code><code class="p">(</code><code class="n">rX</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="p">(</code><code class="p">(</code><code class="n">rX</code><code> </code><code class="o">-</code><code> </code><code class="n">mu</code><code class="p">(</code><code class="n">rX</code><code class="p">)</code><code class="p">)</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO5-1" href="#callout_normative_finance_CO5-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">var</code><code class="p">(</code><code class="n">rS</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.5625</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">36</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">var</code><code class="p">(</code><code class="n">rB</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">36</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.0</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">37</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">sigma</code><code class="p">(</code><code class="n">rX</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">var</code><code class="p">(</code><code class="n">rX</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO5-2" href="#callout_normative_finance_CO5-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">38</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sigma</code><code class="p">(</code><code class="n">rS</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">38</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.75</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sigma</code><code class="p">(</code><code class="n">rB</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.0</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">40</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">cov</code><code class="p">(</code><code class="n">rM</code><code class="o">.</code><code class="n">T</code><code class="p">,</code><code> </code><code class="n">aweights</code><code class="o">=</code><code class="n">P</code><code class="p">,</code><code> </code><code class="n">ddof</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO5-3" href="#callout_normative_finance_CO5-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">40</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mf">0.5625</code><code class="p">,</code><code> </code><code class="mf">0.</code><code>    </code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mf">0.</code><code>    </code><code class="p">,</code><code> </code><code class="mf">0.</code><code>    </code><code class="p">]</code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO5-1" href="#co_normative_finance_CO5-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The variance function</p></dd>
<dt><a class="co" id="callout_normative_finance_CO5-2" href="#co_normative_finance_CO5-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>The volatility function</p></dd>
<dt><a class="co" id="callout_normative_finance_CO5-3" href="#co_normative_finance_CO5-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>The covariance matrix</p></dd>
</dl>

<p>Third, the <em>portfolio expected return</em>, <em>portfolio expected variance</em>, and <em>portfolio expected volatility</em>, illustrated for an equally weighted portfolio:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">41</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">phi</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code><code> </code><code class="mf">0.5</code><code class="p">)</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">42</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">mu_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">phi</code><code class="p">,</code><code> </code><code class="n">mu</code><code class="p">(</code><code class="n">rM</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO6-1" href="#callout_normative_finance_CO6-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">43</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">mu_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">43</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.17500000000000004</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">44</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">var_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="n">cv</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">cov</code><code class="p">(</code><code class="n">rM</code><code class="o">.</code><code class="n">T</code><code class="p">,</code><code> </code><code class="n">aweights</code><code class="o">=</code><code class="n">P</code><code class="p">,</code><code> </code><code class="n">ddof</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">phi</code><code class="p">,</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">cv</code><code class="p">,</code><code> </code><code class="n">phi</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO6-2" href="#callout_normative_finance_CO6-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">45</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">var_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">45</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.140625</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">46</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">sigma_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">var_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mf">0.5</code><code>  </code><a class="co" id="co_normative_finance_CO6-3" href="#callout_normative_finance_CO6-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">47</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sigma_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">47</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.375</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO6-1" href="#co_normative_finance_CO6-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The portfolio expected return</p></dd>
<dt><a class="co" id="callout_normative_finance_CO6-2" href="#co_normative_finance_CO6-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>The portfolio expected variance</p></dd>
<dt><a class="co" id="callout_normative_finance_CO6-3" href="#co_normative_finance_CO6-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>The portfolio expected volatility</p></dd>
</dl>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Investment opportunity set"><div class="sect3" id="idm45625330494760">
<h3>Investment opportunity set</h3>

<p><a data-type="indexterm" data-primary="Monte Carlo simulations" id="ix_montecarlo_MVP"/>Based on a Monte Carlo simulation for the portfolio weights <math alttext="phi">
  <mi>ϕ</mi>
</math>, one can visualize the investment opportunity set in the volatility-return space (<a data-type="xref" href="#figure_nf_01">Figure 3-1</a>, generated by the following code snippet).</p>

<figure><div id="figure_nf_01" class="figure">
<img src="Images/aiif_0301.png" alt="aiif 0301" width="2510" height="1492"/>
<h6><span class="label">Figure 3-1. </span>Simulated expected portfolio volatility and return (one risky asset)</h6>
</div></figure>

<p>Because there is only one risky asset and one risk-less asset, the opportunity set is a straight line:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">48</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">from</code><code> </code><code class="nn">pylab</code><code> </code><code class="kn">import</code><code> </code><code class="n">plt</code><code class="p">,</code><code> </code><code class="n">mpl</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'</code><code class="s1">seaborn</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s1">'</code><code class="s1">savefig.dpi</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">300</code><code>
</code><code>         </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s1">'</code><code class="s1">font.family</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">serif</code><code class="s1">'</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">49</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">phi_mcs</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">200</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO7-1" href="#callout_normative_finance_CO7-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">50</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">phi_mcs</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="n">phi_mcs</code><code> </code><code class="o">/</code><code> </code><code class="n">phi_mcs</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="n">axis</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">T</code><code>  </code><a class="co" id="co_normative_finance_CO7-2" href="#callout_normative_finance_CO7-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">51</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">mcs</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">(</code><code class="n">sigma_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">mu_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">)</code><code>
</code><code>                         </code><code class="k">for</code><code> </code><code class="n">phi</code><code> </code><code class="ow">in</code><code> </code><code class="n">phi_mcs</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO7-3" href="#callout_normative_finance_CO7-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">52</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">mcs</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">mcs</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ro</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected volatility</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected return</code><code class="s1">'</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO7-1" href="#co_normative_finance_CO7-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Random portfolio compositions, normalized to 1</p></dd>
<dt><a class="co" id="callout_normative_finance_CO7-2" href="#co_normative_finance_CO7-3"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Expected portfolio volatility and return for the random compositions</p></dd>
</dl>

<p>Consider now the case of a static three-state economy <math alttext="script upper M cubed">
  <msup><mi>ℳ</mi> <mn>3</mn> </msup>
</math> for which <math alttext="normal upper Omega equals StartSet u comma m comma d EndSet">
  <mrow>
    <mi>Ω</mi>
    <mo>=</mo>
    <mo>{</mo>
    <mi>u</mi>
    <mo>,</mo>
    <mi>m</mi>
    <mo>,</mo>
    <mi>d</mi>
    <mo>}</mo>
  </mrow>
</math> holds. The three states are equally likely, <math alttext="upper P equals StartSet one-third comma one-third comma one-third EndSet">
  <mrow>
    <mi>P</mi>
    <mo>=</mo>
    <mfenced separators="" open="{" close="}">
      <mfrac><mn>1</mn> <mn>3</mn></mfrac>
      <mo>,</mo>
      <mfrac><mn>1</mn> <mn>3</mn></mfrac>
      <mo>,</mo>
      <mfrac><mn>1</mn> <mn>3</mn></mfrac>
    </mfenced>
  </mrow>
</math>. The set of tradable assets consists of two risky assets <math alttext="upper S">
  <mi>S</mi>
</math> and <math alttext="upper T">
  <mi>T</mi>
</math> with a fixed price of <math alttext="upper S 0 equals upper T 0 equals 10">
  <mrow>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <msub><mi>T</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mn>10</mn>
  </mrow>
</math> and uncertain payoffs, respectively, of the following:</p>
<div data-type="equation">
<math alttext="upper S 1 equals Start 3 By 1 Matrix 1st Row  20 2nd Row  10 3rd Row  5 EndMatrix" display="block">
  <mrow>
    <msub><mi>S</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mfenced open="[" close="]">
      <mtable>
        <mtr>
          <mtd>
            <mn>20</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>10</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>5</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p>and</p>
<div data-type="equation">
<math alttext="upper T 1 equals Start 3 By 1 Matrix 1st Row  1 2nd Row  12 3rd Row  13 EndMatrix" display="block">
  <mrow>
    <msub><mi>T</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mfenced open="[" close="]">
      <mtable>
        <mtr>
          <mtd>
            <mn>1</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>12</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>13</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p>Based on these assumptions, the following Python code repeats the Monte Carlo simulation and visualizes the results in <a data-type="xref" href="#figure_nf_02">Figure 3-2</a>. With two risky assets, the well-known MVP “bullet” becomes visible.<a data-type="indexterm" data-primary="" data-startref="ix_montecarlo_MVP" id="idm45625329504248"/></p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">53</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">P</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">ones</code><code class="p">(</code><code class="mi">3</code><code class="p">)</code><code> </code><code class="o">/</code><code> </code><code class="mi">3</code><code>  </code><a class="co" id="co_normative_finance_CO8-1" href="#callout_normative_finance_CO8-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">P</code><code>  </code><a class="co" id="co_normative_finance_CO8-2" href="#callout_normative_finance_CO8-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">53</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">0.33333333</code><code class="p">,</code><code> </code><code class="mf">0.33333333</code><code class="p">,</code><code> </code><code class="mf">0.33333333</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">54</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">S1</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">20</code><code class="p">,</code><code> </code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">)</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">55</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">T0</code><code> </code><code class="o">=</code><code> </code><code class="mi">10</code><code>
</code><code>         </code><code class="n">T1</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">12</code><code class="p">,</code><code> </code><code class="mi">13</code><code class="p">)</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">56</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">M0</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">S0</code><code class="p">,</code><code> </code><code class="n">T0</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">M0</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">56</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">10</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">57</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">M1</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">S1</code><code class="p">,</code><code> </code><code class="n">T1</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">T</code><code>
</code><code>         </code><code class="n">M1</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">57</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">20</code><code class="p">,</code><code>  </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">12</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code> </code><code class="mi">5</code><code class="p">,</code><code> </code><code class="mi">13</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">58</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rM</code><code> </code><code class="o">=</code><code> </code><code class="n">M1</code><code> </code><code class="o">/</code><code> </code><code class="n">M0</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code>
</code><code>         </code><code class="n">rM</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">58</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code> </code><code class="mf">1.</code><code> </code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">0.9</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code> </code><code class="mf">0.</code><code> </code><code class="p">,</code><code>  </code><code class="mf">0.2</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="o">-</code><code class="mf">0.5</code><code class="p">,</code><code>  </code><code class="mf">0.3</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">59</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">mcs</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">(</code><code class="n">sigma_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">mu_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">)</code><code>
</code><code>                         </code><code class="k">for</code><code> </code><code class="n">phi</code><code> </code><code class="ow">in</code><code> </code><code class="n">phi_mcs</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">60</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">mcs</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">mcs</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ro</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected volatility</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected return</code><code class="s1">'</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO8-1" href="#co_normative_finance_CO8-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>New probability measure for three states</p></dd>
</dl>

<figure><div id="figure_nf_02" class="figure">
<img src="Images/aiif_0302.png" alt="aiif 0302" width="2545" height="1492"/>
<h6><span class="label">Figure 3-2. </span>Simulated expected portfolio volatility and return (two risky assets)</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Minimum volatility and maximum Sharpe ratio"><div class="sect3" id="idm45625329827768">
<h3>Minimum volatility and maximum Sharpe ratio</h3>

<p><a data-type="indexterm" data-primary="Sharpe ratio" id="idm45625328276008"/><a data-type="indexterm" data-primary="volatility" data-secondary="minimum volatility portfolio" id="idm45625328275080"/><a data-type="indexterm" data-primary="maximum Sharpe ratio portfolio" id="idm45625328274168"/><a data-type="indexterm" data-primary="minimum volatility portfolio" id="idm45625328288472"/>Next, the derivation of the <em>minimum volatility</em> (minimum variance) and <em>maximum Sharpe ratio</em> portfolios. <a data-type="xref" href="#figure_nf_03">Figure 3-3</a> shows the location of the two portfolios in the risk-return space.</p>

<p>Although the risky asset <math alttext="upper T">
  <mi>T</mi>
</math> has a negative expected return, it has a significant weight in the maximum Sharpe ratio portfolio. This is due to diversification effects that lower the portfolio risk more than the expected return of the portfolio is reduced:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">61</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">cons</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="s1">'</code><code class="s1">type</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">eq</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">fun</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="k">lambda</code><code> </code><code class="n">phi</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">}</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">62</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">bnds</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">63</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">min_var</code><code> </code><code class="o">=</code><code> </code><code class="n">minimize</code><code class="p">(</code><code class="n">sigma_phi</code><code class="p">,</code><code> </code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code><code> </code><code class="mf">0.5</code><code class="p">)</code><code class="p">,</code><code>
</code><code>                            </code><code class="n">constraints</code><code class="o">=</code><code class="n">cons</code><code class="p">,</code><code> </code><code class="n">bounds</code><code class="o">=</code><code class="n">bnds</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO9-1" href="#callout_normative_finance_CO9-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">64</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">min_var</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">64</code><code class="p">]</code><code class="p">:</code><code>      </code><code class="n">fun</code><code class="p">:</code><code> </code><code class="mf">0.07481322946910632</code><code>
</code><code>              </code><code class="n">jac</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">0.07426564</code><code class="p">,</code><code> </code><code class="mf">0.07528945</code><code class="p">]</code><code class="p">)</code><code>
</code><code>          </code><code class="n">message</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Optimization terminated successfully.</code><code class="s1">'</code><code>
</code><code>             </code><code class="n">nfev</code><code class="p">:</code><code> </code><code class="mi">17</code><code>
</code><code>              </code><code class="n">nit</code><code class="p">:</code><code> </code><code class="mi">4</code><code>
</code><code>             </code><code class="n">njev</code><code class="p">:</code><code> </code><code class="mi">4</code><code>
</code><code>           </code><code class="n">status</code><code class="p">:</code><code> </code><code class="mi">0</code><code>
</code><code>          </code><code class="n">success</code><code class="p">:</code><code> </code><code class="bp">True</code><code>
</code><code>                </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">0.46511697</code><code class="p">,</code><code> </code><code class="mf">0.53488303</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">65</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">sharpe</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">mu_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code> </code><code class="o">/</code><code> </code><code class="n">sigma_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO9-2" href="#callout_normative_finance_CO9-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">66</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">max_sharpe</code><code> </code><code class="o">=</code><code> </code><code class="n">minimize</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">phi</code><code class="p">:</code><code> </code><code class="o">-</code><code class="n">sharpe</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code><code> </code><code class="mf">0.5</code><code class="p">)</code><code class="p">,</code><code>
</code><code>                        </code><code class="n">constraints</code><code class="o">=</code><code class="n">cons</code><code class="p">,</code><code> </code><code class="n">bounds</code><code class="o">=</code><code class="n">bnds</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO9-3" href="#callout_normative_finance_CO9-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">67</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">max_sharpe</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">67</code><code class="p">]</code><code class="p">:</code><code>      </code><code class="n">fun</code><code class="p">:</code><code> </code><code class="o">-</code><code class="mf">0.2721654098971811</code><code>
</code><code>              </code><code class="n">jac</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code> </code><code class="mf">0.00012054</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">0.00024174</code><code class="p">]</code><code class="p">)</code><code>
</code><code>          </code><code class="n">message</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Optimization terminated successfully.</code><code class="s1">'</code><code>
</code><code>             </code><code class="n">nfev</code><code class="p">:</code><code> </code><code class="mi">38</code><code>
</code><code>              </code><code class="n">nit</code><code class="p">:</code><code> </code><code class="mi">9</code><code>
</code><code>             </code><code class="n">njev</code><code class="p">:</code><code> </code><code class="mi">9</code><code>
</code><code>           </code><code class="n">status</code><code class="p">:</code><code> </code><code class="mi">0</code><code>
</code><code>          </code><code class="n">success</code><code class="p">:</code><code> </code><code class="bp">True</code><code>
</code><code>                </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">0.66731116</code><code class="p">,</code><code> </code><code class="mf">0.33268884</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">68</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">mcs</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">mcs</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ro</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">ms</code><code class="o">=</code><code class="mi">5</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sigma_phi</code><code class="p">(</code><code class="n">min_var</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">mu_phi</code><code class="p">(</code><code class="n">min_var</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code>
</code><code>                  </code><code class="s1">'</code><code class="s1">^</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">ms</code><code class="o">=</code><code class="mf">12.5</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">minimum volatility</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sigma_phi</code><code class="p">(</code><code class="n">max_sharpe</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">mu_phi</code><code class="p">(</code><code class="n">max_sharpe</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code>
</code><code>                  </code><code class="s1">'</code><code class="s1">v</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">ms</code><code class="o">=</code><code class="mf">12.5</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">maximum Sharpe ratio</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected volatility</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected return</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO9-1" href="#co_normative_finance_CO9-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Minimizes the expected portfolio volatility</p></dd>
<dt><a class="co" id="callout_normative_finance_CO9-2" href="#co_normative_finance_CO9-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Defines the Sharpe ratio function, assuming a short rate of <code>0</code></p></dd>
<dt><a class="co" id="callout_normative_finance_CO9-3" href="#co_normative_finance_CO9-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Maximizes the Sharpe ratio by minimizing its negative value</p></dd>
</dl>

<figure><div id="figure_nf_03" class="figure">
<img src="Images/aiif_0303.png" alt="aiif 0303" width="2545" height="1492"/>
<h6><span class="label">Figure 3-3. </span>Minimum volatility and maximum Sharpe ratio portfolios</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Efficient frontier"><div class="sect3" id="idm45625329221784">
<h3>Efficient frontier</h3>

<p><a data-type="indexterm" data-primary="efficient frontier" id="idm45625329220344"/><a data-type="indexterm" data-primary="efficient versus inefficient portfolio, MVP theory" id="idm45625328519688"/>An <em>efficient portfolio</em> is one that has a maximum expected return (risk) given its expected risk (return). In <a data-type="xref" href="#figure_nf_03">Figure 3-3</a>, all those portfolios that have a lower expected return than the minimum risk portfolio are <em>inefficient</em>. The following code derives the efficient portfolios in risk-return space and plots them as seen in <a data-type="xref" href="#figure_nf_04">Figure 3-4</a>. The set of all efficient portfolios is called the <em>efficient frontier</em>, and agents will only choose a portfolio that lies on the efficient frontier:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">69</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">cons</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">{</code><code class="s1">'</code><code class="s1">type</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">eq</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">fun</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="k">lambda</code><code> </code><code class="n">phi</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">}</code><code class="p">,</code><code>
</code><code>                </code><code class="p">{</code><code class="s1">'</code><code class="s1">type</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">eq</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">fun</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="k">lambda</code><code> </code><code class="n">phi</code><code class="p">:</code><code> </code><code class="n">mu_phi</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code> </code><code class="o">-</code><code> </code><code class="n">target</code><code class="p">}</code><code class="p">]</code><code>  </code><a class="co" id="co_normative_finance_CO10-1" href="#callout_normative_finance_CO10-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">70</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">bnds</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">71</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">targets</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="n">mu_phi</code><code class="p">(</code><code class="n">min_var</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code> </code><code class="mf">0.16</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO10-2" href="#callout_normative_finance_CO10-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">72</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">frontier</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>
</code><code>         </code><code class="k">for</code><code> </code><code class="n">target</code><code> </code><code class="ow">in</code><code> </code><code class="n">targets</code><code class="p">:</code><code>
</code><code>             </code><code class="n">phi_eff</code><code> </code><code class="o">=</code><code> </code><code class="n">minimize</code><code class="p">(</code><code class="n">sigma_phi</code><code class="p">,</code><code> </code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code><code> </code><code class="mf">0.5</code><code class="p">)</code><code class="p">,</code><code>
</code><code>                                </code><code class="n">constraints</code><code class="o">=</code><code class="n">cons</code><code class="p">,</code><code> </code><code class="n">bounds</code><code class="o">=</code><code class="n">bnds</code><code class="p">)</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code>  </code><a class="co" id="co_normative_finance_CO10-3" href="#callout_normative_finance_CO10-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>             </code><code class="n">frontier</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="p">(</code><code class="n">sigma_phi</code><code class="p">(</code><code class="n">phi_eff</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">mu_phi</code><code class="p">(</code><code class="n">phi_eff</code><code class="p">)</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">frontier</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="n">frontier</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">73</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">frontier</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">frontier</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">mo</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">ms</code><code class="o">=</code><code class="mi">5</code><code class="p">,</code><code>
</code><code>                  </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">efficient frontier</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sigma_phi</code><code class="p">(</code><code class="n">min_var</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">mu_phi</code><code class="p">(</code><code class="n">min_var</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code>
</code><code>                  </code><code class="s1">'</code><code class="s1">^</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">ms</code><code class="o">=</code><code class="mf">12.5</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">minimum volatility</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sigma_phi</code><code class="p">(</code><code class="n">max_sharpe</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">mu_phi</code><code class="p">(</code><code class="n">max_sharpe</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code>
</code><code>                  </code><code class="s1">'</code><code class="s1">v</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">ms</code><code class="o">=</code><code class="mf">12.5</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">maximum Sharpe ratio</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected volatility</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected return</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO10-1" href="#co_normative_finance_CO10-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The new constraint fixes a target level for the expected return.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO10-2" href="#co_normative_finance_CO10-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Generates the set of target expected returns.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO10-3" href="#co_normative_finance_CO10-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Derives the minimum volatility portfolio given a target expected return.<a data-type="indexterm" data-primary="" data-startref="ix_MVP_gen" id="idm45625329127240"/><a data-type="indexterm" data-primary="" data-startref="ix_MVP_risk_meas_ch3" id="idm45625328725816"/><a data-type="indexterm" data-primary="" data-startref="ix_norm_fin_MVP_ch3" id="idm45625328724872"/><a data-type="indexterm" data-primary="" data-startref="ix_portfolio_MVP_ch3" id="idm45625328723928"/><a data-type="indexterm" data-primary="" data-startref="ix_uncertain_risk_MVP" id="idm45625328722984"/></p></dd>
</dl>

<figure><div id="figure_nf_04" class="figure">
<img src="Images/aiif_0304.png" alt="aiif 0304" width="2510" height="1492"/>
<h6><span class="label">Figure 3-4. </span>Efficient frontier</h6>
</div></figure>
</div></section>



</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Capital Asset Pricing Model"><div class="sect1" id="cap_model">
<h1>Capital Asset Pricing Model</h1>

<p><a data-type="indexterm" data-primary="CAPM (capital asset pricing model)" data-secondary="risk measures and" id="ix_capm_risk_meas_ch3"/><a data-type="indexterm" data-primary="uncertainty and risk" data-secondary="capital asset pricing model" id="ix_uncertain_risk_CAPM"/><a data-type="indexterm" data-primary="CAPM (capital asset pricing model)" id="ix_capm_gen"/>The capital asset pricing model (CAPM) is one of the most widely documented and applied models in finance. At its core, it relates in linear fashion the expected return for a single stock to the expected return of the market portfolio, usually approximated by a broad stock index such as the S&amp;P 500. The model dates back to the pioneering work of Sharpe (1964) and Lintner (1965). Jones (2012, ch. 9) describes the CAPM in relation to MVP as follows:</p>
<blockquote>
<p>Capital market theory is a positive theory in that it hypothesizes how investors do behave rather than how investors should behave, as in the case of modern portfolio theory (MVP). It is reasonable to view capital market theory as an extension of portfolio theory, but it is important to understand that MVP is not based on the validity, or lack thereof, of capital market theory.</p>

<p>The specific equilibrium model of interest to many investors is known as the capital asset pricing model, typically referred to as the CAPM. It allows us to assess the relevant risk of an individual security as well as to assess the relationship between risk and the returns expected from investing. The CAPM is attractive as an equilibrium model because of its simplicity and its implications.</p></blockquote>








<section data-type="sect2" data-pdf-bookmark="Assumptions and Results"><div class="sect2" id="idm45625328535544">
<h2>Assumptions and Results</h2>

<p>Assume the static model economy from the previous section <math alttext="script upper M Superscript upper N Baseline equals left-parenthesis StartSet normal upper Omega comma script upper F comma upper P EndSet comma double-struck upper A right-parenthesis">
  <mrow>
    <msup><mi>ℳ</mi> <mi>N</mi> </msup>
    <mo>=</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>{</mo>
        <mi>Ω</mi>
        <mo>,</mo>
        <mi>ℱ</mi>
        <mo>,</mo>
        <mi>P</mi>
        <mo>}</mo>
      </mrow>
      <mo>,</mo>
      <mi>𝔸</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math> with <math alttext="upper N">
  <mi>N</mi>
</math> traded assets and all simplifying assumptions. In the CAPM, agents are assumed to invest according to MVP, caring only about the risk and return statistics of risky assets over one period.</p>

<p><a data-type="indexterm" data-primary="portfolios" data-secondary="in CAPM theory" data-secondary-sortas="CAPM theory" id="idm45625329240840"/><a data-type="indexterm" data-primary="capital market equilibrium" id="idm45625329239592"/>In a <em>capital market equilibrium</em>, all available assets are held by all agents and the markets clear. Since agents are assumed to be identical in that they use MVP to form their efficient portfolios, this implies that all agents must hold the same efficient portfolio (in terms of composition) since the set of tradable assets is the same for every agent. In other words, the <em>market portfolio</em> (set of tradable assets) must lie on the efficient frontier. If this were not the case, the market could not be in equilibrium.</p>

<p>What is the mechanism to obtain a capital market equilibrium? Today’s prices of the tradable assets are the mechanism to make sure that markets clear. If agents do not demand enough of a tradable asset, its price needs to decrease. If demand is higher than supply, its price needs to increase. If prices are set correctly, demand and supply are equal for every tradable asset. <a data-type="indexterm" data-primary="portfolios" data-secondary="MVP theory" id="idm45625329236712"/><a data-type="indexterm" data-primary="MVP (mean-variance portfolio) theory" data-secondary="versus CAPM" data-secondary-sortas="CAPM" id="idm45625329235736"/><a data-type="indexterm" data-primary="normative financial theories and models" data-secondary="mean-variance portfolio theory" id="idm45625327914120"/>While MVP takes the prices of tradable assets as given, the CAPM is a theory and model about what the equilibrium price of an asset <em>should be</em>, given its risk-return characteristics.</p>

<p>The CAPM assumes the existence of (at least) one risk-free asset in which every agent can invest any amount and which earns the risk-free rate of <math alttext="r overbar">
  <mover accent="true"><mi>r</mi> <mo>¯</mo></mover>
</math>. <a data-type="indexterm" data-primary="two fund separation theorem" id="idm45625327909768"/>Every agent will therefore hold a combination of the market portfolio and the risk-free asset in equilibrium, something known as the <em>two fund separation theorem</em>.<sup><a data-type="noteref" id="idm45625327908440-marker" href="ch03.xhtml#idm45625327908440">9</a></sup> <a data-type="indexterm" data-primary="portfolios" data-secondary="CML" id="ix_portfolio_CML_gen"/><a data-type="indexterm" data-primary="CML (capital market line)" id="ix_CML_gen"/>The set of all such portfolios is called the <em>capital market line</em> (CML). <a data-type="xref" href="#figure_nf_05">Figure 3-5</a> shows the CML schematically. Portfolios to the right of the market portfolio are only achievable if agents are allowed to sell the risk-free asset short and to borrow money that way:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">74</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">((</code><code class="mi">0</code><code class="p">,</code> <code class="mf">0.3</code><code class="p">),</code> <code class="p">(</code><code class="mf">0.01</code><code class="p">,</code> <code class="mf">0.22</code><code class="p">),</code> <code class="n">label</code><code class="o">=</code><code class="s1">'capital market line'</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mf">0.01</code><code class="p">,</code> <code class="s1">'o'</code><code class="p">,</code> <code class="n">ms</code><code class="o">=</code><code class="mi">9</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'risk-less asset'</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="mf">0.2</code><code class="p">,</code> <code class="mf">0.15</code><code class="p">,</code> <code class="s1">'^'</code><code class="p">,</code> <code class="n">ms</code><code class="o">=</code><code class="mi">9</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'market portfolio'</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s1">'$(0, </code><code class="se">\\</code><code class="s1">bar{r})$'</code><code class="p">,</code> <code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mf">0.01</code><code class="p">),</code> <code class="p">(</code><code class="o">-</code><code class="mf">0.01</code><code class="p">,</code> <code class="mf">0.02</code><code class="p">))</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s1">'$(\sigma_M, \mu_M)$'</code><code class="p">,</code> <code class="p">(</code><code class="mf">0.2</code><code class="p">,</code> <code class="mf">0.15</code><code class="p">),</code> <code class="p">(</code><code class="mf">0.19</code><code class="p">,</code> <code class="mf">0.16</code><code class="p">))</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'expected volatility'</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s1">'expected return'</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">();</code></pre>

<figure><div id="figure_nf_05" class="figure">
<img src="Images/aiif_0305.png" alt="aiif 0305" width="2510" height="1492"/>
<h6><span class="label">Figure 3-5. </span>Capital market line (CML)</h6>
</div></figure>

<p>If <math alttext="sigma Subscript upper M Baseline comma mu Subscript upper M Baseline">
  <mrow>
    <msub><mi>σ</mi> <mi>M</mi> </msub>
    <mo>,</mo>
    <msub><mi>μ</mi> <mi>M</mi> </msub>
  </mrow>
</math> are the expected volatility and return of the market portfolio, the capital market line relating the expected portfolio return <math alttext="mu">
  <mi>μ</mi>
</math> to the expected volatility <math alttext="sigma">
  <mi>σ</mi>
</math> is defined by the following:</p>
<div data-type="equation">
<math alttext="mu equals r overbar plus StartFraction mu Subscript upper M Baseline minus r overbar Over sigma Subscript upper M Baseline EndFraction sigma" display="block">
  <mrow>
    <mi>μ</mi>
    <mo>=</mo>
    <mover accent="true"><mi>r</mi> <mo>¯</mo></mover>
    <mo>+</mo>
    <mfrac><mrow><msub><mi>μ</mi> <mi>M</mi> </msub><mo>-</mo><mover accent="true"><mi>r</mi> <mo>¯</mo></mover></mrow> <msub><mi>σ</mi> <mi>M</mi> </msub></mfrac>
    <mi>σ</mi>
  </mrow>
</math>
</div>

<p>The following expression is called the <em>market price of risk</em>:</p>
<div data-type="equation">
<math alttext="StartFraction mu Subscript upper M Baseline minus r overbar Over sigma Subscript upper M Baseline EndFraction" display="block">
  <mfrac><mrow><msub><mi>μ</mi> <mi>M</mi> </msub><mo>-</mo><mover accent="true"><mi>r</mi> <mo>¯</mo></mover></mrow> <msub><mi>σ</mi> <mi>M</mi> </msub></mfrac>
</math>
</div>

<p>It expresses how much more expected return in equilibrium is needed for an agent to bear one unit more of risk.</p>

<p>The CAPM then relates the expected return of any tradable risky asset <math alttext="n equals 1 comma 2 comma ellipsis comma upper N">
  <mrow>
    <mi>n</mi>
    <mo>=</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mo>...</mo>
    <mo>,</mo>
    <mi>N</mi>
  </mrow>
</math> to the expected return of the market portfolio as follows:</p>
<div data-type="equation">
<math alttext="mu Superscript n Baseline equals r overbar plus beta Subscript n Baseline left-parenthesis mu Subscript upper M Baseline minus r overbar right-parenthesis" display="block">
  <mrow>
    <msup><mi>μ</mi> <mi>n</mi> </msup>
    <mo>=</mo>
    <mover accent="true"><mi>r</mi> <mo>¯</mo></mover>
    <mo>+</mo>
    <msub><mi>β</mi> <mi>n</mi> </msub>
    <mrow>
      <mo>(</mo>
      <msub><mi>μ</mi> <mi>M</mi> </msub>
      <mo>-</mo>
      <mover accent="true"><mi>r</mi> <mo>¯</mo></mover>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>
<div style="page-break-after: always;"/>

<p>Here, <math alttext="beta Subscript n">
  <msub><mi>β</mi> <mi>n</mi> </msub>
</math> is defined by the covariance of the market portfolio with the risky asset <math alttext="n">
  <mi>n</mi>
</math> divided by the variance of the market portfolio itself:</p>
<div data-type="equation">
<math alttext="beta Subscript n Baseline equals StartFraction sigma Subscript upper M comma n Baseline Over sigma Subscript upper M Superscript 2 Baseline EndFraction" display="block">
  <mrow>
    <msub><mi>β</mi> <mi>n</mi> </msub>
    <mo>=</mo>
    <mfrac><msub><mi>σ</mi> <mrow><mi>M</mi><mo>,</mo><mi>n</mi></mrow> </msub> <msubsup><mi>σ</mi> <mi>M</mi> <mn>2</mn> </msubsup></mfrac>
  </mrow>
</math>
</div>

<p><a data-type="indexterm" data-primary="market risk" id="idm45625328769912"/><a data-type="indexterm" data-primary="nondiversifiable risk" id="idm45625328768984"/><a data-type="indexterm" data-primary="systemic risk" id="idm45625328768312"/>When <math alttext="beta Subscript n Baseline equals 0">
  <mrow>
    <msub><mi>β</mi> <mi>n</mi> </msub>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math>, the expected return according to the CAPM formula is the risk-free rate. The higher <math alttext="beta Subscript n">
  <msub><mi>β</mi> <mi>n</mi> </msub>
</math> is, the higher the expected return for the risky asset will be. <math alttext="beta Subscript n">
  <msub><mi>β</mi> <mi>n</mi> </msub>
</math> measures <em>risk that is nondiversifiable</em>. This type of risk is also called <em>market risk</em> or <em>systemic risk</em>. According to the CAPM, this is the only risk for which an agent should be rewarded with a higher expected return.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Numerical Example"><div class="sect2" id="idm45625328535016">
<h2>Numerical Example</h2>

<p>Assume the static model economy with three possible future states from before <math alttext="script upper M cubed equals left-parenthesis StartSet normal upper Omega comma script upper F comma upper P EndSet comma double-struck upper A right-parenthesis">
  <mrow>
    <msup><mi>ℳ</mi> <mn>3</mn> </msup>
    <mo>=</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>{</mo>
        <mi>Ω</mi>
        <mo>,</mo>
        <mi>ℱ</mi>
        <mo>,</mo>
        <mi>P</mi>
        <mo>}</mo>
      </mrow>
      <mo>,</mo>
      <mi>𝔸</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math> with the opportunity to borrow and lend at a risk-free rate of <math alttext="r overbar equals">
  <mrow>
    <mover accent="true"><mi>r</mi> <mo>¯</mo></mover>
    <mo>=</mo>
  </mrow>
</math> 0.0025. The two risky assets <math alttext="upper S comma upper T">
  <mrow>
    <mi>S</mi>
    <mo>,</mo>
    <mi>T</mi>
  </mrow>
</math> are available in quantities of 0.8 and 0.2, respectively.</p>










<section data-type="sect3" data-pdf-bookmark="Capital market line"><div class="sect3" id="idm45625328743176">
<h3>Capital market line</h3>

<p><a data-type="xref" href="#figure_nf_06">Figure 3-6</a> shows the efficient frontier, the market portfolio, the risk-less asset, and the resulting capital market line in risk-return space:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">75</code><code class="p">]:</code> <code class="n">phi_M</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">((</code><code class="mf">0.8</code><code class="p">,</code> <code class="mf">0.2</code><code class="p">))</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">76</code><code class="p">]:</code> <code class="n">mu_M</code> <code class="o">=</code> <code class="n">mu_phi</code><code class="p">(</code><code class="n">phi_M</code><code class="p">)</code>
         <code class="n">mu_M</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">76</code><code class="p">]:</code> <code class="mf">0.10666666666666666</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">77</code><code class="p">]:</code> <code class="n">sigma_M</code> <code class="o">=</code> <code class="n">sigma_phi</code><code class="p">(</code><code class="n">phi_M</code><code class="p">)</code>
         <code class="n">sigma_M</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">77</code><code class="p">]:</code> <code class="mf">0.39474323581566567</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">78</code><code class="p">]:</code> <code class="n">r</code> <code class="o">=</code> <code class="mf">0.0025</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">79</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">frontier</code><code class="p">[:,</code> <code class="mi">0</code><code class="p">],</code> <code class="n">frontier</code><code class="p">[:,</code> <code class="mi">1</code><code class="p">],</code> <code class="s1">'m.'</code><code class="p">,</code> <code class="n">ms</code><code class="o">=</code><code class="mi">5</code><code class="p">,</code>
                  <code class="n">label</code><code class="o">=</code><code class="s1">'efficient frontier'</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="n">r</code><code class="p">,</code> <code class="s1">'o'</code><code class="p">,</code> <code class="n">ms</code><code class="o">=</code><code class="mi">9</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'risk-less asset'</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sigma_M</code><code class="p">,</code> <code class="n">mu_M</code><code class="p">,</code> <code class="s1">'^'</code><code class="p">,</code> <code class="n">ms</code><code class="o">=</code><code class="mi">9</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'market portfolio'</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">((</code><code class="mi">0</code><code class="p">,</code> <code class="mf">0.6</code><code class="p">),</code> <code class="p">(</code><code class="n">r</code><code class="p">,</code> <code class="n">r</code> <code class="o">+</code> <code class="p">((</code><code class="n">mu_M</code> <code class="o">-</code> <code class="n">r</code><code class="p">)</code> <code class="o">/</code> <code class="n">sigma_M</code><code class="p">)</code> <code class="o">*</code> <code class="mf">0.6</code><code class="p">),</code>
                  <code class="s1">'r'</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'capital market line'</code><code class="p">,</code> <code class="n">lw</code><code class="o">=</code><code class="mf">2.0</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s1">'$(0, </code><code class="se">\\</code><code class="s1">bar{r})$'</code><code class="p">,</code> <code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="n">r</code><code class="p">),</code> <code class="p">(</code><code class="o">-</code><code class="mf">0.015</code><code class="p">,</code> <code class="n">r</code> <code class="o">+</code> <code class="mf">0.01</code><code class="p">))</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s1">'$(\sigma_M, \mu_M)$'</code><code class="p">,</code> <code class="p">(</code><code class="n">sigma_M</code><code class="p">,</code> <code class="n">mu_M</code><code class="p">),</code>
                      <code class="p">(</code><code class="n">sigma_M</code> <code class="o">-</code> <code class="mf">0.025</code><code class="p">,</code> <code class="n">mu_M</code> <code class="o">+</code> <code class="mf">0.01</code><code class="p">))</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'expected volatility'</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s1">'expected return'</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">();</code></pre>

<figure><div id="figure_nf_06" class="figure">
<img src="Images/aiif_0306.png" alt="aiif 0306" width="2510" height="1492"/>
<h6><span class="label">Figure 3-6. </span>Capital market line with two risky assets</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Optimal portfolio"><div class="sect3" id="idm45625328733320">
<h3>Optimal portfolio</h3>

<p>Assume an agent with an expected utility function defined over future payoffs as 
<span class="keep-together">follows:</span></p>
<div data-type="equation">
<math alttext="upper U colon double-struck upper X right-arrow double-struck upper R Subscript plus Baseline comma x right-arrow from bar bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis x right-parenthesis right-parenthesis equals bold upper E Superscript upper P Baseline left-parenthesis x minus StartFraction b Over 2 EndFraction x squared right-parenthesis" display="block">
  <mrow>
    <mi>U</mi>
    <mo>:</mo>
    <mi>𝕏</mi>
    <mo>→</mo>
    <msub><mi>ℝ</mi> <mo>+</mo> </msub>
    <mo>,</mo>
    <mi>x</mi>
    <mo>↦</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>u</mi>
      <mrow>
        <mo>(</mo>
        <mi>x</mi>
        <mo>)</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mfenced separators="" open="(" close=")">
      <mi>x</mi>
      <mo>-</mo>
      <mfrac><mi>b</mi> <mn>2</mn></mfrac>
      <msup><mi>x</mi> <mn>2</mn> </msup>
    </mfenced>
  </mrow>
</math>
</div>

<p>Here, <math alttext="b greater-than 0">
  <mrow>
    <mi>b</mi>
    <mo>&gt;</mo>
    <mn>0</mn>
  </mrow>
</math>. After some transformations, the expected utility function can then be expressed over risk-return combinations:</p>
<div data-type="equation">
<math alttext="upper U colon double-struck upper R Subscript double-struck plus Baseline times double-struck upper R Subscript double-struck plus Baseline right-arrow double-struck upper R comma left-parenthesis sigma comma mu right-parenthesis right-arrow from bar mu minus StartFraction b Over 2 EndFraction left-parenthesis sigma squared plus mu squared right-parenthesis" display="block">
  <mrow>
    <mi>U</mi>
    <mo>:</mo>
    <msub><mi>ℝ</mi> <mo>+</mo> </msub>
    <mo>×</mo>
    <msub><mi>ℝ</mi> <mo>+</mo> </msub>
    <mo>→</mo>
    <mi>ℝ</mi>
    <mo>,</mo>
    <mrow>
      <mo>(</mo>
      <mi>σ</mi>
      <mo>,</mo>
      <mi>μ</mi>
      <mo>)</mo>
    </mrow>
    <mo>↦</mo>
    <mi>μ</mi>
    <mo>-</mo>
    <mfrac><mi>b</mi> <mn>2</mn></mfrac>
    <mrow>
      <mo>(</mo>
      <msup><mi>σ</mi> <mn>2</mn> </msup>
      <mo>+</mo>
      <msup><mi>μ</mi> <mn>2</mn> </msup>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>
<div data-type="caution"><h1>Specific Quadratic Utility Function</h1>
<p><a data-type="indexterm" data-primary="portfolios" data-secondary="MVP theory" id="idm45625327567192"/><a data-type="indexterm" data-primary="quadratic utility, normative financial theories" id="idm45625327566216"/><a data-type="indexterm" data-primary="normative financial theories and models" data-secondary="mean-variance portfolio theory" id="idm45625327565448"/><a data-type="indexterm" data-primary="CAPM (capital asset pricing model)" data-secondary="versus EUT" data-secondary-sortas="EUT" id="idm45625327564424"/><a data-type="indexterm" data-primary="EUT (expected utility theory)" data-secondary="versus MVP and CAPM" data-secondary-sortas="MVP and CAPM" id="idm45625327563192"/><a data-type="indexterm" data-primary="MVP (mean-variance portfolio) theory" data-secondary="quadratic utility function in" id="idm45625327561960"/>Although the MVP theory and the CAPM both assume that investors only care about one period portfolio risk and return, this assumption is in general only consistent with the EUT when a specific form of the Bernoulli utility function is given: the quadratic utility.
This type of Bernoulli function is almost exclusively mentioned and used in the context of MVP theory. Beyond that, its particular form and characteristics are usually considered inappropriate. <a data-type="indexterm" data-primary="returns" data-secondary="normally distributed" id="idm45625327560376"/><a data-type="indexterm" data-primary="normally distributed returns" id="idm45625327559432"/>Neither the assumption of normally distributed asset returns nor the quadratic utility function seems to be an “elegant” way of reconciling the inconsistency between EUT on the one hand and MVP theory and the CAPM on the other hand.</p>
</div>

<p>What portfolio combination would the agent choose on the CML? A straightforward utility maximization, implemented in Python, yields the answer. To this end, fix the parameter <math alttext="b equals 1">
  <mrow>
    <mi>b</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">80</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">U</code><code class="p">(</code><code class="n">p</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="n">mu</code><code class="p">,</code><code> </code><code class="n">sigma</code><code> </code><code class="o">=</code><code> </code><code class="n">p</code><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">mu</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code> </code><code class="o">/</code><code> </code><code class="mi">2</code><code> </code><code class="o">*</code><code> </code><code class="p">(</code><code class="n">sigma</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code> </code><code class="o">+</code><code> </code><code class="n">mu</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO11-1" href="#callout_normative_finance_CO11-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">81</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">cons</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="s1">'</code><code class="s1">type</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">eq</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>                 </code><code class="s1">'</code><code class="s1">fun</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="k">lambda</code><code> </code><code class="n">p</code><code class="p">:</code><code> </code><code class="n">p</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="p">(</code><code class="n">r</code><code> </code><code class="o">+</code><code> </code><code class="p">(</code><code class="n">mu_M</code><code> </code><code class="o">-</code><code> </code><code class="n">r</code><code class="p">)</code><code> </code><code class="o">/</code><code> </code><code class="n">sigma_M</code><code> </code><code class="o">*</code><code> </code><code class="n">p</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="p">}</code><code>  </code><a class="co" id="co_normative_finance_CO11-2" href="#callout_normative_finance_CO11-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">82</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">opt</code><code> </code><code class="o">=</code><code> </code><code class="n">minimize</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">p</code><code class="p">:</code><code> </code><code class="o">-</code><code class="n">U</code><code class="p">(</code><code class="n">p</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="mf">0.1</code><code class="p">,</code><code> </code><code class="mf">0.3</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">constraints</code><code class="o">=</code><code class="n">cons</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">83</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">opt</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">83</code><code class="p">]</code><code class="p">:</code><code>      </code><code class="n">fun</code><code class="p">:</code><code> </code><code class="o">-</code><code class="mf">0.034885186826739426</code><code>
</code><code>              </code><code class="n">jac</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mf">0.93256102</code><code class="p">,</code><code>  </code><code class="mf">0.24608851</code><code class="p">]</code><code class="p">)</code><code>
</code><code>          </code><code class="n">message</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Optimization terminated successfully.</code><code class="s1">'</code><code>
</code><code>             </code><code class="n">nfev</code><code class="p">:</code><code> </code><code class="mi">8</code><code>
</code><code>              </code><code class="n">nit</code><code class="p">:</code><code> </code><code class="mi">2</code><code>
</code><code>             </code><code class="n">njev</code><code class="p">:</code><code> </code><code class="mi">2</code><code>
</code><code>           </code><code class="n">status</code><code class="p">:</code><code> </code><code class="mi">0</code><code>
</code><code>          </code><code class="n">success</code><code class="p">:</code><code> </code><code class="bp">True</code><code>
</code><code>                </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">0.06743897</code><code class="p">,</code><code> </code><code class="mf">0.2460885</code><code> </code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO11-1" href="#co_normative_finance_CO11-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The utility function in risk-return space</p></dd>
<dt><a class="co" id="callout_normative_finance_CO11-2" href="#co_normative_finance_CO11-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>The condition that the portfolio be on the CML</p></dd>
</dl>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Indifference curves"><div class="sect3" id="idm45625328732856">
<h3>Indifference curves</h3>

<p><a data-type="indexterm" data-primary="indifference curves, risk-return space" id="ix_indiff_curves"/>A visual analysis can illustrate the optimal decision making of the agent. Fixing a utility level for the agent, one can plot <em>indifference curves</em> in risk-return space. An optimal portfolio is found when an indifference curve is tangent to the CML. Any other indifference curve (not touching the CML or cutting the CML twice) cannot identify an optimal portfolio.</p>

<p>First, here is some symbolic Python code that transforms the utility function in risk-return space into a functional relationship between <math alttext="mu">
  <mi>μ</mi>
</math> and <math alttext="sigma">
  <mi>σ</mi>
</math> for a fixed utility level <math alttext="v">
  <mi>v</mi>
</math> and a fixed parameter value <math alttext="b">
  <mi>b</mi>
</math>. <a data-type="xref" href="#figure_nf_07">Figure 3-7</a> shows two indifference curves. Every <math alttext="left-parenthesis sigma comma mu right-parenthesis">
  <mrow>
    <mo>(</mo>
    <mi>σ</mi>
    <mo>,</mo>
    <mi>μ</mi>
    <mo>)</mo>
  </mrow>
</math> combination on such an indifference curve yields the same utility; the agent is indifferent between such portfolios:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">84</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">from</code><code> </code><code class="nn">sympy</code><code> </code><code class="kn">import</code><code> </code><code class="o">*</code><code>
</code><code>         </code><code class="n">init_printing</code><code class="p">(</code><code class="n">use_unicode</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code><code> </code><code class="n">use_latex</code><code class="o">=</code><code class="bp">False</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">85</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">mu</code><code class="p">,</code><code> </code><code class="n">sigma</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">,</code><code> </code><code class="n">v</code><code> </code><code class="o">=</code><code> </code><code class="n">symbols</code><code class="p">(</code><code class="s1">'</code><code class="s1">mu sigma b v</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO12-1" href="#callout_normative_finance_CO12-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">86</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sol</code><code> </code><code class="o">=</code><code> </code><code class="n">solve</code><code class="p">(</code><code class="s1">'</code><code class="s1">mu - b / 2 * (sigma ** 2 + mu ** 2) - v</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">mu</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO12-2" href="#callout_normative_finance_CO12-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">87</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sol</code><code>  </code><a class="co" id="co_normative_finance_CO12-3" href="#callout_normative_finance_CO12-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">87</code><code class="p">]</code><code class="p">:</code><code>         </code><code class="n">_________________________</code><code>     </code><code class="n">_________________________</code><code>
</code><code>                </code><code class="o">/</code><code>    </code><code class="mi">2</code><code>      </code><code class="mi">2</code><code>                 </code><code class="o">/</code><code>    </code><code class="mi">2</code><code>      </code><code class="mi">2</code><code>
</code><code>          </code><code class="mi">1</code><code> </code><code class="o">-</code><code> </code><code>\</code><code class="o">/</code><code>  </code><code class="o">-</code><code> </code><code class="n">b</code><code> </code><code class="o">*</code><code class="n">sigma</code><code>  </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="o">*</code><code class="n">b</code><code class="o">*</code><code class="n">v</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code>   </code><code>\</code><code class="o">/</code><code>  </code><code class="o">-</code><code> </code><code class="n">b</code><code> </code><code class="o">*</code><code class="n">sigma</code><code>  </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="o">*</code><code class="n">b</code><code class="o">*</code><code class="n">v</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code>  </code><code class="o">+</code><code> </code><code class="mi">1</code><code>
</code><code>         </code><code class="p">[</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="p">,</code><code> </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="p">]</code><code>
</code><code>                         </code><code class="n">b</code><code>                                 </code><code class="n">b</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">88</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">u1</code><code> </code><code class="o">=</code><code> </code><code class="n">sol</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="o">.</code><code class="n">subs</code><code class="p">(</code><code class="p">{</code><code class="s1">'</code><code class="s1">b</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">v</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mf">0.1</code><code class="p">}</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO12-4" href="#callout_normative_finance_CO12-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">u1</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">88</code><code class="p">]</code><code class="p">:</code><code>        </code><code class="n">______________</code><code>
</code><code>               </code><code class="o">/</code><code>            </code><code class="mi">2</code><code>
</code><code>         </code><code class="mi">1</code><code> </code><code class="o">-</code><code> </code><code>\</code><code class="o">/</code><code>  </code><code class="mf">0.8</code><code> </code><code class="o">-</code><code> </code><code class="n">sigma</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">89</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">u2</code><code> </code><code class="o">=</code><code> </code><code class="n">sol</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="o">.</code><code class="n">subs</code><code class="p">(</code><code class="p">{</code><code class="s1">'</code><code class="s1">b</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">v</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mf">0.125</code><code class="p">}</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO12-5" href="#callout_normative_finance_CO12-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">u2</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">89</code><code class="p">]</code><code class="p">:</code><code>        </code><code class="n">_______________</code><code>
</code><code>               </code><code class="o">/</code><code>             </code><code class="mi">2</code><code>
</code><code>         </code><code class="mi">1</code><code> </code><code class="o">-</code><code> </code><code>\</code><code class="o">/</code><code>  </code><code class="mf">0.75</code><code> </code><code class="o">-</code><code> </code><code class="n">sigma</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">90</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">f1</code><code> </code><code class="o">=</code><code> </code><code class="n">lambdify</code><code class="p">(</code><code class="n">sigma</code><code class="p">,</code><code> </code><code class="n">u1</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO12-6" href="#callout_normative_finance_CO12-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">f2</code><code> </code><code class="o">=</code><code> </code><code class="n">lambdify</code><code class="p">(</code><code class="n">sigma</code><code class="p">,</code><code> </code><code class="n">u2</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO12-7" href="#callout_normative_finance_CO12-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">91</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">sigma_</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mf">0.0</code><code class="p">,</code><code> </code><code class="mf">0.5</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO12-8" href="#callout_normative_finance_CO12-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">u1_</code><code> </code><code class="o">=</code><code> </code><code class="n">f1</code><code class="p">(</code><code class="n">sigma_</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO12-9" href="#callout_normative_finance_CO12-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">u2_</code><code> </code><code class="o">=</code><code> </code><code class="n">f2</code><code class="p">(</code><code class="n">sigma_</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO12-10" href="#callout_normative_finance_CO12-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">92</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sigma_</code><code class="p">,</code><code> </code><code class="n">u1_</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">$v=0.1$</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sigma_</code><code class="p">,</code><code> </code><code class="n">u2_</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">--</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">$v=0.125$</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected volatility</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected return</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO12-1" href="#co_normative_finance_CO12-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Defines <code>SymPy</code> symbols</p></dd>
<dt><a class="co" id="callout_normative_finance_CO12-2" href="#co_normative_finance_CO12-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Solves the utility function for <math alttext="mu">
  <mi>μ</mi>
</math></p></dd>
<dt><a class="co" id="callout_normative_finance_CO12-3" href="#co_normative_finance_CO12-4"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Substitutes numerical values for <math alttext="b comma v">
  <mrow>
    <mi>b</mi>
    <mo>,</mo>
    <mi>v</mi>
  </mrow>
</math></p></dd>
<dt><a class="co" id="callout_normative_finance_CO12-4" href="#co_normative_finance_CO12-6"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Generates callable functions from the resulting equations</p></dd>
<dt><a class="co" id="callout_normative_finance_CO12-5" href="#co_normative_finance_CO12-8"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>Specifies values for <math alttext="sigma">
  <mi>σ</mi>
</math> over which to evaluate the functions</p></dd>
<dt><a class="co" id="callout_normative_finance_CO12-6" href="#co_normative_finance_CO12-9"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>Evaluates the callable functions for the two different utility levels</p></dd>
</dl>

<figure><div id="figure_nf_07" class="figure">
<img src="Images/aiif_0307.png" alt="aiif 0307" width="2537" height="1493"/>
<h6><span class="label">Figure 3-7. </span>Indifference curves in risk-return space</h6>
</div></figure>

<p>In a next step, the indifference curves need to be combined with the CML to find out visually what the optimal portfolio choice of the agent is. Making use of the previous numerical optimization results, <a data-type="xref" href="#figure_nf_08">Figure 3-8</a> shows the optimal portfolio—the point at which the indifference curve is tangent to the CML. <a data-type="xref" href="#figure_nf_08">Figure 3-8</a> shows that the agent indeed chooses a mixture of the market portfolio and the risk-less asset:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">93</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">u</code><code> </code><code class="o">=</code><code> </code><code class="n">sol</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="o">.</code><code class="n">subs</code><code class="p">(</code><code class="p">{</code><code class="s1">'</code><code class="s1">b</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">v</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="o">-</code><code class="n">opt</code><code class="p">[</code><code class="s1">'</code><code class="s1">fun</code><code class="s1">'</code><code class="p">]</code><code class="p">}</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO13-1" href="#callout_normative_finance_CO13-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">u</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">93</code><code class="p">]</code><code class="p">:</code><code>        </code><code class="n">____________________________</code><code>
</code><code>               </code><code class="o">/</code><code>                          </code><code class="mi">2</code><code>
</code><code>         </code><code class="mi">1</code><code> </code><code class="o">-</code><code> </code><code>\</code><code class="o">/</code><code>  </code><code class="mf">0.930229626346521</code><code> </code><code class="o">-</code><code> </code><code class="n">sigma</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">94</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">f</code><code> </code><code class="o">=</code><code> </code><code class="n">lambdify</code><code class="p">(</code><code class="n">sigma</code><code class="p">,</code><code> </code><code class="n">u</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">95</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">u_</code><code> </code><code class="o">=</code><code> </code><code class="n">f</code><code class="p">(</code><code class="n">sigma_</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO13-2" href="#callout_normative_finance_CO13-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">96</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="n">r</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">o</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">ms</code><code class="o">=</code><code class="mi">9</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">risk-less asset</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sigma_M</code><code class="p">,</code><code> </code><code class="n">mu_M</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">^</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">ms</code><code class="o">=</code><code class="mi">9</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">market portfolio</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">opt</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">opt</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">v</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">ms</code><code class="o">=</code><code class="mi">9</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">optimal portfolio</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mf">0.5</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="n">r</code><code class="p">,</code><code> </code><code class="n">r</code><code> </code><code class="o">+</code><code> </code><code class="p">(</code><code class="n">mu_M</code><code> </code><code class="o">-</code><code> </code><code class="n">r</code><code class="p">)</code><code> </code><code class="o">/</code><code> </code><code class="n">sigma_M</code><code> </code><code class="o">*</code><code> </code><code class="mf">0.5</code><code class="p">)</code><code class="p">,</code><code>
</code><code>                  </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">capital market line</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">lw</code><code class="o">=</code><code class="mf">2.0</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sigma_</code><code class="p">,</code><code> </code><code class="n">u_</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">--</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">$v={}$</code><code class="s1">'</code><code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="o">-</code><code class="nb">round</code><code class="p">(</code><code class="n">opt</code><code class="p">[</code><code class="s1">'</code><code class="s1">fun</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">)</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected volatility</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s1">'</code><code class="s1">expected return</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO13-1" href="#co_normative_finance_CO13-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Defines the indifference curve for the optimal utility level</p></dd>
<dt><a class="co" id="callout_normative_finance_CO13-2" href="#co_normative_finance_CO13-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Derives numerical values to plot the indifference curve</p></dd>
</dl>

<figure><div id="figure_nf_08" class="figure">
<img src="Images/aiif_0308.png" alt="aiif 0308" width="2537" height="1492"/>
<h6><span class="label">Figure 3-8. </span>Optimal portfolio on the CML</h6>
</div></figure>

<p><a data-type="indexterm" data-primary="CMT (capital market theory)" id="idm45625326763064"/>The topics presented in this sub-section are usually discussed under <em>capital market theory</em> (CMT). The CAPM is part of that theory and shall be illustrated by the use of real financial time series data in the next chapter.<a data-type="indexterm" data-primary="" data-startref="ix_capm_gen" id="idm45625326761736"/><a data-type="indexterm" data-primary="" data-startref="ix_capm_risk_meas_ch3" id="idm45625326760760"/><a data-type="indexterm" data-primary="" data-startref="ix_uncertain_risk_CAPM" id="idm45625326759816"/><a data-type="indexterm" data-primary="" data-startref="ix_CML_gen" id="idm45625326758872"/><a data-type="indexterm" data-primary="" data-startref="ix_portfolio_CML_gen" id="idm45625326755512"/><a data-type="indexterm" data-primary="" data-startref="ix_indiff_curves" id="idm45625326754568"/></p>
</div></section>



</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Arbitrage Pricing Theory"><div class="sect1" id="ap_theory">
<h1>Arbitrage Pricing Theory</h1>

<p><a data-type="indexterm" data-primary="uncertainty and risk" data-secondary="arbitrage pricing theory" id="ix_uncertain_risk_APT_2"/><a data-type="indexterm" data-primary="APT (arbitrage pricing theory)" data-secondary="risk measures and" id="ix_APT_risk_meas_2"/><a data-type="indexterm" data-primary="normative financial theories and models" data-secondary="arbitrage pricing theory" id="ix_norm_fin_APT_2"/><a data-type="indexterm" data-primary="APT (arbitrage pricing theory)" id="ix_APT_gen_ch3"/>Early on, shortcomings of the CAPM were observed and then addressed in the finance literature. One of the major generalizations of the CAPM is the arbitrage pricing theory (APT) as proposed in Ross (1971) and Ross (1976). <a data-type="indexterm" data-primary="Ross, Stephen" id="idm45625326222696"/>Ross (1976) introduces his paper as follows:</p>
<blockquote>
<p>The purpose of this paper is to examine rigorously the arbitrage model of capital asset pricing developed in Ross (1971). The arbitrage model was proposed as an alternative to the mean variance capital asset pricing model, introduced by Sharpe, Lintner, and Treynor, that has become the major analytic tool for explaining phenomena observed in capital markets for risky assets.</p></blockquote>








<section data-type="sect2" data-pdf-bookmark="Assumptions and Results"><div class="sect2" id="idm45625326220776">
<h2>Assumptions and Results</h2>

<p>The APT is a generalization of the CAPM to multiple risk factors. In that sense, APT does not assume that the market portfolio is the only relevant risk factor; there are rather multiple types of risk that together are assumed to drive the performance (expected returns) of a stock. Such risk factors might include size, volatility, value, and momentum.<sup><a data-type="noteref" id="idm45625326218712-marker" href="ch03.xhtml#idm45625326218712">10</a></sup> Beyond this major difference, the model relies on similar assumptions, such as that markets are perfect, that (unlimited) borrowing and lending are possible at the same constant rate, and so on.</p>

<p>In its original dynamic version, as found in Ross (1976), the APT takes on the 
<span class="keep-together">following</span> form:</p>
<div data-type="equation">
<math alttext="y Subscript t Baseline equals a plus upper B f Subscript t Baseline plus epsilon Subscript t" display="block">
  <mrow>
    <msub><mi>y</mi> <mi>t</mi> </msub>
    <mo>=</mo>
    <mi>a</mi>
    <mo>+</mo>
    <mi>B</mi>
    <msub><mi>f</mi> <mi>t</mi> </msub>
    <mo>+</mo>
    <msub><mi>ϵ</mi> <mi>t</mi> </msub>
  </mrow>
</math>
</div>

<p>Here, <math alttext="y Subscript t">
  <msub><mi>y</mi> <mi>t</mi> </msub>
</math> is the vector of <math alttext="upper M">
  <mi>M</mi>
</math> observed variables—say, the expected returns of <math alttext="upper M">
  <mi>M</mi>
</math> different stocks—at time <math alttext="t">
  <mi>t</mi>
</math>:</p>
<div data-type="equation">
<math alttext="y Subscript t Baseline equals Start 4 By 1 Matrix 1st Row  y Subscript t Superscript 1 Baseline 2nd Row  y Subscript t Superscript 2 Baseline 3rd Row   ellipsis 4th Row  y Subscript t Superscript upper M EndMatrix" display="block">
  <mrow>
    <msub><mi>y</mi> <mi>t</mi> </msub>
    <mo>=</mo>
    <mfenced open="[" close="]">
      <mtable>
        <mtr>
          <mtd>
            <msubsup><mi>y</mi> <mi>t</mi> <mn>1</mn> </msubsup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msubsup><mi>y</mi> <mi>t</mi> <mn>2</mn> </msubsup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mo>⋮</mo>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msubsup><mi>y</mi> <mi>t</mi> <mi>M</mi> </msubsup>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p><math alttext="a">
  <mi>a</mi>
</math> is the vector of <math alttext="upper M">
  <mi>M</mi>
</math> constant terms:</p>
<div data-type="equation">
<math alttext="a equals Start 4 By 1 Matrix 1st Row  a Superscript 1 Baseline 2nd Row  a squared 3rd Row   ellipsis 4th Row  a Superscript upper M EndMatrix" display="block">
  <mrow>
    <mi>a</mi>
    <mo>=</mo>
    <mfenced open="[" close="]">
      <mtable>
        <mtr>
          <mtd>
            <msup><mi>a</mi> <mn>1</mn> </msup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msup><mi>a</mi> <mn>2</mn> </msup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mo>⋮</mo>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msup><mi>a</mi> <mi>M</mi> </msup>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>
<div style="page-break-after: always;"/>

<p><math alttext="f Subscript t">
  <msub><mi>f</mi> <mi>t</mi> </msub>
</math> is the vector of <math alttext="upper F">
  <mi>F</mi>
</math> factors at time <math alttext="t">
  <mi>t</mi>
</math>:</p>
<div data-type="equation">
<math alttext="f Subscript t Baseline equals Start 4 By 1 Matrix 1st Row  f Subscript t Superscript 1 Baseline 2nd Row  f Subscript t Superscript 2 Baseline 3rd Row   ellipsis 4th Row  f Subscript t Superscript upper F EndMatrix" display="block">
  <mrow>
    <msub><mi>f</mi> <mi>t</mi> </msub>
    <mo>=</mo>
    <mfenced open="[" close="]">
      <mtable>
        <mtr>
          <mtd>
            <msubsup><mi>f</mi> <mi>t</mi> <mn>1</mn> </msubsup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msubsup><mi>f</mi> <mi>t</mi> <mn>2</mn> </msubsup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mo>⋮</mo>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msubsup><mi>f</mi> <mi>t</mi> <mi>F</mi> </msubsup>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p><math alttext="upper B">
  <mi>B</mi>
</math> is the <math alttext="upper M times upper F">
  <mrow>
    <mi>M</mi>
    <mo>×</mo>
    <mi>F</mi>
  </mrow>
</math> matrix of the so-called factor loadings:</p>
<div data-type="equation">
<math alttext="upper B equals Start 4 By 4 Matrix 1st Row 1st Column b 11 2nd Column b 12 3rd Column  ellipsis 4th Column b Subscript 1 upper F Baseline 2nd Row 1st Column b 21 2nd Column b 22 3rd Column  ellipsis 4th Column b Subscript 2 upper F Baseline 3rd Row 1st Column  ellipsis 2nd Column  ellipsis 3rd Column  ellipsis 4th Column  ellipsis 4th Row 1st Column b Subscript upper M Baseline 1 Baseline 2nd Column b Subscript upper M Baseline 2 Baseline 3rd Column  ellipsis 4th Column b Subscript upper M upper F EndMatrix" display="block">
  <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <mfenced open="[" close="]">
      <mtable>
        <mtr>
          <mtd>
            <msub><mi>b</mi> <mn>11</mn> </msub>
          </mtd>
          <mtd>
            <msub><mi>b</mi> <mn>12</mn> </msub>
          </mtd>
          <mtd>
            <mo>...</mo>
          </mtd>
          <mtd>
            <msub><mi>b</mi> <mrow><mn>1</mn><mi>F</mi></mrow> </msub>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub><mi>b</mi> <mn>21</mn> </msub>
          </mtd>
          <mtd>
            <msub><mi>b</mi> <mn>22</mn> </msub>
          </mtd>
          <mtd>
            <mo>...</mo>
          </mtd>
          <mtd>
            <msub><mi>b</mi> <mrow><mn>2</mn><mi>F</mi></mrow> </msub>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mo>⋮</mo>
          </mtd>
          <mtd>
            <mo>⋮</mo>
          </mtd>
          <mtd>
            <mo>⋱</mo>
          </mtd>
          <mtd>
            <mo>⋮</mo>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub><mi>b</mi> <mrow><mi>M</mi><mn>1</mn></mrow> </msub>
          </mtd>
          <mtd>
            <msub><mi>b</mi> <mrow><mi>M</mi><mn>2</mn></mrow> </msub>
          </mtd>
          <mtd>
            <mo>...</mo>
          </mtd>
          <mtd>
            <msub><mi>b</mi> <mrow><mi>M</mi><mi>F</mi></mrow> </msub>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p>Finally, <math alttext="epsilon Subscript t">
  <msub><mi>ϵ</mi> <mi>t</mi> </msub>
</math> is the vector of <math alttext="upper M">
  <mi>M</mi>
</math> sufficiently independent residual terms:</p>
<div data-type="equation">
<math alttext="epsilon Subscript t Baseline equals Start 4 By 1 Matrix 1st Row  epsilon Subscript t Superscript 1 Baseline 2nd Row  epsilon Subscript t Superscript 2 Baseline 3rd Row   ellipsis 4th Row  epsilon Subscript t Superscript upper M EndMatrix" display="block">
  <mrow>
    <msub><mi>ϵ</mi> <mi>t</mi> </msub>
    <mo>=</mo>
    <mfenced open="[" close="]">
      <mtable>
        <mtr>
          <mtd>
            <msubsup><mi>ϵ</mi> <mi>t</mi> <mn>1</mn> </msubsup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msubsup><mi>ϵ</mi> <mi>t</mi> <mn>2</mn> </msubsup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mo>⋮</mo>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msubsup><mi>ϵ</mi> <mi>t</mi> <mi>M</mi> </msubsup>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p>Jones (2012, ch. 9) describes the difference between the CAPM and the APT as 
<span class="keep-together">follows:</span></p>
<blockquote>
<p>Similar to the CAPM, or any other asset pricing model, APT posits a relationship between expected return and risk. It does so, however, using different assumptions and procedures. Very importantly, APT is not critically dependent on an underlying market portfolio as is the CAPM, which predicts that only market risk influences expected returns. Instead, APT recognizes that several types of risk may affect security returns.</p></blockquote>

<p><a data-type="indexterm" data-primary="OLS (ordinary least-squares) regression" data-secondary="CAPM versus APT" id="idm45625326152680"/><a data-type="indexterm" data-primary="CAPM (capital asset pricing model)" data-secondary="versus APT" data-secondary-sortas="APT" id="idm45625326151528"/>Both the CAPM and the APT relate the output variables with the relevant input factors in <em>linear</em> fashion. From an econometric point of view, both models are implemented based on linear ordinary least-squares (OLS) regression. <a data-type="indexterm" data-primary="multivariate linear OLS regression" id="idm45625326149528"/><a data-type="indexterm" data-primary="univariate linear OLS regression" id="idm45625326148808"/>While the CAPM can be implemented based on <em>univariate</em> linear OLS regression, the APT requires <em>multivariate</em> OLS regression.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Numerical Example"><div class="sect2" id="idm45625326220248">
<h2>Numerical Example</h2>

<p>The following numerical example casts the APT in a static model, although the formulation given previously is a dynamic one. Assume the static model economy with three possible future states from the previous section, <math alttext="script upper M cubed equals left-parenthesis StartSet normal upper Omega comma script upper F comma upper P EndSet comma double-struck upper A right-parenthesis">
  <mrow>
    <msup><mi>ℳ</mi> <mn>3</mn> </msup>
    <mo>=</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo>{</mo>
        <mi>Ω</mi>
        <mo>,</mo>
        <mi>ℱ</mi>
        <mo>,</mo>
        <mi>P</mi>
        <mo>}</mo>
      </mrow>
      <mo>,</mo>
      <mi>𝔸</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>. Assume that the two risky assets are now the relevant risk factors in the economy and introduce a third asset <math alttext="upper V">
  <mi>V</mi>
</math> with the following future payoff:</p>
<div data-type="equation">
<math alttext="upper V 1 equals Start 3 By 1 Matrix 1st Row  12 2nd Row  15 3rd Row  7 EndMatrix" display="block">
  <mrow>
    <msub><mi>V</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mfenced open="[" close="]">
      <mtable>
        <mtr>
          <mtd>
            <mn>12</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>15</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>7</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p>Although two linearly independent vectors, such as <math alttext="upper S 1 comma upper T 1">
  <mrow>
    <msub><mi>S</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>T</mi> <mn>1</mn> </msub>
  </mrow>
</math>, cannot form a basis of <math alttext="double-struck upper R cubed">
  <msup><mi>ℝ</mi> <mn>3</mn> </msup>
</math>, they can nevertheless be used for an OLS regression to approximate the payoff <math alttext="upper V 1">
  <msub><mi>V</mi> <mn>1</mn> </msub>
</math>. The following Python code implements the OLS regression:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">97</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">M1</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">97</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">20</code><code class="p">,</code><code>  </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">12</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code> </code><code class="mi">5</code><code class="p">,</code><code> </code><code class="mi">13</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">98</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">M0</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">98</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">10</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">99</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">V1</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">12</code><code class="p">,</code><code> </code><code class="mi">15</code><code class="p">,</code><code> </code><code class="mi">7</code><code class="p">)</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">100</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">reg</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">lstsq</code><code class="p">(</code><code class="n">M1</code><code class="p">,</code><code> </code><code class="n">V1</code><code class="p">,</code><code> </code><code class="n">rcond</code><code class="o">=</code><code class="o">-</code><code class="mi">1</code><code class="p">)</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code>  </code><a class="co" id="co_normative_finance_CO14-1" href="#callout_normative_finance_CO14-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>          </code><code class="n">reg</code><code>  </code><a class="co" id="co_normative_finance_CO14-2" href="#callout_normative_finance_CO14-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">100</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">0.6141665</code><code> </code><code class="p">,</code><code> </code><code class="mf">0.50030531</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">101</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M1</code><code class="p">,</code><code> </code><code class="n">reg</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">101</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">12.78363525</code><code class="p">,</code><code> </code><code class="mf">12.14532872</code><code class="p">,</code><code>  </code><code class="mf">9.57480155</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">102</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M1</code><code class="p">,</code><code> </code><code class="n">reg</code><code class="p">)</code><code> </code><code class="o">-</code><code> </code><code class="n">V1</code><code>  </code><a class="co" id="co_normative_finance_CO14-3" href="#callout_normative_finance_CO14-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">102</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code> </code><code class="mf">0.78363525</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">2.85467128</code><code class="p">,</code><code>  </code><code class="mf">2.57480155</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">103</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">V0</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M0</code><code class="p">,</code><code> </code><code class="n">reg</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO14-4" href="#callout_normative_finance_CO14-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>          </code><code class="n">V0</code><code>  </code><a class="co" id="co_normative_finance_CO14-5" href="#callout_normative_finance_CO14-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">103</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">11.144718094850402</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO14-1" href="#co_normative_finance_CO14-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The optimal regression parameters can be interpreted as factor loadings.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO14-2" href="#co_normative_finance_CO14-3"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>The two factors are not enough to explain the payoff <math alttext="upper V 1">
  <msub><mi>V</mi> <mn>1</mn> </msub>
</math>; the replication is imperfect, and the residual values are nonzero.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO14-3" href="#co_normative_finance_CO14-4"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>The factor loadings can be used to estimate an arbitrage-free price <math alttext="upper V 0">
  <msub><mi>V</mi> <mn>0</mn> </msub>
</math> for the risky asset <math alttext="upper V">
  <mi>V</mi>
</math>.</p></dd>
</dl>

<p>Obviously, the two factors are not enough to fully “explain” the payoff <math alttext="upper V 1">
  <msub><mi>V</mi> <mn>1</mn> </msub>
</math>. This is not too surprising given standard results from linear algebra.<sup><a data-type="noteref" id="idm45625325664472-marker" href="ch03.xhtml#idm45625325664472">11</a></sup> What about adding a third risk factor <math alttext="upper U">
  <mi>U</mi>
</math> to the model economy? Assume that the third risk factor <math alttext="upper U">
  <mi>U</mi>
</math> is defined by <math alttext="upper U 0 equals 10">
  <mrow>
    <msub><mi>U</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mn>10</mn>
  </mrow>
</math> and the following:</p>
<div data-type="equation">
<math alttext="upper U 1 equals Start 3 By 1 Matrix 1st Row  12 2nd Row  5 3rd Row  11 EndMatrix" display="block">
  <mrow>
    <msub><mi>U</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mfenced open="[" close="]">
      <mtable>
        <mtr>
          <mtd>
            <mn>12</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>5</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p>Now, the three risk factors together can explain (replicate) the payoff <math alttext="upper V 1">
  <msub><mi>V</mi> <mn>1</mn> </msub>
</math> fully (exactly):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">104</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">U0</code><code> </code><code class="o">=</code><code> </code><code class="mi">10</code><code>
</code><code>          </code><code class="n">U1</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">12</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">,</code><code> </code><code class="mi">11</code><code class="p">)</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">105</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">M0_</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">S0</code><code class="p">,</code><code> </code><code class="n">T0</code><code class="p">,</code><code> </code><code class="n">U0</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO15-1" href="#callout_normative_finance_CO15-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">106</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">M1_</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">concatenate</code><code class="p">(</code><code class="p">(</code><code class="n">M1</code><code class="o">.</code><code class="n">T</code><code class="p">,</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="n">U1</code><code class="p">,</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">T</code><code>  </code><a class="co" id="co_normative_finance_CO15-2" href="#callout_normative_finance_CO15-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">107</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">M1_</code><code>  </code><a class="co" id="co_normative_finance_CO15-3" href="#callout_normative_finance_CO15-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">107</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">20</code><code class="p">,</code><code>  </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">12</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                 </code><code class="p">[</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">12</code><code class="p">,</code><code>  </code><code class="mi">5</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                 </code><code class="p">[</code><code> </code><code class="mi">5</code><code class="p">,</code><code> </code><code class="mi">13</code><code class="p">,</code><code> </code><code class="mi">11</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">108</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">matrix_rank</code><code class="p">(</code><code class="n">M1_</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO15-4" href="#callout_normative_finance_CO15-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">108</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mi">3</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">109</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">reg</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">lstsq</code><code class="p">(</code><code class="n">M1_</code><code class="p">,</code><code> </code><code class="n">V1</code><code class="p">,</code><code> </code><code class="n">rcond</code><code class="o">=</code><code class="o">-</code><code class="mi">1</code><code class="p">)</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code>
</code><code>          </code><code class="n">reg</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">109</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code> </code><code class="mf">0.9575179</code><code> </code><code class="p">,</code><code>  </code><code class="mf">0.72553699</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">0.65632458</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">110</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">allclose</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M1_</code><code class="p">,</code><code> </code><code class="n">reg</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">V1</code><code class="p">)</code><code>  </code><a class="co" id="co_normative_finance_CO15-5" href="#callout_normative_finance_CO15-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">110</code><code class="p">]</code><code class="p">:</code><code> </code><code class="bp">True</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">111</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">V0_</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M0_</code><code class="p">,</code><code> </code><code class="n">reg</code><code class="p">)</code><code>
</code><code>          </code><code class="n">V0_</code><code>  </code><a class="co" id="co_normative_finance_CO15-6" href="#callout_normative_finance_CO15-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">111</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">10.267303102625307</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_normative_finance_CO15-1" href="#co_normative_finance_CO15-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Augmented market price vector.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO15-2" href="#co_normative_finance_CO15-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Augmented market payoff matrix with full rank.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO15-3" href="#co_normative_finance_CO15-5"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Exact replication of <math alttext="upper V 1">
  <msub><mi>V</mi> <mn>1</mn> </msub>
</math>. Residual values are zero.</p></dd>
<dt><a class="co" id="callout_normative_finance_CO15-4" href="#co_normative_finance_CO15-6"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Unique arbitrage-free price for the risky asset <math alttext="upper V">
  <mi>V</mi>
</math>.</p></dd>
</dl>

<p>The example here resembles the one presented in <a data-type="xref" href="#uncertainty_risk">“Uncertainty and Risk”</a> in that enough risk factors (tradable assets) can be used to derive an arbitrage-free price for a traded asset. APT does not necessarily require that perfect replication is possible; its very model formulation contains residual values. However, if perfect replication is possible, then the residual terms are zero, as in the previous example with three risk factors.<a data-type="indexterm" data-primary="" data-startref="ix_norm_fin_theory_ch3" id="idm45625325366984"/><a data-type="indexterm" data-primary="" data-startref="ix_APT_gen_ch3" id="idm45625325366040"/><a data-type="indexterm" data-primary="" data-startref="ix_APT_risk_meas_2" id="idm45625325365096"/><a data-type="indexterm" data-primary="" data-startref="ix_norm_fin_APT_2" id="idm45625325364152"/><a data-type="indexterm" data-primary="" data-startref="ix_uncertain_risk_APT_2" id="idm45625325363208"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Conclusions"><div class="sect1" id="idm45625326146728">
<h1>Conclusions</h1>

<p>Some of the early theories and models from the 1940s through the 1970s, in particular those presented in this chapter, are still central topics of finance textbooks and are still used in financial practice. One reason for this is that many of those mostly 
<span class="keep-together">normative</span> theories and models have a strong intellectual appeal to students, academics, and practitioners alike. They somehow “simply seem to make sense.” Using Python, numerical examples for the models presented are easily created, analyzed, and 
<span class="keep-together">visualized.</span></p>

<p>Despite theories and models such as MVP and CAPM being intellectually appealing, easy to implement, and mathematically elegant, it is surprising that they are still so popular today, for a few reasons. First, the popular theories and models presented in this chapter have hardly any meaningful empirical support. Second, some of the theories and models are even theoretically inconsistent with each other in a number of ways. Third, there has been continuous progress on the theoretical and modeling fronts of finance, such that alternative theories and models are available. Fourth, modern computational and empirical finance can rely on almost unlimited data sources and almost unlimited computational power, making concise, parsimonious, and elegant mathematical models and results less and less relevant.</p>

<p>The next chapter analyzes some of the theories and models introduced in this chapter on the basis of real financial data. While in the early years of quantitative finance, data was a scarce resource, today even students have access to a wealth of financial data and open source tools that allow the comprehensive analysis of financial theories and models based on real-world data. Empirical finance has always been an important sister discipline to theoretical finance. However, financial theory has usually driven empirical finance to a large extent. The new area of <em>data-driven finance</em> might lead to a lasting shift in the relative importance of theory as compared to data in finance.</p>
<div style="page-break-after: always;"/>
</div></section>













<section data-type="sect1" class="less_space" data-pdf-bookmark="References"><div class="sect1" id="idm45625325355512">
<h1>References</h1>

<p>Books and papers cited in this chapter:</p>

<ul class="author-date-bib">
<li>
<p>Bender, Jennifer et al. 2013. “Foundations of Factor Investing.” <em>MSCI Research Insight</em>. <a href="http://bit.ly/aiif_factor_invest"><em class="hyperlink">http://bit.ly/aiif_factor_invest</em></a>.</p>
</li>
<li>
<p>Calvello, Angelo. 2020. “Fund Managers Must Embrace AI Disruption.” <em>Financial Times</em>, January 15, 2020. <a href="http://bit.ly/aiif_ai_disrupt"><em class="hyperlink">http://bit.ly/aiif_ai_disrupt</em></a>.</p>
</li>
<li>
<p>Eichberger, Jürgen, and Ian R. Harper. 1997. <em>Financial Economics.</em> New York: Oxford University Press.</p>
</li>
<li>
<p>Fishburn, Peter. 1968. “Utility Theory.” <em>Management Science</em> 14 (5): 335-378.</p>
</li>
<li>
<p>Fama, Eugene F. and Kenneth R. French. 2004. “The Capital Asset Pricing Model: Theory and Evidence.” <em>Journal of Economic Perspectives</em> 18 (3): 25-46.</p>
</li>
<li>
<p>Halevy, Alon, Peter Norvig, and Fernando Pereira. 2009. “The Unreasonable Effectiveness of Data.” <em>IEEE Intelligent Systems</em>, Expert Opinion.</p>
</li>
<li>
<p>Hilpisch, Yves. 2015. <em>Derivatives Analytics with Python: Data Analysis, Models, Simulation, Calibration, and Hedging</em>. Wiley Finance.</p>
</li>
<li>
<p>Jacod, Jean, and Philip Protter. 2004. <em>Probability Essentials.</em> 2nd ed. Berlin: Springer.</p>
</li>
<li>
<p>Johnstone, David and Dennis Lindley. 2013. “Mean-Variance and Expected Utility: The Borch Paradox.” <em>Statistical Science</em> 28 (2): 223-237.</p>
</li>
<li>
<p>Jones, Charles P. 2012. <em>Investments: Analysis and Management.</em> 12th ed. Hoboken: John Wiley &amp; Sons.</p>
</li>
<li>
<p>Karni, Edi. 2014. “Axiomatic Foundations of Expected Utility and Subjective Probability.” In <em>Handbook of the Economics of Risk and Uncertainty</em>, edited by Mark J. Machina and W. Kip Viscusi, 1-39. Oxford: North Holland.</p>
</li>
<li>
<p>Lintner, John. 1965. “The Valuation of Risk Assets and the Selection of Risky Investments in Stock Portfolios and Capital Budgets.” <em>Review of Economics and Statistics</em> 47 (1): 13-37.</p>
</li>
<li>
<p>Markowitz, Harry. 1952. “Portfolio Selection.” <em>Journal of Finance</em> 7 (1): 77-91.</p>
</li>
<li>
<p>Pratt, John W. 1964. “Risk Aversion in the Small and in the Large.” <em>Econometrica</em> 32 (1/2): 122-136.</p>
</li>
<li>
<p>Ross, Stephen A. 1971. “Portfolio and Capital Market Theory with Arbitrary Preferences and Distributions: The General Validity of the Mean-Variance Approach in Large Markets.” Working Paper No. 12-72, Rodney L. White Center for Financial Research.</p>
</li>
<li>
<p>⸻. 1976. “The Arbitrage Theory of Capital Asset Pricing.” <em>Journal of Economic Theory</em> 13: 341-360.</p>
</li>
<li>
<p>Rubinstein, Mark. 2006. <em>A History of the Theory of Investments—My Annotated Bibliography.</em> Hoboken: Wiley Finance.</p>
</li>
<li>
<p>Sharpe, William F. 1964. “Capital Asset Prices: A Theory of Market Equilibrium under Conditions of Risk.” <em>Journal of Finance</em> 19 (3): 425-442.</p>
</li>
<li>
<p>⸻. 1966. “Mutual Fund Performance.” <em>Journal of Business</em> 39 (1): 119-138.</p>
</li>
<li>
<p>Varian, Hal R. 2010. <em>Intermediate Microeconomics: A Modern Approach.</em> 8th ed. New York &amp; London: W.W. Norton &amp; Company.</p>
</li>
<li>
<p>von Neumann, John, and Oskar Morgenstern. 1944. <em>Theory of Games and Economic Behavior</em>. Princeton: Princeton University Press.</p>
</li>
</ul>
</div></section>







<div data-type="footnotes"><p data-type="footnote" id="idm45625332671048"><sup><a href="ch03.xhtml#idm45625332671048-marker">1</a></sup> See Jacod and Protter (2004) for an introductory text on probability theory.</p><p data-type="footnote" id="idm45625332662264"><sup><a href="ch03.xhtml#idm45625332662264-marker">2</a></sup> In a <em>dynamic</em> economy, uncertainty would gradually resolve over time, say, on each day between today and one year later.</p><p data-type="footnote" id="idm45625332913576"><sup><a href="ch03.xhtml#idm45625332913576-marker">3</a></sup> For details with regard to risk-neutral valuation and valuation by arbitrage, refer to Hilpisch (2015, ch. 4).</p><p data-type="footnote" id="idm45625331905816"><sup><a href="ch03.xhtml#idm45625331905816-marker">4</a></sup> Again, refer to Hilpisch (2015, ch. 4) and the references given there.</p><p data-type="footnote" id="idm45625331795688"><sup><a href="ch03.xhtml#idm45625331795688-marker">5</a></sup> For more background and details, see Eichberger and Harper (1997, ch. 1) or Varian (2010, ch. 12).</p><p data-type="footnote" id="idm45625331644552"><sup><a href="ch03.xhtml#idm45625331644552-marker">6</a></sup> One speaks in general of <em>ordinal</em> numbers. House numbers in streets are a good example for ordinal numbers.</p><p data-type="footnote" id="idm45625330715848"><sup><a href="ch03.xhtml#idm45625330715848-marker">7</a></sup> For details, see <a href="http://bit.ly/aiif_minimize"><em class="hyperlink">http://bit.ly/aiif_minimize</em></a>.</p><p data-type="footnote" id="idm45625330610520"><sup><a href="ch03.xhtml#idm45625330610520-marker">8</a></sup> These assumptions are not really necessary. Short sales, for instance, might be allowed without altering the analysis significantly.</p><p data-type="footnote" id="idm45625327908440"><sup><a href="ch03.xhtml#idm45625327908440-marker">9</a></sup> For further details, see Jones (2012, ch. 9).</p><p data-type="footnote" id="idm45625326218712"><sup><a href="ch03.xhtml#idm45625326218712-marker">10</a></sup> See Bender et al. (2013) for more background information about factors used in practice.</p><p data-type="footnote" id="idm45625325664472"><sup><a href="ch03.xhtml#idm45625325664472-marker">11</a></sup> Of course, the payoff <math alttext="upper V 1">
  <msub><mi>V</mi> <mn>1</mn> </msub>
</math> might lie (incidentally) in the span of the two factor payoff vectors <math alttext="upper S 1 comma upper T 1">
  <mrow>
    <msub><mi>S</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>T</mi> <mn>1</mn> </msub>
  </mrow>
</math>.</p></div></div></section></div>



  </body></html>