<html><head></head><body><div id="sbo-rt-content"><section data-type="preface" epub:type="preface" data-pdf-bookmark="Preface"><div class="preface" id="idm45625350511096">
<h1>Preface</h1>

<blockquote>
<p class="align_me_right">Will alpha eventually go to zero for every imaginable investment strategy? More fundamentally, is the day approaching when, thanks to so many smart people and smarter computers, financial markets really do become perfect, and we can just sit back, relax, and assume that all assets are priced correctly?</p>
<p data-type="attribution">Robert Shiller (2015)</p>
</blockquote>

<p>Artificial intelligence (AI) rose to become a key technology in the 2010s and is assumed to be the dominating technology in the 2020s. Spurred by technological innovations, algorithmic breakthroughs, availability of big data, and ever-increasing compute power, many industries are undergoing fundamental changes driven by AI.</p>

<p>While media and public attention mostly focus on breakthroughs in areas such as gaming and self-driving cars, AI has also become a major technological force in the financial industry. However, it is safe to say that AI in finance is still at a nascent stage—as compared, for example, to industries such as web search or social media.</p>

<p>This book sets out to cover a number of important aspects related to AI in finance. AI in finance is already a vast topic, and a single book needs to focus on selected aspects. Therefore, this book covers the basics first (see <a data-type="xref" href="part01.xhtml#part_introduction">Part I</a> and <a data-type="xref" href="part02.xhtml#part_background">Part II</a>). It then zooms in on discovering <em>statistical inefficiencies</em> in financial markets by the use of AI and, more specifically, neural networks (see <a data-type="xref" href="part03.xhtml#part_statistical_inefficiencies">Part III</a>). Such inefficiencies—embodied by AI algorithms that successfully predict future market movements—are a prerequisite for the exploitation of <em>economic inefficiencies</em> through algorithmic trading (see <a data-type="xref" href="part04.xhtml#part_economic_inefficiencies">Part IV</a>). Being able to systematically exploit statistical and economic inefficiencies would prove contradictory to one of the established theories and cornerstones in finance: the <em>efficient market hypothesis</em> (EMH). The design of a successful <em>trading bot</em> can be considered the holy grail in finance to which AI might lead the way. This book concludes by discussing consequences of AI for the financial industry and the possibility of a financial singularity (see <a data-type="xref" href="part05.xhtml#part_outlook">Part V</a>). There is also a technical appendix that shows how to build neural networks from scratch based on plain Python code and provides additional examples for their application (see <a data-type="xref" href="part06.xhtml#part_appendices">Part VI</a>).</p>

<p>The problem of applying AI to finance is not too dissimilar to the problem of applying AI to other fields. Some major breakthroughs in AI in the 2010s were made possible by the application of reinforcement learning (RL) to playing arcade games, such as those from Atari published in the 1980s (see Mnih et al. 2013), and to board games, such as chess or Go (see Silver et al. 2016). Lessons learned from applying RL in gaming contexts, among other areas, are today applied to such challenging problems as designing and building autonomous vehicles or improving medical diagnostics. <a data-type="xref" href="#pre_table_comparison">Table P-1</a> compares the application of AI and RL in different domains.</p>
<table id="pre_table_comparison">
<caption><span class="label">Table P-1. </span>Comparison of AI in different domains</caption>
<thead>
<tr>
<th>Domain</th>
<th>Agent</th>
<th>Goal</th>
<th>Approach</th>
<th>Reward</th>
<th>Obstacle</th>
<th>Risks</th>
</tr>
</thead>
<tbody>
<tr>
<td><p><strong>Arcade games</strong></p></td>
<td><p>AI agent (software)</p></td>
<td><p>Maximizing game score</p></td>
<td><p>RL in virtual gaming environment</p></td>
<td><p>Points and scores</p></td>
<td><p>Planning and delayed rewards</p></td>
<td><p>None</p></td>
</tr>
<tr>
<td><p><strong>Autonomous driving</strong></p></td>
<td><p>Self-driving car (software + car)</p></td>
<td><p>Safely driving from location A to B</p></td>
<td><p>RL in virtual (gaming) environment, real-world test drives</p></td>
<td><p>Punishment for mistakes</p></td>
<td><p>Transition from virtual to physical world</p></td>
<td><p>Damaging property, harming people</p></td>
</tr>
<tr>
<td><p><strong>Financial trading</strong></p></td>
<td><p>Trading bot (software)</p></td>
<td><p>Maximizing long-term performance</p></td>
<td><p>RL in virtual trading environment</p></td>
<td><p>Financial returns</p></td>
<td><p>Efficient markets and competition</p></td>
<td><p>Financial losses</p></td>
</tr>
</tbody>
</table>

<p>The beauty of training AI agents to play arcade games lies in the availability of a perfect virtual learning environment<sup><a data-type="noteref" id="idm45625349196776-marker" href="preface01.xhtml#idm45625349196776">1</a></sup> and the absence of any kind of risk. With autonomous vehicles, the major problem arises when transitioning from virtual learning environments—for example, a computer game such as <em>Grand Theft Auto</em>—to the physical world with a self-driving car navigating real streets populated by other cars and people. This leads to serious risks such as a car causing accidents or harming people.</p>

<p>For a trading bot, RL can also be completely virtual, that is, in a simulated financial market environment. The major risks that arise from malfunctioning trading bots are financial losses and, on an aggregated level, potential systematic risks due to herding by trading bots. Overall, however, the financial domain seems like an ideal place to train, test, and deploy AI algorithms.</p>

<p>Given the rapid developments in the field, it should even be possible for an interested and ambitious student, equipped with a notebook and internet access, to successfully apply AI in a financial trading context. Beyond the hardware and software improvements over recent years, this is due primarily to the rise of online brokers that supply 
<span class="keep-together">historical</span> and real-time financial data and that allow the execution of financial trades via programmatic APIs.</p>

<p>The book is structured in the following six parts.</p>
<dl>
<dt><a data-type="xref" href="part01.xhtml#part_introduction">Part I</a></dt>
<dd>
<p>The first part discusses central notions and algorithms of AI in general, such as supervised learning and neural networks (see <a data-type="xref" href="ch01.xhtml#artificial_intelligence">Chapter 1</a>). It also discusses the concept of superintelligence, which relates to an AI agent that possesses human-level intelligence and, in some domains, superhuman-level intelligence (see <a data-type="xref" href="ch02.xhtml#superintelligence">Chapter 2</a>). Not every researcher in AI believes that superintelligence is possible in the foreseeable future. However, the discussion of this idea provides a valuable framework for discussing AI in general and AI for finance in particular.</p>
</dd>
<dt><a data-type="xref" href="part02.xhtml#part_background">Part II</a></dt>
<dd>
<p>The second part consists of four chapters and is about traditional, normative finance theory (see <a data-type="xref" href="ch03.xhtml#normative_finance">Chapter 3</a>) and how the field is transformed by data-driven finance (see <a data-type="xref" href="ch04.xhtml#data_driven_finance">Chapter 4</a>) and machine learning (ML) (see <a data-type="xref" href="ch05.xhtml#machine_learning">Chapter 5</a>). Taken together, data-driven finance and ML give rise to a model-free, AI-first approach to finance, as discussed in <a data-type="xref" href="ch06.xhtml#ai_first_finance">Chapter 6</a>.</p>
</dd>
<dt><a data-type="xref" href="part03.xhtml#part_statistical_inefficiencies">Part III</a></dt>
<dd>
<p>The third part is about discovering statistical inefficiencies in financial markets by applying deep learning, neural networks, and reinforcement learning. The part covers dense neural networks (DNNs, see <a data-type="xref" href="ch07.xhtml#dense_networks">Chapter 7</a>), recurrent neural networks (RNNs, see <a data-type="xref" href="ch08.xhtml#recurrent_networks">Chapter 8</a>), and algorithms from reinforcement learning (RL, see <a data-type="xref" href="ch09.xhtml#reinforcement_learning">Chapter 9</a>) that in turn often rely on DNNs to represent and approximate the optimal policy of the AI agent.</p>
</dd>
<dt><a data-type="xref" href="part04.xhtml#part_economic_inefficiencies">Part IV</a></dt>
<dd>
<p>The fourth part discusses how to exploit statistical inefficiencies through algorithmic trading. Topics are vectorized backtesting (see <a data-type="xref" href="ch10.xhtml#vectorized_backtesting">Chapter 10</a>), event-based backtesting and risk management (see <a data-type="xref" href="ch11.xhtml#risk_management">Chapter 11</a>), and execution and deployment of AI-powered algorithmic trading strategies (see <a data-type="xref" href="ch12.xhtml#execution_deployment">Chapter 12</a>).</p>
</dd>
<dt><a data-type="xref" href="part05.xhtml#part_outlook">Part V</a></dt>
<dd>
<p>The fifth part is about the consequences that arise from AI-based competition in the financial industry (see <a data-type="xref" href="ch13.xhtml#ai_based_competition">Chapter 13</a>). It also discusses the possibility of a financial singularity, a point in time at which AI agents would dominate all aspects of finance as we know it. The discussion in this context focuses on artificial financial intelligences as trading bots that consistently generate trading profits above any human or institutional benchmark (see <a data-type="xref" href="ch14.xhtml#financial_singularity">Chapter 14</a>).</p>
</dd>
<dt><a data-type="xref" href="part06.xhtml#part_appendices">Part VI</a></dt>
<dd>
<p>The Appendix contains Python code for interactive neural network training (see <a data-type="xref" href="app01.xhtml#app_interactive_neural_networks">Appendix A</a>), classes for simple and shallow neural networks that are implemented from scratch based on plain Python code (see <a data-type="xref" href="app02.xhtml#app_neural_network_classes">Appendix B</a>), and an example of how to use convolutional neural networks (CNNs) for financial time series prediction (see <a data-type="xref" href="app03.xhtml#app_convolutional_neural_networks">Appendix C</a>).</p>
</dd>
</dl>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45625348588456">
<h5>Author’s Note</h5>
<p>The application of AI to financial trading is still a nascent field, although at the time of writing there are a number of other books available that cover this topic to some extent. Many of these publications, however, fail to show what it means to <em>economically</em> exploit statistical inefficiencies.</p>

<p>Some hedge funds already claim to exclusively rely on machine learning to manage their investors’ capital. A prominent example is The Voleon Group, a hedge fund that reported more than $6 billion in assets under management at the end of 2019 (see Lee and Karsh 2020). The difficulty of relying on machine learning to outsmart the financial markets is reflected in the fund’s performance of 7% for 2019, a year during which the S&amp;P 500 stock index rose by almost 30%.</p>

<p>This book is based on years of practical experience in developing, backtesting, and deploying AI-powered algorithmic trading strategies. The approaches and examples presented are mostly based on my own research since the field is, by nature, not only nascent, but also rather secretive. The exposition and the style throughout this book are relentlessly practical, and in many instances the concrete examples are lacking proper theoretical support and/or comprehensive empirical evidence. This book even presents some applications and examples that might be vehemently criticized by experts in finance and/or machine learning.</p>

<p>For example, some experts in machine and deep learning, such as François Chollet (2017), outright doubt that prediction in financial markets is possible. Certain experts in finance, such as Robert Shiller (2015), doubt that there will ever be something like a financial singularity. Others active at the intersection of the two domains, such as Marcos López de Prado (2018), argue that the use of machine learning for financial trading and investing requires an industrial-scale effort with large teams and huge budgets.</p>

<p>This book does not try to provide a balanced view of or a comprehensive set of references for all the topics covered. The presentation is driven by the personal opinions and experiences of the author, as well as by practical considerations when providing concrete examples and Python code. Many of the examples are also chosen and tweaked to drive home certain points or to show encouraging results. Therefore, it can certainly be argued that results from many examples presented in the book suffer from data snooping and overfitting (for a discussion of these topics, see Hilpisch 2020, ch. 4).</p>

<p>The major goal of this book is to empower the reader to use the code examples in the book as a framework to explore the exciting space of AI applied to financial trading. To achieve this goal, the book relies throughout on a number of simplifying assumptions and primarily on <em>financial time series data and features derived directly from such data</em>. In practical applications, a restriction to financial time series data is of course not necessary—a great variety of other types of data and data sources could be used as well. This book’s approach to deriving features implicitly assumes that financial time series and features derived from them show <em>patterns</em> that, at least to some extent, persist over time and that can be used to predict the direction of future price movements.</p>

<p>Against this background, all examples and code presented in this book are technical and illustrative in nature and do not represent any recommendation or investment advice.</p>

<p>For those who want to deploy approaches and algorithmic trading strategies presented in this book, my book <em>Python for Algorithmic Trading: From Idea to Cloud Deployment</em> (O’Reilly) provides more process-oriented and technical details. The two books complement each other in many respects. For readers who are just getting started with Python for finance or who are seeking a refresher and reference manual, my book <em>Python for Finance: Mastering Data-Driven Finance</em> (O’Reilly) covers a comprehensive set of important topics and fundamental skills in Python as applied to the financial domain.</p>
</div></aside>






<section data-type="sect1" data-pdf-bookmark="References"><div class="sect1" id="idm45625350180248">
<h1>References</h1>

<p>Papers and books cited in the preface:</p>

<ul class="author-date-bib">
<li>
<p>Chollet, François. 2017. <em>Deep Learning with Python</em>. Shelter Island: Manning.</p>
</li>
<li>
<p>Hilpisch, Yves. 2018. <em>Python for Finance: Mastering Data-Driven Finance.</em> 2nd ed. Sebastopol: O’Reilly.</p>
</li>
<li>
<p>⸻. 2020. <em>Python for Algorithmic Trading: From Idea to Cloud Deployment.</em> Sebastopol: O’Reilly.</p>
</li>
<li>
<p>Lee, Justina and Melissa Karsh. 2020. “Machine-Learning Hedge Fund Voleon Group Returns 7% in 2019.” <em>Bloomberg</em>, January 21, 2020. <a href="https://oreil.ly/TOQiv"><em class="hyperlink">https://oreil.ly/TOQiv</em></a>.</p>
</li>
<li>
<p>López de Prado, Marcos. 2018. <em>Advances in Financial Machine Learning</em>. Hoboken, NJ: John Wiley &amp; Sons.</p>
</li>
<li>
<p>Mnih, Volodymyr et al. 2013. “Playing Atari with Deep Reinforcement Learning.” arXiv. December 19. <a href="https://oreil.ly/-pW-1"><em class="hyperlink">https://oreil.ly/-pW-1</em></a>.</p>
</li>
</ul>
<div style="page-break-after: always;"/>

<ul class="author-date-bib">
<li>
<p>Shiller, Robert. 2015. “The Mirage of the Financial Singularity.” Yale Insights. July 16. <a href="https://oreil.ly/VRkP3"><em class="hyperlink">https://oreil.ly/VRkP3</em></a>.</p>
</li>
<li>
<p>Silver, David et al. 2016. “Mastering the Game of Go with Deep Neural Networks and Tree Search.” <em>Nature</em> 529 (January): 484-489.</p>
</li>
</ul>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Conventions Used in This Book"><div class="sect1" id="idm45625358566920">
<h1>Conventions Used in This Book</h1>

<p>The following typographical conventions are used in this book:</p>
<dl>
<dt><em>Italic</em></dt>
<dd>
<p>Indicates new terms, URLs, email addresses, filenames, and file extensions.</p>
</dd>
<dt><code>Constant width</code></dt>
<dd>
<p>Used for program listings, as well as within paragraphs to refer to program elements such as variable or function names, databases, data types, environment variables, statements, and keywords.</p>
</dd>
<dt><strong><code>Constant width bold</code></strong></dt>
<dd>
<p>Shows commands or other text that should be typed literally by the user.</p>
</dd>
<dt><em><code>Constant width italic</code></em></dt>
<dd>
<p>Shows text that should be replaced with user-supplied values or by values determined by context.</p>
</dd>
</dl>
<div data-type="tip"><h6>Tip</h6>
<p>This element signifies a tip or suggestion.</p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>This element signifies a general note.</p>
</div>
<div data-type="important"><h6>Important</h6>
<p>This element indicates important information.</p>
</div>
<div data-type="warning" epub:type="warning"><h6>Warning</h6>
<p>This element indicates a warning or caution.</p>
</div>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Using Code Examples"><div class="sect1" id="idm45625349776344">
<h1>Using Code Examples</h1>
<!--PROD: Please reach out to author to find out if they will be uploading code examples to oreilly.com or their own site (e.g., GitHub). If there is no code download, delete this whole section. If there is, when you email digidist with the link, let them know what you filled in for title_title (should be as close to book title as possible, i.e., learning_python_2e). This info will determine where digidist loads the files.-->

<p>You can access and execute the code that accompanies the book on the Quant Platform at <a href="https://aiif.pqp.io"><em class="hyperlink">https://aiif.pqp.io</em></a>, for which only a free registration is required.</p>

<p>If you have a technical question or a problem using the code examples, please send an email to <a class="email" href="mailto:bookquestions@oreilly.com"><em>bookquestions@oreilly.com</em></a>.</p>

<p>This book is here to help you get your job done. In general, if example code is offered with this book, you may use it in your programs and documentation. You do not need to contact us for permission unless you’re reproducing a significant portion of the code. For example, writing a program that uses several chunks of code from this book does not require permission. Selling or distributing examples from O’Reilly books does require permission. Answering a question by citing this book and quoting example code does not require permission. Incorporating a significant amount of example code from this book into your product’s documentation does require permission.</p>

<p>We appreciate, but generally do not require, attribution. An attribution usually includes the title, author, publisher, and ISBN. For example, this book may be attributed as: “<em>Artificial Intelligence in Finance</em> by Yves Hilpisch (O’Reilly). Copyright 2021 Yves Hilpisch, 978-1-492-05543-3.”</p>

<p>If you feel your use of code examples falls outside fair use or the permission given above, feel free to contact us at <a class="email" href="mailto:permissions@oreilly.com"><em>permissions@oreilly.com</em></a>.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="O’Reilly Online Learning"><div class="sect1" id="idm45625335300632">
<h1>O’Reilly Online Learning</h1>
<div data-type="note" epub:type="note" class="ormenabled"><h6>Note</h6>
<p>For more than 40 years, <a href="http://oreilly.com" class="orm:hideurl"><em class="hyperlink">O’Reilly Media</em></a> has provided technology and business training, knowledge, and insight to help companies succeed.</p>
</div>

<p>Our unique network of experts and innovators share their knowledge and expertise through books, articles, and our online learning platform. O’Reilly’s online learning platform gives you on-demand access to live training courses, in-depth learning paths, interactive coding environments, and a vast collection of text and video from O’Reilly and 200+ other publishers. For more information, visit <a href="http://oreilly.com" class="orm:hideurl"><em>http://oreilly.com</em></a>.</p>
<div style="page-break-after: always;"/>
</div></section>













<section data-type="sect1" class="less_space" data-pdf-bookmark="How to Contact Us"><div class="sect1" id="idm45625350940728">
<h1>How to Contact Us</h1>

<p>Please address comments and questions concerning this book to the publisher:</p>
<ul class="simplelist">
  <li>O’Reilly Media, Inc.</li>
  <li>1005 Gravenstein Highway North</li>
  <li>Sebastopol, CA 95472</li>
  <li>800-998-9938 (in the United States or Canada)</li>
  <li>707-829-0515 (international or local)</li>
  <li>707-829-0104 (fax)</li>
</ul>

<p>We have a web page for this book, where we list errata, examples, and any additional information. You can access this page at <a href="https://oreil.ly/ai-in-finance"><em class="hyperlink">https://oreil.ly/ai-in-finance</em></a>.</p>
<!--Don't forget to update the link above.-->

<p>Email <a class="email" href="mailto:bookquestions@oreilly.com"><em>bookquestions@oreilly.com</em></a> to comment or ask technical questions about this book.</p>

<p>For news and information about our books and courses, visit <a href="http://oreilly.com"><em class="hyperlink">http://oreilly.com</em></a>.</p>

<p>Find us on Facebook: <a href="http://facebook.com/oreilly"><em class="hyperlink">http://facebook.com/oreilly</em></a></p>

<p>Follow us on Twitter: <a href="http://twitter.com/oreillymedia"><em class="hyperlink">http://twitter.com/oreillymedia</em></a></p>

<p>Watch us on YouTube: <a href="http://www.youtube.com/oreillymedia"><em class="hyperlink">http://www.youtube.com/oreillymedia</em></a></p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Acknowledgments"><div class="sect1" id="idm45625334650152">
<h1>Acknowledgments</h1>

<p>I want to thank the technical reviewers—Margaret Maynard-Reid, Dr. Tim Nugent, and Dr. Abdullah Karasan—who did a great job in helping me improve the contents of the book.</p>

<p>Delegates of the Certificate Programs in Python for Computational Finance and Algorithmic Trading also helped improve this book. Their ongoing feedback has enabled me to weed out errors and mistakes and refine the code and notebooks used in our online training classes and now, finally, in this book.</p>

<p>The same holds true for the team members of The Python Quants and The AI Machine. In particular, Michael Schwed, Ramanathan Ramakrishnamoorthy, and Prem Jebaseelan support me in numerous ways. They are the ones who assist me with the difficult technical problems that arise during the writing of a book like this one.</p>

<p>I would also like to thank the whole team at O’Reilly Media—especially Michelle Smith, Corbin Collins, Victoria DeRose, and Danny Elfanbaum—for making it all happen and helping me refine the book in so many ways.</p>

<p>Of course, all remaining errors are mine alone.</p>

<p>Furthermore, I would also like to thank the team at Refinitiv—in particular, Jason Ramchandani—for providing ongoing support and access to financial data. The major data files used throughout the book and made available to the readers were received in one way or another from Refinitiv’s data APIs.</p>

<p>Of course, everybody making use of artificial intelligence and machine learning today benefits from the achievements and contributions of so many others. Therefore, we should always recall what Sir Isaac Newton wrote in 1675: “If I have seen further it is by standing on the shoulders of Giants.” In that sense, a big thank you to all the researchers and open source maintainers contributing to the field.</p>

<p>Finally, special thanks go to my family, who support me all year round in my business and book-writing activities. In particular, I thank my wife Sandra for relentlessly taking care of us all and for providing us with a home and environment that we all love so much. I dedicate this book to my lovely wife Sandra and my wonderful son Henry.</p>
</div></section>







<div data-type="footnotes"><p data-type="footnote" id="idm45625349196776"><sup><a href="preface01.xhtml#idm45625349196776-marker">1</a></sup> See the <a href="https://oreil.ly/bGgZs">Arcade Learning Environment</a>.</p></div></div></section></div>



  </body></html>