<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 1. Artificial Intelligence"><div class="chapter" id="artificial_intelligence">
<h1><span class="label">Chapter 1. </span>Artificial Intelligence</h1>

<blockquote>
<p class="align_me_right">This is the first time that a computer program has defeated a human professional player in the full-sized game of Go, a feat previously thought to be at least a decade away.</p>
<p data-type="attribution">David Silver et al. (2016)</p>
</blockquote>

<p>This chapter introduces general notions, ideas, and definitions from the field of artificial intelligence (AI) for the purposes of this book. It also provides worked-out examples for different types of major learning algorithms. In particular, <a data-type="xref" href="#ai_algorithms">“Algorithms”</a> takes a broad perspective and categorizes types of data, types of learning, and types of problems typically encountered in an AI context. This chapter also presents examples for unsupervised and reinforcement learning. <a data-type="xref" href="#ai_neural_networks">“Neural Networks”</a> jumps right into the world of neural networks, which not only are central to what follows in later chapters of the book but also have proven to be among the most powerful algorithms AI has to offer nowadays. <a data-type="xref" href="#ai_importance_of_data">“Importance of Data”</a> discusses the importance of data volume and variety in the context of AI.</p>






<section data-type="sect1" data-pdf-bookmark="Algorithms"><div class="sect1" id="ai_algorithms">
<h1>Algorithms</h1>

<p><a data-type="indexterm" data-primary="artificial financial intelligence" data-see="AFI" id="idm45625334671016"/><a data-type="indexterm" data-primary="absolute risk aversion" data-see="ARA" id="idm45625335231784"/><a data-type="indexterm" data-primary="AI (artificial intelligence)" data-secondary="machine learning" data-see="ML" id="idm45625335302536"/><a data-type="indexterm" data-primary="algorithmic trading" data-secondary="risk management" data-see="risk management" id="idm45625335301336"/><a data-type="indexterm" data-primary="algorithmic trading" data-secondary="vectorized backtesting" data-see="vectorized backtesting" id="idm45625335380296"/><a data-type="indexterm" data-primary="approximation task" data-see="estimation task" id="idm45625354727592"/><a data-type="indexterm" data-primary="Arcade Learning Environment" data-see="ALE" id="idm45625354726648"/><a data-type="indexterm" data-primary="artificial financial intelligence" data-see="AFI" id="idm45625335299416"/><a data-type="indexterm" data-primary="artificial general intelligence" data-see="AGI" id="idm45625335298456"/><a data-type="indexterm" data-primary="artificial intelligence" data-see="AI" id="idm45625335217736"/><a data-type="indexterm" data-primary="artificial narrow intelligence" data-see="ANI" id="idm45625335216792"/><a data-type="indexterm" data-primary="algorithms, generally" id="ix_algorithms_gen"/><a data-type="indexterm" data-primary="capital market line" data-see="CML" id="idm45625352520088"/><a data-type="indexterm" data-primary="capital market theory" data-see="CMT" id="idm45625334866360"/><a data-type="indexterm" data-primary="contracts for difference (CFD) trading" data-see="CFD" id="idm45625334865416"/><a data-type="indexterm" data-primary="convolutional neural networks" data-see="CNNs" id="idm45625343715416"/><a data-type="indexterm" data-primary="Data, News, Analytics platform" data-see="DNA" id="idm45625343714456"/><a data-type="indexterm" data-primary="deep learning" data-see="DL" id="idm45625335220648"/><a data-type="indexterm" data-primary="dense neural networks" data-see="DNNs" id="idm45625335219704"/><a data-type="indexterm" data-primary="DL (deep learning)" data-secondary="dense neural networks" data-see="DNNs" id="idm45625335282088"/><a data-type="indexterm" data-primary="DL (deep learning)" data-secondary="recurrent neural networks" data-see="RNNs" id="idm45625335280872"/><a data-type="indexterm" data-primary="efficient market hypothesis" data-see="EMH" id="idm45625335295368"/><a data-type="indexterm" data-primary="expected utility theory" data-see="EUT" id="idm45625335294408"/><a data-type="indexterm" data-primary="finance industry" data-secondary="AI-first finance" data-see="AI-first finance" id="idm45625354854696"/><a data-type="indexterm" data-primary="finance industry" data-secondary="data-driven finance" data-see="data-driven finance" id="idm45625354853480"/><a data-type="indexterm" data-primary="finance industry" data-secondary="normative finance" data-see="normative financial theories and models" id="idm45625352003768"/><a data-type="indexterm" data-primary="finance industry" data-secondary="trading bots" data-see="algorithmic trading" id="idm45625334649256"/><a data-type="indexterm" data-primary="financial AI agents" data-see="algorithmic trading" id="idm45625334648040"/><a data-type="indexterm" data-primary="foreign exchange" data-see="FX" id="idm45625358745560"/><a data-type="indexterm" data-primary="Keras deep learning package" data-secondary="DNNs" data-see="DNNs" id="idm45625358744616"/><a data-type="indexterm" data-primary="Keras deep learning package" data-secondary="RNNs" data-see="RNNs" id="idm45625352659176"/><a data-type="indexterm" data-primary="machine intelligence" data-see="AI" id="idm45625352657992"/><a data-type="indexterm" data-primary="machine learning" data-see="ML" id="idm45625335238824"/><a data-type="indexterm" data-primary="market portfolios" data-see="portfolios" id="idm45625335237880"/><a data-type="indexterm" data-primary="market prediction" data-secondary="expected returns" data-see="expected returns" id="idm45625335236936"/><a data-type="indexterm" data-primary="market prediction" data-secondary="with trading bots" data-see="algorithmic trading" data-secondary-sortas="trading bots" id="idm45625351991656"/><a data-type="indexterm" data-primary="mean squared error" data-see="MSE" id="idm45625335258232"/><a data-type="indexterm" data-primary="mean-variance portfolio (MVP) theory" data-see="MVP" id="idm45625335257288"/><a data-type="indexterm" data-primary="MLP (multi-layer perceptron)" data-see="DNNs" id="idm45625335256328"/><a data-type="indexterm" data-primary="natural language processing" data-see="NLP" id="idm45625335215608"/><a data-type="indexterm" data-primary="neural networks" data-secondary="dense neural networks" data-see="DNNs" id="idm45625335214648"/><a data-type="indexterm" data-primary="neural networks" data-secondary="recurrent neural networks" data-see="RNNs" id="idm45625343469384"/><a data-type="indexterm" data-primary="normative financial theories and models" data-secondary="capital asset pricing model" data-see="CAPM" id="idm45625343468152"/><a data-type="indexterm" data-primary="normative financial theories and models" data-secondary="expected utility theory" data-see="EUT" id="idm45625334642840"/><a data-type="indexterm" data-primary="ordinary least-squares (OLS) regression" data-see="OLS" id="idm45625334641608"/><a data-type="indexterm" data-primary="probability density function" data-see="PDF" id="idm45625337380904"/><a data-type="indexterm" data-primary="random walk hypothesis" data-see="EMH" id="idm45625337379944"/><a data-type="indexterm" data-primary="regression task" data-see="estimation task" id="idm45625333500344"/><a data-type="indexterm" data-primary="reinforcement learning" data-see="RL" id="idm45625333499432"/><a data-type="indexterm" data-primary="risk and uncertainty" data-see="uncertainty and risk" id="idm45625333498488"/><a data-type="indexterm" data-primary="RWH (random walk hypothesis)" data-see="EMH" id="idm45625335202392"/><a data-type="indexterm" data-primary="simple moving average" data-see="SMA" id="idm45625335201432"/><a data-type="indexterm" data-primary="superintelligence" data-see="SI" id="idm45625335200488"/><a data-type="indexterm" data-primary="supervised learning" data-see="SL" id="idm45625352571960"/><a data-type="indexterm" data-primary="trade execution" data-see="execution of trading algorithms" id="idm45625352571016"/><a data-type="indexterm" data-primary="trading bots" data-see="algorithmig trading" id="idm45625352570056"/><a data-type="indexterm" data-primary="training algorithms" data-see="ML" id="idm45625334952616"/><a data-type="indexterm" data-primary="unsupervised learning" data-see="UL" id="idm45625334951672"/><a data-type="indexterm" data-primary="uploading" data-see="WBE" id="idm45625343476808"/><a data-type="indexterm" data-primary="AI (artificial intelligence)" data-secondary="algorithms" id="ix_AI_algorithms_basic"/>This section introduces basic notions from the field of AI relevant to this book. It discusses the different types of data, learning, problems, and approaches that can be subsumed under the general term <em>AI</em>. Alpaydin (2016) provides an informal introduction to and overview of many of the topics covered only briefly in this section, along with many examples.</p>
<div style="page-break-after: always;"/>








<section data-type="sect2" class="less_space" data-pdf-bookmark="Types of Data"><div class="sect2" id="idm45625335271576">
<h2>Types of Data</h2>

<p><a data-type="indexterm" data-primary="data" data-seealso="classification task; estimation task" id="idm45625335270104"/>Data in general has two major components:</p>
<dl>
<dt>Features</dt>
<dd>
<p><a data-type="indexterm" data-primary="features data type" id="idm45625343748120"/>Features data (or input data) is data that is given as input to an algorithm. In a financial context, this might be, for example, the income and the savings of a potential debtor.</p>
</dd>
<dt>Labels</dt>
<dd>
<p><a data-type="indexterm" data-primary="labels data type" id="idm45625337377960"/>Labels data (or output data) is data that is given as the relevant output to be learned, for example, by a supervised learning algorithm. In a financial context, this might be the creditworthiness of a potential debtor.</p>
</dd>
</dl>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Types of Learning"><div class="sect2" id="idm45625337376376">
<h2>Types of Learning</h2>

<p><a data-type="indexterm" data-primary="learning" id="ix_learning_gen"/>There are three major types of learning algorithms:</p>
<dl>
<dt>Supervised learning (SL)</dt>
<dd>
<p><a data-type="indexterm" data-primary="SL (supervised learning)" id="idm45625335268232"/><a data-type="indexterm" data-primary="ML (machine learning)" data-secondary="SL" id="idm45625335267560"/>These are algorithms that learn from a given sample data set of features (input) and labels (output) values. The next section presents examples for such algorithms, like ordinary least-squares (OLS) regression and neural networks. The purpose of supervised learning is to learn the relationship between the input and output values. In finance, such algorithms might be trained to predict whether a potential debtor is creditworthy or not. For the purposes of this book, these are the most important types of algorithms.</p>
</dd>
<dt>Unsupervised learning (UL)</dt>
<dd>
<p>These are algorithms that learn from a given sample data set of features (input) values only, often with the goal of finding structure in the data. They are supposed to learn about the input data set, given, for example, some guiding parameters. Clustering algorithms fall into that category. In a financial context, such algorithms might cluster stocks into certain groups.</p>
</dd>
<dt>Reinforcement learning (RL)</dt>
<dd>
<p><a data-type="indexterm" data-primary="RL (reinforcement learning)" id="idm45625335433240"/>These are algorithms that learn from trial and error by receiving a reward for taking an action. They update an optimal action policy according to what rewards and punishments they receive. Such algorithms are, for example, used for environments where actions need to be taken continuously and rewards are received immediately, such as in a computer game.</p>
</dd>
</dl>

<p>Because supervised learning is addressed in the subsequent section in some detail, brief examples will illustrate unsupervised learning and reinforcement learning.</p>










<section data-type="sect3" data-pdf-bookmark="Unsupervised Learning"><div class="sect3" id="idm45625335431272">
<h3>Unsupervised Learning</h3>

<p><a data-type="indexterm" data-primary="UL (unsupervised learning)" id="ix_UL_unsup_gen"/><a data-type="indexterm" data-primary="scikit-learn package" data-secondary="KMeans algorithm" id="ix_scikit_kmeans"/><a data-type="indexterm" data-primary="KMeans algorithm" id="ix_kmeans_alg"/><a data-type="indexterm" data-primary="clustering algorithms" id="idm45625352535592"/>Simply speaking, a <em>k-means clustering algorithm</em> sorts <math alttext="n">
  <mi>n</mi>
</math> observations into <math alttext="k">
  <mi>k</mi>
</math> clusters.
Each observation belongs to the cluster to which its mean (center) is nearest.
The following Python code generates sample data for which the features data is clustered. <a data-type="xref" href="#figure_ai_08">Figure 1-1</a> visualizes the clustered sample data and also shows that the <code>scikit-learn</code> <code>KMeans</code> algorithm used here has identified the clusters perfectly. The coloring of the dots is based on what the algorithm has learned.<sup><a data-type="noteref" id="idm45625352526520-marker" href="ch01.xhtml#idm45625352526520">1</a></sup></p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">numpy</code><code> </code><code class="kn">as</code><code> </code><code class="nn">np</code><code>
</code><code>        </code><code class="kn">import</code><code> </code><code class="nn">pandas</code><code> </code><code class="kn">as</code><code> </code><code class="nn">pd</code><code>
</code><code>        </code><code class="kn">from</code><code> </code><code class="nn">pylab</code><code> </code><code class="kn">import</code><code> </code><code class="n">plt</code><code class="p">,</code><code> </code><code class="n">mpl</code><code>
</code><code>        </code><code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'</code><code class="s1">seaborn</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>        </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s1">'</code><code class="s1">savefig.dpi</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">300</code><code>
</code><code>        </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s1">'</code><code class="s1">font.family</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">serif</code><code class="s1">'</code><code>
</code><code>        </code><code class="n">np</code><code class="o">.</code><code class="n">set_printoptions</code><code class="p">(</code><code class="n">precision</code><code class="o">=</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">suppress</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">2</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">from</code><code> </code><code class="nn">sklearn.cluster</code><code> </code><code class="kn">import</code><code> </code><code class="n">KMeans</code><code>
</code><code>        </code><code class="kn">from</code><code> </code><code class="nn">sklearn.datasets</code><code> </code><code class="kn">import</code><code> </code><code class="n">make_blobs</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">3</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code> </code><code class="o">=</code><code> </code><code class="n">make_blobs</code><code class="p">(</code><code class="n">n_samples</code><code class="o">=</code><code class="mi">100</code><code class="p">,</code><code> </code><code class="n">centers</code><code class="o">=</code><code class="mi">4</code><code class="p">,</code><code>
</code><code>                          </code><code class="n">random_state</code><code class="o">=</code><code class="mi">500</code><code class="p">,</code><code> </code><code class="n">cluster_std</code><code class="o">=</code><code class="mf">1.25</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO1-1" href="#callout_artificial_intelligence_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code> </code><code class="o">=</code><code> </code><code class="n">KMeans</code><code class="p">(</code><code class="n">n_clusters</code><code class="o">=</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">random_state</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO1-2" href="#callout_artificial_intelligence_CO1-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO1-3" href="#callout_artificial_intelligence_CO1-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">KMeans</code><code class="p">(</code><code class="n">n_clusters</code><code class="o">=</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">random_state</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">y_</code><code> </code><code class="o">=</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO1-4" href="#callout_artificial_intelligence_CO1-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">y_</code><code>  </code><a class="co" id="co_artificial_intelligence_CO1-5" href="#callout_artificial_intelligence_CO1-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code>
</code><code>               </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code>
</code><code>               </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code>
</code><code>               </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code>
</code><code>               </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">dtype</code><code class="o">=</code><code class="n">int32</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>        </code><code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">x</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">x</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">c</code><code class="o">=</code><code class="n">y_</code><code class="p">,</code><code>  </code><code class="n">cmap</code><code class="o">=</code><code class="s1">'</code><code class="s1">coolwarm</code><code class="s1">'</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO1-1" href="#co_artificial_intelligence_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>A sample data set is created with clustered features data.</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO1-2" href="#co_artificial_intelligence_CO1-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>A <code>KMeans</code> model object is instantiated, fixing the number of clusters.</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO1-3" href="#co_artificial_intelligence_CO1-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>The model is fitted to the features data.</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO1-4" href="#co_artificial_intelligence_CO1-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>The predictions are generated given the fitted model.</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO1-5" href="#co_artificial_intelligence_CO1-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>The predictions are numbers from 0 to 3, each representing one cluster.</p></dd>
</dl>

<figure><div id="figure_ai_08" class="figure">
<img src="Images/aiif_0101.png" alt="aiif 0101" width="2402" height="1420"/>
<h6><span class="label">Figure 1-1. </span>Unsupervised learning of clusters</h6>
</div></figure>

<p>Once an algorithm such as <code>KMeans</code> is trained, it can, for instance, predict the cluster for a new (not yet seen) combination of features values. Assume that such an algorithm is trained on features data that describes potential and real debtors of a bank. It might learn about the creditworthiness of potential debtors by generating two clusters. New potential debtors can then be sorted into a certain cluster: “creditworthy” versus “not creditworthy.”<a data-type="indexterm" data-primary="" data-startref="ix_kmeans_alg" id="idm45625340791256"/><a data-type="indexterm" data-primary="" data-startref="ix_scikit_kmeans" id="idm45625337500040"/><a data-type="indexterm" data-primary="" data-startref="ix_UL_unsup_gen" id="idm45625337499096"/></p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Reinforcement learning"><div class="sect3" id="idm45625335431000">
<h3>Reinforcement learning</h3>

<p><a data-type="indexterm" data-primary="RL (reinforcement learning)" data-secondary="example algorithm" id="ix_RL_example"/>The following example is based on a coin tossing game that is played with a coin that lands 80% of the time on heads and 20% of the time on tails. The coin tossing game is heavily biased to emphasize the benefits of learning as compared to an uninformed baseline algorithm. The baseline algorithm, which bets randomly and equally distributes on heads and tails, achieves a total reward of around 50, on average, per epoch of 100 bets played:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">9</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">ssp</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code>  </code><a class="co" id="co_artificial_intelligence_CO2-1" href="#callout_artificial_intelligence_CO2-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">asp</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code>  </code><a class="co" id="co_artificial_intelligence_CO2-2" href="#callout_artificial_intelligence_CO2-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">epoch</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="n">tr</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code><code>
</code><code>             </code><code class="k">for</code><code> </code><code class="n">_</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code class="p">:</code><code>
</code><code>                 </code><code class="n">a</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">choice</code><code class="p">(</code><code class="n">asp</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO2-3" href="#callout_artificial_intelligence_CO2-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>                 </code><code class="n">s</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">choice</code><code class="p">(</code><code class="n">ssp</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO2-4" href="#callout_artificial_intelligence_CO2-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>                 </code><code class="k">if</code><code> </code><code class="n">a</code><code> </code><code class="o">==</code><code> </code><code class="n">s</code><code class="p">:</code><code>
</code><code>                     </code><code class="n">tr</code><code> </code><code class="o">+</code><code class="o">=</code><code> </code><code class="mi">1</code><code>  </code><a class="co" id="co_artificial_intelligence_CO2-5" href="#callout_artificial_intelligence_CO2-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">tr</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">12</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rl</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="n">epoch</code><code class="p">(</code><code class="p">)</code><code> </code><code class="k">for</code><code> </code><code class="n">_</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">15</code><code class="p">)</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO2-6" href="#callout_artificial_intelligence_CO2-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">rl</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">12</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">53</code><code class="p">,</code><code> </code><code class="mi">55</code><code class="p">,</code><code> </code><code class="mi">50</code><code class="p">,</code><code> </code><code class="mi">48</code><code class="p">,</code><code> </code><code class="mi">46</code><code class="p">,</code><code> </code><code class="mi">41</code><code class="p">,</code><code> </code><code class="mi">51</code><code class="p">,</code><code> </code><code class="mi">49</code><code class="p">,</code><code> </code><code class="mi">50</code><code class="p">,</code><code> </code><code class="mi">52</code><code class="p">,</code><code> </code><code class="mi">46</code><code class="p">,</code><code> </code><code class="mi">47</code><code class="p">,</code><code> </code><code class="mi">43</code><code class="p">,</code><code> </code><code class="mi">51</code><code class="p">,</code><code> </code><code class="mi">52</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">13</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rl</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO2-7" href="#callout_artificial_intelligence_CO2-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">13</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">48.93333333333333</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO2-1" href="#co_artificial_intelligence_CO2-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The state space (1 = heads, 0 = tails).</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO2-2" href="#co_artificial_intelligence_CO2-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>The action space (1 = bet on heads, 0 = bet on tails).</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO2-3" href="#co_artificial_intelligence_CO2-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>An action is randomly chosen from the action space.</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO2-4" href="#co_artificial_intelligence_CO2-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>A state is randomly chosen from the state space.</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO2-5" href="#co_artificial_intelligence_CO2-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>The total reward <code>tr</code> is increased by one if the bet is correct.</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO2-6" href="#co_artificial_intelligence_CO2-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>The game is played for a number of epochs; each epoch is 100 bets.</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO2-7" href="#co_artificial_intelligence_CO2-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a></dt>
<dd><p>The average total reward of the epochs played is calculated.</p></dd>
</dl>

<p>Reinforcement learning tries to learn from what is observed after an action is taken, usually based on a reward. To keep things simple, the following learning algorithm only keeps track of the states that are observed in each round insofar as they are appended to the action space <code>list</code> object. In this way, the algorithm learns the bias in the game, though maybe not perfectly. By randomly sampling from the updated action space, the bias is reflected because naturally the bet will more often be heads. Over time, heads is chosen, on average, around 80% of the time. The average total reward of around 65 reflects the improvement of the learning algorithm as compared to the uninformed baseline algorithm:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">14</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">ssp</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">15</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">epoch</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="n">tr</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code><code>
</code><code>             </code><code class="n">asp</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code>  </code><a class="co" id="co_artificial_intelligence_CO3-1" href="#callout_artificial_intelligence_CO3-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>             </code><code class="k">for</code><code> </code><code class="n">_</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code class="p">:</code><code>
</code><code>                 </code><code class="n">a</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">choice</code><code class="p">(</code><code class="n">asp</code><code class="p">)</code><code>
</code><code>                 </code><code class="n">s</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">choice</code><code class="p">(</code><code class="n">ssp</code><code class="p">)</code><code>
</code><code>                 </code><code class="k">if</code><code> </code><code class="n">a</code><code> </code><code class="o">==</code><code> </code><code class="n">s</code><code class="p">:</code><code>
</code><code>                     </code><code class="n">tr</code><code> </code><code class="o">+</code><code class="o">=</code><code> </code><code class="mi">1</code><code>
</code><code>                 </code><code class="n">asp</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">s</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO3-2" href="#callout_artificial_intelligence_CO3-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="n">tr</code><code>
</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">16</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rl</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="n">epoch</code><code class="p">(</code><code class="p">)</code><code> </code><code class="k">for</code><code> </code><code class="n">_</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">15</code><code class="p">)</code><code class="p">]</code><code class="p">)</code><code>
</code><code>         </code><code class="n">rl</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">16</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">64</code><code class="p">,</code><code> </code><code class="mi">65</code><code class="p">,</code><code> </code><code class="mi">77</code><code class="p">,</code><code> </code><code class="mi">65</code><code class="p">,</code><code> </code><code class="mi">54</code><code class="p">,</code><code> </code><code class="mi">64</code><code class="p">,</code><code> </code><code class="mi">71</code><code class="p">,</code><code> </code><code class="mi">64</code><code class="p">,</code><code> </code><code class="mi">57</code><code class="p">,</code><code> </code><code class="mi">62</code><code class="p">,</code><code> </code><code class="mi">69</code><code class="p">,</code><code> </code><code class="mi">63</code><code class="p">,</code><code> </code><code class="mi">61</code><code class="p">,</code><code> </code><code class="mi">66</code><code class="p">,</code><code> </code><code class="mi">75</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">17</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rl</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">17</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">65.13333333333334</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO3-1" href="#co_artificial_intelligence_CO3-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Resets the action space before starting (over)</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO3-2" href="#co_artificial_intelligence_CO3-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Adds the observed state to the action space<a data-type="indexterm" data-primary="" data-startref="ix_learning_gen" id="idm45625340672680"/><a data-type="indexterm" data-primary="" data-startref="ix_RL_example" id="idm45625340671704"/></p></dd>
</dl>
</div></section>



</div></section>













<section data-type="sect2" data-pdf-bookmark="Types of Tasks"><div class="sect2" id="idm45625334915560">
<h2>Types of Tasks</h2>

<p>Depending on the type of labels data and the problem at hand, two types of tasks to be learned are important:</p>
<dl>
<dt>Estimation</dt>
<dd>
<p><a data-type="indexterm" data-primary="estimation task" id="idm45625334693144"/>Estimation (or approximation, regression) refers to the cases in which the labels data is real-valued (continuous); that is, it is technically represented as floating point numbers.</p>
</dd>
<dt>Classification</dt>
<dd>
<p><a data-type="indexterm" data-primary="classification task" id="idm45625338138712"/>Classification refers to the cases in which the labels data consists of a finite number of classes or categories that are typically represented by discrete values (positive natural numbers), which in turn are represented technically as integers.</p>
</dd>
</dl>

<p>The following section provides examples for both types of tasks.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Types of Approaches"><div class="sect2" id="idm45625335560056">
<h2>Types of Approaches</h2>

<p>Some more definitions might be in order before finishing this section. This book follows the common differentiation between the following three major terms:</p>
<dl>
<dt>Artificial intelligence (AI)</dt>
<dd>
<p>AI encompasses all types of learning (algorithms), as defined before, and some more (for example, expert systems).</p>
</dd>
<dt>Machine learning (ML)</dt>
<dd>
<p>ML is the discipline of learning relationships and other information about given data sets based on an algorithm and a measure of success; a measure of success might, for example, be the mean-squared error (MSE) given labels values and output values to be estimated and the predicted values from the algorithm. ML is a sub-set of AI.</p>
</dd>
<dt>Deep learning (DL)</dt>
<dd>
<p><a data-type="indexterm" data-primary="DL (deep learning)" data-seealso="Keras deep learning package" id="idm45625338141480"/>DL encompasses all algorithms based on neural networks. The term <em>deep</em> is usually only used when the <a data-type="indexterm" data-primary="neural networks" data-secondary="deep learning" id="idm45625334722760"/>neural network has more than one hidden layer. <a data-type="indexterm" data-primary="ML (machine learning)" id="idm45625334721656"/><a data-type="indexterm" data-primary="ML (machine learning)" data-secondary="deep learning" id="idm45625334720984"/>DL is a sub-set of machine learning and so is therefore also a sub-set of AI.</p>
</dd>
</dl>

<p>DL has proven useful for a number of broad problem areas. It is suited for estimation and classification tasks, as well as for RL. In many cases, DL-based approaches 
<span class="keep-together">perform</span> better than alternative algorithms, such as logistic regression or kernel-based ones, like support vector machines.<sup><a data-type="noteref" id="idm45625338167000-marker" href="ch01.xhtml#idm45625338167000">2</a></sup> That is why this book mainly focuses on DL. DL approaches used include dense neural networks (DNNs), recurrent neural networks (RNNs), and convolutional neural networks (CNNs). More details appear in later chapters, particularly in <a data-type="xref" href="part03.xhtml#part_statistical_inefficiencies">Part III</a>.<a data-type="indexterm" data-primary="" data-startref="ix_AI_algorithms_basic" id="idm45625340575112"/><a data-type="indexterm" data-primary="" data-startref="ix_algorithms_gen" id="idm45625340574136"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Neural Networks"><div class="sect1" id="ai_neural_networks">
<h1>Neural Networks</h1>

<p><a data-type="indexterm" data-primary="neural networks" data-secondary="role in AI" id="ix_neuralnet_role_AI"/><a data-type="indexterm" data-primary="AI (artificial intelligence)" data-secondary="neural networks in" id="ix_AI_neuralnet_gen"/>The previous sections provide a broader overview of algorithms in AI. This section shows how neural networks fit in. A simple example will illustrate what characterizes neural networks in comparison to traditional statistical methods, such as ordinary least-squares (OLS) regression.
The example starts with mathematics and then uses linear regression for <em>estimation</em> (or function approximation) and finally applies neural networks to accomplish the estimation.
The approach taken here is a supervised learning approach where the task is to estimate labels data based on features data. 
<span class="keep-together">This section</span> also illustrates the use of neural networks in the context of <em>classification</em> 
<span class="keep-together">problems.</span></p>








<section data-type="sect2" data-pdf-bookmark="OLS Regression"><div class="sect2" id="idm45625334906648">
<h2>OLS Regression</h2>

<p><a data-type="indexterm" data-primary="OLS (ordinary least-squares) regression" data-secondary="versus neural networks" data-secondary-sortas="neural networks" id="ix_OLS_vs_neuralnet"/>Assume that a mathematical function is given as follows:</p>
<div data-type="equation">
<math alttext="f colon double-struck upper R right-arrow double-struck upper R comma y equals 2 x squared minus one-third x cubed" display="block">
  <mrow>
    <mi>f</mi>
    <mo>:</mo>
    <mi>ℝ</mi>
    <mo>→</mo>
    <mi>ℝ</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>=</mo>
    <mn>2</mn>
    <msup><mi>x</mi> <mn>2</mn> </msup>
    <mo>-</mo>
    <mfrac><mn>1</mn> <mn>3</mn></mfrac>
    <msup><mi>x</mi> <mn>3</mn> </msup>
  </mrow>
</math>
</div>

<p>Such a function transforms an input value <math alttext="x">
  <mi>x</mi>
</math> to an output value <math alttext="y">
  <mi>y</mi>
</math>. Or it transforms a series of input values <math alttext="x 1 comma x 2 comma ellipsis comma x Subscript upper N Baseline">
  <mrow>
    <msub><mi>x</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>x</mi> <mn>2</mn> </msub>
    <mo>,</mo>
    <mo>...</mo>
    <mo>,</mo>
    <msub><mi>x</mi> <mi>N</mi> </msub>
  </mrow>
</math> into a series of output values <math alttext="y 1 comma y 2 comma ellipsis comma y Subscript upper N Baseline">
  <mrow>
    <msub><mi>y</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>y</mi> <mn>2</mn> </msub>
    <mo>,</mo>
    <mo>...</mo>
    <mo>,</mo>
    <msub><mi>y</mi> <mi>N</mi> </msub>
  </mrow>
</math>. The following Python code implements the mathematical function as a Python function and creates a number of input and output values. <a data-type="xref" href="#figure_ai_01">Figure 1-2</a> plots the output values against the input values:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">18</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">def</code><code> </code><code class="nf">f</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="k">return</code><code> </code><code class="mi">2</code><code> </code><code class="o">*</code><code> </code><code class="n">x</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code> </code><code class="o">-</code><code> </code><code class="n">x</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">3</code><code> </code><code class="o">/</code><code> </code><code class="mi">3</code><code>  </code><a class="co" id="co_artificial_intelligence_CO4-1" href="#callout_artificial_intelligence_CO4-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">4</code><code class="p">,</code><code> </code><code class="mi">25</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO4-2" href="#callout_artificial_intelligence_CO4-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">x</code><code>  </code><a class="co" id="co_artificial_intelligence_CO4-3" href="#callout_artificial_intelligence_CO4-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mf">2.</code><code>  </code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">1.75</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">1.5</code><code> </code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">1.25</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">1.</code><code>  </code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">0.75</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">0.5</code><code> </code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">0.25</code><code class="p">,</code><code>  </code><code class="mf">0.</code><code>  </code><code class="p">,</code><code>
</code><code>                 </code><code class="mf">0.25</code><code class="p">,</code><code>  </code><code class="mf">0.5</code><code> </code><code class="p">,</code><code>  </code><code class="mf">0.75</code><code class="p">,</code><code>  </code><code class="mf">1.</code><code>  </code><code class="p">,</code><code>  </code><code class="mf">1.25</code><code class="p">,</code><code>  </code><code class="mf">1.5</code><code> </code><code class="p">,</code><code>  </code><code class="mf">1.75</code><code class="p">,</code><code>  </code><code class="mf">2.</code><code>  </code><code class="p">,</code><code>  </code><code class="mf">2.25</code><code class="p">,</code><code>
</code><code>                 </code><code class="mf">2.5</code><code> </code><code class="p">,</code><code>  </code><code class="mf">2.75</code><code class="p">,</code><code>  </code><code class="mf">3.</code><code>  </code><code class="p">,</code><code>  </code><code class="mf">3.25</code><code class="p">,</code><code>  </code><code class="mf">3.5</code><code> </code><code class="p">,</code><code>  </code><code class="mf">3.75</code><code class="p">,</code><code>  </code><code class="mf">4.</code><code>  </code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">20</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">y</code><code> </code><code class="o">=</code><code> </code><code class="n">f</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO4-4" href="#callout_artificial_intelligence_CO4-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">y</code><code>  </code><a class="co" id="co_artificial_intelligence_CO4-5" href="#callout_artificial_intelligence_CO4-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">20</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mf">10.6667</code><code class="p">,</code><code>  </code><code class="mf">7.9115</code><code class="p">,</code><code>  </code><code class="mf">5.625</code><code> </code><code class="p">,</code><code>  </code><code class="mf">3.776</code><code> </code><code class="p">,</code><code>  </code><code class="mf">2.3333</code><code class="p">,</code><code>  </code><code class="mf">1.2656</code><code class="p">,</code><code>  </code><code class="mf">0.5417</code><code class="p">,</code><code>
</code><code>                 </code><code class="mf">0.1302</code><code class="p">,</code><code>  </code><code class="mf">0.</code><code>    </code><code class="p">,</code><code>  </code><code class="mf">0.1198</code><code class="p">,</code><code>  </code><code class="mf">0.4583</code><code class="p">,</code><code>  </code><code class="mf">0.9844</code><code class="p">,</code><code>  </code><code class="mf">1.6667</code><code class="p">,</code><code>  </code><code class="mf">2.474</code><code> </code><code class="p">,</code><code>
</code><code>                 </code><code class="mf">3.375</code><code> </code><code class="p">,</code><code>  </code><code class="mf">4.3385</code><code class="p">,</code><code>  </code><code class="mf">5.3333</code><code class="p">,</code><code>  </code><code class="mf">6.3281</code><code class="p">,</code><code>  </code><code class="mf">7.2917</code><code class="p">,</code><code>  </code><code class="mf">8.1927</code><code class="p">,</code><code>  </code><code class="mf">9.</code><code>    </code><code class="p">,</code><code>
</code><code>                 </code><code class="mf">9.6823</code><code class="p">,</code><code> </code><code class="mf">10.2083</code><code class="p">,</code><code> </code><code class="mf">10.5469</code><code class="p">,</code><code> </code><code class="mf">10.6667</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">21</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ro</code><code class="s1">'</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO4-1" href="#co_artificial_intelligence_CO4-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>The mathematical function as a Python function</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO4-2" href="#co_artificial_intelligence_CO4-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>The input values</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO4-3" href="#co_artificial_intelligence_CO4-4"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>The output values</p></dd>
</dl>

<figure><div id="figure_ai_01" class="figure">
<img src="Images/aiif_0102.png" alt="aiif 0102" width="2402" height="1420"/>
<h6><span class="label">Figure 1-2. </span>Output values against input values</h6>
</div></figure>

<p>Whereas in the mathematical example the function comes first, the input data second, and the output data third, the sequence is different in <a data-type="indexterm" data-primary="statistical learning" id="idm45625340618392"/><em>statistical learning</em>. Assume that the previous input values and output values are given. They represent the <em>sample</em> (data). The problem in <em>statistical regression</em> is to find a function that approximates the functional relationship between the <a data-type="indexterm" data-primary="dependent values" id="idm45625340616360"/><a data-type="indexterm" data-primary="independent values" id="idm45625336158616"/>input values (also called the <em>independent values</em>) and the output values (also called the <em>dependent values</em>) as well as possible.</p>

<p><a data-type="indexterm" data-primary="linear regression, in neural networks example" id="idm45625336156824"/>Assume simple OLS linear regression. In this case, the functional relationship between the input and output values is assumed to be linear, and the problem is to find optimal parameters <math alttext="alpha">
  <mi>α</mi>
</math> and <math alttext="beta">
  <mi>β</mi>
</math> for the following linear equation:</p>
<div data-type="equation">
<math alttext="ModifyingAbove f With caret colon double-struck upper R right-arrow double-struck upper R comma ModifyingAbove y With caret equals alpha plus beta x" display="block">
  <mrow>
    <mover accent="true"><mi>f</mi> <mo>^</mo></mover>
    <mo>:</mo>
    <mi>ℝ</mi>
    <mo>→</mo>
    <mi>ℝ</mi>
    <mo>,</mo>
    <mover accent="true"><mi>y</mi> <mo>^</mo></mover>
    <mo>=</mo>
    <mi>α</mi>
    <mo>+</mo>
    <mi>β</mi>
    <mi>x</mi>
  </mrow>
</math>
</div>

<p><a data-type="indexterm" data-primary="MSE (mean squared error)" id="idm45625335420424"/>For given input values <math alttext="x 1 comma x 2 comma ellipsis comma x Subscript upper N Baseline">
  <mrow>
    <msub><mi>x</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>x</mi> <mn>2</mn> </msub>
    <mo>,</mo>
    <mo>...</mo>
    <mo>,</mo>
    <msub><mi>x</mi> <mi>N</mi> </msub>
  </mrow>
</math> and output values <math alttext="y 1 comma y 2 comma ellipsis comma y Subscript upper N Baseline">
  <mrow>
    <msub><mi>y</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <msub><mi>y</mi> <mn>2</mn> </msub>
    <mo>,</mo>
    <mo>...</mo>
    <mo>,</mo>
    <msub><mi>y</mi> <mi>N</mi> </msub>
  </mrow>
</math>, <em>optimal</em> in this case means that they minimize the mean squared error (MSE) between the real output values and the approximated output values:</p>
<div data-type="equation">
<math alttext="min Underscript alpha comma beta Endscripts StartFraction 1 Over upper N EndFraction sigma-summation Underscript n Overscript upper N Endscripts left-parenthesis y Subscript n Baseline minus ModifyingAbove f With caret left-parenthesis x Subscript n Baseline right-parenthesis right-parenthesis squared" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">min</mo> <mrow><mi>α</mi><mo>,</mo><mi>β</mi></mrow> </munder>
    <mfrac><mn>1</mn> <mi>N</mi></mfrac>
    <munderover><mo>∑</mo> <mi>n</mi> <mi>N</mi> </munderover>
    <msup><mfenced separators="" open="(" close=")"><msub><mi>y</mi> <mi>n</mi> </msub><mo>-</mo><mover accent="true"><mi>f</mi> <mo>^</mo></mover><mrow><mo>(</mo><msub><mi>x</mi> <mi>n</mi> </msub><mo>)</mo></mrow></mfenced> <mn>2</mn> </msup>
  </mrow>
</math>
</div>

<p>For the case of simple linear regression, the solution <math alttext="left-parenthesis alpha Superscript asterisk Baseline comma beta Superscript asterisk Baseline right-parenthesis">
  <mrow>
    <mo>(</mo>
    <msup><mi>α</mi> <mo>*</mo> </msup>
    <mo>,</mo>
    <msup><mi>β</mi> <mo>*</mo> </msup>
    <mo>)</mo>
  </mrow>
</math> is known in closed form, as shown in the following equation. Bars on the variables indicate sample mean values:</p>
<div data-type="equation">
<math alttext="StartLayout 1st Row 1st Column beta Superscript asterisk 2nd Column equals 3rd Column StartFraction upper C o v left-parenthesis x comma y right-parenthesis Over upper V a r left-parenthesis x right-parenthesis EndFraction 2nd Row 1st Column alpha Superscript asterisk 2nd Column equals 3rd Column y overbar minus beta x overbar EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <msup><mi>β</mi> <mo>*</mo> </msup>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mfrac><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow> <mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mfrac>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <msup><mi>α</mi> <mo>*</mo> </msup>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mover accent="true"><mi>y</mi> <mo>¯</mo></mover>
          <mo>-</mo>
          <mi>β</mi>
          <mover accent="true"><mi>x</mi> <mo>¯</mo></mover>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p>The following Python code calculates the optimal parameter values, linearly estimates (approximates) the output values, and plots the linear regression line alongside the sample data (see <a data-type="xref" href="#figure_ai_02">Figure 1-3</a>). The linear regression approach does not work too well here in approximating the functional relationship. This is confirmed by the relatively high MSE value:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">beta</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">cov</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="n">ddof</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code> </code><code class="o">/</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">var</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO5-1" href="#callout_artificial_intelligence_CO5-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">beta</code><code>  </code><a class="co" id="co_artificial_intelligence_CO5-2" href="#callout_artificial_intelligence_CO5-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">1.0541666666666667</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">23</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">alpha</code><code> </code><code class="o">=</code><code> </code><code class="n">y</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code> </code><code class="o">-</code><code> </code><code class="n">beta</code><code> </code><code class="o">*</code><code> </code><code class="n">x</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO5-3" href="#callout_artificial_intelligence_CO5-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">alpha</code><code>  </code><a class="co" id="co_artificial_intelligence_CO5-4" href="#callout_artificial_intelligence_CO5-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">23</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">3.8625000000000003</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">y_</code><code> </code><code class="o">=</code><code> </code><code class="n">alpha</code><code> </code><code class="o">+</code><code> </code><code class="n">beta</code><code> </code><code class="o">*</code><code> </code><code class="n">x</code><code>  </code><a class="co" id="co_artificial_intelligence_CO5-5" href="#callout_artificial_intelligence_CO5-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">MSE</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="p">(</code><code class="n">y</code><code> </code><code class="o">-</code><code> </code><code class="n">y_</code><code class="p">)</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO5-6" href="#callout_artificial_intelligence_CO5-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">MSE</code><code>  </code><a class="co" id="co_artificial_intelligence_CO5-7" href="#callout_artificial_intelligence_CO5-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">10.721953125</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ro</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">sample data</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y_</code><code class="p">,</code><code> </code><code class="n">lw</code><code class="o">=</code><code class="mf">3.0</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">linear regression</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO5-1" href="#co_artificial_intelligence_CO5-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Calculation of optimal <math alttext="beta">
  <mi>β</mi>
</math></p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO5-2" href="#co_artificial_intelligence_CO5-3"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Calculation of optimal <math alttext="alpha">
  <mi>α</mi>
</math></p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO5-3" href="#co_artificial_intelligence_CO5-5"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Calculation of estimated output values</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO5-4" href="#co_artificial_intelligence_CO5-6"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Calculation of the MSE given the approximation</p></dd>
</dl>

<figure><div id="figure_ai_02" class="figure">
<img src="Images/aiif_0103.png" alt="aiif 0103" width="2402" height="1420"/>
<h6><span class="label">Figure 1-3. </span>Sample data and linear regression line</h6>
</div></figure>

<p>How can the MSE value be improved (decreased)—maybe even to 0, that is, to a “perfect estimation?” Of course, OLS regression is not constrained to a simple linear relationship. In addition to the constant and linear terms, higher order monomials, for instance, can be easily added as basis functions. To this end, compare the regression results shown in <a data-type="xref" href="#figure_ai_03">Figure 1-4</a> and the following code that creates the figure. The improvements that come from using quadratic and cubic monomials as basis functions are obvious and also are numerically confirmed by the calculated MSE values. For basis functions up to and including the cubic monomial, the estimation is perfect, and the functional relationship is perfectly recovered:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ro</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">sample data</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="k">for</code><code> </code><code class="n">deg</code><code> </code><code class="ow">in</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">]</code><code class="p">:</code><code>
</code><code>             </code><code class="n">reg</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">polyfit</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="n">deg</code><code class="o">=</code><code class="n">deg</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO6-1" href="#callout_artificial_intelligence_CO6-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>             </code><code class="n">y_</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">polyval</code><code class="p">(</code><code class="n">reg</code><code class="p">,</code><code> </code><code class="n">x</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO6-2" href="#callout_artificial_intelligence_CO6-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>             </code><code class="n">MSE</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="p">(</code><code class="n">y</code><code> </code><code class="o">-</code><code> </code><code class="n">y_</code><code class="p">)</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO6-3" href="#callout_artificial_intelligence_CO6-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>             </code><code class="k">print</code><code class="p">(</code><code class="n">f</code><code class="s1">'</code><code class="s1">deg={deg} | MSE={MSE:.5f}</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>             </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">polyval</code><code class="p">(</code><code class="n">reg</code><code class="p">,</code><code> </code><code class="n">x</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="n">f</code><code class="s1">'</code><code class="s1">deg={deg}</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code>         </code><code class="n">deg</code><code class="o">=</code><code class="mi">1</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">10.72195</code><code>
</code><code>         </code><code class="n">deg</code><code class="o">=</code><code class="mi">2</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">2.31258</code><code>
</code><code>         </code><code class="n">deg</code><code class="o">=</code><code class="mi">3</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.00000</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">reg</code><code>  </code><a class="co" id="co_artificial_intelligence_CO6-4" href="#callout_artificial_intelligence_CO6-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mf">0.3333</code><code class="p">,</code><code>  </code><code class="mf">2.</code><code>    </code><code class="p">,</code><code>  </code><code class="mf">0.</code><code>    </code><code class="p">,</code><code> </code><code class="o">-</code><code class="mf">0.</code><code>    </code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO6-1" href="#co_artificial_intelligence_CO6-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Regression step</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO6-2" href="#co_artificial_intelligence_CO6-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Approximation step</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO6-3" href="#co_artificial_intelligence_CO6-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>MSE calculation</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO6-4" href="#co_artificial_intelligence_CO6-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Optimal (“perfect”) parameter values</p></dd>
</dl>

<figure><div id="figure_ai_03" class="figure">
<img src="Images/aiif_0104.png" alt="aiif 0104" width="2402" height="1420"/>
<h6><span class="label">Figure 1-4. </span>Sample data and OLS regression lines</h6>
</div></figure>

<p>Exploiting the knowledge of the form of the mathematical function to be approximated and accordingly adding more basis functions to the regression leads to a “perfect approximation.” That is, the OLS regression recovers the exact factors of the quadratic and cubic part, respectively, of the original function.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Estimation with Neural Networks"><div class="sect2" id="idm45625334706312">
<h2>Estimation with Neural Networks</h2>

<p>However, not all relationships are of this kind. This is where, for instance, <em>neural networks</em> can help. Without going into the details, neural networks can approximate a wide range of functional relationships. Knowledge of the form of the relationship is generally not required.</p>










<section data-type="sect3" data-pdf-bookmark="Scikit-learn"><div class="sect3" id="idm45625340115448">
<h3>Scikit-learn</h3>

<p><a data-type="indexterm" data-primary="scikit-learn package" id="idm45625340114008"/><a data-type="indexterm" data-primary="MLPRegressor class, scikit-learn" id="idm45625340113144"/><a data-type="indexterm" data-primary="scikit-learn package" data-secondary="MLPRegressor class" id="idm45625340112456"/>The following Python code uses the <code>MLPRegressor</code> class of <code>scikit-learn</code>, which implements a DNN for estimation. <a data-type="indexterm" data-primary="estimation task" data-secondary="neural networks applied to" id="ix_estim_task_neuralnet_app"/><a data-type="indexterm" data-primary="neural networks" data-secondary="in estimation task" data-secondary-sortas="estimation task" id="ix_neuralnet_estim_task"/><a data-type="indexterm" data-primary="DNNs (dense neural networks)" data-secondary="estimation task" id="ix_DNN_estim_task"/>DNNs are sometimes also called multi-layer perceptron (MLP).<sup><a data-type="noteref" id="idm45625340102264-marker" href="ch01.xhtml#idm45625340102264">3</a></sup> The results are not perfect, as <a data-type="xref" href="#figure_ai_04">Figure 1-5</a> and the MSE illustrate. However, they are quite good already for the simple configuration used:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">29</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">from</code><code> </code><code class="nn">sklearn.neural_network</code><code> </code><code class="kn">import</code><code> </code><code class="n">MLPRegressor</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code> </code><code class="o">=</code><code> </code><code class="n">MLPRegressor</code><code class="p">(</code><code class="n">hidden_layer_sizes</code><code class="o">=</code><code class="mi">3</code><code> </code><code class="o">*</code><code> </code><code class="p">[</code><code class="mi">256</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                              </code><code class="n">learning_rate_init</code><code class="o">=</code><code class="mf">0.03</code><code class="p">,</code><code>
</code><code>                              </code><code class="n">max_iter</code><code class="o">=</code><code class="mi">5000</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO7-1" href="#callout_artificial_intelligence_CO7-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">31</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">x</code><code class="o">.</code><code class="n">reshape</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO7-2" href="#callout_artificial_intelligence_CO7-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">31</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">MLPRegressor</code><code class="p">(</code><code class="n">hidden_layer_sizes</code><code class="o">=</code><code class="p">[</code><code class="mi">256</code><code class="p">,</code><code> </code><code class="mi">256</code><code class="p">,</code><code> </code><code class="mi">256</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">learning_rate_init</code><code class="o">=</code><code class="mf">0.03</code><code class="p">,</code><code>
</code><code>                      </code><code class="n">max_iter</code><code class="o">=</code><code class="mi">5000</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">y_</code><code> </code><code class="o">=</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">x</code><code class="o">.</code><code class="n">reshape</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO7-3" href="#callout_artificial_intelligence_CO7-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">MSE</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="p">(</code><code class="n">y</code><code> </code><code class="o">-</code><code> </code><code class="n">y_</code><code class="p">)</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>
</code><code>         </code><code class="n">MSE</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.021662355744355866</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">34</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ro</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">sample data</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y_</code><code class="p">,</code><code> </code><code class="n">lw</code><code class="o">=</code><code class="mf">3.0</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">dnn estimation</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO7-1" href="#co_artificial_intelligence_CO7-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Instantiates the <code>MLPRegressor</code> object</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO7-2" href="#co_artificial_intelligence_CO7-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Implements the fitting or learning step</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO7-3" href="#co_artificial_intelligence_CO7-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Implements the prediction step</p></dd>
</dl>

<p>Just having a look at the results in <a data-type="xref" href="#figure_ai_03">Figure 1-4</a> and <a data-type="xref" href="#figure_ai_04">Figure 1-5</a>, one might assume that the methods and approaches are not too dissimilar after all. However, there is a fundamental difference worth highlighting. Although the OLS regression approach, as shown explicitly for the simple <a data-type="indexterm" data-primary="linear regression, in neural networks example" id="idm45625337132984"/>linear regression, is based on the calculation of certain well-specified quantities and parameters, the neural network approach relies on <a data-type="indexterm" data-primary="incremental learning characteristic of neural networks" id="idm45625337132056"/><em>incremental learning</em>. This in turn means that a set of parameters, <a data-type="indexterm" data-primary="weights in neural network" id="idm45625337131032"/>the <em>weights</em> within the neural network, are first initialized randomly and then adjusted gradually given the differences between the neural network output and the sample output values. This approach lets you retrain (update) a neural network incrementally.</p>

<figure><div id="figure_ai_04" class="figure">
<img src="Images/aiif_0105.png" alt="aiif 0105" width="2402" height="1420"/>
<h6><span class="label">Figure 1-5. </span>Sample data and neural network–based estimations</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Keras"><div class="sect3" id="idm45625340098616">
<h3>Keras</h3>

<p><a data-type="indexterm" data-primary="Keras deep learning package" id="ix_keras_gen"/>The next example uses a sequential model with the <code>Keras</code> deep learning package.<sup><a data-type="noteref" id="idm45625340095720-marker" href="ch01.xhtml#idm45625340095720">4</a></sup> The model is fitted, or <em>trained</em>, for 100 epochs. The procedure is repeated for five rounds. After every such round, the approximation by the neural network is updated and plotted. <a data-type="xref" href="#figure_ai_05">Figure 1-6</a> shows how the approximation gradually improves with every round. This is also reflected in the decreasing MSE values. The end result is not perfect, but again, it is quite good given the simplicity of the model:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">tensorflow</code><code> </code><code class="kn">as</code><code> </code><code class="nn">tf</code><code>
</code><code>         </code><code class="n">tf</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">set_seed</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">36</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">from</code><code> </code><code class="nn">keras.layers</code><code> </code><code class="kn">import</code><code> </code><code class="n">Dense</code><code>
</code><code>         </code><code class="kn">from</code><code> </code><code class="nn">keras.models</code><code> </code><code class="kn">import</code><code> </code><code class="n">Sequential</code><code>
</code><code>         </code><code class="n">Using</code><code> </code><code class="n">TensorFlow</code><code> </code><code class="n">backend</code><code class="o">.</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">37</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code> </code><code class="o">=</code><code> </code><code class="n">Sequential</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO8-1" href="#callout_artificial_intelligence_CO8-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">model</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">Dense</code><code class="p">(</code><code class="mi">256</code><code class="p">,</code><code> </code><code class="n">activation</code><code class="o">=</code><code class="s1">'</code><code class="s1">relu</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">input_dim</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" id="co_artificial_intelligence_CO8-2" href="#callout_artificial_intelligence_CO8-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">model</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">Dense</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">activation</code><code class="o">=</code><code class="s1">'</code><code class="s1">linear</code><code class="s1">'</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO8-3" href="#callout_artificial_intelligence_CO8-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">model</code><code class="o">.</code><code class="n">compile</code><code class="p">(</code><code class="n">loss</code><code class="o">=</code><code class="s1">'</code><code class="s1">mse</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">optimizer</code><code class="o">=</code><code class="s1">'</code><code class="s1">rmsprop</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO8-4" href="#callout_artificial_intelligence_CO8-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">38</code><code class="p">]</code><code class="p">:</code><code> </code><code class="p">(</code><code class="p">(</code><code class="n">y</code><code> </code><code class="o">-</code><code> </code><code class="n">y_</code><code class="p">)</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">38</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.021662355744355866</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ro</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">sample data</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="k">for</code><code> </code><code class="n">_</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="n">model</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="n">epochs</code><code class="o">=</code><code class="mi">100</code><code class="p">,</code><code> </code><code class="n">verbose</code><code class="o">=</code><code class="bp">False</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO8-5" href="#callout_artificial_intelligence_CO8-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code>             </code><code class="n">y_</code><code> </code><code class="o">=</code><code>  </code><code class="n">model</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO8-6" href="#callout_artificial_intelligence_CO8-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>             </code><code class="n">MSE</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="p">(</code><code class="n">y</code><code> </code><code class="o">-</code><code> </code><code class="n">y_</code><code class="o">.</code><code class="n">flatten</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO8-7" href="#callout_artificial_intelligence_CO8-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a><code>
</code><code>             </code><code class="k">print</code><code class="p">(</code><code class="n">f</code><code class="s1">'</code><code class="s1">round={_} | MSE={MSE:.5f}</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>             </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y_</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">--</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="n">f</code><code class="s1">'</code><code class="s1">round={_}</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO8-8" href="#callout_artificial_intelligence_CO8-8"><img src="Images/8.png" alt="8" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">1</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">3.09714</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">2</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.75603</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">3</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.22814</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">4</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.11861</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">5</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.09029</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO8-1" href="#co_artificial_intelligence_CO8-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Instantiates the <code>Sequential</code> model object</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO8-2" href="#co_artificial_intelligence_CO8-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Adds a densely connected hidden layer with rectified linear unit (ReLU) <span class="keep-together">activation</span><sup><a data-type="noteref" id="idm45625339723528-marker" href="ch01.xhtml#idm45625339723528">5</a></sup></p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO8-3" href="#co_artificial_intelligence_CO8-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Adds the output layer with linear activation</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO8-4" href="#co_artificial_intelligence_CO8-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Compiles the model for usage</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO8-5" href="#co_artificial_intelligence_CO8-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>Trains the neural network for a fixed number of epochs</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO8-6" href="#co_artificial_intelligence_CO8-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>Implements the approximation step</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO8-7" href="#co_artificial_intelligence_CO8-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a></dt>
<dd><p>Calculates the current MSE</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO8-8" href="#co_artificial_intelligence_CO8-8"><img src="Images/8.png" alt="8" width="12" height="12"/></a></dt>
<dd><p>Plots the current approximation results</p></dd>
</dl>

<p>Roughly speaking, one can say that the neural network does almost as well in the estimation as the OLS regression, which delivers a perfect result. Therefore, why use neural networks at all? A more comprehensive answer might need to come later in this book, but a somewhat different example might give some hint.</p>

<p>Consider instead the previous sample data set, as generated from a well-defined mathematical function, now a <em>random sample data set</em>, for which both features and labels are randomly chosen. Of course, this example is for illustration and does not allow for a deep interpretation.</p>

<figure><div id="figure_ai_05" class="figure">
<img src="Images/aiif_0106.png" alt="aiif 0106" width="2477" height="1421"/>
<h6><span class="label">Figure 1-6. </span>Sample data and estimations after multiple training rounds</h6>
</div></figure>

<p>The following code generates the random sample data set and creates the OLS regression estimation based on a varying number of monomial basis functions. <a data-type="xref" href="#figure_ai_06">Figure 1-7</a> visualizes the results. Even for the highest number of monomials in the example, the estimation results are still not too good. The MSE value is accordingly relatively high:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">40</code><code class="p">]:</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">seed</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code>
         <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">)</code>
         <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">x</code><code class="p">))</code> <code class="o">*</code> <code class="mi">2</code> <code class="o">-</code> <code class="mi">1</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">41</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="s1">'ro'</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'sample data'</code><code class="p">)</code>
         <code class="k">for</code> <code class="n">deg</code> <code class="ow">in</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">9</code><code class="p">,</code> <code class="mi">11</code><code class="p">,</code> <code class="mi">13</code><code class="p">,</code> <code class="mi">15</code><code class="p">]:</code>
             <code class="n">reg</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">polyfit</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">deg</code><code class="o">=</code><code class="n">deg</code><code class="p">)</code>
             <code class="n">y_</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">polyval</code><code class="p">(</code><code class="n">reg</code><code class="p">,</code> <code class="n">x</code><code class="p">)</code>
             <code class="n">MSE</code> <code class="o">=</code> <code class="p">((</code><code class="n">y</code> <code class="o">-</code> <code class="n">y_</code><code class="p">)</code> <code class="o">**</code> <code class="mi">2</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">()</code>
             <code class="k">print</code><code class="p">(</code><code class="n">f</code><code class="s1">'deg={deg:2d} | MSE={MSE:.5f}'</code><code class="p">)</code>
             <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">polyval</code><code class="p">(</code><code class="n">reg</code><code class="p">,</code> <code class="n">x</code><code class="p">),</code> <code class="n">label</code><code class="o">=</code><code class="n">f</code><code class="s1">'deg={deg}'</code><code class="p">)</code>
         <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">();</code>
         <code class="n">deg</code><code class="o">=</code> <code class="mi">1</code> <code class="o">|</code> <code class="n">MSE</code><code class="o">=</code><code class="mf">0.28153</code>
         <code class="n">deg</code><code class="o">=</code> <code class="mi">5</code> <code class="o">|</code> <code class="n">MSE</code><code class="o">=</code><code class="mf">0.27331</code>
         <code class="n">deg</code><code class="o">=</code> <code class="mi">9</code> <code class="o">|</code> <code class="n">MSE</code><code class="o">=</code><code class="mf">0.25442</code>
         <code class="n">deg</code><code class="o">=</code><code class="mi">11</code> <code class="o">|</code> <code class="n">MSE</code><code class="o">=</code><code class="mf">0.23458</code>
         <code class="n">deg</code><code class="o">=</code><code class="mi">13</code> <code class="o">|</code> <code class="n">MSE</code><code class="o">=</code><code class="mf">0.22989</code>
         <code class="n">deg</code><code class="o">=</code><code class="mi">15</code> <code class="o">|</code> <code class="n">MSE</code><code class="o">=</code><code class="mf">0.21672</code></pre>

<p><a data-type="indexterm" data-primary="random sample data set, OLS versus neural networks" id="ix_random_OLSvsnn"/>The results for the OLS regression are not too surprising. OLS regression in this case assumes that the approximation can be achieved through an appropriate combination of a finite number of basis functions. Since the sample data set has been generated randomly, the OLS regression does not perform well in this case.</p>

<figure><div id="figure_ai_06" class="figure">
<img src="Images/aiif_0107.png" alt="aiif 0107" width="2451" height="1421"/>
<h6><span class="label">Figure 1-7. </span>Random sample data and OLS regression lines</h6>
</div></figure>

<p>What about neural networks? The application is as straightforward as before and yields estimations as shown in <a data-type="xref" href="#figure_ai_07">Figure 1-8</a>. While the end result is not perfect, it is obvious that the neural network performs better than the OLS regression in estimating the random label values from the random features values. Given its architecture, however, the neural network has almost 200,000 trainable parameters (weights), which offers relatively high flexibility, particularly when compared to the OLS regression, for which a maximum of 15 + 1 parameters are used:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">42</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code> </code><code class="o">=</code><code> </code><code class="n">Sequential</code><code class="p">(</code><code class="p">)</code><code>
</code><code>         </code><code class="n">model</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">Dense</code><code class="p">(</code><code class="mi">256</code><code class="p">,</code><code> </code><code class="n">activation</code><code class="o">=</code><code class="s1">'</code><code class="s1">relu</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">input_dim</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="k">for</code><code> </code><code class="n">_</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">3</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="n">model</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">Dense</code><code class="p">(</code><code class="mi">256</code><code class="p">,</code><code> </code><code class="n">activation</code><code class="o">=</code><code class="s1">'</code><code class="s1">relu</code><code class="s1">'</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO9-1" href="#callout_artificial_intelligence_CO9-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">model</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">Dense</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">activation</code><code class="o">=</code><code class="s1">'</code><code class="s1">linear</code><code class="s1">'</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">model</code><code class="o">.</code><code class="n">compile</code><code class="p">(</code><code class="n">loss</code><code class="o">=</code><code class="s1">'</code><code class="s1">mse</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">optimizer</code><code class="o">=</code><code class="s1">'</code><code class="s1">rmsprop</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">43</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">summary</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO9-2" href="#callout_artificial_intelligence_CO9-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">Model</code><code class="p">:</code><code> </code><code class="s2">"</code><code class="s2">sequential_2</code><code class="s2">"</code><code>
</code><code>         </code><code class="n">_________________________________________________________________</code><code>
</code><code>         </code><code class="n">Layer</code><code> </code><code class="p">(</code><code class="nb">type</code><code class="p">)</code><code>                 </code><code class="n">Output</code><code> </code><code class="n">Shape</code><code>              </code><code class="n">Param</code><code> </code><code class="c1">#</code><code>
</code><code>         </code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">=</code><code>
</code><code>         </code><code class="n">dense_3</code><code> </code><code class="p">(</code><code class="n">Dense</code><code class="p">)</code><code>              </code><code class="p">(</code><code class="bp">None</code><code class="p">,</code><code> </code><code class="mi">256</code><code class="p">)</code><code>               </code><code class="mi">512</code><code>
</code><code>         </code><code class="n">_________________________________________________________________</code><code>
</code><code>         </code><code class="n">dense_4</code><code> </code><code class="p">(</code><code class="n">Dense</code><code class="p">)</code><code>              </code><code class="p">(</code><code class="bp">None</code><code class="p">,</code><code> </code><code class="mi">256</code><code class="p">)</code><code>               </code><code class="mi">65792</code><code>
</code><code>         </code><code class="n">_________________________________________________________________</code><code>
</code><code>         </code><code class="n">dense_5</code><code> </code><code class="p">(</code><code class="n">Dense</code><code class="p">)</code><code>              </code><code class="p">(</code><code class="bp">None</code><code class="p">,</code><code> </code><code class="mi">256</code><code class="p">)</code><code>               </code><code class="mi">65792</code><code>
</code><code>         </code><code class="n">_________________________________________________________________</code><code>
</code><code>         </code><code class="n">dense_6</code><code> </code><code class="p">(</code><code class="n">Dense</code><code class="p">)</code><code>              </code><code class="p">(</code><code class="bp">None</code><code class="p">,</code><code> </code><code class="mi">256</code><code class="p">)</code><code>               </code><code class="mi">65792</code><code>
</code><code>         </code><code class="n">_________________________________________________________________</code><code>
</code><code>         </code><code class="n">dense_7</code><code> </code><code class="p">(</code><code class="n">Dense</code><code class="p">)</code><code>              </code><code class="p">(</code><code class="bp">None</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code>                 </code><code class="mi">257</code><code>
</code><code>         </code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">==</code><code class="o">=</code><code>
</code><code>         </code><code class="n">Total</code><code> </code><code class="n">params</code><code class="p">:</code><code> </code><code class="mi">198</code><code class="p">,</code><code class="mi">145</code><code>
</code><code>         </code><code class="n">Trainable</code><code> </code><code class="n">params</code><code class="p">:</code><code> </code><code class="mi">198</code><code class="p">,</code><code class="mi">145</code><code>
</code><code>         </code><code class="n">Non</code><code class="o">-</code><code class="n">trainable</code><code> </code><code class="n">params</code><code class="p">:</code><code> </code><code class="mi">0</code><code>
</code><code>         </code><code class="n">_________________________________________________________________</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">44</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="o">%</code><code class="n">time</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ro</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">sample data</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="k">for</code><code> </code><code class="n">_</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">8</code><code class="p">)</code><code class="p">:</code><code>
</code><code>             </code><code class="n">model</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="n">epochs</code><code class="o">=</code><code class="mi">500</code><code class="p">,</code><code> </code><code class="n">verbose</code><code class="o">=</code><code class="bp">False</code><code class="p">)</code><code>
</code><code>             </code><code class="n">y_</code><code> </code><code class="o">=</code><code>  </code><code class="n">model</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><code>             </code><code class="n">MSE</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="p">(</code><code class="n">y</code><code> </code><code class="o">-</code><code> </code><code class="n">y_</code><code class="o">.</code><code class="n">flatten</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>
</code><code>             </code><code class="k">print</code><code class="p">(</code><code class="n">f</code><code class="s1">'</code><code class="s1">round={_} | MSE={MSE:.5f}</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>             </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y_</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">--</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="n">f</code><code class="s1">'</code><code class="s1">round={_}</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">1</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.13560</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">2</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.08337</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">3</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.06281</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">4</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.04419</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">5</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.03329</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">6</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.07676</code><code>
</code><code>         </code><code class="nb">round</code><code class="o">=</code><code class="mi">7</code><code> </code><code class="o">|</code><code> </code><code class="n">MSE</code><code class="o">=</code><code class="mf">0.00431</code><code>
</code><code>         </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mf">30.4</code><code> </code><code class="n">s</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mf">4.7</code><code> </code><code class="n">s</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mf">35.1</code><code> </code><code class="n">s</code><code>
</code><code>         </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mf">13.6</code><code> </code><code class="n">s</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO9-1" href="#co_artificial_intelligence_CO9-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Multiple hidden layers are added.</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO9-2" href="#co_artificial_intelligence_CO9-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Network architecture and number of trainable parameters are shown.<a data-type="indexterm" data-primary="" data-startref="ix_DNN_estim_task" id="idm45625338391336"/><a data-type="indexterm" data-primary="" data-startref="ix_estim_task_neuralnet_app" id="idm45625338390360"/><a data-type="indexterm" data-primary="" data-startref="ix_neuralnet_estim_task" id="idm45625338402056"/><a data-type="indexterm" data-primary="" data-startref="ix_random_OLSvsnn" id="idm45625338401224"/></p></dd>
</dl>

<figure><div id="figure_ai_07" class="figure">
<img src="Images/aiif_0108.png" alt="aiif 0108" width="2438" height="1421"/>
<h6><span class="label">Figure 1-8. </span>Random sample data and neural network estimations</h6>
</div></figure>
</div></section>



</div></section>













<section data-type="sect2" data-pdf-bookmark="Classification with Neural Networks"><div class="sect2" id="idm45625338469880">
<h2>Classification with Neural Networks</h2>

<p><a data-type="indexterm" data-primary="neural networks" data-secondary="in classification task" data-secondary-sortas="classification task" id="ix_neuralnet_classif"/><a data-type="indexterm" data-primary="classification task" data-secondary="neural networks applied to" id="ix_classif_neuralnet_app"/>Another benefit of neural networks is that they can be easily used for classification tasks as well. Consider the following Python code that implements a classification using a neural network based on <code>Keras</code>. The binary features data and labels data are generated randomly. <a data-type="indexterm" data-primary="activation functions, neural networks" id="idm45625338395656"/><a data-type="indexterm" data-primary="linear activation function" id="idm45625338394984"/><a data-type="indexterm" data-primary="neural networks" data-secondary="activation functions" id="idm45625338394344"/><a data-type="indexterm" data-primary="sigmoid activation function" id="ix_sigmoid_function"/>The major adjustment to be made modeling-wise is to change the activation function from the output layer to <code>sigmoid</code> from <code>linear</code>. More details on this appear in later chapters. The classification is not perfect. However, it reaches 
<span class="keep-together">a high level</span> of accuracy. How the accuracy, expressed as the relationship between 
<span class="keep-together">correct</span> results to all label values, changes with the number of training epochs is shown 
<span class="keep-together">in <a data-type="xref" href="#figure_ai_09">Figure 1-9</a>.</span> The accuracy starts out low and then improves step-wise, though not 
<span class="keep-together">necessarily</span> with every step:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">45</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">f</code><code> </code><code class="o">=</code><code> </code><code class="mi">5</code><code>
</code><code>         </code><code class="n">n</code><code> </code><code class="o">=</code><code> </code><code class="mi">10</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">46</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">seed</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">47</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randint</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="p">(</code><code class="n">n</code><code class="p">,</code><code> </code><code class="n">f</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO10-1" href="#callout_artificial_intelligence_CO10-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">x</code><code>  </code><a class="co" id="co_artificial_intelligence_CO10-2" href="#callout_artificial_intelligence_CO10-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">47</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">48</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">y</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randint</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">n</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO10-3" href="#callout_artificial_intelligence_CO10-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">y</code><code>  </code><a class="co" id="co_artificial_intelligence_CO10-4" href="#callout_artificial_intelligence_CO10-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">48</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">49</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code> </code><code class="o">=</code><code> </code><code class="n">Sequential</code><code class="p">(</code><code class="p">)</code><code>
</code><code>         </code><code class="n">model</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">Dense</code><code class="p">(</code><code class="mi">256</code><code class="p">,</code><code> </code><code class="n">activation</code><code class="o">=</code><code class="s1">'</code><code class="s1">relu</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">input_dim</code><code class="o">=</code><code class="n">f</code><code class="p">)</code><code class="p">)</code><code>
</code><code>         </code><code class="n">model</code><code class="o">.</code><code class="n">add</code><code class="p">(</code><code class="n">Dense</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">activation</code><code class="o">=</code><code class="s1">'</code><code class="s1">sigmoid</code><code class="s1">'</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO10-5" href="#callout_artificial_intelligence_CO10-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">model</code><code class="o">.</code><code class="n">compile</code><code class="p">(</code><code class="n">loss</code><code class="o">=</code><code class="s1">'</code><code class="s1">binary_crossentropy</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">optimizer</code><code class="o">=</code><code class="s1">'</code><code class="s1">rmsprop</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>                      </code><code class="n">metrics</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">acc</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO10-6" href="#callout_artificial_intelligence_CO10-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">50</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="n">epochs</code><code class="o">=</code><code class="mi">50</code><code class="p">,</code><code> </code><code class="n">verbose</code><code class="o">=</code><code class="bp">False</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">50</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">&lt;</code><code class="n">keras</code><code class="o">.</code><code class="n">callbacks</code><code class="o">.</code><code class="n">callbacks</code><code class="o">.</code><code class="n">History</code><code> </code><code class="n">at</code><code> </code><code class="mh">0x7fde09dd1cd0</code><code class="o">&gt;</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">51</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">y_</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">where</code><code class="p">(</code><code class="n">model</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="o">.</code><code class="n">flatten</code><code class="p">(</code><code class="p">)</code><code> </code><code class="o">&gt;</code><code> </code><code class="mf">0.5</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code>
</code><code>         </code><code class="n">y_</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">51</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">dtype</code><code class="o">=</code><code class="n">int32</code><code class="p">)</code><code>
</code><code>
</code><code>
</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">52</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">y</code><code> </code><code class="o">==</code><code> </code><code class="n">y_</code><code>  </code><a class="co" id="co_artificial_intelligence_CO10-7" href="#callout_artificial_intelligence_CO10-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">52</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code> </code><code class="bp">True</code><code class="p">,</code><code>  </code><code class="bp">True</code><code class="p">,</code><code>  </code><code class="bp">True</code><code class="p">,</code><code>  </code><code class="bp">True</code><code class="p">,</code><code> </code><code class="bp">False</code><code class="p">,</code><code>  </code><code class="bp">True</code><code class="p">,</code><code>  </code><code class="bp">True</code><code class="p">,</code><code>  </code><code class="bp">True</code><code class="p">,</code><code>  </code><code class="bp">True</code><code class="p">,</code><code>
</code><code>                 </code><code class="bp">True</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">53</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">res</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">model</code><code class="o">.</code><code class="n">history</code><code class="o">.</code><code class="n">history</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO10-8" href="#callout_artificial_intelligence_CO10-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">54</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">res</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="p">;</code><code>  </code><a class="co" id="co_artificial_intelligence_CO10-9" href="#callout_artificial_intelligence_CO10-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO10-1" href="#co_artificial_intelligence_CO10-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Creates random features data</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO10-2" href="#co_artificial_intelligence_CO10-3"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Creates random labels data</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO10-3" href="#co_artificial_intelligence_CO10-5"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Defines the activation function for the output layer as <code>sigmoid</code></p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO10-4" href="#co_artificial_intelligence_CO10-6"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Defines the loss function to be <code>binary_crossentropy</code><sup><a data-type="noteref" id="idm45625343405032-marker" href="ch01.xhtml#idm45625343405032">6</a></sup></p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO10-5" href="#co_artificial_intelligence_CO10-7"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>Compares the predicted values with the labels data</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO10-6" href="#co_artificial_intelligence_CO10-8"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>Plots the loss function and accuracy values for every training step</p></dd>
</dl>

<figure><div id="figure_ai_09" class="figure">
<img src="Images/aiif_0109.png" alt="aiif 0109" width="2418" height="1421"/>
<h6><span class="label">Figure 1-9. </span>Classification accuracy and loss against number of epochs</h6>
</div></figure>
<div style="page-break-after: always;"/>

<p>The examples in this section illustrate some fundamental characteristics of neural networks as compared to OLS regression:</p>
<dl>
<dt><a data-type="indexterm" data-primary="problem-agnostic characteristic of neural networks" id="idm45625343401976"/>Problem-agnostic</dt>
<dd>
<p>The neural network approach is agnostic when it comes to estimating and classifying label values, given a set of feature values. Statistical methods, such as OLS regression, might perform well for a smaller set of problems, but not too well or not at all for others.</p>
</dd>
<dt><a data-type="indexterm" data-primary="incremental learning characteristic of neural networks" id="idm45625343399672"/>Incremental learning</dt>
<dd>
<p>The optimal weights within a neural network, given a target measure of success, are learned incrementally based on a random initialization and incremental improvements. These incremental improvements are achieved by considering the differences between the predicted values and the sample label values and backpropagating weights updates through the neural network.<a data-type="indexterm" data-primary="" data-startref="ix_sigmoid_function" id="idm45625335931304"/></p>
</dd>
<dt><a data-type="indexterm" data-primary="universal approximation characteristic of neural networks" id="idm45625335929944"/>Universal approximation</dt>
<dd>
<p>There are strong mathematical theorems showing that neural networks (even with one hidden layer only) can approximate almost any function.<sup><a data-type="noteref" id="idm45625335928248-marker" href="ch01.xhtml#idm45625335928248">7</a></sup></p>
</dd>
</dl>

<p>These characteristics might justify why this book puts neural networks at the core with regard to the algorithms used. <a data-type="xref" href="ch02.xhtml#superintelligence">Chapter 2</a> discusses more good reasons.<a data-type="indexterm" data-primary="" data-startref="ix_OLS_vs_neuralnet" id="idm45625340301752"/><a data-type="indexterm" data-primary="" data-startref="ix_classif_neuralnet_app" id="idm45625340300808"/><a data-type="indexterm" data-primary="" data-startref="ix_neuralnet_classif" id="idm45625340299896"/></p>
<div data-type="note" epub:type="note"><h1>Neural Networks</h1>
<p>Neural networks are good at learning relationships between input and output data. They can be applied to a number of problem types, such as estimation in the presence of complex relationships or classification, for which traditional statistical methods are not well suited.<a data-type="indexterm" data-primary="" data-startref="ix_AI_neuralnet_gen" id="idm45625343353560"/><a data-type="indexterm" data-primary="" data-startref="ix_neuralnet_role_AI" id="idm45625343352584"/><a data-type="indexterm" data-primary="" data-startref="ix_keras_gen" id="idm45625343351640"/></p>
</div>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Importance of Data"><div class="sect1" id="ai_importance_of_data">
<h1>Importance of Data</h1>

<p><a data-type="indexterm" data-primary="prediction algorithm" id="ix_predict_alg_gen"/><a data-type="indexterm" data-primary="data" data-secondary="for neural networks" data-secondary-sortas="neural networks" id="ix_data_neuralnet_gen"/><a data-type="indexterm" data-primary="neural networks" data-secondary="prediction algorithms and data size" id="ix_neuralnet_data_size"/><a data-type="indexterm" data-primary="AI (artificial intelligence)" data-secondary="importance of data" id="ix_AI_imp_data"/>The example at the end of the previous section shows that neural networks are capable of solving classification problems quite well. The neural network with one hidden layer reaches a high degree of accuracy on the given data set, or <em>in-sample</em>. However, what about the predictive power of a neural network? This hinges significantly on the volume and variety of the data available to train the neural network. Another numerical example, based on larger data sets, will illustrate this point.</p>








<section data-type="sect2" data-pdf-bookmark="Small Data Set"><div class="sect2" id="idm45625340207976">
<h2>Small Data Set</h2>

<p><a data-type="indexterm" data-primary="data" data-secondary="small data set" id="ix_data_smallset"/>Consider a random sample data set similar to the one used before in the classification example, but with more features and more samples. <a data-type="indexterm" data-primary="pattern recognition, AI algorithms’ focus on" id="idm45625340204616"/>Most algorithms used in AI are about <em>pattern recognition</em>. In the following Python code, the number of binary features defines the number of possible patterns about which the algorithm can learn something. Given that the labels data is also binary, the algorithm tries to learn whether a <code>0</code> or <code>1</code> is more likely given a certain pattern, say <code>[0, 0, 1, 1, 1, 1, 0, 0, 0, 0]</code>. Because all numbers are randomly chosen with equal probability, there is not that much to learn beyond the fact that the labels <code>0</code> and <code>1</code> are equally likely no matter what (random) pattern is observed. Therefore, a baseline prediction algorithm should be accurate about 50% of the time, no matter what (random) pattern it is 
<span class="keep-together">presented</span> with:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">55</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">f</code><code> </code><code class="o">=</code><code> </code><code class="mi">10</code><code>
</code><code>         </code><code class="n">n</code><code> </code><code class="o">=</code><code> </code><code class="mi">250</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">56</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">seed</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">57</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randint</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="p">(</code><code class="n">n</code><code class="p">,</code><code> </code><code class="n">f</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO11-1" href="#callout_artificial_intelligence_CO11-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">x</code><code class="p">[</code><code class="p">:</code><code class="mi">4</code><code class="p">]</code><code>  </code><a class="co" id="co_artificial_intelligence_CO11-2" href="#callout_artificial_intelligence_CO11-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">57</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code>
</code><code>                </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">58</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">y</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randint</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">n</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO11-3" href="#callout_artificial_intelligence_CO11-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">y</code><code class="p">[</code><code class="p">:</code><code class="mi">4</code><code class="p">]</code><code>  </code><a class="co" id="co_artificial_intelligence_CO11-4" href="#callout_artificial_intelligence_CO11-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">58</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">]</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">59</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mi">2</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="n">f</code><code>  </code><a class="co" id="co_artificial_intelligence_CO11-5" href="#callout_artificial_intelligence_CO11-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">59</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mi">1024</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO11-1" href="#co_artificial_intelligence_CO11-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Features data</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO11-2" href="#co_artificial_intelligence_CO11-3"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Labels data</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO11-3" href="#co_artificial_intelligence_CO11-5"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Number of patterns</p></dd>
</dl>

<p>In order to proceed, the raw data is put into a <code>pandas</code> <code>DataFrame</code> object, which simplifies certain operations and analyses:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">60</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">fcols</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="n">f</code><code class="s1">'</code><code class="s1">f{_}</code><code class="s1">'</code><code> </code><code class="k">for</code><code> </code><code class="n">_</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="n">f</code><code class="p">)</code><code class="p">]</code><code>  </code><a class="co" id="co_artificial_intelligence_CO12-1" href="#callout_artificial_intelligence_CO12-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">fcols</code><code>  </code><a class="co" id="co_artificial_intelligence_CO12-2" href="#callout_artificial_intelligence_CO12-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">60</code><code class="p">]</code><code class="p">:</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">f0</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">f1</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">f2</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">f3</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">f4</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">f5</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">f6</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">f7</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">f8</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">f9</code><code class="s1">'</code><code class="p">]</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">61</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">columns</code><code class="o">=</code><code class="n">fcols</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO12-3" href="#callout_artificial_intelligence_CO12-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">l</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">y</code><code>  </code><a class="co" id="co_artificial_intelligence_CO12-4" href="#callout_artificial_intelligence_CO12-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">62</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO12-5" href="#callout_artificial_intelligence_CO12-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code>         </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>
</code><code>         </code><code class="n">RangeIndex</code><code class="p">:</code><code> </code><code class="mi">250</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">0</code><code> </code><code class="n">to</code><code> </code><code class="mi">249</code><code>
</code><code>         </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">11</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>
</code><code>          </code><code class="c1">#   Column  Non-Null Count  Dtype</code><code>
</code><code>         </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>
</code><code>          </code><code class="mi">0</code><code>   </code><code class="n">f0</code><code>      </code><code class="mi">250</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>
</code><code>          </code><code class="mi">1</code><code>   </code><code class="n">f1</code><code>      </code><code class="mi">250</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>
</code><code>          </code><code class="mi">2</code><code>   </code><code class="n">f2</code><code>      </code><code class="mi">250</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>
</code><code>          </code><code class="mi">3</code><code>   </code><code class="n">f3</code><code>      </code><code class="mi">250</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>
</code><code>          </code><code class="mi">4</code><code>   </code><code class="n">f4</code><code>      </code><code class="mi">250</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>
</code><code>          </code><code class="mi">5</code><code>   </code><code class="n">f5</code><code>      </code><code class="mi">250</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>
</code><code>          </code><code class="mi">6</code><code>   </code><code class="n">f6</code><code>      </code><code class="mi">250</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>
</code><code>          </code><code class="mi">7</code><code>   </code><code class="n">f7</code><code>      </code><code class="mi">250</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>
</code><code>          </code><code class="mi">8</code><code>   </code><code class="n">f8</code><code>      </code><code class="mi">250</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>
</code><code>          </code><code class="mi">9</code><code>   </code><code class="n">f9</code><code>      </code><code class="mi">250</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>
</code><code>          </code><code class="mi">10</code><code>  </code><code class="n">l</code><code>       </code><code class="mi">250</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>    </code><code class="n">int64</code><code>
</code><code>         </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">int64</code><code class="p">(</code><code class="mi">11</code><code class="p">)</code><code>
</code><code>         </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">21.6</code><code> </code><code class="n">KB</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO12-1" href="#co_artificial_intelligence_CO12-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Defines column names for the features data</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO12-2" href="#co_artificial_intelligence_CO12-3"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Puts the features data into a <code>DataFrame</code> object</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO12-3" href="#co_artificial_intelligence_CO12-4"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Puts the labels data into the same <code>DataFrame</code> object</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO12-4" href="#co_artificial_intelligence_CO12-5"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Shows the meta information for the data set</p></dd>
</dl>

<p>Two major problems can be identified given the results from executing the following Python code. First, not all patterns are in the sample data set. Second, the sample size is much too small per observed pattern. Even without digging deeper, it is clear 
<span class="keep-together">that no</span> classification algorithm can really learn about all the possible patterns in a 
<span class="keep-together">meaningful</span> way:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">63</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">grouped</code><code> </code><code class="o">=</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="nb">list</code><code class="p">(</code><code class="n">data</code><code class="o">.</code><code class="n">columns</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO13-1" href="#callout_artificial_intelligence_CO13-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">64</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">freq</code><code> </code><code class="o">=</code><code> </code><code class="n">grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">l</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">size</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">unstack</code><code class="p">(</code><code class="n">fill_value</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO13-2" href="#callout_artificial_intelligence_CO13-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">65</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">freq</code><code class="p">[</code><code class="s1">'</code><code class="s1">sum</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">freq</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code> </code><code class="o">+</code><code> </code><code class="n">freq</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code>  </code><a class="co" id="co_artificial_intelligence_CO13-3" href="#callout_artificial_intelligence_CO13-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">66</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">freq</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO13-4" href="#callout_artificial_intelligence_CO13-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">66</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">l</code><code>                              </code><code class="mi">0</code><code>  </code><code class="mi">1</code><code>  </code><code class="nb">sum</code><code>
</code><code>         </code><code class="n">f0</code><code> </code><code class="n">f1</code><code> </code><code class="n">f2</code><code> </code><code class="n">f3</code><code> </code><code class="n">f4</code><code> </code><code class="n">f5</code><code> </code><code class="n">f6</code><code> </code><code class="n">f7</code><code> </code><code class="n">f8</code><code> </code><code class="n">f9</code><code>
</code><code>         </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">1</code><code>  </code><code class="mi">1</code><code>  </code><code class="mi">1</code><code>   </code><code class="mi">0</code><code>  </code><code class="mi">1</code><code>    </code><code class="mi">1</code><code>
</code><code>                           </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>   </code><code class="mi">1</code><code>  </code><code class="mi">1</code><code>    </code><code class="mi">2</code><code>
</code><code>                                    </code><code class="mi">1</code><code>   </code><code class="mi">0</code><code>  </code><code class="mi">1</code><code>    </code><code class="mi">1</code><code>
</code><code>                        </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>   </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>    </code><code class="mi">1</code><code>
</code><code>                                    </code><code class="mi">1</code><code>   </code><code class="mi">0</code><code>  </code><code class="mi">1</code><code>    </code><code class="mi">1</code><code>
</code><code>                              </code><code class="mi">1</code><code>  </code><code class="mi">1</code><code>  </code><code class="mi">1</code><code>   </code><code class="mi">0</code><code>  </code><code class="mi">1</code><code>    </code><code class="mi">1</code><code>
</code><code>                           </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>   </code><code class="mi">0</code><code>  </code><code class="mi">1</code><code>    </code><code class="mi">1</code><code>
</code><code>                                 </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>   </code><code class="mi">0</code><code>  </code><code class="mi">1</code><code>    </code><code class="mi">1</code><code>
</code><code>                     </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">1</code><code>  </code><code class="mi">1</code><code>   </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>    </code><code class="mi">1</code><code>
</code><code>                           </code><code class="mi">1</code><code>  </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>   </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>    </code><code class="mi">1</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">67</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">freq</code><code class="p">[</code><code class="s1">'</code><code class="s1">sum</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">describe</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">astype</code><code class="p">(</code><code class="nb">int</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO13-5" href="#callout_artificial_intelligence_CO13-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">67</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">count</code><code>    </code><code class="mi">227</code><code>
</code><code>         </code><code class="n">mean</code><code>       </code><code class="mi">1</code><code>
</code><code>         </code><code class="n">std</code><code>        </code><code class="mi">0</code><code>
</code><code>         </code><code class="nb">min</code><code>        </code><code class="mi">1</code><code>
</code><code>         </code><code class="mi">25</code><code class="o">%</code><code>        </code><code class="mi">1</code><code>
</code><code>         </code><code class="mi">50</code><code class="o">%</code><code>        </code><code class="mi">1</code><code>
</code><code>         </code><code class="mi">75</code><code class="o">%</code><code>        </code><code class="mi">1</code><code>
</code><code>         </code><code class="nb">max</code><code>        </code><code class="mi">2</code><code>
</code><code>         </code><code class="n">Name</code><code class="p">:</code><code> </code><code class="nb">sum</code><code class="p">,</code><code> </code><code class="n">dtype</code><code class="p">:</code><code> </code><code class="n">int64</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO13-1" href="#co_artificial_intelligence_CO13-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Groups the data along all columns</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO13-2" href="#co_artificial_intelligence_CO13-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Unstacks the grouped data for the labels column</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO13-3" href="#co_artificial_intelligence_CO13-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Adds up the frequency for a <code>0</code> and a <code>1</code></p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO13-4" href="#co_artificial_intelligence_CO13-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Shows the frequencies for a <code>0</code> and a <code>1</code> given a certain pattern</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO13-5" href="#co_artificial_intelligence_CO13-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>Provides statistics for the sum of the frequencies</p></dd>
</dl>

<p><a data-type="indexterm" data-primary="DNNs (dense neural networks)" data-secondary="small data set" id="idm45625336853624"/><a data-type="indexterm" data-primary="MLPClassifier model, scikit-learn" id="idm45625338926456"/><a data-type="indexterm" data-primary="scikit-learn package" data-secondary="MLPClassifier model" id="idm45625338925768"/>The following Python code uses the <code>MLPClassifier</code> model from <code>scikit-learn</code>.<sup><a data-type="noteref" id="idm45625338923864-marker" href="ch01.xhtml#idm45625338923864">8</a></sup> The model is trained on the whole data set. What about the ability of a neural network 
<span class="keep-together">to learn</span> about the relationships within a given data set? The ability is pretty high, as the in-sample accuracy score shows. It is in fact close to 100%, a result driven to a large extent by the relatively high neural network capacity given the relatively small 
<span class="keep-together">data set:</span></p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">68</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">sklearn.neural_network</code> <code class="kn">import</code> <code class="n">MLPClassifier</code>
         <code class="kn">from</code> <code class="nn">sklearn.metrics</code> <code class="kn">import</code> <code class="n">accuracy_score</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">69</code><code class="p">]:</code> <code class="n">model</code> <code class="o">=</code> <code class="n">MLPClassifier</code><code class="p">(</code><code class="n">hidden_layer_sizes</code><code class="o">=</code><code class="p">[</code><code class="mi">128</code><code class="p">,</code> <code class="mi">128</code><code class="p">,</code> <code class="mi">128</code><code class="p">],</code>
                               <code class="n">max_iter</code><code class="o">=</code><code class="mi">1000</code><code class="p">,</code> <code class="n">random_state</code><code class="o">=</code><code class="mi">100</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">70</code><code class="p">]:</code> <code class="n">model</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="n">fcols</code><code class="p">],</code> <code class="n">data</code><code class="p">[</code><code class="s1">'l'</code><code class="p">])</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">70</code><code class="p">]:</code> <code class="n">MLPClassifier</code><code class="p">(</code><code class="n">hidden_layer_sizes</code><code class="o">=</code><code class="p">[</code><code class="mi">128</code><code class="p">,</code> <code class="mi">128</code><code class="p">,</code> <code class="mi">128</code><code class="p">],</code> <code class="n">max_iter</code><code class="o">=</code><code class="mi">1000</code><code class="p">,</code>
                       <code class="n">random_state</code><code class="o">=</code><code class="mi">100</code><code class="p">)</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">71</code><code class="p">]:</code> <code class="n">accuracy_score</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="s1">'l'</code><code class="p">],</code> <code class="n">model</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="n">fcols</code><code class="p">]))</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">71</code><code class="p">]:</code> <code class="mf">0.952</code></pre>

<p>But what about the <em>predictive power</em> of a trained neural network? To this end, the given data set can be split into a training and a test data sub-set. The model is trained on the training data sub-set only and then tested with regard to its predictive power on the test data set. As before, the accuracy of the trained neural network is pretty high in-sample (that is, on the training data set). However, it is more than 10 percentage points worse than an uninformed baseline algorithm on the test data set:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">72</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">split</code><code> </code><code class="o">=</code><code> </code><code class="nb">int</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">data</code><code class="p">)</code><code> </code><code class="o">*</code><code> </code><code class="mf">0.7</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO14-1" href="#callout_artificial_intelligence_CO14-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">73</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">train</code><code> </code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="p">:</code><code class="n">split</code><code class="p">]</code><code>  </code><a class="co" id="co_artificial_intelligence_CO14-2" href="#callout_artificial_intelligence_CO14-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>         </code><code class="n">test</code><code> </code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">split</code><code class="p">:</code><code class="p">]</code><code>  </code><a class="co" id="co_artificial_intelligence_CO14-3" href="#callout_artificial_intelligence_CO14-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">74</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">train</code><code class="p">[</code><code class="n">fcols</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">train</code><code class="p">[</code><code class="s1">'</code><code class="s1">l</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO14-4" href="#callout_artificial_intelligence_CO14-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">74</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">MLPClassifier</code><code class="p">(</code><code class="n">hidden_layer_sizes</code><code class="o">=</code><code class="p">[</code><code class="mi">128</code><code class="p">,</code><code> </code><code class="mi">128</code><code class="p">,</code><code> </code><code class="mi">128</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">max_iter</code><code class="o">=</code><code class="mi">1000</code><code class="p">,</code><code>
</code><code>                       </code><code class="n">random_state</code><code class="o">=</code><code class="mi">100</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">75</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">accuracy_score</code><code class="p">(</code><code class="n">train</code><code class="p">[</code><code class="s1">'</code><code class="s1">l</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">train</code><code class="p">[</code><code class="n">fcols</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO14-5" href="#callout_artificial_intelligence_CO14-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">75</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.9714285714285714</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">76</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">accuracy_score</code><code class="p">(</code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">l</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">test</code><code class="p">[</code><code class="n">fcols</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO14-6" href="#callout_artificial_intelligence_CO14-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">76</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.38666666666666666</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO14-1" href="#co_artificial_intelligence_CO14-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Splits the data into <code>train</code> and <code>test</code> data sub-sets</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO14-2" href="#co_artificial_intelligence_CO14-4"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Trains the model on the training data set only</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO14-3" href="#co_artificial_intelligence_CO14-5"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Reports the accuracy in-sample (training data set)</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO14-4" href="#co_artificial_intelligence_CO14-6"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Reports the accuracy out-of-sample (test data set)</p></dd>
</dl>

<p>Roughly speaking, the neural network, trained on a small data set only, learns wrong relationships due to the identified two major problem areas. The problems are not really relevant in the context of learning relationships <em>in-sample</em>. To the contrary, the smaller a data set is, the more easily in-sample relationships can be learned in general. However, the problem areas are highly relevant when using the trained neural network to generate predictions <em>out-of-sample</em>.<a data-type="indexterm" data-primary="" data-startref="ix_data_smallset" id="idm45625343117832"/></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Larger Data Set"><div class="sect2" id="idm45625340207416">
<h2>Larger Data Set</h2>

<p><a data-type="indexterm" data-primary="data" data-secondary="larger data" id="ix_data_larger_set"/>Fortunately, there is often a clear way out of this problematic situation: a <em>larger data set</em>. Faced with real-world problems, this theoretical insight might be equally correct. From a practical point of view, though, such larger data sets are not always available, nor can they often be generated so easily. However, in the context of the example of this section, a larger data set is indeed easily created.</p>

<p>The following Python code increases the number of samples in the initial sample data set significantly. The result is that the prediction accuracy of the trained neural 
<span class="keep-together">network</span> increases by more than 10 percentage points, to a level of about 50%, which is to be expected given the nature of the labels data. It is now in line with an uninformed baseline algorithm:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">77</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">factor</code><code> </code><code class="o">=</code><code> </code><code class="mi">50</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">78</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">big</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randint</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="p">(</code><code class="n">factor</code><code> </code><code class="o">*</code><code> </code><code class="n">n</code><code class="p">,</code><code> </code><code class="n">f</code><code class="p">)</code><code class="p">)</code><code class="p">,</code><code>
</code><code>                            </code><code class="n">columns</code><code class="o">=</code><code class="n">fcols</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">79</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">big</code><code class="p">[</code><code class="s1">'</code><code class="s1">l</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randint</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">factor</code><code> </code><code class="o">*</code><code> </code><code class="n">n</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">80</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">train</code><code> </code><code class="o">=</code><code> </code><code class="n">big</code><code class="p">[</code><code class="p">:</code><code class="n">split</code><code class="p">]</code><code>
</code><code>         </code><code class="n">test</code><code> </code><code class="o">=</code><code> </code><code class="n">big</code><code class="p">[</code><code class="n">split</code><code class="p">:</code><code class="p">]</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">81</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">train</code><code class="p">[</code><code class="n">fcols</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">train</code><code class="p">[</code><code class="s1">'</code><code class="s1">l</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">81</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">MLPClassifier</code><code class="p">(</code><code class="n">hidden_layer_sizes</code><code class="o">=</code><code class="p">[</code><code class="mi">128</code><code class="p">,</code><code> </code><code class="mi">128</code><code class="p">,</code><code> </code><code class="mi">128</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">max_iter</code><code class="o">=</code><code class="mi">1000</code><code class="p">,</code><code>
</code><code>                       </code><code class="n">random_state</code><code class="o">=</code><code class="mi">100</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">82</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">accuracy_score</code><code class="p">(</code><code class="n">train</code><code class="p">[</code><code class="s1">'</code><code class="s1">l</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">train</code><code class="p">[</code><code class="n">fcols</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO15-1" href="#callout_artificial_intelligence_CO15-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">82</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.9657142857142857</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">83</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">accuracy_score</code><code class="p">(</code><code class="n">test</code><code class="p">[</code><code class="s1">'</code><code class="s1">l</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">model</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">test</code><code class="p">[</code><code class="n">fcols</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO15-2" href="#callout_artificial_intelligence_CO15-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">83</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">0.5043407707910751</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO15-1" href="#co_artificial_intelligence_CO15-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Prediction accuracy in-sample (training data set)</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO15-2" href="#co_artificial_intelligence_CO15-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Prediction accuracy out-of-sample (test data set)</p></dd>
</dl>

<p>A quick analysis of the available data, as shown next, explains the increase in the prediction accuracy. First, all possible patterns are now represented in the data set. Second, all patterns have an average frequency of above 10 in the data set. In other words, the neural network sees basically <em>all the patterns multiple times</em>. This allows the neural network to “learn” that both labels <code>0</code> and <code>1</code> are equally likely for all possible patterns. Of course, it is a rather involved way of learning this, but it is a good illustration of the fact that a <em>relatively small</em> data set might often be <em>too small</em> in the context of neural networks:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">84</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">grouped</code><code> </code><code class="o">=</code><code> </code><code class="n">big</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="nb">list</code><code class="p">(</code><code class="n">data</code><code class="o">.</code><code class="n">columns</code><code class="p">)</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">85</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">freq</code><code> </code><code class="o">=</code><code> </code><code class="n">grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">l</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">size</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">unstack</code><code class="p">(</code><code class="n">fill_value</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">86</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">freq</code><code class="p">[</code><code class="s1">'</code><code class="s1">sum</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">freq</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code> </code><code class="o">+</code><code> </code><code class="n">freq</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code>  </code><a class="co" id="co_artificial_intelligence_CO16-1" href="#callout_artificial_intelligence_CO16-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">87</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">freq</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="mi">6</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">87</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">l</code><code>                               </code><code class="mi">0</code><code>  </code><code class="mi">1</code><code>  </code><code class="nb">sum</code><code>
</code><code>         </code><code class="n">f0</code><code> </code><code class="n">f1</code><code> </code><code class="n">f2</code><code> </code><code class="n">f3</code><code> </code><code class="n">f4</code><code> </code><code class="n">f5</code><code> </code><code class="n">f6</code><code> </code><code class="n">f7</code><code> </code><code class="n">f8</code><code> </code><code class="n">f9</code><code>
</code><code>         </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>   </code><code class="mi">10</code><code>  </code><code class="mi">9</code><code>   </code><code class="mi">19</code><code>
</code><code>                                    </code><code class="mi">1</code><code>    </code><code class="mi">5</code><code>  </code><code class="mi">4</code><code>    </code><code class="mi">9</code><code>
</code><code>                                 </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>    </code><code class="mi">2</code><code>  </code><code class="mi">5</code><code>    </code><code class="mi">7</code><code>
</code><code>                                    </code><code class="mi">1</code><code>    </code><code class="mi">6</code><code>  </code><code class="mi">6</code><code>   </code><code class="mi">12</code><code>
</code><code>                              </code><code class="mi">1</code><code>  </code><code class="mi">0</code><code>  </code><code class="mi">0</code><code>    </code><code class="mi">9</code><code>  </code><code class="mi">8</code><code>   </code><code class="mi">17</code><code>
</code><code>                                    </code><code class="mi">1</code><code>    </code><code class="mi">7</code><code>  </code><code class="mi">4</code><code>   </code><code class="mi">11</code><code>
</code><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">88</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">freq</code><code class="p">[</code><code class="s1">'</code><code class="s1">sum</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">describe</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">astype</code><code class="p">(</code><code class="nb">int</code><code class="p">)</code><code>  </code><a class="co" id="co_artificial_intelligence_CO16-2" href="#callout_artificial_intelligence_CO16-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">88</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">count</code><code>    </code><code class="mi">1024</code><code>
</code><code>         </code><code class="n">mean</code><code>       </code><code class="mi">12</code><code>
</code><code>         </code><code class="n">std</code><code>         </code><code class="mi">3</code><code>
</code><code>         </code><code class="nb">min</code><code>         </code><code class="mi">2</code><code>
</code><code>         </code><code class="mi">25</code><code class="o">%</code><code>        </code><code class="mi">10</code><code>
</code><code>         </code><code class="mi">50</code><code class="o">%</code><code>        </code><code class="mi">12</code><code>
</code><code>         </code><code class="mi">75</code><code class="o">%</code><code>        </code><code class="mi">15</code><code>
</code><code>         </code><code class="nb">max</code><code>        </code><code class="mi">26</code><code>
</code><code>         </code><code class="n">Name</code><code class="p">:</code><code> </code><code class="nb">sum</code><code class="p">,</code><code> </code><code class="n">dtype</code><code class="p">:</code><code> </code><code class="n">int64</code></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_artificial_intelligence_CO16-1" href="#co_artificial_intelligence_CO16-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Adds the frequency for the <code>0</code> and <code>1</code> values</p></dd>
<dt><a class="co" id="callout_artificial_intelligence_CO16-2" href="#co_artificial_intelligence_CO16-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Shows summary statistics for the sum values</p></dd>
</dl>
<div data-type="caution"><h1>Volume and Variety</h1>
<p>In the context of neural networks that perform prediction tasks, the volume and variety of the available data used to train the neural network are decisive for its prediction performance. The numerical, hypothetical examples in this section show that the same neural network trained on a relatively small and not-as-varied data set underperforms its counterpart trained on a relatively large and varied data set by more than 10 percentage points. This difference can be considered huge given that AI practitioners and companies often fight for improvements as small as a tenth of a percentage point.<a data-type="indexterm" data-primary="" data-startref="ix_data_larger_set" id="idm45625342640760"/></p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Big Data"><div class="sect2" id="idm45625339110264">
<h2>Big Data</h2>

<p><a data-type="indexterm" data-primary="big data" id="idm45625339108888"/><a data-type="indexterm" data-primary="data" data-secondary="big data" id="idm45625339107960"/>What is the difference between a <em>larger</em> data set and a <em>big</em> data set? <a data-type="indexterm" data-primary="data" data-secondary="volume and variety in prediction" id="idm45625339106056"/>The term <em>big data</em> has been used for more than a decade now to mean a number of things. For the purposes of this book, one might say that a <em>big data set</em> is large enough—in terms of volume, variety, and also maybe velocity—for an AI algorithm to be trained properly such that the algorithm performs better at a prediction task as compared to a baseline algorithm.</p>

<p>The larger data set used before is still small in practical terms. However, it is large enough to accomplish the specified goal. The required volume and variety of the data set are mainly driven by the structure and characteristics of the features and labels data.</p>

<p>In this context, assume that a retail bank implements a neural network–based classification approach for credit scoring. Given in-house data, the responsible data scientist designs 25 categorical features, every one of which can take on 8 different values. The resulting number of patterns is astronomically large:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code> <code class="p">[</code><code class="mi">89</code><code class="p">]:</code> <code class="mi">8</code> <code class="o">**</code> <code class="mi">25</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">89</code><code class="p">]:</code> <code class="mi">37778931862957161709568</code></pre>

<p>It is clear that no single data set can provide a neural network with exposure to every single one of these patterns.<sup><a data-type="noteref" id="idm45625339136664-marker" href="ch01.xhtml#idm45625339136664">9</a></sup> Fortunately, in practice this is not necessary for the neural network to learn about the creditworthiness based on data for regular, defaulting, and/or rejected debtors. It is also not necessary in general to generate “good” predictions with regard to the creditworthiness of every potential debtor.</p>

<p>This is due to a number of reasons. To name only a few, first, not every pattern will be relevant in practice—some patterns might simply not exist, might be impossible, and so forth. Second, not all features might be equally important, reducing the number of relevant features and thereby the number of possible patterns. Third, a value of <code>4</code> or <code>5</code> for feature number <code>7</code>, say, might not make a difference at all, further reducing the number of relevant patterns.<a data-type="indexterm" data-primary="" data-startref="ix_AI_imp_data" id="idm45625339093064"/><a data-type="indexterm" data-primary="" data-startref="ix_data_neuralnet_gen" id="idm45625339092088"/><a data-type="indexterm" data-primary="" data-startref="ix_neuralnet_data_size" id="idm45625339091144"/><a data-type="indexterm" data-primary="" data-startref="ix_predict_alg_gen" id="idm45625339090200"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Conclusions"><div class="sect1" id="idm45625339089256">
<h1>Conclusions</h1>

<p>For this book, artificial intelligence, or AI, encompasses methods, techniques, algorithms, and so on that are able to learn relationships, rules, probabilities, and more from data. The focus lies on supervised learning algorithms, such as those for estimation and classification. With regard to algorithms, neural networks and deep learning approaches are at the core.</p>

<p>The central theme of this book is the application of neural networks to one of the core problems in finance: the prediction of future market movements. More specifically, the problem might be to predict the direction of movement for a stock index or the exchange rate for a currency pair. The prediction of the future market direction (that is, whether a target level or price goes up or down) is a problem that can be easily cast into a classification setting.</p>

<p>Before diving deeper into the core theme itself, the next chapter first discusses selected topics related to what is called <em>superintelligence</em> and <em>technological singularity</em>. That discussion will provide useful background for the chapters that follow, which focus on finance and the application of AI to the financial domain.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="References"><div class="sect1" id="idm45625339129912">
<h1>References</h1>

<p>Books and papers cited in this chapter:</p>

<ul class="author-date-bib">
<li>
<p>Alpaydin, Ethem. 2016. <em>Machine Learning</em>. MIT Press, Cambridge.</p>
</li>
<li>
<p>Chollet, Francois. 2017. <em>Deep Learning with Python</em>. Shelter Island: Manning.</p>
</li>
<li>
<p>Goodfellow, Ian, Yoshua Bengio, and Aaron Courville. 2016. <em>Deep Learning</em>. Cambridge: MIT Press. <a href="http://deeplearningbook.org"><em class="hyperlink">http://deeplearningbook.org</em></a>.</p>
</li>
<li>
<p>Kratsios, Anastasis. 2019. “Universal Approximation Theorems.” <a href="https://oreil.ly/COOdI"><em class="hyperlink">https://oreil.ly/COOdI</em></a>.</p>
</li>
<li>
<p>Silver, David et al. 2016. “Mastering the Game of Go with Deep Neural Networks and Tree Search.” <em>Nature</em> 529 (January): 484-489.</p>
</li>
<li>
<p>Shanahan, Murray. 2015. <em>The Technological Singularity</em>. Cambridge: MIT Press.</p>
</li>
<li>
<p>Tegmark, Max. 2017. <em>Life 3.0: Being Human in the Age of Artificial Intelligence</em>. United Kingdom: Penguin Random House.</p>
</li>
<li>
<p>VanderPlas, Jake. 2017. <em>Python Data Science Handbook</em>. Sebastopol: O’Reilly.</p>
</li>
</ul>
</div></section>







<div data-type="footnotes"><p data-type="footnote" id="idm45625352526520"><sup><a href="ch01.xhtml#idm45625352526520-marker">1</a></sup> For details, see <a href="https://oreil.ly/cRcJo"><code>sklearn.cluster.KMeans</code></a> and VanderPlas (2017, ch. 5).</p><p data-type="footnote" id="idm45625338167000"><sup><a href="ch01.xhtml#idm45625338167000-marker">2</a></sup> For details, see VanderPlas (2017, ch. 5).</p><p data-type="footnote" id="idm45625340102264"><sup><a href="ch01.xhtml#idm45625340102264-marker">3</a></sup> For details, see <a href="https://oreil.ly/Oimd8"><code>sklearn.neural_network.MLPRegressor</code></a>. For more background, see Goodfellow et al. (2016, ch. 6).</p><p data-type="footnote" id="idm45625340095720"><sup><a href="ch01.xhtml#idm45625340095720-marker">4</a></sup> For details, see Chollet (2017, ch. 3).</p><p data-type="footnote" id="idm45625339723528"><sup><a href="ch01.xhtml#idm45625339723528-marker">5</a></sup> For details on activation functions with <code>Keras</code>, see <a href="https://keras.io/activations"><em class="hyperlink">https://keras.io/activations</em></a>.</p><p data-type="footnote" id="idm45625343405032"><sup><a href="ch01.xhtml#idm45625343405032-marker">6</a></sup> The <em>loss function</em> calculates the prediction error of the neural network (or other ML algorithms). <em>Binary cross entropy</em> is an appropriate loss function for binary classification problems, while the <em>mean squared error</em> (MSE) is, for example, appropriate for estimation problems. For details on loss functions with <code>Keras</code>, see <a href="https://keras.io/losses"><em class="hyperlink">https://keras.io/losses</em></a>.</p><p data-type="footnote" id="idm45625335928248"><sup><a href="ch01.xhtml#idm45625335928248-marker">7</a></sup> See, for example, Kratsios (2019).</p><p data-type="footnote" id="idm45625338923864"><sup><a href="ch01.xhtml#idm45625338923864-marker">8</a></sup> For details, see <a href="https://oreil.ly/hCR4h"><code>sklearn.neural_network.MLPClassifier</code></a>.</p><p data-type="footnote" id="idm45625339136664"><sup><a href="ch01.xhtml#idm45625339136664-marker">9</a></sup> Nor would current compute technology allow one to model and train a neural network based on such a data set if it would be available. In this context, the next chapter discusses the importance of hardware for AI.</p></div></div></section></div>



  </body></html>