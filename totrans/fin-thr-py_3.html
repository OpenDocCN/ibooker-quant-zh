<html><head></head><body><div id="sbo-rt-content" class="calibre1"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 3. Three-State Economy" class="calibre4"><div class="preface" id="three_state_economy">
<h1 class="calibre11"><span class="firstname">Chapter 3. </span>Three-State Economy</h1>

<blockquote class="calibre12 pcalibre1 pcalibre2">
<p class="calibre13">The<a data-type="indexterm" data-primary="Pliska, Stanley" id="idm44853703938808" class="calibre6"/> model is said to be <em class="calibre7">complete</em> if every contingent claim can be generated by some trading strategy. Otherwise, the model is said to be <em class="calibre7">incomplete</em>.</p>
<p data-type="attribution" class="pcalibre3 calibre16">Stanley Pliska (1997)</p>
</blockquote>
<blockquote class="calibre12 pcalibre1 pcalibre2">
<p class="calibre13">Assume <a data-type="indexterm" data-primary="Sharpe, William" id="idm44853703935096" class="calibre6"/>that an individual views the outcome of any investment in probabilistic terms; that is, he thinks of the possible results in terms of some probability distribution. In assessing the desirability of a particular investment, however, he is willing to act on the basis of only two parameters of this distribution—its expected value and standard deviation.</p>
<p data-type="attribution" class="pcalibre3 calibre16">William Sharpe (1964)</p>
</blockquote>

<p class="author1">The previous chapter is based on the most simple model economy, in which the notion of uncertainty in finance can be analyzed. This chapter enriches the two-state economy by just a single additional state while keeping the number of traded financial assets constant at two. In this<a data-type="indexterm" data-primary="model economies" data-secondary="three-state" id="idm44853703932328" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" id="idm44853703931352" class="calibre6"/><a data-type="indexterm" data-primary="static three-state economy" data-see="three-state model economy" id="idm44853703930712" class="calibre6"/> slightly enriched <em class="calibre7">static three-state economy</em>, the notions of market incompleteness and indeterminacy of the martingale measure are discussed. Super-replication and approximate replication approaches are presented to cope with incompleteness and its consequences for the pricing of contingent claims. The chapter also presents the Capital Asset Pricing Model (CAPM), which builds on the mean-variance portfolio analysis and adds equilibrium arguments to derive prices for financial assets in mean-volatility space even if they are not replicable.</p>

<p class="author1">This chapter mainly covers the following topics from finance, mathematics, and Python programming:</p>
<table class="calibre34">

<thead class="calibre35">
<tr class="calibre36">
<th class="calibre37">Finance</th>
<th class="calibre37">Mathematics</th>
<th class="calibre37">Python</th>
</tr>
</thead>
<tbody class="calibre38">
<tr class="calibre36">
<td class="calibre39"><p class="author1">Uncertainty</p></td>
<td class="calibre39"><p class="author1">Probability space</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">ndarray</code></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Financial assets</p></td>
<td class="calibre39"><p class="author1">Vectors, matrices</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">ndarray</code></p></td>
</tr>
<tr class="calibre36">
<td class="calibre39"><p class="author1">Attainable contingent claims</p></td>
<td class="calibre39"><p class="author1">Span of vectors, basis of vector space</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">ndarray</code></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Martingale pricing, arbitrage</p></td>
<td class="calibre39"><p class="author1">Sets of probability measures, expectation</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">ndarray, np.dot</code></p></td>
</tr>
<tr class="calibre36">
<td class="calibre39"><p class="author1">Super-replication</p></td>
<td class="calibre39"><p class="author1">Minimization, constraints</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">scipy.optimize.minimize, dict, lambda</code></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Approximate replication</p></td>
<td class="calibre39"><p class="author1">Mean squared error, OLS regression</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">np.linalg.lstsq</code></p></td>
</tr>
<tr class="calibre36">
<td class="calibre39"><p class="author1">Capital market line</p></td>
<td class="calibre39"><p class="author1">Expectation, standard deviation</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">NumPy</code></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Capital Asset Pricing Model</p></td>
<td class="calibre39"><p class="author1">Correlation, covariance</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">NumPy</code></p></td>
</tr>
</tbody>
</table>

<p class="author1">If not explicitly stated otherwise, the assumptions and notions of the two-state economy from the previous chapter carry over to the three-state economy discussed in this chapter.</p>






<section data-type="sect1" data-pdf-bookmark="Uncertainty" class="calibre4"><div class="preface" id="idm44853703888808">
<h1 class="calibre17">Uncertainty</h1>

<p class="author1">Two <em class="calibre7">points in time</em> are <a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="uncertainty" id="idm44853703886648" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="uncertainty" id="idm44853703885368" class="calibre6"/><a data-type="indexterm" data-primary="uncertainty" data-secondary="in three-state economy" data-secondary-sortas="three-state economy" id="idm44853703884456" class="calibre6"/>relevant, today, <math alttext="t equals 0">
  <mrow>
    <mi>t</mi>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math>, and one year from today in the future, <math alttext="t equals 1">
  <mrow>
    <mi>t</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>. Let the <em class="calibre7">state space</em> be<a data-type="indexterm" data-primary="state space" id="idm44853703877464" class="calibre6"/> given by <math alttext="normal upper Omega equals StartSet u comma m comma d EndSet">
  <mrow>
    <mi>Ω</mi>
    <mo>=</mo>
    <mo>{</mo>
    <mi>u</mi>
    <mo>,</mo>
    <mi>m</mi>
    <mo>,</mo>
    <mi>d</mi>
    <mo>}</mo>
  </mrow>
</math>. <math alttext="StartSet u comma m comma d EndSet">
  <mrow>
    <mo>{</mo>
    <mi>u</mi>
    <mo>,</mo>
    <mi>m</mi>
    <mo>,</mo>
    <mi>d</mi>
    <mo>}</mo>
  </mrow>
</math> represent the three different states of the economy possible in one year. The <em class="calibre7">power set</em> over <a data-type="indexterm" data-primary="power set" id="idm44853703866264" class="calibre6"/>the state space is given as:</p>
<div data-type="equation" class="calibre42">
<math alttext="normal script upper P left-parenthesis normal upper Omega right-parenthesis equals StartSet normal empty-set comma StartSet u EndSet comma StartSet m EndSet comma StartSet d EndSet comma StartSet u comma m EndSet comma StartSet u comma d EndSet comma StartSet m comma d EndSet comma normal upper Omega EndSet" display="block">
  <mrow>
    <mi>℘</mi>
    <mrow>
      <mo>(</mo>
      <mi>Ω</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfenced separators="" open="{" close="}">
      <mi>∅</mi>
      <mo>,</mo>
      <mo>{</mo>
      <mi>u</mi>
      <mo>}</mo>
      <mo>,</mo>
      <mo>{</mo>
      <mi>m</mi>
      <mo>}</mo>
      <mo>,</mo>
      <mo>{</mo>
      <mi>d</mi>
      <mo>}</mo>
      <mo>,</mo>
      <mo>{</mo>
      <mi>u</mi>
      <mo>,</mo>
      <mi>m</mi>
      <mo>}</mo>
      <mo>,</mo>
      <mo>{</mo>
      <mi>u</mi>
      <mo>,</mo>
      <mi>d</mi>
      <mo>}</mo>
      <mo>,</mo>
      <mo>{</mo>
      <mi>m</mi>
      <mo>,</mo>
      <mi>d</mi>
      <mo>}</mo>
      <mo>,</mo>
      <mi>Ω</mi>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">The probability measure <math alttext="upper P">
  <mi>P</mi>
</math> is defined on the power set, and it is assumed that <math alttext="upper P left-parenthesis omega right-parenthesis equals one-third comma omega element-of normal upper Omega">
  <mrow>
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>ω</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>3</mn></mfrac>
    <mo>,</mo>
    <mi>ω</mi>
    <mo>∈</mo>
    <mi>Ω</mi>
  </mrow>
</math>. The <a data-type="indexterm" data-primary="probability space" id="idm44853703835544" class="calibre6"/>resulting <em class="calibre7">probability space</em> <math alttext="left-parenthesis normal upper Omega comma normal script upper P left-parenthesis normal upper Omega right-parenthesis comma upper P right-parenthesis">
  <mrow>
    <mo>(</mo>
    <mi>Ω</mi>
    <mo>,</mo>
    <mi>℘</mi>
    <mo>(</mo>
    <mi>Ω</mi>
    <mo>)</mo>
    <mo>,</mo>
    <mi>P</mi>
    <mo>)</mo>
  </mrow>
</math> represents <em class="calibre7">uncertainty</em> in the model economy.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Financial Assets" class="calibre4"><div class="preface" id="idm44853703827672">
<h1 class="calibre17">Financial Assets</h1>

<p class="author1">There are <a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="financial assets" id="idm44853703825848" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="financial assets" id="idm44853703824568" class="calibre6"/><a data-type="indexterm" data-primary="assets" data-secondary="financial" id="idm44853703823656" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" id="idm44853703822712" class="calibre6"/>two financial assets traded in the model economy. The first is a <em class="calibre7">risk-less bond</em> <math alttext="upper B equals left-parenthesis upper B 0 comma upper B 1 right-parenthesis">
  <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <mo>(</mo>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>,</mo>
    <msub><mi>B</mi> <mn>1</mn> </msub>
    <mo>)</mo>
  </mrow>
</math> with <math alttext="upper B 0 equals 10">
  <mrow>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mn>10</mn>
  </mrow>
</math> and <math alttext="upper B 1 equals left-parenthesis 11 comma 11 comma 11 right-parenthesis Superscript upper T">
  <mrow>
    <msub><mi>B</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <msup><mrow><mo>(</mo><mn>11</mn><mo>,</mo><mn>11</mn><mo>,</mo><mn>11</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
  </mrow>
</math>. The risk-less interest rate accordingly is <math alttext="i equals">
  <mrow>
    <mi>i</mi>
    <mo>=</mo>
  </mrow>
</math> 0.1.</p>

<p class="author1">The second is a <em class="calibre7">risky stock</em>, <math alttext="upper S equals left-parenthesis upper S 0 comma left-parenthesis upper S 1 Superscript u Baseline comma upper S 1 Superscript m Baseline comma upper S 1 Superscript d Baseline right-parenthesis Superscript upper T Baseline right-parenthesis">
  <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>S</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msup><mrow><mo>(</mo><msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup><mo>,</mo><msubsup><mi>S</mi> <mn>1</mn> <mi>m</mi> </msubsup><mo>,</mo><msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup><mo>)</mo></mrow> <mi>T</mi> </msup>
    </mfenced>
  </mrow>
</math>, with <math alttext="upper S 0 equals 10">
  <mrow>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mn>10</mn>
  </mrow>
</math> and:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S 1 equals Start 3 By 1 Matrix 1st Row  20 2nd Row  10 3rd Row  5 EndMatrix" display="block">
  <mrow>
    <msub><mi>S</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>20</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>10</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>5</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">Define the market payoff matrix <math alttext="script upper M element-of double-struck upper R Superscript 3 times 2">
  <mrow>
    <mi>ℳ</mi>
    <mo>∈</mo>
    <msup><mi>ℝ</mi> <mrow><mn>3</mn><mo>×</mo><mn>2</mn></mrow> </msup>
  </mrow>
</math> by:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M identical-to Start 3 By 2 Matrix 1st Row 1st Column upper B 1 2nd Column upper S 1 Superscript u Baseline 2nd Row 1st Column upper B 1 2nd Column upper S 1 Superscript m Baseline 3rd Row 1st Column upper B 1 2nd Column upper S 1 Superscript d Baseline EndMatrix equals Start 3 By 2 Matrix 1st Row 1st Column 11 2nd Column 20 2nd Row 1st Column 11 2nd Column 10 3rd Row 1st Column 11 2nd Column 5 EndMatrix" display="block">
  <mrow>
    <mi>ℳ</mi>
    <mo>≡</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <msub><mi>B</mi> <mn>1</mn> </msub>
          </mtd>
          <mtd>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub><mi>B</mi> <mn>1</mn> </msub>
          </mtd>
          <mtd>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>m</mi> </msubsup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub><mi>B</mi> <mn>1</mn> </msub>
          </mtd>
          <mtd>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>20</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>10</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>5</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Attainable Contingent Claims" class="calibre4"><div class="preface" id="idm44853703747800">
<h1 class="calibre17">Attainable Contingent Claims</h1>

<p class="author1">The <em class="calibre7">span</em> of <a data-type="indexterm" data-primary="span" data-secondary="defined" id="idm44853703745400" class="calibre6"/><a data-type="indexterm" data-primary="set of attainable contingent claims" id="idm44853703744392" class="calibre6"/><a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="attainable contingent claims" id="model-three-state-attainable" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="attainable contingent claims" id="three-state-attainable" class="calibre6"/><a data-type="indexterm" data-primary="contingent claims" data-secondary="attainable" id="contingent-attainable" class="calibre6"/><a data-type="indexterm" data-primary="attainable contingent claims" id="attainable-contingent" class="calibre6"/>the traded financial assets is also called the <em class="calibre7">set of attainable contingent claims</em> <math alttext="double-struck upper A">
  <mi>𝔸</mi>
</math>. A contingent claim <math alttext="upper C 1 colon normal upper Omega right-arrow double-struck upper R Subscript 0 Baseline">
  <mrow>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>:</mo>
    <mi>Ω</mi>
    <mo>→</mo>
    <msub><mi>ℝ</mi> <mrow><mo>≥</mo><mn>0</mn></mrow> </msub>
  </mrow>
</math> is said to be attainable if its payoff can be expressed as a linear combination of the payoff vectors of the traded assets. In other words, there exists a portfolio <math alttext="phi">
  <mi>ϕ</mi>
</math> such that <math alttext="upper V 1 left-parenthesis phi right-parenthesis equals script upper M dot phi equals upper C 1">
  <mrow>
    <msub><mi>V</mi> <mn>1</mn> </msub>
    <mrow>
      <mo>(</mo>
      <mi>ϕ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mi>ℳ</mi>
    <mo>·</mo>
    <mi>ϕ</mi>
    <mo>=</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
  </mrow>
</math>. Therefore</p>
<div data-type="equation" class="calibre42">
<math alttext="double-struck upper A equals StartSet script upper M dot phi comma phi element-of double-struck upper R squared EndSet" display="block">
  <mrow>
    <mi>𝔸</mi>
    <mo>=</mo>
    <mfenced separators="" open="{" close="}">
      <mi>ℳ</mi>
      <mo>·</mo>
      <mi>ϕ</mi>
      <mo>,</mo>
      <mi>ϕ</mi>
      <mo>∈</mo>
      <msup><mi>ℝ</mi> <mn>2</mn> </msup>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">if there are no constraints on the portfolio positions, or</p>
<div data-type="equation" class="calibre42">
<math mode="display">
  <mrow>
    <mi>𝔸</mi>
    <mo>=</mo>
    <mfenced separators="" open="{" close="}">
      <mi>ℳ</mi>
      <mo>·</mo>
      <mi>ϕ</mi>
      <mo>,</mo>
      <mi>ϕ</mi>
      <mo>∈</mo>
      <msubsup><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> <mn>2</mn> </msubsup>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">if short selling is prohibited.</p>

<p class="author1">It is easy to verify that the payoff vectors of the two financial assets are linearly independent. However, there are only two such vectors and three different states. It is known by standard results from linear algebra that a basis for the vector space <math alttext="double-struck upper R cubed">
  <msup><mi>ℝ</mi> <mn>3</mn> </msup>
</math> needs to consist of three linearly independent vectors. In other words, not every contingent claim is replicable by a portfolio of the traded financial assets. An example is, for instance, the <em class="calibre7">first Arrow-Debreu security</em>. <a data-type="indexterm" data-primary="Arrow-Debreu securities" id="idm44853703701032" class="calibre6"/>The system of linear equations for the replication is:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row  b dot 11 plus s dot 20 equals 1 2nd Row  b dot 11 plus s dot 10 equals 0 3rd Row  b dot 11 plus s dot 5 equals 0 EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mi>b</mi>
            <mo>·</mo>
            <mn>11</mn>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <mn>20</mn>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mi>b</mi>
            <mo>·</mo>
            <mn>11</mn>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <mn>10</mn>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mi>b</mi>
            <mo>·</mo>
            <mn>11</mn>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <mn>5</mn>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">Subtracting the second equation from the first gives <math alttext="s equals one-tenth">
  <mrow>
    <mi>s</mi>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>10</mn></mfrac>
  </mrow>
</math>. Subtracting the third equation from the first gives <math alttext="s equals one-fifteenth">
  <mrow>
    <mi>s</mi>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>15</mn></mfrac>
  </mrow>
</math>, which is obviously a contradiction to the first result. Therefore, there is no solution to this replication problem.</p>

<p class="author1">Using Python, the set of attainable contingent claims can be visualized in three dimensions. The approach is based on Monte Carlo simulation for the portfolio composition. For simplicity, the simulation allows only for positive portfolio positions between 0 and 1. <a data-type="xref" href="#incom_01" class="calibre6">Figure 3-1</a> shows the results graphically and illustrates that the two vectors can only span a two-dimensional area of the three-dimensional space. If the market would be complete, the simulated payoff vectors would populate a cube (the financial assets would span <math alttext="double-struck upper R cubed">
  <msup><mi>ℝ</mi> <mn>3</mn> </msup>
</math>) and not only a rectangular area (span <math alttext="double-struck upper R squared">
  <msup><mi>ℝ</mi> <mn>2</mn> </msup>
</math>). The modeling of uncertainty is along the lines of the Python code introduced in <a data-type="xref" href="ch02_split_000.xhtml#two_state_economy" class="calibre6">Chapter 2</a> with the necessary adjustments for three possible future states of the economy:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="nn">numpy</code><code class="calibre22"> </code><code class="kn">as</code><code class="calibre22"> </code><code class="nn">np</code><code class="calibre22">
</code><code class="calibre22">        </code><code class="kn">from</code><code class="calibre22"> </code><code class="nn">numpy.random</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="n">default_rng</code><code class="calibre22">
</code><code class="calibre22">        </code><code class="n">np</code><code class="o">.</code><code class="n">set_printoptions</code><code class="p">(</code><code class="n">precision</code><code class="o">=</code><code class="mi">5</code><code class="p">,</code><code class="calibre22"> </code><code class="n">suppress</code><code class="o">=</code><code class="nb">True</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">2</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">rng</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">default_rng</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">3</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">11</code><code class="p">)</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">20</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">5</code><code class="p">)</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">n</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">1000</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO1-1" href="#callout_three_state_economy_CO1-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">b</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">rng</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="n">n</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO1-2" href="#callout_three_state_economy_CO1-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">b</code><code class="p">[</code><code class="p">:</code><code class="mi">5</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO1-3" href="#callout_three_state_economy_CO1-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0.83498</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.59655</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.28886</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.04295</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.97365</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">s</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">rng</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="n">n</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO1-4" href="#callout_three_state_economy_CO1-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">9</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">A</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">[</code><code class="n">b</code><code class="p">[</code><code class="n">i</code><code class="p">]</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">B</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">s</code><code class="p">[</code><code class="n">i</code><code class="p">]</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">S</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="calibre22"> </code><code class="kn">for</code><code class="calibre22"> </code><code class="n">i</code><code class="calibre22"> </code><code class="ow">in</code><code class="calibre22"> </code><code class="nb">range</code><code class="p">(</code><code class="n">n</code><code class="p">)</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO1-5" href="#callout_three_state_economy_CO1-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">A</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="n">A</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO1-6" href="#callout_three_state_economy_CO1-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">A</code><code class="p">[</code><code class="p">:</code><code class="mi">3</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO1-7" href="#callout_three_state_economy_CO1-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">19.86232</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">14.52356</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">11.85418</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">26.35796</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">16.46003</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">11.51106</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">11.64939</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">7.41344</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">5.29547</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">12</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">from</code><code class="calibre22"> </code><code class="nn">pylab</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="n">mpl</code><code class="p">,</code><code class="calibre22"> </code><code class="n">plt</code><code class="calibre22">   </code><a class="calibre6" id="co_three_state_economy_CO1-8" href="#callout_three_state_economy_CO1-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s">'</code><code class="s">seaborn</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s">'</code><code class="s">savefig.dpi</code><code class="s">'</code><code class="p">]</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">300</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s">'</code><code class="s">font.family</code><code class="s">'</code><code class="p">]</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="s">'</code><code class="s">serif</code><code class="s">'</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="kn">from</code><code class="calibre22"> </code><code class="nn">mpl_toolkits.mplot3d</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="n">Axes3D</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO1-9" href="#callout_three_state_economy_CO1-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">13</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">fig</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO1-10" href="#callout_three_state_economy_CO1-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">ax</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">fig</code><code class="o">.</code><code class="n">add_subplot</code><code class="p">(</code><code class="mi">111</code><code class="p">,</code><code class="calibre22"> </code><code class="n">projection</code><code class="o">=</code><code class="s">'</code><code class="s">3d</code><code class="s">'</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO1-11" href="#callout_three_state_economy_CO1-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">ax</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">A</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="n">A</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="n">A</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="n">c</code><code class="o">=</code><code class="s">'</code><code class="s">r</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">marker</code><code class="o">=</code><code class="s">'</code><code class="s">.</code><code class="s">'</code><code class="p">)</code><code class="p">;</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO1-12" href="#callout_three_state_economy_CO1-9"><img src="Images/9.png" alt="9" class="calibre44"/></a></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO1-1" href="#co_three_state_economy_CO1-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Number of portfolios to be simulated.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO1-2" href="#co_three_state_economy_CO1-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The random position in the bond with some examples—all position values are between 0 and 1.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO1-3" href="#co_three_state_economy_CO1-4"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The random position in the stock.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO1-4" href="#co_three_state_economy_CO1-5"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">A <code class="calibre22">list</code> comprehension that calculates the resulting payoff vectors from the random portfolio compositions.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO1-5" href="#co_three_state_economy_CO1-8"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The basic plotting subpackage of <code class="calibre22">matplotlib</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO1-6" href="#co_three_state_economy_CO1-9"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Three-dimensional plotting capabilities.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO1-7" href="#co_three_state_economy_CO1-10"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">An empty canvas is created.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO1-8" href="#co_three_state_economy_CO1-11"><img src="Images/8.png" alt="8" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">A subplot for a three-dimensional object is added.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO1-9" href="#co_three_state_economy_CO1-12"><img src="Images/9.png" alt="9" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The payoff vectors are visualized as a red dot each.</p></dd>
</dl>
<div data-type="important" class="calibre28"><h1 class="calibre49">Market Incompleteness</h1>
<p class="author1">While in a <a data-type="indexterm" data-primary="incomplete market model" id="idm44853702993960" class="calibre6"/><a data-type="indexterm" data-primary="market incompleteness" id="idm44853702993224" class="calibre6"/>complete model economy <em class="calibre7">every</em> contingent claim is attainable, only a <em class="calibre7">small subset</em> of contingent claims is generally attainable in an incomplete market. In that sense, changing from a complete to an incomplete model economy has tremendous consequences. Pricing by replication, as introduced in <a data-type="xref" href="ch02_split_000.xhtml#two_state_economy" class="calibre6">Chapter 2</a>, relies on the attainability of a contingent claim. What about pricing, then, when replication fails? These and other questions in this context are answered in the remainder of the<a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="attainable contingent claims" data-startref="model-three-state-attainable" id="idm44853702990344" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="attainable contingent claims" data-startref="three-state-attainable" id="idm44853702988872" class="calibre6"/><a data-type="indexterm" data-primary="contingent claims" data-secondary="attainable" data-startref="contingent-attainable" id="idm44853702987624" class="calibre6"/><a data-type="indexterm" data-primary="attainable contingent claims" data-startref="attainable-contingent" id="idm44853702986408" class="calibre6"/> chapter.</p>
</div>

<figure class="calibre50"><div id="incom_01" class="figure">
<img src="Images/ftwp_0301.png" alt="ftwp 0301" class="calibre62"/>
<h6 class="calibre52"><span class="firstname">Figure 3-1. </span>Random portfolio payoff vectors visualized in three dimensions</h6>
</div></figure>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Martingale Pricing" class="calibre4"><div class="preface" id="idm44853703747144">
<h1 class="calibre17">Martingale Pricing</h1>

<p class="author1">The <a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="martingale pricing" id="model-three-state-martingale" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="martingale pricing" id="three-state-martingale" class="calibre6"/><a data-type="indexterm" data-primary="martingale pricing" data-secondary="in three-state economy" data-secondary-sortas="three-state economy" id="martingale-three-state" class="calibre6"/>importance of martingale measures is clear from the First Fundamental Theorem of Asset Pricing (1FTAP) and the Second Fundamental Theorem of Asset Pricing (2FTAP).</p>








<section data-type="sect2" data-pdf-bookmark="Martingale Measures" class="calibre4"><div class="preface" id="idm44853703618424">
<h2 class="calibre55">Martingale Measures</h2>

<p class="author1">Any probability measure makes the discounted bond price process a martingale. What about the stock price process? The defining equation for a martingale measure
<math><mrow><mi>Q</mi><mo>:</mo><mi>℘</mi><mrow><mo>(</mo><mi>Ω</mi><mo>)</mo></mrow><mo>→</mo><msub><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> </msub></mrow></math>
is:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S 0 dot left-parenthesis 1 plus i right-parenthesis equals bold upper E Superscript upper Q Baseline left-parenthesis upper S 1 right-parenthesis" display="block">
  <mrow>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>·</mo>
    <mrow>
      <mo>(</mo>
      <mn>1</mn>
      <mo>+</mo>
      <mi>i</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>𝐄</mi> <mi>Q</mi> </msup>
    <mrow>
      <mo>(</mo>
      <msub><mi>S</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">or</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S 0 dot left-parenthesis 1 plus i right-parenthesis equals q Superscript u Baseline dot upper S 1 Superscript u Baseline plus q Superscript m Baseline dot upper S 1 Superscript m Baseline plus q Superscript d Baseline dot upper S 1 Superscript d" display="block">
  <mrow>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>·</mo>
    <mrow>
      <mo>(</mo>
      <mn>1</mn>
      <mo>+</mo>
      <mi>i</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>q</mi> <mi>u</mi> </msup>
    <mo>·</mo>
    <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
    <mo>+</mo>
    <msup><mi>q</mi> <mi>m</mi> </msup>
    <mo>·</mo>
    <msubsup><mi>S</mi> <mn>1</mn> <mi>m</mi> </msubsup>
    <mo>+</mo>
    <msup><mi>q</mi> <mi>d</mi> </msup>
    <mo>·</mo>
    <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
  </mrow>
</math>
</div>

<p class="author1">with <math alttext="q Superscript omega Baseline identical-to upper Q left-parenthesis omega right-parenthesis comma omega element-of normal upper Omega">
  <mrow>
    <msup><mi>q</mi> <mi>ω</mi> </msup>
    <mo>≡</mo>
    <mi>Q</mi>
    <mrow>
      <mo>(</mo>
      <mi>ω</mi>
      <mo>)</mo>
    </mrow>
    <mo>,</mo>
    <mi>ω</mi>
    <mo>∈</mo>
    <mi>Ω</mi>
  </mrow>
</math>. In numbers and with <math alttext="q Superscript d Baseline equals 1 minus q Superscript u Baseline minus q Superscript m">
  <mrow>
    <msup><mi>q</mi> <mi>d</mi> </msup>
    <mo>=</mo>
    <mn>1</mn>
    <mo>-</mo>
    <msup><mi>q</mi> <mi>u</mi> </msup>
    <mo>-</mo>
    <msup><mi>q</mi> <mi>m</mi> </msup>
  </mrow>
</math>:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column 11 2nd Column equals 3rd Column q Superscript u Baseline dot 20 plus q Superscript m Baseline dot 10 plus left-parenthesis 1 minus q Superscript u Baseline minus q Superscript m Baseline right-parenthesis dot 5 2nd Row 1st Column q Superscript m Baseline 2nd Column equals 3rd Column StartFraction 6 minus 15 dot q Superscript u Baseline Over 5 EndFraction EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mn>11</mn>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <msup><mi>q</mi> <mi>u</mi> </msup>
          <mo>·</mo>
          <mn>20</mn>
          <mo>+</mo>
          <msup><mi>q</mi> <mi>m</mi> </msup>
          <mo>·</mo>
          <mn>10</mn>
          <mo>+</mo>
          <mrow>
            <mo>(</mo>
            <mn>1</mn>
            <mo>-</mo>
            <msup><mi>q</mi> <mi>u</mi> </msup>
            <mo>-</mo>
            <msup><mi>q</mi> <mi>m</mi> </msup>
            <mo>)</mo>
          </mrow>
          <mo>·</mo>
          <mn>5</mn>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msup><mi>q</mi> <mi>m</mi> </msup>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mfrac><mrow><mn>6</mn><mo>-</mo><mn>15</mn><mo>·</mo><msup><mi>q</mi> <mi>u</mi> </msup></mrow> <mn>5</mn></mfrac>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">Recalling the properties of a probability measure, it must hold (binding condition)</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column 6 minus 15 dot q Superscript u 2nd Column greater-than-or-equal-to 3rd Column 0 2nd Row 1st Column q Superscript u Baseline 2nd Column less-than-or-equal-to 3rd Column two-fifths EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <mn>6</mn>
          <mo>-</mo>
          <mn>15</mn>
          <mo>·</mo>
          <msup><mi>q</mi> <mi>u</mi> </msup>
        </mrow>
      </mtd>
      <mtd>
        <mo>≥</mo>
      </mtd>
      <mtd>
        <mn>0</mn>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msup><mi>q</mi> <mi>u</mi> </msup>
        </mrow>
      </mtd>
      <mtd>
        <mo>≤</mo>
      </mtd>
      <mtd>
        <mfrac><mn>2</mn> <mn>5</mn></mfrac>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">and (nonbinding condition)</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column StartFraction 6 minus 15 dot q Superscript u Baseline Over 5 EndFraction 2nd Column less-than-or-equal-to 3rd Column 1 2nd Row 1st Column q Superscript u Baseline 2nd Column greater-than-or-equal-to 3rd Column one-fifteenth EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mfrac><mrow><mn>6</mn><mo>-</mo><mn>15</mn><mo>·</mo><msup><mi>q</mi> <mi>u</mi> </msup></mrow> <mn>5</mn></mfrac>
      </mtd>
      <mtd>
        <mo>≤</mo>
      </mtd>
      <mtd>
        <mn>1</mn>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msup><mi>q</mi> <mi>u</mi> </msup>
        </mrow>
      </mtd>
      <mtd>
        <mo>≥</mo>
      </mtd>
      <mtd>
        <mfrac><mn>1</mn> <mn>15</mn></mfrac>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">as well as (binding condition)</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column q Superscript d Baseline equals 1 minus q Superscript u Baseline minus q Superscript m Baseline 2nd Column greater-than-or-equal-to 3rd Column 0 2nd Row 1st Column q Superscript u Baseline 2nd Column greater-than-or-equal-to 3rd Column one-tenth EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <msup><mi>q</mi> <mi>d</mi> </msup>
          <mo>=</mo>
          <mn>1</mn>
          <mo>-</mo>
          <msup><mi>q</mi> <mi>u</mi> </msup>
          <mo>-</mo>
          <msup><mi>q</mi> <mi>m</mi> </msup>
        </mrow>
      </mtd>
      <mtd>
        <mo>≥</mo>
      </mtd>
      <mtd>
        <mn>0</mn>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msup><mi>q</mi> <mi>u</mi> </msup>
        </mrow>
      </mtd>
      <mtd>
        <mo>≥</mo>
      </mtd>
      <mtd>
        <mfrac><mn>1</mn> <mn>10</mn></mfrac>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">and (nonbinding condition)</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column q Superscript d Baseline equals 1 minus q Superscript u Baseline minus q Superscript m Baseline 2nd Column less-than-or-equal-to 3rd Column 1 2nd Row 1st Column q Superscript u Baseline 2nd Column less-than-or-equal-to 3rd Column three-fifths EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <msup><mi>q</mi> <mi>d</mi> </msup>
          <mo>=</mo>
          <mn>1</mn>
          <mo>-</mo>
          <msup><mi>q</mi> <mi>u</mi> </msup>
          <mo>-</mo>
          <msup><mi>q</mi> <mi>m</mi> </msup>
        </mrow>
      </mtd>
      <mtd>
        <mo>≤</mo>
      </mtd>
      <mtd>
        <mn>1</mn>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msup><mi>q</mi> <mi>u</mi> </msup>
        </mrow>
      </mtd>
      <mtd>
        <mo>≤</mo>
      </mtd>
      <mtd>
        <mfrac><mn>3</mn> <mn>5</mn></mfrac>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">Therefore, there are infinitely many probability measures that make the discounted stock price process a martingale. Setting <math alttext="q identical-to q Superscript u">
  <mrow>
    <mi>q</mi>
    <mo>≡</mo>
    <msup><mi>q</mi> <mi>u</mi> </msup>
  </mrow>
</math>, the set of all martingale measures <math alttext="double-struck upper Q">
  <mi>ℚ</mi>
</math> consistent with the market model is:</p>
<div data-type="equation" class="calibre42">
<math alttext="double-struck upper Q equals StartSet Start 3 By 1 Matrix 1st Row  q 2nd Row  StartFraction 6 minus 15 dot q Over 5 EndFraction 3rd Row  1 minus q minus StartFraction 6 minus 15 dot q Over 5 EndFraction EndMatrix comma one-tenth less-than-or-equal-to q less-than-or-equal-to two-fifths EndSet" display="block">
  <mrow>
    <mi>ℚ</mi>
    <mo>=</mo>
    <mfenced separators="" open="{" close="}">
      <mfenced open="(" close=")">
        <mtable>
          <mtr>
            <mtd>
              <mi>q</mi>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mfrac><mrow><mn>6</mn><mo>-</mo><mn>15</mn><mo>·</mo><mi>q</mi></mrow> <mn>5</mn></mfrac>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mrow>
                <mn>1</mn>
                <mo>-</mo>
                <mi>q</mi>
                <mo>-</mo>
                <mfrac><mrow><mn>6</mn><mo>-</mo><mn>15</mn><mo>·</mo><mi>q</mi></mrow> <mn>5</mn></mfrac>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
      </mfenced>
      <mo>,</mo>
      <mfrac><mn>1</mn> <mn>10</mn></mfrac>
      <mo>≤</mo>
      <mi>q</mi>
      <mo>≤</mo>
      <mfrac><mn>2</mn> <mn>5</mn></mfrac>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">As an example, take <math alttext="q equals three-tenths">
  <mrow>
    <mi>q</mi>
    <mo>=</mo>
    <mfrac><mn>3</mn> <mn>10</mn></mfrac>
  </mrow>
</math>. It follows</p>
<div data-type="equation" class="calibre42">
<math alttext="upper Q left-parenthesis q equals three-tenths right-parenthesis equals Start 3 By 1 Matrix 1st Row  three-tenths 2nd Row  StartFraction 6 minus 15 dot three-tenths Over 5 EndFraction 3rd Row  1 minus three-tenths minus three-tenths EndMatrix equals Start 3 By 1 Matrix 1st Row  three-tenths 2nd Row  three-tenths 3rd Row  four-tenths EndMatrix" display="block">
  <mrow>
    <mi>Q</mi>
    <mfenced separators="" open="(" close=")">
      <mi>q</mi>
      <mo>=</mo>
      <mfrac><mn>3</mn> <mn>10</mn></mfrac>
    </mfenced>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mfrac><mn>3</mn> <mn>10</mn></mfrac>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mfrac><mrow><mn>6</mn><mo>-</mo><mn>15</mn><mo>·</mo><mfrac><mn>3</mn> <mn>10</mn></mfrac></mrow> <mn>5</mn></mfrac>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mn>1</mn>
              <mo>-</mo>
              <mfrac><mn>3</mn> <mn>10</mn></mfrac>
              <mo>-</mo>
              <mfrac><mn>3</mn> <mn>10</mn></mfrac>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mfrac><mn>3</mn> <mn>10</mn></mfrac>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mfrac><mn>3</mn> <mn>10</mn></mfrac>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mfrac><mn>4</mn> <mn>10</mn></mfrac>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">and</p>
<div data-type="equation" class="calibre42">
<math alttext="three-tenths dot 20 plus three-tenths dot 10 plus four-tenths dot 5 equals 11" display="block">
  <mrow>
    <mfrac><mn>3</mn> <mn>10</mn></mfrac>
    <mo>·</mo>
    <mn>20</mn>
    <mo>+</mo>
    <mfrac><mn>3</mn> <mn>10</mn></mfrac>
    <mo>·</mo>
    <mn>10</mn>
    <mo>+</mo>
    <mfrac><mn>4</mn> <mn>10</mn></mfrac>
    <mo>·</mo>
    <mn>5</mn>
    <mo>=</mo>
    <mn>11</mn>
  </mrow>
</math>
</div>

<p class="author1">as desired for the stock price process.</p>

<p class="author1">With the specifications from before, the calculation in Python is as follows:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code> <code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="n">Q</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">((</code><code class="mi">0.3</code><code class="p">,</code> <code class="mi">0.3</code><code class="p">,</code> <code class="mi">0.4</code><code class="p">))</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">Q</code><code class="p">,</code> <code class="n">S</code><code class="p">[</code><code class="mi">1</code><code class="p">])</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="mi">11.0</code></pre>

<p class="author1">According to the 2FTAP, the market model is <em class="calibre7">incomplete</em> since there is more than one martingale measure consistent with the market model.</p>
<div data-type="caution" class="calibre28"><h1 class="calibre49">Martingale Measures in Incomplete Markets</h1>
<p class="author1">Complete market models<a data-type="indexterm" data-primary="complete market model" data-secondary="martingale pricing in" id="idm44853702833336" class="calibre6"/><a data-type="indexterm" data-primary="incomplete market model" data-secondary="martingale pricing in" id="idm44853702832328" class="calibre6"/><a data-type="indexterm" data-primary="market completeness" data-secondary="martingale pricing in" id="idm44853702831384" class="calibre6"/><a data-type="indexterm" data-primary="market incompleteness" data-secondary="martingale pricing in" id="idm44853702830440" class="calibre6"/> are characterized by a unique martingale measure. By contrast, incomplete market models usually allow for an infinite number of martingale measures consistent with the model economy. It should be clear that this has significant consequences for the pricing of contingent claims since different martingale measures will lead to different values of contingent claims that are all consistent with the absence of arbitrage.</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Risk-Neutral Pricing" class="calibre4"><div class="preface" id="idm44853703617512">
<h2 class="calibre55">Risk-Neutral Pricing</h2>

<p class="author1">What <a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="risk-neutral pricing" id="model-three-state-risk-neutral" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="risk-neutral pricing" id="three-state-risk-neutral" class="calibre6"/><a data-type="indexterm" data-primary="risk-neutral pricing" id="risk-neutral" class="calibre6"/>implications does an infinite number of market consistent martingale measures have when it comes to the arbitrage pricing of contingent claims? First, for those contingent claims that are attainable, <math alttext="double-struck upper A">
  <mi>𝔸</mi>
</math>, arbitrage pricing holds as in a complete market setting: the value of the replicating portfolio equals the price of the contingent claim to be replicated—otherwise arbitrage opportunities exist. Formally, <math alttext="upper C 0 equals upper V 0 left-parenthesis phi right-parenthesis">
  <mrow>
    <msub><mi>C</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <msub><mi>V</mi> <mn>0</mn> </msub>
    <mrow>
      <mo>(</mo>
      <mi>ϕ</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math> if <math alttext="upper V 1 left-parenthesis phi right-parenthesis equals upper C 1">
  <mrow>
    <msub><mi>V</mi> <mn>1</mn> </msub>
    <mrow>
      <mo>(</mo>
      <mi>ϕ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
  </mrow>
</math>.</p>

<p class="author1">For those contingent claims that are not attainable, <math alttext="upper C 1 element-of double-struck upper A overbar equals double-struck upper R cubed minus double-struck upper A">
  <mrow>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>∈</mo>
    <mover accent="true"><mi>𝔸</mi> <mo>¯</mo></mover>
    <mo>=</mo>
    <msup><mi>ℝ</mi> <mn>3</mn> </msup>
    <mo>∖</mo>
    <mi>𝔸</mi>
  </mrow>
</math>, the answer is not that simple. Suppose the first Arrow-Debreu security <math alttext="gamma Superscript u">
  <msup><mi>γ</mi> <mi>u</mi> </msup>
</math>. It is not replicable as shown previously and therefore belongs to the set <math alttext="double-struck upper A overbar">
  <mover accent="true"><mi>𝔸</mi> <mo>¯</mo></mover>
</math>. Its martingale price is:</p>
<div data-type="equation" class="calibre42">
<math alttext="gamma 0 Superscript u Baseline left-parenthesis q right-parenthesis equals StartFraction 1 Over 1 plus i EndFraction dot double-struck upper E Superscript upper Q Baseline left-parenthesis left-parenthesis 1 comma 0 comma 0 right-parenthesis Superscript upper T Baseline right-parenthesis equals StartFraction 1 Over 1 plus i EndFraction dot q" display="block">
  <mrow>
    <msubsup><mi>γ</mi> <mn>0</mn> <mi>u</mi> </msubsup>
    <mrow>
      <mo>(</mo>
      <mi>q</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mrow><mn>1</mn><mo>+</mo><mi>i</mi></mrow></mfrac>
    <mo>·</mo>
    <msup><mi>𝔼</mi> <mi>Q</mi> </msup>
    <mfenced separators="" open="(" close=")">
      <msup><mrow><mo>(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
    </mfenced>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mrow><mn>1</mn><mo>+</mo><mi>i</mi></mrow></mfrac>
    <mo>·</mo>
    <mi>q</mi>
  </mrow>
</math>
</div>

<p class="author1">The quantity <math alttext="gamma 0 Superscript omega">
  <msubsup><mi>γ</mi> <mn>0</mn> <mi>ω</mi> </msubsup>
</math> is often called the <em class="calibre7">state price</em> for one unit of currency in state <math alttext="omega element-of normal upper Omega">
  <mrow>
    <mi>ω</mi>
    <mo>∈</mo>
    <mi>Ω</mi>
  </mrow>
</math>. It is simply the discounted martingale probability for this state.</p>

<p class="author1">In the model economy, <math alttext="one-tenth less-than-or-equal-to q less-than-or-equal-to two-fifths">
  <mrow>
    <mfrac><mn>1</mn> <mn>10</mn></mfrac>
    <mo>≤</mo>
    <mi>q</mi>
    <mo>≤</mo>
    <mfrac><mn>2</mn> <mn>5</mn></mfrac>
  </mrow>
</math> must hold, therefore the martingale price—the price avoiding arbitrage opportunities—lies in the interval:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartFraction 10 Over 11 EndFraction dot one-tenth equals one-eleventh less-than-or-equal-to gamma 0 Superscript u Baseline less-than-or-equal-to StartFraction 10 Over 11 EndFraction dot two-fifths equals four-elevenths" display="block">
  <mrow>
    <mfrac><mn>10</mn> <mn>11</mn></mfrac>
    <mo>·</mo>
    <mfrac><mn>1</mn> <mn>10</mn></mfrac>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>11</mn></mfrac>
    <mo>≤</mo>
    <msubsup><mi>γ</mi> <mn>0</mn> <mi>u</mi> </msubsup>
    <mo>≤</mo>
    <mfrac><mn>10</mn> <mn>11</mn></mfrac>
    <mo>·</mo>
    <mfrac><mn>2</mn> <mn>5</mn></mfrac>
    <mo>=</mo>
    <mfrac><mn>4</mn> <mn>11</mn></mfrac>
  </mrow>
</math>
</div>

<p class="author1">In words, every price between <math alttext="one-eleventh">
  <mfrac><mn>1</mn> <mn>11</mn></mfrac>
</math> and <math alttext="four-elevenths">
  <mfrac><mn>4</mn> <mn>11</mn></mfrac>
</math> for the first Arrow-Debreu security is consistent with the absence of arbitrage, given the assumptions for the model economy. Calculations for other contingent claims that are not attainable lead to similar <a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="martingale pricing" data-startref="model-three-state-martingale" id="idm44853702727336" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="martingale pricing" data-startref="three-state-martingale" id="idm44853702725784" class="calibre6"/><a data-type="indexterm" data-primary="martingale pricing" data-secondary="in three-state economy" data-secondary-sortas="three-state economy" data-startref="martingale-three-state" id="idm44853702724552" class="calibre6"/>results.</p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Super-Replication" class="calibre4"><div class="preface" id="idm44853702722680">
<h1 class="calibre17">Super-Replication</h1>

<p class="author1">Replication is<a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="super-replication" id="model-three-state-super-rep" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="super-replication" id="three-state-super-rep" class="calibre6"/><a data-type="indexterm" data-primary="replication" data-secondary="super-replication" id="replication-super" class="calibre6"/><a data-type="indexterm" data-primary="super-replication" id="super-replication" class="calibre6"/> important not only in a <em class="calibre7">pricing</em> context. It is also an approach<a data-type="indexterm" data-primary="hedging risk" id="idm44853702715304" class="calibre6"/><a data-type="indexterm" data-primary="risk" data-secondary="hedging" id="idm44853702714600" class="calibre6"/> to <em class="calibre7">hedge risk</em> resulting from an uncertain contingent claim payoff. Consider an arbitrary attainable contingent claim. Selling short the replication portfolio in addition to holding the contingent claim eliminates any kind of risk resulting from uncertainty regarding future payoff. This is because the payoffs of the contingent claim and the replicating portfolio cancel each other out perfectly. Formally, if the portfolio <math alttext="phi Superscript asterisk">
  <msup><mi>ϕ</mi> <mo>*</mo> </msup>
</math> replicates contingent claim <math alttext="upper C 1">
  <msub><mi>C</mi> <mn>1</mn> </msub>
</math>, then:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper C 1 minus upper V 1 left-parenthesis phi Superscript asterisk Baseline right-parenthesis equals upper C 1 minus script upper M dot phi Superscript asterisk Baseline equals 0" display="block">
  <mrow>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>-</mo>
    <msub><mi>V</mi> <mn>1</mn> </msub>
    <mrow>
      <mo>(</mo>
      <msup><mi>ϕ</mi> <mo>*</mo> </msup>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>-</mo>
    <mi>ℳ</mi>
    <mo>·</mo>
    <msup><mi>ϕ</mi> <mo>*</mo> </msup>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math>
</div>

<p class="author1">For a contingent claim that is not attainable, such a perfect hedge is not available. However, one can always compose a portfolio that <em class="calibre7">super-replicates</em> the payoff of such a contingent claim. A portfolio <math alttext="phi">
  <mi>ϕ</mi>
</math> super-replicates a contingent claim <math alttext="upper C 1">
  <msub><mi>C</mi> <mn>1</mn> </msub>
</math> if its payoff in every future state of the economy is greater than or equal to the contingent claims payoff <math alttext="upper V 1 left-parenthesis phi right-parenthesis greater-than-or-equal-to upper C 1">
  <mrow>
    <msub><mi>V</mi> <mn>1</mn> </msub>
    <mrow>
      <mo>(</mo>
      <mi>ϕ</mi>
      <mo>)</mo>
    </mrow>
    <mo>≥</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
  </mrow>
</math>.</p>

<p class="author1">Consider again the first Arrow-Debreu security <math alttext="gamma Superscript u">
  <msup><mi>γ</mi> <mi>u</mi> </msup>
</math>, which is not attainable. The payoff can be super-replicated, for example, by a portfolio containing the risk-less bond only:</p>
<div data-type="equation" class="calibre42">
<math alttext="phi equals left-parenthesis StartFraction 1 Over upper B 1 EndFraction comma 0 right-parenthesis Superscript upper T" display="block">
  <mrow>
    <mi>ϕ</mi>
    <mo>=</mo>
    <msup><mfenced separators="" open="(" close=")"><mfrac><mn>1</mn> <msub><mi>B</mi> <mn>1</mn> </msub></mfrac><mo>,</mo><mn>0</mn></mfenced> <mi>T</mi> </msup>
  </mrow>
</math>
</div>

<p class="author1">The resulting payoff is</p>
<div data-type="equation" class="calibre42">
<math alttext="upper V 1 left-parenthesis phi right-parenthesis equals StartFraction 1 Over upper B 1 EndFraction dot Start 3 By 1 Matrix 1st Row  upper B 1 2nd Row  upper B 1 3rd Row  upper B 1 EndMatrix equals Start 3 By 1 Matrix 1st Row  1 2nd Row  1 3rd Row  1 EndMatrix greater-than-or-equal-to Start 3 By 1 Matrix 1st Row  1 2nd Row  0 3rd Row  0 EndMatrix equals upper C 1" display="block">
  <mrow>
    <msub><mi>V</mi> <mn>1</mn> </msub>
    <mrow>
      <mo>(</mo>
      <mi>ϕ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac><mn>1</mn> <msub><mi>B</mi> <mn>1</mn> </msub></mfrac>
    <mo>·</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <msub><mi>B</mi> <mn>1</mn> </msub>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub><mi>B</mi> <mn>1</mn> </msub>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub><mi>B</mi> <mn>1</mn> </msub>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>1</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>1</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>1</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>≥</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>1</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>=</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
  </mrow>
</math>
</div>

<p class="author1">where the <math alttext="greater-than-or-equal-to">
  <mo>≥</mo>
</math> sign is to be understood element-wise. Although this satisfies the definition of super-replication, it might not be the best choice in terms of the costs to set up the super-replication portfolio. Therefore, a <em class="calibre7">cost minimization</em> argument is introduced in general.</p>

<p class="author1">The <em class="calibre7">super-replication problem</em> for a contingent claim <math alttext="upper C 1">
  <msub><mi>C</mi> <mn>1</mn> </msub>
</math> at <em class="calibre7">minimal costs</em> is:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row  min Underscript phi Endscripts upper V 0 left-parenthesis phi right-parenthesis 2nd Row  s period t period upper V 1 left-parenthesis phi right-parenthesis greater-than-or-equal-to upper C 1 EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <munder><mo movablelimits="true" form="prefix">min</mo> <mi>ϕ</mi> </munder>
          <msub><mi>V</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mi>ϕ</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mtext>s.t.</mtext>
          <mspace width="4.pt"/>
          <msub><mi>V</mi> <mn>1</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mi>ϕ</mi>
            <mo>)</mo>
          </mrow>
          <mo>≥</mo>
          <msub><mi>C</mi> <mn>1</mn> </msub>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">or</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row  min Underscript b comma s Endscripts b dot upper B 0 plus s dot upper S 0 2nd Row  s period t period StartLayout Enlarged left-brace 1st Row  b dot upper B 1 plus s dot upper S 1 Superscript u Baseline greater-than-or-equal-to upper C 1 Superscript u Baseline 2nd Row  b dot upper B 1 plus s dot upper S 1 Superscript m Baseline greater-than-or-equal-to upper C 1 Superscript m Baseline 3rd Row  b dot upper B 1 plus s dot upper S 1 Superscript d Baseline greater-than-or-equal-to upper C 1 Superscript d EndLayout EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <munder><mo movablelimits="true" form="prefix">min</mo> <mrow><mi>b</mi><mo>,</mo><mi>s</mi></mrow> </munder>
          <mi>b</mi>
          <mo>·</mo>
          <msub><mi>B</mi> <mn>0</mn> </msub>
          <mo>+</mo>
          <mi>s</mi>
          <mo>·</mo>
          <msub><mi>S</mi> <mn>0</mn> </msub>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mtext>s.t.</mtext>
          <mspace width="4.pt"/>
          <mfenced separators="" open="{" close="">
            <mtable>
              <mtr>
                <mtd columnalign="left">
                  <mrow>
                    <mi>b</mi>
                    <mo>·</mo>
                    <msub><mi>B</mi> <mn>1</mn> </msub>
                    <mo>+</mo>
                    <mi>s</mi>
                    <mo>·</mo>
                    <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
                    <mo>≥</mo>
                    <msubsup><mi>C</mi> <mn>1</mn> <mi>u</mi> </msubsup>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd columnalign="left">
                  <mrow>
                    <mi>b</mi>
                    <mo>·</mo>
                    <msub><mi>B</mi> <mn>1</mn> </msub>
                    <mo>+</mo>
                    <mi>s</mi>
                    <mo>·</mo>
                    <msubsup><mi>S</mi> <mn>1</mn> <mi>m</mi> </msubsup>
                    <mo>≥</mo>
                    <msubsup><mi>C</mi> <mn>1</mn> <mi>m</mi> </msubsup>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd columnalign="left">
                  <mrow>
                    <mi>b</mi>
                    <mo>·</mo>
                    <msub><mi>B</mi> <mn>1</mn> </msub>
                    <mo>+</mo>
                    <mi>s</mi>
                    <mo>·</mo>
                    <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
                    <mo>≥</mo>
                    <msubsup><mi>C</mi> <mn>1</mn> <mi>d</mi> </msubsup>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
          </mfenced>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">Such <a data-type="indexterm" data-primary="SciPy" data-secondary="minimization problems" id="scipy-minimize" class="calibre6"/><a data-type="indexterm" data-primary="minimization problems" id="minimize-problems" class="calibre6"/>minimization problems can be modeled and solved straightforwardly in Python when using the <a href="http://scipy.org" class="calibre6"><code class="calibre22">SciPy</code></a> package. The following code starts by calculating the costs for the inefficient super-replication portfolio using the bond only. It proceeds by defining a value function for a portfolio. It also illustrates that alternative portfolio compositions can indeed be more cost efficient:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">16</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO2-1" href="#callout_three_state_economy_CO2-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">17</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">B</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">B</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="calibre22"> </code><code class="o">&gt;</code><code class="o">=</code><code class="calibre22"> </code><code class="n">C1</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO2-2" href="#callout_three_state_economy_CO2-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">17</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="calibre22"> </code><code class="nb">True</code><code class="p">,</code><code class="calibre22">  </code><code class="nb">True</code><code class="p">,</code><code class="calibre22">  </code><code class="nb">True</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">18</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">B</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">B</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO2-3" href="#callout_three_state_economy_CO2-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">18</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.9090909090909092</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">def</code><code class="calibre22"> </code><code class="nf">V</code><code class="p">(</code><code class="n">phi</code><code class="p">,</code><code class="calibre22"> </code><code class="n">t</code><code class="p">)</code><code class="p">:</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO2-4" href="#callout_three_state_economy_CO2-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">             </code><code class="kn">return</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">B</code><code class="p">[</code><code class="n">t</code><code class="p">]</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">S</code><code class="p">[</code><code class="n">t</code><code class="p">]</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">20</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">phi</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">0.04</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.03</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO2-5" href="#callout_three_state_economy_CO2-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">21</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">V</code><code class="p">(</code><code class="n">phi</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO2-6" href="#callout_three_state_economy_CO2-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">21</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.7</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">V</code><code class="p">(</code><code class="n">phi</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO2-7" href="#callout_three_state_economy_CO2-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">1.04</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.74</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.59</code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO2-1" href="#co_three_state_economy_CO2-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The payoff of the contingent claim (first Arrow-Debreu security).</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO2-2" href="#co_three_state_economy_CO2-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The portfolio with the bond only checked for the super-replication characteristic.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO2-3" href="#co_three_state_economy_CO2-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The costs to set up this portfolio.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO2-4" href="#co_three_state_economy_CO2-4"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">A function to calculate the value of a portfolio <code class="calibre22">phi</code> today, <code class="calibre22">t=0</code>, or in one year, <code class="calibre22">t=1</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO2-5" href="#co_three_state_economy_CO2-5"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Another guess for a super-replicating portfolio.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO2-6" href="#co_three_state_economy_CO2-6"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The cost to set it up, which is lower than with the bond only.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO2-7" href="#co_three_state_economy_CO2-7"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">And the resulting value (payoff) in one year, which super-replicates the first Arrow-Debreu security.</p></dd>
</dl>

<p class="author1">The second part of the code implements the <em class="calibre7">minimization program</em> based on the previous inequality constraints in vectorized fashion. The cost optimal super-replication portfolio is much cheaper than the one using the bond only or the already more efficient portfolio including the bond and the stock:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">23</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">from</code><code class="calibre22"> </code><code class="nn">scipy.optimize</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="n">minimize</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO3-1" href="#callout_three_state_economy_CO3-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">cons</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="p">{</code><code class="s">'</code><code class="s">type</code><code class="s">'</code><code class="p">:</code><code class="calibre22"> </code><code class="s">'</code><code class="s">ineq</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="s">'</code><code class="s">fun</code><code class="s">'</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">lambda</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">:</code><code class="calibre22"> </code><code class="n">V</code><code class="p">(</code><code class="n">phi</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">C1</code><code class="p">}</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO3-2" href="#callout_three_state_economy_CO3-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">res</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">minimize</code><code class="p">(</code><code class="kn">lambda</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">:</code><code class="calibre22"> </code><code class="n">V</code><code class="p">(</code><code class="n">phi</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="p">,</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO3-3" href="#callout_three_state_economy_CO3-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">                        </code><code class="p">(</code><code class="mi">0.01</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.01</code><code class="p">)</code><code class="p">,</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO3-4" href="#callout_three_state_economy_CO3-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">                        </code><code class="n">method</code><code class="o">=</code><code class="s">'</code><code class="s">SLSQP</code><code class="s">'</code><code class="p">,</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO3-5" href="#callout_three_state_economy_CO3-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">                        </code><code class="n">constraints</code><code class="o">=</code><code class="n">cons</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO3-6" href="#callout_three_state_economy_CO3-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">res</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO3-7" href="#callout_three_state_economy_CO3-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code class="calibre22">      </code><code class="n">fun</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.3636363636310989</code><code class="calibre22">
</code><code class="calibre22">              </code><code class="n">jac</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">10.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10.</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">          </code><code class="n">message</code><code class="p">:</code><code class="calibre22"> </code><code class="s">'</code><code class="s">Optimization terminated successfully</code><code class="s">'</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">nfev</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">6</code><code class="calibre22">
</code><code class="calibre22">              </code><code class="n">nit</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">2</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">njev</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">2</code><code class="calibre22">
</code><code class="calibre22">           </code><code class="n">status</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0</code><code class="calibre22">
</code><code class="calibre22">          </code><code class="n">success</code><code class="p">:</code><code class="calibre22"> </code><code class="nb">True</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="n">x</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mi">0.0303</code><code class="calibre22"> </code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.06667</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">V</code><code class="p">(</code><code class="n">res</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO3-8" href="#callout_three_state_economy_CO3-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.3636363636310989</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">V</code><code class="p">(</code><code class="n">res</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO3-9" href="#callout_three_state_economy_CO3-9"><img src="Images/9.png" alt="9" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="calibre22"> </code><code class="mi">1.</code><code class="calibre22">     </code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.33333</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">0.</code><code class="calibre22">     </code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO3-1" href="#co_three_state_economy_CO3-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Imports the <code class="calibre22">minimize</code> function from <code class="calibre22">scipy.optimize</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO3-2" href="#co_three_state_economy_CO3-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Defines the inequality constraints in vectorized fashion based on a <code class="calibre22">lambda</code> (or anonymous) function; the function <math alttext="lamda">
  <mi>λ</mi>
</math> modeled here is <math alttext="lamda left-parenthesis phi right-parenthesis equals upper V 1 left-parenthesis phi right-parenthesis minus upper C 1">
  <mrow>
    <mi>λ</mi>
    <mrow>
      <mo>(</mo>
      <mi>ϕ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub><mi>V</mi> <mn>1</mn> </msub>
    <mrow>
      <mo>(</mo>
      <mi>ϕ</mi>
      <mo>)</mo>
    </mrow>
    <mo>-</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
  </mrow>
</math>, for which the inequality constraint <math alttext="lamda left-parenthesis phi right-parenthesis greater-than-or-equal-to 0">
  <mrow>
    <mi>λ</mi>
    <mo>(</mo>
    <mi>ϕ</mi>
    <mo>)</mo>
    <mo>≥</mo>
    <mn>0</mn>
  </mrow>
</math> must hold.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO3-3" href="#co_three_state_economy_CO3-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The function to be minimized also as a <code class="calibre22">lambda</code> function.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO3-4" href="#co_three_state_economy_CO3-4"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">An initial guess for the optimal solution (not too important here).</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO3-5" href="#co_three_state_economy_CO3-5"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The method to be used for the minimization, here Sequential Least Squares 
<span class="firstname">Programming</span> (<code class="calibre22">SLSQP</code>).</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO3-6" href="#co_three_state_economy_CO3-6"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The constraints for the minimization problem as defined before.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO3-7" href="#co_three_state_economy_CO3-7"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The complete results dictionary from the minimization, with the optimal parameters under <code class="calibre22">x</code> and the minimal function value under <code class="calibre22">fun</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO3-8" href="#co_three_state_economy_CO3-8"><img src="Images/8.png" alt="8" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The value of the optimal super-replicating portfolio today.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO3-9" href="#co_three_state_economy_CO3-9"><img src="Images/9.png" alt="9" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The future uncertain value of the optimal super-replicating portfolio; the optimal portfolio that sells short the bond and goes long the stock exactly replicates the relevant payoff in two states and only super-replicates in <a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="super-replication" data-startref="model-three-state-super-rep" id="idm44853701934648" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="super-replication" data-startref="three-state-super-rep" id="idm44853701933112" class="calibre6"/><a data-type="indexterm" data-primary="replication" data-secondary="super-replication" data-startref="replication-super" id="idm44853701931880" class="calibre6"/><a data-type="indexterm" data-primary="super-replication" data-startref="super-replication" id="idm44853701930664" class="calibre6"/><a data-type="indexterm" data-primary="SciPy" data-secondary="minimization problems" data-startref="scipy-minimize" id="idm44853701929720" class="calibre6"/><a data-type="indexterm" data-primary="minimization problems" data-startref="minimize-problems" id="idm44853701928504" class="calibre6"/>the middle state.</p></dd>
</dl>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Approximate Replication" class="calibre4"><div class="preface" id="idm44853702257448">
<h1 class="calibre17">Approximate Replication</h1>

<p class="author1">Super-replication <a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="approximate replication" id="model-three-state-approximate" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="approximate replication" id="three-state-approximate" class="calibre6"/><a data-type="indexterm" data-primary="replication" data-secondary="approximate" id="replication-approximate" class="calibre6"/><a data-type="indexterm" data-primary="approximate replication" id="approximate-replication" class="calibre6"/>assumes a somewhat extreme situation: the payoff of the contingent claim to be super-replicated must be reached or exceeded in any given state under any circumstances. Such a situation is seen in practice, for instance, when a life insurance company invests in a way that it can meet under all circumstances—which often translates in the real world into something like “With a probability of 99.9%.”—its future liabilities and obligations (contingent claims). However, this might not be an economically sensible or even viable option in many cases.</p>

<p class="author1">This is where <em class="calibre7">approximation</em> comes into play. The idea is to replicate the payoff of a contingent claim <em class="calibre7">as well as possible</em> given an objective function. The problem then becomes minimizing the <em class="calibre7">replication error</em> given the traded financial assets.</p>

<p class="author1">A possible candidate for the objective or error function <a data-type="indexterm" data-primary="mean squared error (MSE)" id="mean-squared-error" class="calibre6"/><a data-type="indexterm" data-primary="MSE (mean squared error)" id="mse" class="calibre6"/>is the <em class="calibre7">mean squared error</em> (MSE). Let <math alttext="upper V 1 left-parenthesis phi right-parenthesis">
  <mrow>
    <msub><mi>V</mi> <mn>1</mn> </msub>
    <mrow>
      <mo>(</mo>
      <mi>ϕ</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math> be the value vector given a replication portfolio <math alttext="phi">
  <mi>ϕ</mi>
</math>. The MSE for a contingent claim <math alttext="upper C 1">
  <msub><mi>C</mi> <mn>1</mn> </msub>
</math> given the portfolio <math alttext="phi">
  <mi>ϕ</mi>
</math> is:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper M upper S upper E left-parenthesis upper V 1 left-parenthesis phi right-parenthesis minus upper C 1 right-parenthesis equals StartFraction 1 Over bar normal upper Omega bar EndFraction sigma-summation Underscript omega element-of normal upper Omega Endscripts left-parenthesis upper V 1 Superscript omega Baseline left-parenthesis phi right-parenthesis minus upper C 1 Superscript omega Baseline right-parenthesis squared" display="block">
  <mrow>
    <mi>M</mi>
    <mi>S</mi>
    <mi>E</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>V</mi> <mn>1</mn> </msub>
      <mrow>
        <mo>(</mo>
        <mi>ϕ</mi>
        <mo>)</mo>
      </mrow>
      <mo>-</mo>
      <msub><mi>C</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mrow><mo>|</mo><mi>Ω</mi><mo>|</mo></mrow></mfrac>
    <munder><mo>∑</mo> <mrow><mi>ω</mi><mo>∈</mo><mi>Ω</mi></mrow> </munder>
    <msup><mrow><mo>(</mo><msubsup><mi>V</mi> <mn>1</mn> <mi>ω</mi> </msubsup><mrow><mo>(</mo><mi>ϕ</mi><mo>)</mo></mrow><mo>-</mo><msubsup><mi>C</mi> <mn>1</mn> <mi>ω</mi> </msubsup><mo>)</mo></mrow> <mn>2</mn> </msup>
  </mrow>
</math>
</div>

<p class="author1">This is the quantity to be minimized. For an attainable contingent claim, the MSE is zero. The problem itself in matrix form is:</p>
<div data-type="equation" class="calibre42">
<math alttext="min Underscript phi Endscripts upper M upper S upper E left-parenthesis script upper M dot phi minus upper C 1 right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">min</mo> <mi>ϕ</mi> </munder>
    <mi>M</mi>
    <mi>S</mi>
    <mi>E</mi>
    <mrow>
      <mo>(</mo>
      <mi>ℳ</mi>
      <mo>·</mo>
      <mi>ϕ</mi>
      <mo>-</mo>
      <msub><mi>C</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">In linear algebra, this<a data-type="indexterm" data-primary="linear algebra" data-secondary="OLS (ordinary least-squares) regression" id="linear-ols" class="calibre6"/><a data-type="indexterm" data-primary="OLS (ordinary least-squares) regression" id="ols" class="calibre6"/><a data-type="indexterm" data-primary="ordinary least-squares (OLS) regression" id="ordinary-least-squares" class="calibre6"/> is a problem that falls in the category of <em class="calibre7">ordinary least-squares regression</em> (OLS regression) problems. The previous problem is the special case of a <em class="calibre7">linear</em> OLS regression problem.</p>

<p class="author1"><code class="calibre22">NumPy</code> provides <a data-type="indexterm" data-primary="NumPy" data-secondary="OLS (ordinary least-squares) regression" id="numpy-ols" class="calibre6"/><a data-type="indexterm" data-primary="np.linalg.lstsq function" id="np.linalg.lstsq" class="calibre6"/>the function <code class="calibre22">np.linalg.lstsq</code> that solves problems of this kind in a standardized and efficient manner:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">29</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">B</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="n">S</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">T</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO4-1" href="#callout_three_state_economy_CO4-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO4-2" href="#callout_three_state_economy_CO4-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">20</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="p">[</code><code class="mi">11</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">5</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">31</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">reg</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">lstsq</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">C1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">rcond</code><code class="o">=</code><code class="o">-</code><code class="mi">1</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO4-3" href="#callout_three_state_economy_CO4-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">reg</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="c"># (array,   </code><a class="calibre6" id="co_three_state_economy_CO4-4" href="#callout_three_state_economy_CO4-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="c">#  array,  </code><a class="calibre6" id="co_three_state_economy_CO4-5" href="#callout_three_state_economy_CO4-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="c">#  int,  </code><a class="calibre6" id="co_three_state_economy_CO4-6" href="#callout_three_state_economy_CO4-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="c">#  array)  </code><a class="calibre6" id="co_three_state_economy_CO4-7" href="#callout_three_state_economy_CO4-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="p">(</code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mi">0.04545</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.07143</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0.07143</code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">,</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">28.93836</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">          </code><code class="mi">7.11136</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">V</code><code class="p">(</code><code class="n">reg</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO4-8" href="#callout_three_state_economy_CO4-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.2597402597402598</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">34</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">V</code><code class="p">(</code><code class="n">reg</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO4-9" href="#callout_three_state_economy_CO4-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">34</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="calibre22"> </code><code class="mi">0.92857</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.21429</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">0.14286</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">V</code><code class="p">(</code><code class="n">reg</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">C1</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO4-10" href="#callout_three_state_economy_CO4-9"><img src="Images/9.png" alt="9" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mi">0.07143</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0.21429</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">0.14286</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">36</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">(</code><code class="n">V</code><code class="p">(</code><code class="n">reg</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">C1</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="o">*</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO4-11" href="#callout_three_state_economy_CO4-10"><img src="Images/10.png" alt="10" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">36</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.02380952380952381</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO4-1" href="#co_three_state_economy_CO4-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The future price matrix of the two traded financial assets.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO4-2" href="#co_three_state_economy_CO4-3"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This solves the linear OLS regression problem by minimizing the MSE.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO4-3" href="#co_three_state_economy_CO4-4"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The optimal portfolio positions, that is, the solution to the problem.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO4-4" href="#co_three_state_economy_CO4-5"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The MSE obtained from the optimization procedure (minimal mean squared replication error).</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO4-5" href="#co_three_state_economy_CO4-6"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Rank of matrix <math alttext="upper M">
  <mi>M</mi>
</math>…</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO4-6" href="#co_three_state_economy_CO4-7"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">…and its singular values.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO4-7" href="#co_three_state_economy_CO4-8"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The value of the approximate portfolio (lower than the value of the cost-minimizing portfolio).</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO4-8" href="#co_three_state_economy_CO4-9"><img src="Images/8.png" alt="8" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The payoff of the approximation portfolio.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO4-9" href="#co_three_state_economy_CO4-10"><img src="Images/9.png" alt="9" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The vector with the replication errors.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO4-10" href="#co_three_state_economy_CO4-11"><img src="Images/10.png" alt="10" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The MSE from the approximate replication.</p></dd>
</dl>

<p class="author1">Approximate replication might not be applicable in all circumstances. But an investor or financial manager with discretion in their decisions can decide that an approximation is simply good enough. Such a decision could be made, for example, in cases in which super-replication might be considered to be<a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="approximate replication" data-startref="model-three-state-approximate" id="idm44853701475144" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="approximate replication" data-startref="three-state-approximate" id="idm44853701473656" class="calibre6"/><a data-type="indexterm" data-primary="replication" data-secondary="approximate" data-startref="replication-approximate" id="idm44853701472472" class="calibre6"/><a data-type="indexterm" data-primary="approximate replication" data-startref="approximate-replication" id="idm44853701471256" class="calibre6"/><a data-type="indexterm" data-primary="mean squared error (MSE)" data-startref="mean-squared-error" id="idm44853701470312" class="calibre6"/><a data-type="indexterm" data-primary="MSE (mean squared error)" data-startref="mse" id="idm44853701469400" class="calibre6"/><a data-type="indexterm" data-primary="linear algebra" data-secondary="OLS (ordinary least-squares) regression" data-startref="linear-ols" id="idm44853701468488" class="calibre6"/><a data-type="indexterm" data-primary="OLS (ordinary least-squares) regression" data-startref="ols" id="idm44853701467256" class="calibre6"/><a data-type="indexterm" data-primary="ordinary least-squares (OLS) regression" data-startref="ordinary-least-squares" id="idm44853701466296" class="calibre6"/><a data-type="indexterm" data-primary="NumPy" data-secondary="OLS (ordinary least-squares) regression" data-startref="numpy-ols" id="idm44853701465336" class="calibre6"/><a data-type="indexterm" data-primary="np.linalg.lstsq function" data-startref="np.linalg.lstsq" id="idm44853701464104" class="calibre6"/> too costly.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Capital Market Line" class="calibre4"><div class="preface" id="idm44853701927176">
<h1 class="calibre17">Capital Market Line</h1>

<p class="author1">Assume <a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="CML (capital market line)" id="model-three-state-cml" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="CML (capital market line)" id="three-state-cml" class="calibre6"/><a data-type="indexterm" data-primary="CML (capital market line)" id="cml" class="calibre6"/><a data-type="indexterm" data-primary="capital market line (CML)" id="capital-market-line" class="calibre6"/>a mean-variance or, rather, mean-volatility context. In what follows, the risky stock is interpreted as<a data-type="indexterm" data-primary="market portfolio" id="idm44853701456744" class="calibre6"/> the <em class="calibre7">market portfolio</em>. One can think of the market portfolio in terms of a broad stock index—in the spirit of the S&amp;P 500 stock index.</p>

<p class="author1">As before, agents can compose portfolios that consist of the bond and the market portfolio. The rate of return for the bond—the risk-less interest rate—is <math alttext="i equals">
  <mrow>
    <mi>i</mi>
    <mo>=</mo>
  </mrow>
</math> 0.1, and the volatility is 0. The expected rate of return for the market portfolio is:</p>
<div data-type="equation" class="calibre42">
<math alttext="mu Subscript upper S Baseline equals StartFraction bold upper E Superscript upper P Baseline left-parenthesis upper S 1 right-parenthesis Over upper S 0 EndFraction minus 1 equals seven-sixths minus 1 equals one-sixth" display="block">
  <mrow>
    <msub><mi>μ</mi> <mi>S</mi> </msub>
    <mo>=</mo>
    <mfrac><mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mrow><mo>(</mo><msub><mi>S</mi> <mn>1</mn> </msub><mo>)</mo></mrow></mrow> <msub><mi>S</mi> <mn>0</mn> </msub></mfrac>
    <mo>-</mo>
    <mn>1</mn>
    <mo>=</mo>
    <mfrac><mn>7</mn> <mn>6</mn></mfrac>
    <mo>-</mo>
    <mn>1</mn>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>6</mn></mfrac>
  </mrow>
</math>
</div>

<p class="author1">Its volatility is:</p>
<div data-type="equation" class="calibre42">
<math alttext="sigma Subscript upper S Baseline equals StartRoot bold upper E Superscript upper P Baseline left-parenthesis left-parenthesis StartFraction upper S 1 minus upper S 0 Over upper S 0 EndFraction minus mu Subscript upper S Baseline right-parenthesis squared right-parenthesis EndRoot" display="block">
  <mrow>
    <msub><mi>σ</mi> <mi>S</mi> </msub>
    <mo>=</mo>
    <msqrt>
      <mrow>
        <msup><mi>𝐄</mi> <mi>P</mi> </msup>
        <mfenced separators="" open="(" close=")">
          <msup><mfenced separators="" open="(" close=")"><mfrac><mrow><msub><mi>S</mi> <mn>1</mn> </msub><mo>-</mo><msub><mi>S</mi> <mn>0</mn> </msub></mrow> <msub><mi>S</mi> <mn>0</mn> </msub></mfrac><mo>-</mo><msub><mi>μ</mi> <mi>S</mi> </msub></mfenced> <mn>2</mn> </msup>
        </mfenced>
      </mrow>
    </msqrt>
  </mrow>
</math>
</div>

<p class="author1">Quick calculations in Python give the corresponding numerical values:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">37</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">mu_S</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">7</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="mi">6</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO5-1" href="#callout_three_state_economy_CO5-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">38</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">mu_S</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO5-2" href="#callout_three_state_economy_CO5-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">38</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.16666666666666674</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">sigma_S</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="n">S</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">S</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">)</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO5-3" href="#callout_three_state_economy_CO5-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">40</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">sigma_S</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO5-4" href="#callout_three_state_economy_CO5-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">40</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.6236095644623235</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO5-1" href="#co_three_state_economy_CO5-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The expected return of the market portfolio.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO5-2" href="#co_three_state_economy_CO5-3"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The volatility of the returns of the market portfolio.<sup class="calibre14"><a data-type="noteref" id="idm44853701345560-marker" href="ch03.xhtml#idm44853701345560" class="calibre15">1</a></sup></p></dd>
</dl>

<p class="author1">Feasible mean values for a normalized portfolio with total weight of 1 or 100% consisting of the bond and the market portfolio without short selling range from 0 to about 0.166. Regarding the volatility, values between 0 and about 0.623 are possible.</p>

<p class="author1">Allowing for short selling, <a data-type="xref" href="#incom_02" class="calibre6">Figure 3-2</a> shows the <em class="calibre7">capital market line</em> (CML) resulting from different portfolio compositions. Because short selling of the bond is allowed, risk-return combinations on the upper line (with positive slope) are possible, which is what is referred to in general as <em class="calibre7">the</em> CML. The lower line (with negative slope) is in principle irrelevant since such portfolios, resulting from short positions in the market portfolio, have lower expected rates of return at the same risk as those that have a corresponding long position in the market portfolio:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">41</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">s</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">25</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO6-1" href="#callout_three_state_economy_CO6-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">42</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">b</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">s</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO6-2" href="#callout_three_state_economy_CO6-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">43</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">i</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">0.1</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO6-3" href="#callout_three_state_economy_CO6-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">44</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">mu</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">b</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">i</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">s</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">mu_S</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO6-4" href="#callout_three_state_economy_CO6-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">45</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">sigma</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">abs</code><code class="p">(</code><code class="n">s</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">sigma_S</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO6-5" href="#callout_three_state_economy_CO6-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">46</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">sigma</code><code class="p">,</code><code class="calibre22"> </code><code class="n">mu</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO6-6" href="#callout_three_state_economy_CO6-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s">'</code><code class="s">$</code><code class="s">\</code><code class="s">sigma$</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s">'</code><code class="s">$</code><code class="s">\</code><code class="s">mu$</code><code class="s">'</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO6-1" href="#co_three_state_economy_CO6-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The market portfolio position takes on values between –200% and 200%.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO6-2" href="#co_three_state_economy_CO6-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The bond portfolio position fills up to 100% total portfolio weight.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO6-3" href="#co_three_state_economy_CO6-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The risk-less interest rate.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO6-4" href="#co_three_state_economy_CO6-4"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The resulting expected rates of return for the portfolio.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO6-5" href="#co_three_state_economy_CO6-5"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The resulting volatility values for the portfolio.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO6-6" href="#co_three_state_economy_CO6-6"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Plots the CML for short as well as long positions in the market portfolio.</p></dd>
</dl>

<figure class="calibre50"><div id="incom_02" class="figure">
<img src="Images/ftwp_0302.png" alt="ftwp 0302" class="calibre61"/>
<h6 class="calibre52"><span class="firstname">Figure 3-2. </span>Capital market line (upper, increasing part)</h6>
</div></figure>

<p class="author1">The equation describing the (upper, increasing part of the) CML<a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="CML (capital market line)" data-startref="model-three-state-cml" id="idm44853701089016" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="CML (capital market line)" data-startref="three-state-cml" id="idm44853701087528" class="calibre6"/><a data-type="indexterm" data-primary="CML (capital market line)" data-startref="cml" id="idm44853701086328" class="calibre6"/><a data-type="indexterm" data-primary="capital market line (CML)" data-startref="capital-market-line" id="idm44853701085368" class="calibre6"/> is:</p>
<div data-type="equation" class="calibre42">
<math alttext="mu equals i plus StartFraction mu Subscript upper S Baseline minus i Over sigma Subscript upper S Baseline EndFraction dot sigma" display="block">
  <mrow>
    <mi>μ</mi>
    <mo>=</mo>
    <mi>i</mi>
    <mo>+</mo>
    <mfrac><mrow><msub><mi>μ</mi> <mi>S</mi> </msub><mo>-</mo><mi>i</mi></mrow> <msub><mi>σ</mi> <mi>S</mi> </msub></mfrac>
    <mo>·</mo>
    <mi>σ</mi>
  </mrow>
</math>
</div>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Capital Asset Pricing Model" class="calibre4"><div class="preface" id="idm44853701462552">
<h1 class="calibre17">Capital Asset Pricing Model</h1>

<p class="author1">The <em class="calibre7">Capital Asset Pricing Model</em> (CAPM) <a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="CAPM (capital asset pricing model)" id="model-three-state-capm" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="CAPM (capital asset pricing model)" id="three-state-capm" class="calibre6"/><a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="CAPM (capital asset pricing model)" id="asset-capm" class="calibre6"/><a data-type="indexterm" data-primary="CAPM (capital asset pricing model)" id="capm" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="CAPM (capital asset pricing model)" id="financial-assets-capm" class="calibre6"/>as pioneered by Sharpe (1964) is an equilibrium pricing model that mainly relates the expected rate of return of an arbitrary financial asset or portfolio and its volatility with the market portfolio’s expected rate of return and volatility.</p>

<p class="author1">To this end, the <em class="calibre7">correlation</em> between the rates of return of a financial asset and the market portfolio is of importance. In addition to the market portfolio, consider another risky financial asset with price process <math alttext="upper T equals left-parenthesis upper T 0 comma upper T 1 right-parenthesis">
  <mrow>
    <mi>T</mi>
    <mo>=</mo>
    <mo>(</mo>
    <msub><mi>T</mi> <mn>0</mn> </msub>
    <mo>,</mo>
    <msub><mi>T</mi> <mn>1</mn> </msub>
    <mo>)</mo>
  </mrow>
</math>. The correlation <math alttext="rho">
  <mi>ρ</mi>
</math> is defined by:</p>
<div data-type="equation" class="calibre42">
<math alttext="rho Subscript upper S upper T Baseline equals StartFraction bold upper E Superscript upper P Baseline left-parenthesis left-parenthesis r 1 Superscript upper S Baseline minus mu Subscript upper S Baseline right-parenthesis dot left-parenthesis r 1 Superscript upper T Baseline minus mu Subscript upper T Baseline right-parenthesis right-parenthesis Over sigma Subscript upper S Baseline dot sigma Subscript upper T Baseline EndFraction" display="block">
  <mrow>
    <msub><mi>ρ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub>
    <mo>=</mo>
    <mfrac><mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mfenced separators="" open="(" close=")"><mrow><mo>(</mo><msubsup><mi>r</mi> <mn>1</mn> <mi>S</mi> </msubsup><mo>-</mo><msub><mi>μ</mi> <mi>S</mi> </msub><mo>)</mo></mrow><mo>·</mo><mrow><mo>(</mo><msubsup><mi>r</mi> <mn>1</mn> <mi>T</mi> </msubsup><mo>-</mo><msub><mi>μ</mi> <mi>T</mi> </msub><mo>)</mo></mrow></mfenced></mrow> <mrow><msub><mi>σ</mi> <mi>S</mi> </msub><mo>·</mo><msub><mi>σ</mi> <mi>T</mi> </msub></mrow></mfrac>
  </mrow>
</math>
</div>

<p class="author1">with <math alttext="negative 1 less-than-or-equal-to rho Subscript upper S upper T Baseline less-than-or-equal-to 1">
  <mrow>
    <mo>-</mo>
    <mn>1</mn>
    <mo>≤</mo>
    <msub><mi>ρ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub>
    <mo>≤</mo>
    <mn>1</mn>
  </mrow>
</math>. If the correlation is positive, the two financial assets have a tendency to move in the same direction. If it is negative, the financial assets have a tendency to move in opposite directions. In the special case of perfect positive correlation, <math alttext="rho Subscript upper S upper T Baseline equals 1">
  <mrow>
    <msub><mi>ρ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>, the two financial assets always move in the same direction. This is true, for instance, for portfolios that lie on the CML for which the rates of return are just the rates of return of the market portfolio scaled by the weight of the market portfolio. Uncertainty in this case arises from the market portfolio part only such that any variation in risk is due to the market portfolio weight variation.</p>

<p class="author1">Consider the case of a financial asset <math alttext="upper T">
  <mi>T</mi>
</math>, which is part of the market portfolio and for which the correlation with the market portfolio shall not be perfect. For such a financial asset, the expected rate of return is given by:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column mu Subscript upper T 2nd Column equals 3rd Column i plus StartFraction left-parenthesis mu Subscript upper S Baseline minus i right-parenthesis dot rho Subscript upper S upper T Baseline Over sigma Subscript upper S Baseline EndFraction dot sigma Subscript upper T 2nd Row 1st Column Blank 2nd Column equals 3rd Column i plus StartFraction rho Subscript upper S upper T Baseline dot sigma Subscript upper S Baseline dot sigma Subscript upper T Baseline Over sigma Subscript upper S Superscript 2 Baseline EndFraction dot left-parenthesis mu Subscript upper S Baseline minus i right-parenthesis EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <msub><mi>μ</mi> <mi>T</mi> </msub>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>i</mi>
          <mo>+</mo>
          <mfrac><mrow><mrow><mo>(</mo><msub><mi>μ</mi> <mi>S</mi> </msub><mo>-</mo><mi>i</mi><mo>)</mo></mrow><mo>·</mo><msub><mi>ρ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub></mrow> <msub><mi>σ</mi> <mi>S</mi> </msub></mfrac>
          <mo>·</mo>
          <msub><mi>σ</mi> <mi>T</mi> </msub>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd/>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>i</mi>
          <mo>+</mo>
          <mfrac><mrow><msub><mi>ρ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub><mo>·</mo><msub><mi>σ</mi> <mi>S</mi> </msub><mo>·</mo><msub><mi>σ</mi> <mi>T</mi> </msub></mrow> <msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup></mfrac>
          <mo>·</mo>
          <mrow>
            <mo>(</mo>
            <msub><mi>μ</mi> <mi>S</mi> </msub>
            <mo>-</mo>
            <mi>i</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">It is easy to verify that the correlation between the market portfolio and the bond is zero such that the previous relationship gives the risk-less interest as the expected return if the financial asset <math alttext="upper T">
  <mi>T</mi>
</math> is the risk-less bond.</p>

<p class="author1">The <em class="calibre7">covariance</em> between <math alttext="upper S 1">
  <msub><mi>S</mi> <mn>1</mn> </msub>
</math> and <math alttext="upper T 1">
  <msub><mi>T</mi> <mn>1</mn> </msub>
</math> is defined as <math alttext="sigma Subscript upper S upper T Baseline equals rho Subscript upper S upper T Baseline dot sigma Subscript upper S Baseline dot sigma Subscript upper T">
  <mrow>
    <msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub>
    <mo>=</mo>
    <msub><mi>ρ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub>
    <mo>·</mo>
    <msub><mi>σ</mi> <mi>S</mi> </msub>
    <mo>·</mo>
    <msub><mi>σ</mi> <mi>T</mi> </msub>
  </mrow>
</math> such that</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column mu Subscript upper T 2nd Column equals 3rd Column i plus StartFraction sigma Subscript upper S upper T Baseline Over sigma Subscript upper S Superscript 2 Baseline EndFraction dot left-parenthesis mu Subscript upper S Baseline minus i right-parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column i plus beta Subscript upper T Baseline dot left-parenthesis mu Subscript upper S Baseline minus i right-parenthesis EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <msub><mi>μ</mi> <mi>T</mi> </msub>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>i</mi>
          <mo>+</mo>
          <mfrac><msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub> <msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup></mfrac>
          <mo>·</mo>
          <mrow>
            <mo>(</mo>
            <msub><mi>μ</mi> <mi>S</mi> </msub>
            <mo>-</mo>
            <mi>i</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd/>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>i</mi>
          <mo>+</mo>
          <msub><mi>β</mi> <mi>T</mi> </msub>
          <mo>·</mo>
          <mrow>
            <mo>(</mo>
            <msub><mi>μ</mi> <mi>S</mi> </msub>
            <mo>-</mo>
            <mi>i</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">with</p>
<div data-type="equation" class="calibre42">
<math alttext="beta Subscript upper T Baseline identical-to StartFraction sigma Subscript upper S upper T Baseline Over sigma Subscript upper S Superscript 2 Baseline EndFraction" display="block">
  <mrow>
    <msub><mi>β</mi> <mi>T</mi> </msub>
    <mo>≡</mo>
    <mfrac><msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub> <msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup></mfrac>
  </mrow>
</math>
</div>

<p class="author1">This gives the famous CAPM linear relationship between the expected rate of return of the market portfolio and the expected return of the financial asset <math alttext="upper T">
  <mi>T</mi>
</math>—or any other financial asset to this end. In that sense, the CAPM states that the rate of return for any financial asset is only determined by the expected excess return of the market portfolio over the risk-less interest rate and the beta factor, which is the covariance between the two, scaled by the square of the market portfolio volatility (variance of returns).</p>

<p class="author1">For the CAPM, the CML is replaced by<a data-type="indexterm" data-primary="security market line (SML)" id="idm44853700951256" class="calibre6"/><a data-type="indexterm" data-primary="SML (security market line)" id="idm44853700950488" class="calibre6"/> the <em class="calibre7">security market line</em> (SML), which is plotted in beta-return space as follows. A visualization is given in <a data-type="xref" href="#incom_03" class="calibre6">Figure 3-3</a>:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">47</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">beta</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">2</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">25</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO7-1" href="#callout_three_state_economy_CO7-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">48</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">mu</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">i</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">beta</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="p">(</code><code class="n">mu_S</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">i</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO7-2" href="#callout_three_state_economy_CO7-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">49</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">beta</code><code class="p">,</code><code class="calibre22"> </code><code class="n">mu</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">security market line</code><code class="s">'</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO7-3" href="#callout_three_state_economy_CO7-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s">'</code><code class="s">$</code><code class="se">\\</code><code class="s">beta$</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s">'</code><code class="s">$</code><code class="s">\</code><code class="s">mu$</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">ylim</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.25</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO7-4" href="#callout_three_state_economy_CO7-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">mu_S</code><code class="p">,</code><code class="calibre22"> </code><code class="s">'</code><code class="s">ro</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">market portfolio</code><code class="s">'</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_three_state_economy_CO7-5" href="#callout_three_state_economy_CO7-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">loc</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO7-1" href="#co_three_state_economy_CO7-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Generates an <code class="calibre22">ndarray</code> object with the <code class="calibre22">beta</code> values.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO7-2" href="#co_three_state_economy_CO7-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Calculates the expected returns <code class="calibre22">mu</code> according to the CAPM.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO7-3" href="#co_three_state_economy_CO7-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Plots the <code class="calibre22">beta-mu</code> combinations.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO7-4" href="#co_three_state_economy_CO7-4"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Adjusts the limits for the <code class="calibre22">y</code> axis.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_three_state_economy_CO7-5" href="#co_three_state_economy_CO7-5"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Plots the beta and expected return of the market portfolio.</p></dd>
</dl>

<figure class="calibre50"><div id="incom_03" class="figure">
<img src="Images/ftwp_0303.png" alt="ftwp 0303" class="calibre63"/>
<h6 class="calibre52"><span class="firstname">Figure 3-3. </span>Security market line</h6>
</div></figure>

<p class="author1">But why do the preceding relationships—and in particular the CAPM formula—hold true in the first place? To answer this question, consider a portfolio with normalized weight of 1 or 100% of which a proportion <math alttext="a">
  <mi>a</mi>
</math> is invested in financial asset <math alttext="upper T">
  <mi>T</mi>
</math> and the remainder <math alttext="1 minus a">
  <mrow>
    <mn>1</mn>
    <mo>-</mo>
    <mi>a</mi>
  </mrow>
</math> is invested in the market portfolio. The expected rate of return of this portfolio is:</p>
<div data-type="equation" class="calibre42">
<math alttext="mu left-parenthesis a right-parenthesis equals a dot mu Subscript upper T Baseline plus left-parenthesis 1 minus a right-parenthesis dot mu Subscript upper S" display="block">
  <mrow>
    <mi>μ</mi>
    <mrow>
      <mo>(</mo>
      <mi>a</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mi>a</mi>
    <mo>·</mo>
    <msub><mi>μ</mi> <mi>T</mi> </msub>
    <mo>+</mo>
    <mrow>
      <mo>(</mo>
      <mn>1</mn>
      <mo>-</mo>
      <mi>a</mi>
      <mo>)</mo>
    </mrow>
    <mo>·</mo>
    <msub><mi>μ</mi> <mi>S</mi> </msub>
  </mrow>
</math>
</div>

<p class="author1">The volatility of the portfolio is (see Sharpe (1964)):</p>
<div data-type="equation" class="calibre42">
<math alttext="sigma left-parenthesis a right-parenthesis equals left-parenthesis a squared dot sigma Subscript upper T Superscript 2 Baseline plus left-parenthesis 1 minus a right-parenthesis squared dot sigma Subscript upper S Superscript 2 Baseline plus 2 dot a dot left-parenthesis 1 minus a right-parenthesis dot sigma Subscript upper S upper T Baseline right-parenthesis Superscript one-half" display="block">
  <mrow>
    <mi>σ</mi>
    <mrow>
      <mo>(</mo>
      <mi>a</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mfenced separators="" open="(" close=")"><msup><mi>a</mi> <mn>2</mn> </msup><mo>·</mo><msubsup><mi>σ</mi> <mi>T</mi> <mn>2</mn> </msubsup><mo>+</mo><msup><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>a</mi><mo>)</mo></mrow> <mn>2</mn> </msup><mo>·</mo><msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup><mo>+</mo><mn>2</mn><mo>·</mo><mi>a</mi><mo>·</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>a</mi><mo>)</mo></mrow><mo>·</mo><msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub></mfenced> <mfrac><mn>1</mn> <mn>2</mn></mfrac> </msup>
  </mrow>
</math>
</div>

<p class="author1">The marginal change in the expected portfolio rate of return, given a marginal change in the allocation of the financial asset <math alttext="upper T">
  <mi>T</mi>
</math>, is determined by the following partial 
<span class="firstname">derivative</span>:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartFraction normal partial-differential mu Over normal partial-differential a EndFraction equals mu Subscript upper T Baseline minus mu Subscript upper S" display="block">
  <mrow>
    <mfrac><mrow><mi>∂</mi><mi>μ</mi></mrow> <mrow><mi>∂</mi><mi>a</mi></mrow></mfrac>
    <mo>=</mo>
    <msub><mi>μ</mi> <mi>T</mi> </msub>
    <mo>-</mo>
    <msub><mi>μ</mi> <mi>S</mi> </msub>
  </mrow>
</math>
</div>

<p class="author1">The marginal change in the portfolio volatility, given a marginal change in the allocation of the financial asset <math alttext="upper T">
  <mi>T</mi>
</math>, is determined by the following partial derivative:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartFraction normal partial-differential sigma Over normal partial-differential a EndFraction equals StartFraction a dot sigma Subscript upper T Superscript 2 Baseline minus sigma Subscript upper S Superscript 2 Baseline plus a dot sigma Subscript upper S Superscript 2 Baseline plus sigma Subscript upper S upper T Baseline minus 2 dot a dot sigma Subscript upper S upper T Baseline Over StartRoot a squared dot sigma Subscript upper T Superscript 2 Baseline plus left-parenthesis 1 minus a right-parenthesis squared dot sigma Subscript upper S Superscript 2 Baseline plus 2 dot a dot left-parenthesis 1 minus a right-parenthesis dot sigma Subscript upper S upper T Baseline EndRoot EndFraction" display="block">
  <mrow>
    <mfrac><mrow><mi>∂</mi><mi>σ</mi></mrow> <mrow><mi>∂</mi><mi>a</mi></mrow></mfrac>
    <mo>=</mo>
    <mfrac><mrow><mi>a</mi><mo>·</mo><msubsup><mi>σ</mi> <mi>T</mi> <mn>2</mn> </msubsup><mo>-</mo><msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup><mo>+</mo><mi>a</mi><mo>·</mo><msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup><mo>+</mo><msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub><mo>-</mo><mn>2</mn><mo>·</mo><mi>a</mi><mo>·</mo><msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub></mrow> <msqrt><mrow><msup><mi>a</mi> <mn>2</mn> </msup><mo>·</mo><msubsup><mi>σ</mi> <mi>T</mi> <mn>2</mn> </msubsup><mo>+</mo><msup><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>a</mi><mo>)</mo></mrow> <mn>2</mn> </msup><mo>·</mo><msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup><mo>+</mo><mn>2</mn><mo>·</mo><mi>a</mi><mo>·</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>a</mi><mo>)</mo></mrow><mo>·</mo><msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub></mrow></msqrt></mfrac>
  </mrow>
</math>
</div>

<p class="author1">The basic insight of the CAPM <a data-type="indexterm" data-primary="equilibrium model, CAPM as" id="idm44853700661416" class="calibre6"/>as an <em class="calibre7">equilibrium model</em> is that the financial asset <math alttext="upper T">
  <mi>T</mi>
</math> is already part of the market portfolio. Therefore, <math alttext="a">
  <mi>a</mi>
</math> can only be interpreted as<a data-type="indexterm" data-primary="excess demand" id="idm44853700657848" class="calibre6"/> the <em class="calibre7">excess demand</em> for the financial asset, and in equilibrium when excess demand for all financial assets <em class="calibre7">is zero</em>, <math alttext="a">
  <mi>a</mi>
</math> also must equal zero. Therefore, in equilibrium, the partial derivative for the expected portfolio rate of return remains unchanged, while the one for the portfolio volatility simplifies significantly when evaluated at the equilibrium point <math alttext="a equals 0">
  <mrow>
    <mi>a</mi>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math>:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column StartFraction normal partial-differential sigma Over normal partial-differential a EndFraction vertical-bar Subscript a equals 0 2nd Column equals 3rd Column one-half sigma Subscript upper S dot left-parenthesis negative 2 dot sigma Subscript upper S Superscript 2 Baseline plus 2 dot sigma Subscript upper S upper T Baseline right-parenthesis 2nd Row 1st Column Blank 2nd Column equals 3rd Column sigma Subscript upper S Baseline dot sigma Subscript upper S upper T minus sigma Subscript upper S Baseline dot sigma Subscript upper S Superscript 2 3rd Row 1st Column Blank 2nd Column equals 3rd Column StartFraction sigma Subscript upper S upper T Baseline minus sigma Subscript upper S Superscript 2 Baseline Over sigma Subscript upper S Baseline EndFraction EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <msub><mfenced separators="" open="" close="|"><mfrac><mrow><mi>∂</mi><mi>σ</mi></mrow> <mrow><mi>∂</mi><mi>a</mi></mrow></mfrac></mfenced> <mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow> </msub>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mfrac><mn>1</mn> <mn>2</mn></mfrac>
          <msub><mi>σ</mi> <mi>S</mi> </msub>
          <mo>·</mo>
          <mfenced separators="" open="(" close=")">
            <mo>-</mo>
            <mn>2</mn>
            <mo>·</mo>
            <msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup>
            <mo>+</mo>
            <mn>2</mn>
            <mo>·</mo>
            <msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub>
          </mfenced>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd/>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <msub><mi>σ</mi> <mi>S</mi> </msub>
          <mo>·</mo>
          <msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub>
          <mo>-</mo>
          <msub><mi>σ</mi> <mi>S</mi> </msub>
          <mo>·</mo>
          <msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd/>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mfrac><mrow><msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub><mo>-</mo><msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup></mrow> <msub><mi>σ</mi> <mi>S</mi> </msub></mfrac>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">The <em class="calibre7">risk-return trade-off</em> in <a data-type="indexterm" data-primary="risk-return trade-off in market equilibrium" id="idm44853700614936" class="calibre6"/>market equilibrium therefore is:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column StartStartFraction StartFraction normal partial-differential mu Over normal partial-differential a EndFraction OverOver StartFraction normal partial-differential sigma Over normal partial-differential a EndFraction EndEndFraction vertical-bar Subscript a equals 0 2nd Column equals 3rd Column StartStartFraction mu Subscript upper T Baseline minus mu Subscript upper S Baseline OverOver StartFraction sigma Subscript upper S upper T Baseline minus sigma Subscript upper S Superscript 2 Baseline Over sigma Subscript upper S Baseline EndFraction EndEndFraction EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <msub><mfenced separators="" open="" close="|"><mfrac><mfrac><mrow><mi>∂</mi><mi>μ</mi></mrow> <mrow><mi>∂</mi><mi>a</mi></mrow></mfrac> <mfrac><mrow><mi>∂</mi><mi>σ</mi></mrow> <mrow><mi>∂</mi><mi>a</mi></mrow></mfrac></mfrac></mfenced> <mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow> </msub>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mfrac><mrow><msub><mi>μ</mi> <mi>T</mi> </msub><mo>-</mo><msub><mi>μ</mi> <mi>S</mi> </msub></mrow> <mfrac><mrow><msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub><mo>-</mo><msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup></mrow> <msub><mi>σ</mi> <mi>S</mi> </msub></mfrac></mfrac>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">The final insight needed to derive the preceding <em class="calibre7">CAPM formula</em> is that in equilibrium, the previous term needs to be equal to the slope of the CML:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column StartStartFraction mu Subscript upper T Baseline minus mu Subscript upper S Baseline OverOver StartFraction sigma Subscript upper S upper T Baseline minus sigma Subscript upper S Superscript 2 Baseline Over sigma Subscript upper S Baseline EndFraction EndEndFraction 2nd Column equals 3rd Column StartFraction mu Subscript upper S Baseline minus i Over sigma Subscript upper S Baseline EndFraction 2nd Row 1st Column mu Subscript upper T Baseline 2nd Column equals 3rd Column i plus StartFraction sigma Subscript upper S upper T Baseline Over sigma Subscript upper S Superscript 2 Baseline EndFraction dot left-parenthesis mu Subscript upper S Baseline minus i right-parenthesis 3rd Row 1st Column Blank 2nd Column equals 3rd Column i plus beta Subscript upper T Baseline dot left-parenthesis mu Subscript upper S Baseline minus i right-parenthesis EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mfrac><mrow><msub><mi>μ</mi> <mi>T</mi> </msub><mo>-</mo><msub><mi>μ</mi> <mi>S</mi> </msub></mrow> <mfrac><mrow><msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub><mo>-</mo><msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup></mrow> <msub><mi>σ</mi> <mi>S</mi> </msub></mfrac></mfrac>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mfrac><mrow><msub><mi>μ</mi> <mi>S</mi> </msub><mo>-</mo><mi>i</mi></mrow> <msub><mi>σ</mi> <mi>S</mi> </msub></mfrac>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msub><mi>μ</mi> <mi>T</mi> </msub>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>i</mi>
          <mo>+</mo>
          <mfrac><msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub> <msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup></mfrac>
          <mo>·</mo>
          <mrow>
            <mo>(</mo>
            <msub><mi>μ</mi> <mi>S</mi> </msub>
            <mo>-</mo>
            <mi>i</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd/>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>i</mi>
          <mo>+</mo>
          <msub><mi>β</mi> <mi>T</mi> </msub>
          <mo>·</mo>
          <mrow>
            <mo>(</mo>
            <msub><mi>μ</mi> <mi>S</mi> </msub>
            <mo>-</mo>
            <mi>i</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">How does the CAPM help in pricing a financial asset that is not replicable? Given the vector of uncertain prices in one year of a financial asset <math alttext="upper T 1">
  <msub><mi>T</mi> <mn>1</mn> </msub>
</math>, the uncertain rates of return are</p>
<div data-type="equation" class="calibre42">
<math alttext="r Superscript upper T Baseline equals StartFraction upper T 1 minus upper T 0 Over upper T 0 EndFraction" display="block">
  <mrow>
    <msup><mi>r</mi> <mi>T</mi> </msup>
    <mo>=</mo>
    <mfrac><mrow><msub><mi>T</mi> <mn>1</mn> </msub><mo>-</mo><msub><mi>T</mi> <mn>0</mn> </msub></mrow> <msub><mi>T</mi> <mn>0</mn> </msub></mfrac>
  </mrow>
</math>
</div>

<p class="author1">where <math alttext="upper T 0">
  <msub><mi>T</mi> <mn>0</mn> </msub>
</math> is the equilibrium price today to be determined. The following relationship holds as well:</p>
<div data-type="equation" class="calibre42">
<math alttext="mu Subscript upper T Baseline equals StartFraction bold upper E Superscript upper P Baseline left-parenthesis upper T 1 right-parenthesis minus upper T 0 Over upper T 0 EndFraction" display="block">
  <mrow>
    <msub><mi>μ</mi> <mi>T</mi> </msub>
    <mo>=</mo>
    <mfrac><mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mrow><mo>(</mo><msub><mi>T</mi> <mn>1</mn> </msub><mo>)</mo></mrow><mo>-</mo><msub><mi>T</mi> <mn>0</mn> </msub></mrow> <msub><mi>T</mi> <mn>0</mn> </msub></mfrac>
  </mrow>
</math>
</div>

<p class="author1">Define now <a data-type="indexterm" data-primary="unit price of risk" id="idm44853700533656" class="calibre6"/>the <em class="calibre7">unit price of risk</em> as the excess return of the market portfolio per unit of variance by</p>
<div data-type="equation" class="calibre42">
<math alttext="lamda equals StartFraction mu Subscript upper S Baseline minus i Over sigma Subscript upper S Superscript 2 Baseline EndFraction" display="block">
  <mrow>
    <mi>λ</mi>
    <mo>=</mo>
    <mfrac><mrow><msub><mi>μ</mi> <mi>S</mi> </msub><mo>-</mo><mi>i</mi></mrow> <msubsup><mi>σ</mi> <mi>S</mi> <mn>2</mn> </msubsup></mfrac>
  </mrow>
</math>
</div>

<p class="author1">such that according to the CAPM, one gets</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column mu Subscript upper T 2nd Column equals 3rd Column i plus lamda dot sigma Subscript upper S upper T EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <msub><mi>μ</mi> <mi>T</mi> </msub>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>i</mi>
          <mo>+</mo>
          <mi>λ</mi>
          <mo>·</mo>
          <msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">This shows that in equilibrium the expected rate of return of a financial asset is determined only by its covariance with the market portfolio. Equating this with the preceding term for the expected return of the financial asset <math alttext="upper T">
  <mi>T</mi>
</math> yields</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column StartFraction bold upper E Superscript upper P Baseline left-parenthesis upper T 1 right-parenthesis minus upper T 0 Over upper T 0 EndFraction 2nd Column equals 3rd Column i plus lamda dot sigma Subscript upper S upper T 2nd Row 1st Column upper T 0 2nd Column equals 3rd Column StartFraction bold upper E Superscript upper P Baseline left-parenthesis upper T 1 right-parenthesis Over 1 plus i plus lamda dot sigma Subscript upper S upper T Baseline EndFraction EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mfrac><mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mrow><mo>(</mo><msub><mi>T</mi> <mn>1</mn> </msub><mo>)</mo></mrow><mo>-</mo><msub><mi>T</mi> <mn>0</mn> </msub></mrow> <msub><mi>T</mi> <mn>0</mn> </msub></mfrac>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>i</mi>
          <mo>+</mo>
          <mi>λ</mi>
          <mo>·</mo>
          <msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msub><mi>T</mi> <mn>0</mn> </msub>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mfrac><mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mrow><mo>(</mo><msub><mi>T</mi> <mn>1</mn> </msub><mo>)</mo></mrow></mrow> <mrow><mn>1</mn><mo>+</mo><mi>i</mi><mo>+</mo><mi>λ</mi><mo>·</mo><msub><mi>σ</mi> <mrow><mi>S</mi><mi>T</mi></mrow> </msub></mrow></mfrac>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">The denominator can be thought of as <a data-type="indexterm" data-primary="model economies" data-secondary="three-state" data-tertiary="CAPM (capital asset pricing model)" data-startref="model-three-state-capm" id="idm44853700487160" class="calibre6"/><a data-type="indexterm" data-primary="three-state model economy" data-secondary="CAPM (capital asset pricing model)" data-startref="three-state-capm" id="idm44853700485720" class="calibre6"/><a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="CAPM (capital asset pricing model)" data-startref="asset-capm" id="idm44853700484472" class="calibre6"/><a data-type="indexterm" data-primary="CAPM (capital asset pricing model)" data-startref="capm" id="idm44853700482968" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="CAPM (capital asset pricing model)" data-startref="financial-assets-capm" id="idm44853700482008" class="calibre6"/><a data-type="indexterm" data-primary="risk-adjusted discount factors" id="idm44853700480776" class="calibre6"/>a <em class="calibre7">risk-adjusted discount factor</em>.</p>
<div data-type="warning" epub:type="warning" class="calibre28"><h1 class="calibre49">MVP, CAPM, and Market Completeness</h1>
<p class="author1">Both MVP and<a data-type="indexterm" data-primary="MVP (mean-variance portfolio) theory" id="idm44853700478232" class="calibre6"/><a data-type="indexterm" data-primary="mean-variance portfolio (MVP) theory" id="idm44853700477432" class="calibre6"/><a data-type="indexterm" data-primary="complete market model" data-secondary="MVP and CAPM and" id="idm44853700476744" class="calibre6"/><a data-type="indexterm" data-primary="market completeness" data-secondary="MVP and CAPM and" id="idm44853700475800" class="calibre6"/> the CAPM rely on high-level statistics only, such as expectation, volatility, and covariance. When replicating contingent claims, for example, every single payoff in every possible future state plays an important role—with the demonstrated consequences resulting from market incompleteness. In MVP and CAPM contexts, it is (implicitly) assumed that investors only care about aggregate statistics and not really about every single state.</p>

<p class="author1">Consider the example of two financial assets with the same initial prices under an equal probability measure, one paying 20 currency units in one state and nothing in the others, and the other one paying 20 currency units in a different state as the other financial asset and nothing else. Both financial assets have the same risk-return characteristics. However, an agent might strongly prefer one over the other—independent of the fact that their aggregate statistics are the same. Focusing on risk and return is often a convenient simplification but not always an appropriate one.</p>
</div>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Conclusions" class="calibre4"><div class="preface" id="idm44853701074504">
<h1 class="calibre17">Conclusions</h1>

<p class="author1">The major topic of this chapter is incomplete financial markets. Moving from a two-state model economy to one with three states and keeping the number of traded financial assets constant at two, immediately results in market incompleteness. This in turn implies that contingent claims are in general not perfectly replicable by portfolios composed of the risk-less bond and the risky stock.</p>

<p class="author1">However, payoffs of contingent claims can be super-replicated if they must be met or surpassed under all circumstances. While there are in general infinitely many such super-replication portfolios, it is generally required that the cost-minimizing portfolio be chosen. If there is a bit more flexibility, the payoffs of contingent claims that are not attainable can also be approximated. In this context, the replication problem is replaced by an optimization problem, according to which the mean squared error of the replication portfolio is minimized. Mathematically, this boils down to a linear OLS regression problem.</p>

<p class="author1">The CAPM is based on equilibrium pricing arguments to derive expected rates of return and also prices for traded financial assets given their risk-return characteristics in the mean-volatility space. A central role is played by the correlation and the covariance of a financial asset with the market portfolio, which is assumed to contain the financial asset itself.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Further Resources" class="calibre4"><div class="preface" id="idm44853700470424">
<h1 class="calibre17">Further Resources</h1>

<p class="author1">Articles and books cited in this chapter:</p>

<ul class="printings">
<li class="calibre54">
<p class="author1">Pliska, Stanley. 1997. <em class="calibre7">Introduction to Mathematical Finance.</em> Malden and Oxford: Blackwell Publishers.</p>
</li>
<li class="calibre54">
<p class="author1">Sharpe, William. 1964. “Capital Asset Prices: A Theory of Market Equilibrium under Conditions of Risk.” <em class="calibre7">The Journal of Finance</em> 19 (3): 425–442.</p>
</li>
</ul>
</div></section>







<div data-type="footnotes" class="calibre30"><p data-type="footnote" id="idm44853701345560" class="calibre31"><sup class="calibre32"><a href="ch03.xhtml#idm44853701345560-marker" class="calibre15">1</a></sup> Note that this calculation for the volatility is only valid since an equal probability is assumed for the three states.</p></div></div></section></div></body></html>