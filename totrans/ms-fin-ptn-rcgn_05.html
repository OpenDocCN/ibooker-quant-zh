<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Chapter 5. Modern Trend-Following Patterns" data-type="chapter" epub:type="chapter"><div class="chapter" id="chapter5">
<h1><span class="label">Chapter 5. </span>Modern Trend-Following Patterns</h1>
<p>Continuing<a contenteditable="false" data-primary="modern trend-following patterns" data-type="indexterm" id="ix_mod_trend_follow_ch5"/> with the trend-following concept, this chapter reveals new patterns that are not part of the classic ones. I refer to these new patterns as <em>modern </em>since they are personal discoveries that I use in my analyses.</p>
<p>The aim remains the same, which is to create objective conditions and back-test them so that you form an opinion about their frequency and predictability. The important thing to remember is that a pattern’s predictability is quite random from one market to the other, meaning that what works on GBPUSD may not work on EURGBP as every market has different statistical and technical properties.</p>
<p>Therefore, the main assumption I am making is that modern patterns are neither better nor worse than classic patterns; they are simply a diversification tool that  allows you to get more confirmation in the analyses. This means that if you see at least two or three patterns (classic or modern) emerging around the same time, you should have a better conviction to take the trade. Let’s now get started with these new patterns and explore their intuition and code.</p>
<section data-pdf-bookmark="The Quintuplets Pattern" data-type="sect1"><div class="sect1" id="idm46762868474560">
<h1>The Quintuplets Pattern</h1>
<p>The <em>Quintuplets</em> pattern<a contenteditable="false" data-primary="Quintuplets pattern" data-type="indexterm" id="ix_quintuplet_patt_ch5"/><a contenteditable="false" data-primary="trend-following patterns" data-secondary="Quintuplets pattern" data-type="indexterm" id="ix_trend_patt_quint"/><a contenteditable="false" data-primary="modern trend-following patterns" data-secondary="Quintuplets pattern" data-type="indexterm" id="ix_mod_trend_quintuplet"/><a contenteditable="false" data-primary="failure of reaction, Quintuplets pattern" data-type="indexterm" id="idm46762868412432"/><a contenteditable="false" data-primary="herding bias" data-type="indexterm" id="idm46762868411360"/><a contenteditable="false" data-primary="biases" data-secondary="herding" data-type="indexterm" id="idm46762868410256"/> is a multicandlestick configuration that confirms the underlying trend. This pattern was born out of the psychology of herding as well as the failure of reaction,<sup><a data-type="noteref" href="ch05.xhtml#idm46762868430992" id="idm46762868430992-marker">1</a></sup> which gives it the extra push to continue in the same direction. It is characterized by having five successive small candles of the same type. The pattern relies on the gradual upward drift event where the market seems to be overvalued or overbought but remains unscathed and continues upward.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>This type of pattern is typically seen in markets after an impactful event where the price action remains in a low-volatility environment but a clear trend can be seen. An example of this would be USDTRY<sup><a data-type="noteref" href="ch05.xhtml#idm46762868428896" id="idm46762868428896-marker">2</a></sup> at the end of December 2021. Turkish president Recep Tayyip Erdoğan shook the markets with his statements on inflation and interest rates, which caused huge volatility, but then a deterministic form of indecision occurred where the USD steadily rose versus the TRY.</p>
</div>
<p><a data-type="xref" href="#figure5-1">Figure 5-1</a> illustrates a bullish Quintuplets pattern.</p>
<figure><div class="figure" id="figure5-1">
<p>​​<img alt="" height="204" src="assets/mfpr_0501.png" width="600"/></p>
<h6><span class="label">Figure 5-1. </span>A bullish Quintuplets pattern</h6>
</div></figure>
<p>The Quintuplets pattern occurs when volatility slows down, as evidenced by the small-bodied bullish candles. <a data-type="xref" href="#figure5-2">Figure 5-2</a> shows a bearish Quintuplets pattern.</p>
<figure><div class="figure" id="figure5-2">
<p>​​<img alt="" height="204" src="assets/mfpr_0502.png" width="600"/></p>
<h6><span class="label">Figure 5-2. </span>A bearish Quintuplets pattern</h6>
</div></figure>
<p>The difference<a contenteditable="false" data-primary="volatility clustering" data-type="indexterm" id="idm46762868577008"/> between the Three Candles pattern discussed in <a data-type="xref" href="ch04.xhtml#chapter4">Chapter 4</a> and the Quintuplets pattern is the number of candlesticks and their size. The former assumes that big moves are followed by big moves, while the latter assumes that slow and gradual moves are followed by slow and gradual moves as well. (This is in tandem with the volatility-clustering event in the financial markets. <em>Volatility clustering</em> is the persistence of volatility through time where low volatility is generally followed by low volatility while high volatility is followed by high volatility.)</p>
<p>Hence, both patterns point to the same direction but deal with different market <span class="keep-together">properties</span>.</p>
<p>Detecting the Quintuplets pattern is easy, but the pattern can be uncommon since you have many conditions to fulfill. Algorithmically, the conditions need to be as <span class="keep-together">follows</span>:</p>
<ul>
<li>If the latest five close prices are each greater than their open prices, as well as the close prices preceding them, and each candlestick respects a maximum body size, then print 1 in the next buy row.</li>
<li>If the latest five close prices are each lower than their open prices, as well as the close prices preceding them, and each candlestick respects a maximum body size, then print −1 in the next sell row.</li>
</ul>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Remember, the Quintuplets pattern is composed of five small candles. Therefore, you need to code the condition that they must have a maximum size.</p>
</div>
<p>The job now is to code the signal function as follows:</p>
<pre data-code-language="python" data-executable="true" data-type="programlisting">
<code class="k">def</code><code> </code><code class="nf">signal</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">,</code><code> </code><code class="n">buy_column</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">)</code><code class="p">:</code><code>
</code><code>
</code><code>    </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">add_column</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">)</code><code>    </code><code>
</code><code>    </code><code>
</code><code>    </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">data</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>    </code><code>
</code><code>
</code><code>       </code><code class="k">try</code><code class="p">:</code><code>
</code><code>        </code><code>
</code><code>     </code><strong><code>      </code><code class="c1"># Bullish pattern</code></strong><code>
</code><code>           </code><code class="k">if</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&gt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&gt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">-</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">body</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&gt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&gt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">-</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">body</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&gt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&gt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">-</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">body</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&gt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&gt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">-</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">body</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&gt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">-</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">body</code><code> </code><code class="ow">and</code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">buy_column</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="mi">0</code><code class="p">:</code><code>
</code><code>                  </code><code>
</code><code>                    </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">4</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">1</code><code> </code><code>
</code><code>                    </code><code>
</code><strong><code>           </code><code class="c1"># Bearish pattern</code></strong><code>
</code><code>           </code><code class="k">elif</code><code>  </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code class="o">-</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">body</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code class="o">-</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">body</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code class="o">-</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">body</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code class="o">-</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">body</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code class="o">-</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="o">-</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code class="o">&lt;</code><code class="n">body</code><code> </code><code class="ow">and</code><code>\
</code><code>                 </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="mi">0</code><code class="p">:</code><code>
</code><code>                  </code><code>
</code><code>                    </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="o">-</code><code class="mi">1</code><code> </code><code>
</code><code>
</code><code>       </code><code class="k">except</code><code> </code><code class="ne">IndexError</code><code class="p">:</code><code>
</code><code>            </code><code>
</code><code>            </code><code class="k">pass</code><code>
</code><code>              </code><code>
</code><code>    </code><code class="k">return</code><code> </code><code class="n">data</code><code>
</code></pre>
<p>Similar to the Three Candles pattern, <a data-type="xref" href="#table5-1">Table 5-1</a> shows the default values for the variable <code>body</code> when using the hourly time frame.</p>
<table id="table5-1">
<caption><span class="label">Table 5-1. </span>Quintuplets pattern: candle size choice</caption>
<thead>
<tr>
<th>
<p>Asset</p>
</th>
<th>
<p>Body</p>
</th>
<th>
<p>Type</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>EURUSD</p>
</td>
<td>
<p>0.0005</p>
</td>
<td>
<p>Pip</p>
</td>
</tr>
<tr>
<td>
<p>USDCHF</p>
</td>
<td>
<p>0.0005</p>
</td>
<td>
<p>Pip</p>
</td>
</tr>
<tr>
<td>
<p>GBPUSD</p>
</td>
<td>
<p>0.0005</p>
</td>
<td>
<p>Pip</p>
</td>
</tr>
<tr>
<td>
<p>USDCAD</p>
</td>
<td>
<p>0.0005</p>
</td>
<td>
<p>Pip</p>
</td>
</tr>
<tr>
<td>
<p>BTCUSD</p>
</td>
<td>
<p>50</p>
</td>
<td>
<p>USD</p>
</td>
</tr>
<tr>
<td>
<p>ETHUSD</p>
</td>
<td>
<p>10</p>
</td>
<td>
<p>USD</p>
</td>
</tr>
<tr>
<td>
<p>GOLD</p>
</td>
<td>
<p>2</p>
</td>
<td>
<p>USD</p>
</td>
</tr>
<tr>
<td>
<p>S&amp;P500</p>
</td>
<td>
<p>10</p>
</td>
<td>
<p>Points</p>
</td>
</tr>
<tr>
<td>
<p>FTSE100</p>
</td>
<td>
<p>10</p>
</td>
<td>
<p>Points</p>
</td>
</tr>
</tbody>
</table>
<p class="pagebreak-before"><a data-type="xref" href="#figure5-3">Figure 5-3</a> shows the trades generated on ETHUSD following the signals given by the function. The Quintuplets are validated at the close, which is why the signals are given on the open of the next candlestick.</p>
<figure><div class="figure" id="figure5-3">
<p>​<img alt="" height="434" src="assets/mfpr_0503.png" width="600"/></p>
<h6><span class="label">Figure 5-3. </span>Signal chart on ETHUSD</h6>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>The upward-pointing arrows refer to bullish signals generated on the open of the candlestick, whereas the downward-pointing arrows refer to bearish signals also generated on the open of the candlestick.</p>
</div>
<p><a data-type="xref" href="#figure5-4">Figure 5-4</a> shows another example of the signals silver. You can see that whenever the conditions remain valid, you may get successive Quintuplets, but it does not necessarily say anything about the reinforcement of the conviction for a trend <span class="keep-together">continuation</span>.</p>
<figure><div class="figure" id="figure5-4"><img alt="" height="418" src="assets/mfpr_0504.png" width="600"/>
<h6><span class="label">Figure 5-4. </span>Signal chart on silver</h6>
</div></figure>
<p><a data-type="xref" href="#table5-2">Table 5-2</a> summarizes the performance of the Quintuplets pattern.</p>
<table id="table5-2">
<caption><span class="label">Table 5-2. </span>Quintuplets pattern: performance summary table</caption>
<thead>
<tr>
<th>
<p>Asset</p>
</th>
<th>
<p>Hit Ratio</p>
</th>
<th>
<p>Profit Factor</p>
</th>
<th>
<p>Risk-Reward Ratio</p>
</th>
<th>
<p>Signals</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>EURUSD</p>
</td>
<td>
<p>55.21%</p>
</td>
<td>
<p>0.93</p>
</td>
<td>
<p>0.76</p>
</td>
<td>
<p>2032</p>
</td>
</tr>
<tr>
<td>
<p>USDCHF</p>
</td>
<td>
<p>57.28%</p>
</td>
<td>
<p>0.98</p>
</td>
<td>
<p>0.73</p>
</td>
<td>
<p>2004</p>
</td>
</tr>
<tr>
<td>
<p>GBPUSD</p>
</td>
<td>
<p>58.08%</p>
</td>
<td>
<p>1.06</p>
</td>
<td>
<p>0.76</p>
</td>
<td>
<p>2052</p>
</td>
</tr>
<tr>
<td>
<p>USDCAD</p>
</td>
<td>
<p>59.04%</p>
</td>
<td>
<p>1.04</p>
</td>
<td>
<p>0.72</p>
</td>
<td>
<p>2146</p>
</td>
</tr>
<tr>
<td>
<p>BTCUSD</p>
</td>
<td>
<p>57.49%</p>
</td>
<td>
<p>1.09</p>
</td>
<td>
<p>0.81</p>
</td>
<td>
<p>854</p>
</td>
</tr>
<tr>
<td>
<p>ETHUSD</p>
</td>
<td>
<p>58.25%</p>
</td>
<td>
<p>0.93</p>
</td>
<td>
<p>0.67</p>
</td>
<td>
<p>800</p>
</td>
</tr>
<tr>
<td>
<p>GOLD</p>
</td>
<td>
<p>57.93%</p>
</td>
<td>
<p>1.16</p>
</td>
<td>
<p>0.84</p>
</td>
<td>
<p>1883</p>
</td>
</tr>
<tr>
<td>
<p>S&amp;P500</p>
</td>
<td>
<p>59.44%</p>
</td>
<td>
<p>1.12</p>
</td>
<td>
<p>0.77</p>
</td>
<td>
<p>217</p>
</td>
</tr>
<tr>
<td>
<p>FTSE100</p>
</td>
<td>
<p>58.96%</p>
</td>
<td>
<p>1.05</p>
</td>
<td>
<p>0.73</p>
</td>
<td>
<p>212</p>
</td>
</tr>
</tbody>
</table>
<p>The results are mixed and close to breakeven on multiple markets when accounting for the realized risk-reward ratio. Remember from <a data-type="xref" href="ch02.xhtml#performance-evaluation">“Coding Performance Evaluation Functions”</a>, the hit ratio does not mean anything without the realized risk-reward ratio. This is why a 57.28% hit ratio on the USDCHF is not impressive since you are risking $1 to gain $0.76 in every trade. This is also seen through a profit factor that is less than 1.00.</p>
<p>The main conclusion is that the Quintuplets pattern should be used in combination with other techniques while optimizing entries and exits so as to obtain better metrics<a contenteditable="false" data-primary="" data-startref="ix_trend_patt_quint" data-type="indexterm" id="idm46762867295056"/><a contenteditable="false" data-primary="" data-startref="ix_mod_trend_quintuplet" data-type="indexterm" id="idm46762867293680"/><a contenteditable="false" data-primary="" data-startref="ix_quintuplet_patt_ch5" data-type="indexterm" id="idm46762867292304"/>.</p>
</div></section>
<section data-pdf-bookmark="The Double Trouble Pattern" data-type="sect1"><div class="sect1" id="idm46762868516752">
<h1>The Double Trouble Pattern</h1>
<p>The <em>Double Trouble</em> pattern<a contenteditable="false" data-primary="modern trend-following patterns" data-secondary="Double Trouble pattern" data-type="indexterm" id="ix_mod_trend_double_trouble"/><a contenteditable="false" data-primary="trend-following patterns" data-secondary="Double Trouble pattern" data-type="indexterm" id="ix_trend_double_trouble"/><a contenteditable="false" data-primary="volatility" data-secondary="ATR indicator" data-type="indexterm" id="idm46762867319424"/><a contenteditable="false" data-primary="Double Trouble pattern" data-type="indexterm" id="ix_double_trouble_patt_ch5"/><a contenteditable="false" data-primary="average true range (ATR)" data-type="indexterm" id="idm46762868065536"/> uses exogenous variables to be validated, meaning that you borrow information from a volatility indicator called the <em>average true range</em> (ATR) to validate the signal on the pattern.</p>
<p>Let’s first<a contenteditable="false" data-primary="volatility" data-type="indexterm" id="idm46762867326512"/> define the concept of volatility and understand the ATR before introducing the Double Trouble pattern.</p>
<p>Volatility is one of the key concepts in trading and investing as it is directly related to risk and indirectly related to reward. A <em>volatile </em>asset or variable is one that has its returns fluctuate greatly around its mean value.</p>
<p><a data-type="xref" href="#figure5-5">Figure 5-5</a> shows a low-volatility line (the less widely varying one) and a high-volatility line (the wildly swinging one).</p>
<figure><div class="figure" id="figure5-5"><img alt="" height="422" src="assets/mfpr_0505.png" width="600"/>
<h6><span class="label">Figure 5-5. </span>Comparison between high- and low-volatility variables</h6>
</div></figure>
<p>You can code it yourself with the following snippet:</p>
<pre data-code-language="python" data-executable="true" data-type="programlisting">
<strong><code class="c1"># Importing the necessary libraries</code></strong><code>
</code><code class="kn">import</code><code> </code><code class="nn">numpy</code><code> </code><code class="k">as</code><code> </code><code class="nn">np</code><code>
</code><code class="kn">import</code><code> </code><code class="nn">matplotlib</code><code class="nn">.</code><code class="nn">pyplot</code><code> </code><code class="k">as</code><code> </code><code class="nn">plt</code><code>
</code><code>
</code><strong><code class="c1"># Creating high volatility noise</code></strong><code>
</code><code class="n">hv_noise</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">normal</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">250</code><code class="p">)</code><code>
</code><code>
</code><strong><code class="c1"># Creating low volatility noise</code></strong><code>
</code><code class="n">lv_noise</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">normal</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mf">0.1</code><code class="p">,</code><code> </code><code class="mi">250</code><code class="p">)</code><code>
</code><code>
</code><strong><code class="c1"># Plotting</code></strong><code>
</code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">hv_noise</code><code class="p">,</code><code> </code><code class="n">color</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">red</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">High Volatility</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">lv_noise</code><code class="p">,</code><code> </code><code class="n">color</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">blue</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">Low Volatility</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="n">plt</code><code class="o">.</code><code class="n">axhline</code><code class="p">(</code><code class="n">y</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="n">color</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">black</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">linewidth</code><code> </code><code class="o">=</code><code> </code><code class="mi">1</code><code class="p">)</code><code>
</code><code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">(</code><code class="p">)</code><code>
</code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="p">)</code><code>
</code></pre>
<p>I have used a <code>numpy</code> function<a contenteditable="false" data-primary="random.normal() function" data-type="indexterm" id="idm46762870233264"/> called <code>random.normal()</code>, which outputs random samples from a normal distribution. A normal distribution is a probabilistic continuous function with a mean that splits the data in a symmetric way. Data close to the mean tends to occur more frequently than data far from the mean. Visually, normally distributed data looks like a smooth bell with the middle value being the mean.</p>
<p>The different<a contenteditable="false" data-primary="volatility" data-secondary="types of" data-type="indexterm" id="ix_volatility_types"/> types of volatility can be summed up like so:</p>
<dl>
<dt>Historical volatility</dt>
<dd>
<p>This is the realized<a contenteditable="false" data-primary="historical volatility" data-type="indexterm" id="idm46762871489344"/> volatility over a certain period of time. Even though it is backward looking, historical volatility is used more often than not as an expectation of future volatility. One example of a historical measure is the standard deviation.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Before moving on, I want to mention a type of financial instruments called derivatives<a contenteditable="false" data-primary="derivatives" data-type="indexterm" id="idm46762869232784"/><a contenteditable="false" data-primary="forward contract" data-type="indexterm" id="idm46762869231680"/>. <em>Derivatives</em> are products that traders use to trade markets in certain ways. For example, a <em>forward</em> contract is a derivative contract where a buyer locks in a price for an asset to buy it at a later time. A forward contract is an obligation. Another type of derivative is an option<a contenteditable="false" data-primary="option" data-type="indexterm" id="idm46762869229584"/>. An <em>option</em> is the right but not the obligation to buy a certain asset at a specific price in the future by paying a premium now (the option’s price). When a buyer wants to buy the underlying stock, they exercise their option to do so; otherwise, they may let the option expire.</p>
</div>
</dd>
<dt class="pagebreak-before">Implied volatility</dt>
<dd>
<p>In its simplest<a contenteditable="false" data-primary="implied volatility" data-type="indexterm" id="idm46762870941696"/><a contenteditable="false" data-primary="Black-Scholes equation" data-type="indexterm" id="idm46762870940560"/> definition, implied volatility is the measure that, when inputted into the Black-Scholes equation, gives out the option’s market price. (The Black-Scholes equation is a mathematical formula used to price options. The option’s price is the premium a buyer pays to buy the option, which gives them the right to buy a certain asset at a predetermined price before a certain expiration date.) It is the expected future actual volatility. It has one time scale: the option’s expiration date.</p>
</dd>
<dt>Forward volatility</dt>
<dd>
<p>The volatility<a contenteditable="false" data-primary="forward volatility" data-type="indexterm" id="idm46762869326736"/> over a specific period in the future.</p>
</dd>
<dt>Actual volatility</dt>
<dd>
<p>The amount<a contenteditable="false" data-primary="local volatility" data-type="indexterm" id="idm46762869324160"/><a contenteditable="false" data-primary="actual volatility" data-type="indexterm" id="idm46762869323024"/> of volatility at any given time, also known as <em>local volatility</em>. This measure is hard to calculate and has no time scale.</p>
</dd>
</dl>
<p>The most basic type of volatility is the standard deviation<a contenteditable="false" data-primary="variance" data-type="indexterm" id="idm46762869773872"/><a contenteditable="false" data-primary="standard deviation" data-type="indexterm" id="idm46762869772768"/>. It is one of the pillars of descriptive statistics. First, I must explain variance.</p>
<p><em>Variance</em> is a dispersion<a contenteditable="false" data-primary="squared deviations" data-type="indexterm" id="idm46762869770832"/> measure calculated as the squared deviations from the mean. You take the squared deviations, to force the distance from the mean to be non-negative, and then you take the square root of variance, thus turning it into the standard deviation and making the measure have the same units as the mean.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>By squaring the deviations, you are avoiding a negative distance measure, and by taking the square root, you are comparing apples (standard deviation) to apples (mean).</p>
</div>
<p>Variance is therefore calculated through this mathematical formula:</p>
<div data-type="equation">
<math alttext="sigma squared equals StartFraction 1 Over n EndFraction sigma-summation Underscript i equals 1 Overscript n Endscripts left-parenthesis x Subscript i Baseline minus chi right-parenthesis squared">
<mrow>
<msup><mi>σ</mi> <mn>2</mn> </msup>
<mo>=</mo>
<mfrac><mn>1</mn> <mi>n</mi></mfrac>
<msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup>
<msup><mrow><mo>(</mo><msub><mi>x</mi> <mi>i</mi> </msub><mo>-</mo><mi>χ</mi><mo>)</mo></mrow> <mn>2</mn> </msup>
</mrow>
</math>
</div>
<p>Following this logic, standard deviation is therefore as follows:</p>
<div data-type="equation">
<math alttext="sigma equals StartRoot StartFraction 1 Over n EndFraction sigma-summation Underscript i equals 1 Overscript n Endscripts left-parenthesis x Subscript i Baseline minus chi right-parenthesis squared EndRoot">
<mrow>
<mi>σ</mi>
<mo>=</mo>
<msqrt>
<mrow>
<mfrac><mn>1</mn> <mi>n</mi></mfrac>
<msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup>
<msup><mrow><mo>(</mo><msub><mi>x</mi> <mi>i</mi> </msub><mo>-</mo><mi>χ</mi><mo>)</mo></mrow> <mn>2</mn> </msup>
</mrow>
</msqrt>
</mrow>
</math>
</div>
<p>In layperson’s terms, standard deviation is the average distance away from the mean that you expect to find when you analyze every value in the data set.</p>
<p>With the concept<a contenteditable="false" data-primary="average true range (ATR)" data-type="indexterm" id="ix_av_true_rge_atr"/> of volatility in mind, let’s go over the volatility indicator that you must use to find the Double Trouble pattern, the ATR<a contenteditable="false" data-primary="" data-startref="ix_volatility_types" data-type="indexterm" id="idm46762871409248"/>.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>The ATR<a contenteditable="false" data-primary="volatility" data-secondary="ATR indicator" data-type="indexterm" id="ix_volatil_atr"/> is another way to measure volatility. Similar to the standard deviation, the ATR takes into account the highs and the lows in its calculation, thus making it more complete than the standard deviation.</p>
</div>
<p>The ATR<a contenteditable="false" data-primary="true range, calculating" data-type="indexterm" id="ix_true_rge_calc"/><a contenteditable="false" data-primary="Wilder, J. Welles Jr." data-type="indexterm" id="idm46762871147728"/><a contenteditable="false" data-primary="historical volatility" data-type="indexterm" id="idm46762869556896"/> is used as a gauge of historical volatility. It was developed by Wilder Welles Jr., the creator of the RSI, an indicator discussed in <a data-type="xref" href="ch03.xhtml#chapter3">Chapter 3</a>. The first building block of the ATR is the <em>true range</em>. Let’s see how to calculate the true range.</p>
<p>Suppose you have an OHLC array. For each hour, the true range is simply the greatest of the three price differences:</p>
<ul>
<li>High − Low</li>
<li>High − Previous close</li>
<li>Previous close − Low</li>
</ul>
<p>Once you have gotten the maximum out of those, you simply take a smoothed average of a certain lookback period of the true ranges to get the ATR.</p>
<p>Since in periods of panic and price depreciation you see volatility go up, the ATR will most likely trend higher during these periods. Similarly, in times of steady uptrends or downtrends, the ATR will tend to go lower. <a data-type="xref" href="#figure5-6">Figure 5-6</a> shows an example of EURUSD with the 10-period ATR measure. What can you say by looking at the graph?</p>
<figure><div class="figure" id="figure5-6"><img alt="" height="294" src="assets/mfpr_0506.png" width="600"/>
<h6><span class="label">Figure 5-6. </span>EURUSD with the 10-period ATR</h6>
</div></figure>
<p class="pagebreak-before">Obviously, there is a negative correlation with the market and its ATR measure. This is quite common, as high volatility is often associated with fear (a falling market), whereas low volatility is often associated with greed (a rising market). The correlation is not perfect, but over the long term it is statistically negative.</p>
<p>The code for the ATR can be found in the following code snippet.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Make<a contenteditable="false" data-primary="smoothed_ma() function" data-type="indexterm" id="idm46762870890672"/> sure you have already defined the <code>smoothed_ma()</code> function from <a data-type="xref" href="ch03.xhtml#chapter3">Chapter 3</a>. The ATR is a smoothed average of the true ranges for a certain lookback period. Therefore, it is not a simple average.</p>
</div>
<pre data-code-language="python" data-executable="true" data-type="programlisting">
<code class="k">def</code> <code class="nf">atr</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">lookback</code><code class="p">,</code> <code class="n">high_column</code><code class="p">,</code> <code class="n">low_column</code><code class="p">,</code> <code class="n">close_column</code><code class="p">,</code> <code class="n">position</code><code class="p">):</code>
    
    <code class="n">data</code> <code class="o">=</code> <code class="n">add_column</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="mi">1</code><code class="p">)</code>
      
    <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">data</code><code class="p">)):</code>
        
        <code class="k">try</code><code class="p">:</code>
            
            <code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code> <code class="n">position</code><code class="p">]</code> <code class="o">=</code> <code class="nb">max</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code> <code class="n">high_column</code><code class="p">]</code> <code class="o">-</code> \
                                <code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code> <code class="n">low_column</code><code class="p">],</code> <code class="nb">abs</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code> \
                                <code class="n">high_column</code><code class="p">]</code> <code class="o">-</code> <code class="n">data</code><code class="p">[</code><code class="n">i</code> <code class="o">-</code> <code class="mi">1</code><code class="p">,</code> <code class="n">close_column</code><code class="p">]),</code>\
                                <code class="nb">abs</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code> <code class="n">low_column</code><code class="p">]</code>  <code class="o">-</code> \
                                <code class="n">data</code><code class="p">[</code><code class="n">i</code> <code class="o">-</code> <code class="mi">1</code><code class="p">,</code> <code class="n">close_column</code><code class="p">]))</code>
            
        <code class="k">except</code> <code class="ne">ValueError</code><code class="p">:</code>
            
            <code class="k">pass</code>
        
    <code class="n">data</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="n">position</code><code class="p">]</code> <code class="o">=</code> <code class="mi">0</code>   
      
    <code class="n">data</code> <code class="o">=</code> <code class="n">smoothed_ma</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="n">lookback</code><code class="p">,</code> <code class="n">position</code><code class="p">,</code> <code class="n">position</code> <code class="o">+</code> <code class="mi">1</code><code class="p">)</code>

    <code class="n">data</code> <code class="o">=</code> <code class="n">delete_column</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">position</code><code class="p">,</code> <code class="mi">1</code><code class="p">)</code>
    
    <code class="n">data</code> <code class="o">=</code> <code class="n">delete_row</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">lookback</code><code class="p">)</code>
    
    <code class="k">return</code> <code class="n">data</code>
</pre>
<p class="pagebreak-before">Now you are ready to learn about the <em>Double Trouble</em> pattern, a two-candle trend-following configuration that often signals a continuation in the aggregate direction.</p>
<p>The bullish Double Trouble pattern is composed of two bullish candles with the first close price lower than the second close price. The second candlestick must be at least double the size (from high to low) of the previous candlestick’s 10-period ATR.</p>
<p>The bullish Double Trouble is based on the market psychology of euphoria. Another explanation is that it can be a form of a short squeeze, which can further increase the probability of a bullish exit.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>A <em>short squeeze</em> is an abnormal<a contenteditable="false" data-primary="short squeeze" data-type="indexterm" id="idm46762870454000"/> situation characterized by rapidly rising prices in a market. The market must have a huge number of short sellers before the short squeeze. The rapid price increase is magnified by the trigger of short sellers’ stop-loss orders.</p>
</div>
<p><a data-type="xref" href="#figure5-7">Figure 5-7</a> illustrates a bullish Double Trouble pattern.</p>
<figure><div class="figure" id="figure5-7"><img alt="" height="407" src="assets/mfpr_0507.png" width="479"/>
<h6><span class="label">Figure 5-7. </span>A bullish Double Trouble pattern</h6>
</div></figure>
<p>The bearish Double Trouble pattern is composed of two bearish candles with the first close price higher than the second close price. The second candlestick must also be at least double the size (from high to low) of the previous candlestick 10-period ATR.</p>
<p><a data-type="xref" href="#figure5-8">Figure 5-8</a> illustrates a bearish Double Trouble pattern.</p>
<figure><div class="figure" id="figure5-8"><img alt="" height="407" src="assets/mfpr_0508.png" width="471"/>
<h6><span class="label">Figure 5-8. </span>A bearish Double Trouble pattern</h6>
</div></figure>
<p>It is clear now that the Double Trouble pattern highly depends on volatility to appear. The validation of the pattern can occur only when the distance between the current high and the current low is two times greater than the 10-period ATR of the previous hour.</p>
<p>Algorithmically speaking, the code for the Double Trouble pattern is as follows:</p>
<pre class="pre" data-code-language="python" data-executable="true" data-type="programlisting">
<code class="k">def</code><code> </code><code class="nf">signal</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">,</code><code> </code><code>
</code><code>           </code><code class="n">atr_column</code><code class="p">,</code><code> </code><code class="n">buy_column</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">)</code><code class="p">:</code><code>
</code><code>
</code><code>    </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">add_column</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">)</code><code>    </code><code>
</code><code>    </code><code>
</code><code>    </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">data</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>  </code><code>
</code><code>        </code><code>
</code><code>       </code><code class="k">try</code><code class="p">:</code><code>
</code><code>           </code><code>
</code><code>   </code><strong><code>        </code><code class="c1"># Bullish pattern</code></strong><code>
</code><code>           </code><code class="k">if</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="p">(</code><code class="mi">2</code><code> </code><code class="o">*</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code>\
</code><code>              </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">atr_column</code><code class="p">]</code><code class="p">)</code><code> </code><code class="ow">and</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code>\
</code><code>              </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code>\
</code><code>              </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">buy_column</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="mi">0</code><code class="p">:</code><code>
</code><code>                  </code><code>
</code><code>                    </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">buy_column</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">1</code><code> </code><code>
</code><code>                    </code><code>
</code><strong><code>           </code><code class="c1"># Bearish pattern</code></strong><code>
</code><code>           </code><code class="k">elif</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="p">(</code><code class="mi">2</code><code> </code><code class="o">*</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code>\
</code><code>              </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">atr_column</code><code class="p">]</code><code class="p">)</code><code> </code><code class="ow">and</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code>\
</code><code>              </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code>\
</code><code>              </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="mi">0</code><code class="p">:</code><code>
</code><code>                  </code><code>
</code><code>                    </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="o">-</code><code class="mi">1</code><code> </code><code>
</code><code>                    </code><code>
</code><code>       </code><code class="k">except</code><code> </code><code class="ne">IndexError</code><code class="p">:</code><code>
</code><code>            </code><code>
</code><code>            </code><code class="k">pass</code><code>
</code><code>        </code><code>
</code><code>    </code><code class="k">return</code><code> </code><code class="n">data</code><code>
</code></pre>
<p class="pagebreak-before">The signal<a contenteditable="false" data-primary="abs() function" data-type="indexterm" id="idm46762867485392"/> function uses the <code>abs()</code> function, which takes the absolute values of the numbers inside the brackets. This is used to measure the size of a candle.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>By calculating the ATR, you are using the fifth column (index = 4). Therefore, the buy and sell signals of the Double Trouble pattern must be in the sixth and seventh columns (index = 5 and index = 6) as opposed to the previous patterns where no intermediary indicator has been calculated. Make sure to shift the columns before you call the functions<a contenteditable="false" data-primary="" data-startref="ix_volatil_atr" data-type="indexterm" id="idm46762869635648"/><a contenteditable="false" data-primary="" data-startref="ix_av_true_rge_atr" data-type="indexterm" id="idm46762869634272"/><a contenteditable="false" data-primary="" data-startref="ix_true_rge_calc" data-type="indexterm" id="idm46762870429600"/>.</p>
</div>
<p>Figures <a data-type="xref" data-xrefstyle="select:labelnumber" href="#figure5-9">5-9</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#figure5-10">5-10</a> show a signal chart on the FTSE 100 and on BTCUSD.</p>
<figure><div class="figure" id="figure5-9"><img alt="" height="416" src="assets/mfpr_0509.png" width="600"/>
<h6><span class="label">Figure 5-9. </span>Signal chart on the FTSE 100</h6>
</div></figure>
<figure><div class="figure" id="figure5-10">
<p><img alt="" height="412" src="assets/mfpr_0510.png" width="600"/></p>
<h6><span class="label">Figure 5-10. </span>Signal chart on BTCUSD</h6>
</div></figure>
<p><a data-type="xref" href="#table5-3">Table 5-3</a> summarizes the performance of the Double Trouble pattern.</p>
<table id="table5-3">
<caption><span class="label">Table 5-3. </span>Double Trouble pattern: performance summary table</caption>
<thead>
<tr>
<th>
<p>Asset</p>
</th>
<th>
<p>Hit Ratio</p>
</th>
<th>
<p>Profit Factor</p>
</th>
<th>
<p>Risk-Reward Ratio</p>
</th>
<th>
<p>Signals</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>EURUSD</p>
</td>
<td>
<p>51.54%</p>
</td>
<td>
<p>1.03</p>
</td>
<td>
<p>0.97</p>
</td>
<td>
<p>2103</p>
</td>
</tr>
<tr>
<td>
<p>USDCHF</p>
</td>
<td>
<p>50.47%</p>
</td>
<td>
<p>1.03</p>
</td>
<td>
<p>1.01</p>
</td>
<td>
<p>2106</p>
</td>
</tr>
<tr>
<td>
<p>GBPUSD</p>
</td>
<td>
<p>50.06%</p>
</td>
<td>
<p>0.98</p>
</td>
<td>
<p>0.98</p>
</td>
<td>
<p>2155</p>
</td>
</tr>
<tr>
<td>
<p>USDCAD</p>
</td>
<td>
<p>50.86%</p>
</td>
<td>
<p>1.00</p>
</td>
<td>
<p>0.96</p>
</td>
<td>
<p>1787</p>
</td>
</tr>
<tr>
<td>
<p>BTCUSD</p>
</td>
<td>
<p>53.59%</p>
</td>
<td>
<p>1.21</p>
</td>
<td>
<p>1.05</p>
</td>
<td>
<p>1056</p>
</td>
</tr>
<tr>
<td>
<p>ETHUSD</p>
</td>
<td>
<p>56.76%</p>
</td>
<td>
<p>1.30</p>
</td>
<td>
<p>0.99</p>
</td>
<td>
<p>953</p>
</td>
</tr>
<tr>
<td>
<p>GOLD</p>
</td>
<td>
<p>51.76%</p>
</td>
<td>
<p>1.10</p>
</td>
<td>
<p>1.02</p>
</td>
<td>
<p>2007</p>
</td>
</tr>
<tr>
<td>
<p>S&amp;P500</p>
</td>
<td>
<p>54.00%</p>
</td>
<td>
<p>1.32</p>
</td>
<td>
<p>1.13</p>
</td>
<td>
<p>237</p>
</td>
</tr>
<tr>
<td>
<p>FTSE100</p>
</td>
<td>
<p>45.95%</p>
</td>
<td>
<p>0.62</p>
</td>
<td>
<p>0.73</p>
</td>
<td>
<p>198</p>
</td>
</tr>
</tbody>
</table>
<p>You can see that the Double Trouble pattern outperforms the Quintuplets pattern since it has relatively better profit factors and risk-reward ratios.</p>
<p>These results show that the Double Trouble pattern may be more predictive than the Quintuplets pattern. This also suggests that taking into account volatility can offer new insights and opportunities in the world of pattern recognition<a contenteditable="false" data-primary="" data-startref="ix_trend_double_trouble" data-type="indexterm" id="idm46762869196992"/><a contenteditable="false" data-primary="" data-startref="ix_double_trouble_patt_ch5" data-type="indexterm" id="idm46762867085728"/><a contenteditable="false" data-primary="" data-startref="ix_mod_trend_double_trouble" data-type="indexterm" id="idm46762867084384"/>.</p>
</div></section>
<section data-pdf-bookmark="The Bottle Pattern" data-type="sect1"><div class="sect1" id="idm46762868034064">
<h1>The Bottle Pattern</h1>
<p>This is one<a contenteditable="false" data-primary="modern trend-following patterns" data-secondary="Bottle pattern" data-type="indexterm" id="ix_mod_trend_bottle_ch5"/><a contenteditable="false" data-primary="trend-following patterns" data-secondary="Bottle pattern" data-type="indexterm" id="ix_trend_bottle_ch5"/><a contenteditable="false" data-primary="Bottle pattern" data-type="indexterm" id="ix_bottle_patt_ch5"/> of the simplest and most intuitive patterns I have discovered. It relies on two candlesticks to signal a continuation of the trend. I have named it the <em>Bottle</em> pattern because the second candle looks like a Bottle. This pattern also marks the return of the gap as it is one of the conditions needed to validate a bullish or bearish signal.</p>
<p>The bullish<a contenteditable="false" data-primary="gaps" data-type="indexterm" id="idm46762870294320"/> Bottle pattern is composed of a bullish candle followed by another bullish candle with no wick on the low side but with a wick on the high side. At the same time, the second candle must open below the last candle’s close, which is considered a gap lower (or inside gap).</p>
<p>The pattern can be used to confirm upside continuations, as the underlying psychology is that the market has failed to make a new low after its opening, suggesting strong bullish pressure. <a data-type="xref" href="#figure5-11">Figure 5-11</a> illustrates the bullish Bottle.</p>
<figure><div class="figure" id="figure5-11"><img alt="" height="333" src="assets/mfpr_0511.png" width="327"/>
<h6><span class="label">Figure 5-11. </span>A bullish Bottle pattern</h6>
</div></figure>
<p>The bearish Bottle pattern is composed of a bearish candlestick followed by another bearish candlestick with no wick on the high side but with a wick on the low side. At the same time, the second candlestick must open above the last candlestick’s close, which is considered a gap higher. <a data-type="xref" href="#figure5-12">Figure 5-12</a> illustrates the bearish Bottle.</p>
<figure><div class="figure" id="figure5-12"><img alt="" height="333" src="assets/mfpr_0512.png" width="327"/>
<h6><span class="label">Figure 5-12. </span>A bearish Bottle pattern</h6>
</div></figure>
<p>It is relatively easy to spot the configuration, but you must be careful to respect all the conditions as sometimes the gap may not occur, thus rendering the pattern invalid.</p>
<p>You can express the signal function for the pattern the following way:</p>
<pre data-code-language="python" data-executable="true" data-type="programlisting">
<code class="k">def</code><code> </code><code class="nf">signal</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">,</code><code> </code><code>
</code><code>           </code><code class="n">buy_column</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">)</code><code class="p">:</code><code>
</code><code>
</code><code>    </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">add_column</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">)</code><code>    </code><code>
</code><code>    </code><code>
</code><code>    </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">data</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>  </code><code>
</code><code>        </code><code>
</code><code>       </code><code class="k">try</code><code class="p">:</code><code>
</code><code>           </code><code>
</code><code>     </code><strong><code>      </code><code class="c1"># Bullish pattern</code></strong><code>
</code><code>           </code><code class="k">if</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">buy_column</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="mi">0</code><code class="p">:</code><code>
</code><code>                  </code><code>
</code><code>                    </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">buy_column</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">1</code><code> </code><code>
</code><code>                    </code><code>
</code><code>     </code><strong><code>      </code><code class="c1"># Bearish pattern</code></strong><code>
</code><code>           </code><code class="k">elif</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="mi">0</code><code class="p">:</code><code>
</code><code>                  </code><code>
</code><code>                    </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="o">-</code><code class="mi">1</code><code> </code><code>
</code><code>                    </code><code>
</code><code>       </code><code class="k">except</code><code> </code><code class="ne">IndexError</code><code class="p">:</code><code>
</code><code>            </code><code>
</code><code>            </code><code class="k">pass</code><code>
</code><code>        </code><code>
</code><code>    </code><code class="k">return</code><code> </code><code class="n">data</code><code>
</code></pre>
<p>At this point, you should understand how the conditions are written and, therefore, the conditions should become second nature to you. Furthermore, the simplicity of this pattern makes the code basic.</p>
<p>Let’s see the signals in action (<a data-type="xref" href="#figure5-13">Figure 5-13</a>) before performing the back-testing and interpreting the results.</p>
<figure><div class="figure" id="figure5-13"><img alt="" height="294" src="assets/mfpr_0513.png" width="600"/>
<h6><span class="label">Figure 5-13. </span>Signal chart on USDCHF</h6>
</div></figure>
<p>The first thing you notice is that over the last 100 hours, there was only two bearish Bottle patterns on USDCHF. This is normal and can occur from time to time, especially with a condition that imposes equality. <a data-type="xref" href="#figure5-14">Figure 5-14</a> shows AUDJPY where you can also see one bearish signal during the last 100 trading hours.</p>
<figure><div class="figure" id="figure5-14"><img alt="" height="297" src="assets/mfpr_0514.png" width="600"/>
<h6><span class="label">Figure 5-14. </span>Signal chart on the AUDJPY</h6>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>You can<a contenteditable="false" data-primary="rounding() function" data-type="indexterm" id="idm46762866946448"/><a contenteditable="false" data-primary="rounding numbers" data-secondary="Bottle pattern" data-type="indexterm" id="idm46762866945312"/> use the rounding function to increase the signal frequency of the Bottle pattern. I have chosen not to do it so as to keep the true essence of the pattern.</p>
</div>
<p><a data-type="xref" href="#table5-4">Table 5-4</a> summarizes the performance of the Bottle pattern.</p>
<table id="table5-4">
<caption><span class="label">Table 5-4. </span>Bottle pattern: performance summary table</caption>
<thead>
<tr>
<th>
<p>Asset</p>
</th>
<th>
<p>Hit Ratio</p>
</th>
<th>
<p>Profit Factor</p>
</th>
<th>
<p>Risk-Reward Ratio</p>
</th>
<th>
<p>Signals</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>EURUSD</p>
</td>
<td>
<p>51.39%</p>
</td>
<td>
<p>0.99</p>
</td>
<td>
<p>0.94</p>
</td>
<td>
<p>395</p>
</td>
</tr>
<tr>
<td>
<p>USDCHF</p>
</td>
<td>
<p>52.85%</p>
</td>
<td>
<p>1.17</p>
</td>
<td>
<p>1.04</p>
</td>
<td>
<p>507</p>
</td>
</tr>
<tr>
<td>
<p>GBPUSD</p>
</td>
<td>
<p>50.75%</p>
</td>
<td>
<p>0.85</p>
</td>
<td>
<p>0.83</p>
</td>
<td>
<p>398</p>
</td>
</tr>
<tr>
<td>
<p>USDCAD</p>
</td>
<td>
<p>50.48%</p>
</td>
<td>
<p>1.14</p>
</td>
<td>
<p>1.11</p>
</td>
<td>
<p>513</p>
</td>
</tr>
<tr>
<td>
<p>BTCUSD</p>
</td>
<td>
<p>50.44%</p>
</td>
<td>
<p>0.98</p>
</td>
<td>
<p>0.96</p>
</td>
<td>
<p>337</p>
</td>
</tr>
<tr>
<td>
<p>ETHUSD</p>
</td>
<td>
<p>50.95%</p>
</td>
<td>
<p>0.83</p>
</td>
<td>
<p>0.80</p>
</td>
<td>
<p>365</p>
</td>
</tr>
<tr>
<td>
<p>GOLD</p>
</td>
<td>
<p>47.98%</p>
</td>
<td>
<p>0.82</p>
</td>
<td>
<p>0.89</p>
</td>
<td>
<p>471</p>
</td>
</tr>
<tr>
<td>
<p>S&amp;P500</p>
</td>
<td>
<p>41.81%</p>
</td>
<td>
<p>0.72</p>
</td>
<td>
<p>1.01</p>
</td>
<td>
<p>55</p>
</td>
</tr>
<tr>
<td>
<p>FTSE100</p>
</td>
<td>
<p>53.91%</p>
</td>
<td>
<p>1.81</p>
</td>
<td>
<p>1.55</p>
</td>
<td>
<p>115</p>
</td>
</tr>
</tbody>
</table>
<p>The pattern<a contenteditable="false" data-primary="markets" data-secondary="choosing best pattern for" data-type="indexterm" id="idm46762868745616"/> seems to perform better on the USDCHF and the FTSE 100 than the other back-tested assets. It is important to know that patterns, whether good or bad ones, are unlikely to work on every market; therefore, when you find a good pattern, you must trade it on the right market.</p>
<p>The simplest example is the underperformance of reversal patterns on trending markets and the underperformance of continuation patterns on ranging markets. You need to keep in mind that you are looking for good techniques (patterns or strategies), not perfect ones<a contenteditable="false" data-primary="" data-startref="ix_trend_bottle_ch5" data-type="indexterm" id="idm46762868743344"/><a contenteditable="false" data-primary="" data-startref="ix_bottle_patt_ch5" data-type="indexterm" id="idm46762868741968"/><a contenteditable="false" data-primary="" data-startref="ix_mod_trend_bottle_ch5" data-type="indexterm" id="idm46762867130496"/>.</p>
</div></section>
<section data-pdf-bookmark="The Slingshot Pattern" data-type="sect1"><div class="sect1" id="idm46762867082656">
<h1>The Slingshot Pattern</h1>
<p>The name<a contenteditable="false" data-primary="Slingshot pattern" data-type="indexterm" id="ix_slingshot_patt_ch5"/><a contenteditable="false" data-primary="trend-following patterns" data-secondary="Slingshot pattern" data-type="indexterm" id="ix_trend_slling_patt_ch5"/><a contenteditable="false" data-primary="modern trend-following patterns" data-secondary="Slingshot pattern" data-type="indexterm" id="ix_mod_trend_sling_ch5"/> of this pattern comes from the fact it deals with a breakout system that confirms the new trend. Therefore, the <em>Slingshot</em> pattern is a four-candlestick trend detection system that uses the pull-back method after a breakout occurs. The definition may seem complicated, but in reality, it is very simple. Let’s start by the conditions of the bullish Slingshot.</p>
<p>First, the pattern is characterized by having a first bullish candle followed by a higher one confirming a bullish bias, and then it has two more candlesticks, with the latter one not surpassing the high of the former. Finally, the last candlestick must have a low at or below the high of the first candlestick and a close higher than the high of the second candlestick. There is no strict rule about the color of the second and third candles. <a data-type="xref" href="#figure5-15">Figure 5-15</a> shows the perfect bullish Slingshot pattern.</p>
<figure><div class="figure" id="figure5-15"><img alt="" height="494" src="assets/mfpr_0515.png" width="600"/>
<h6><span class="label">Figure 5-15. </span>A bullish Slingshot pattern</h6>
</div></figure>
<p>The bearish Slingshot pattern (<a data-type="xref" href="#figure5-16">Figure 5-16</a>) is characterized by having a first bearish candlestick followed by a lower one confirming a bearish bias, and then it has two more candlesticks, with the latter one not breaking the low of the former. Finally, the last candlestick must have a high at or above the low of the first candlestick and a close lower than the low of the second candlestick.</p>
<figure><div class="figure" id="figure5-16"><img alt="" height="494" src="assets/mfpr_0516.png" width="600"/>
<h6><span class="label">Figure 5-16. </span>A bearish Slingshot pattern</h6>
</div></figure>
<p class="pagebreak-before">Detecting the Slingshot pattern is a bit complex due to the conditions and its rarity but can be simplified by an algorithm, as in the following:</p>
<pre data-code-language="python" data-executable="true" data-type="programlisting">
<code class="k">def</code><code> </code><code class="nf">signal</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">,</code><code> </code><code>
</code><code>           </code><code class="n">buy_column</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">)</code><code class="p">:</code><code>
</code><code>
</code><code>    </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">add_column</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">)</code><code>    </code><code>
</code><code>    </code><code>
</code><code>    </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">data</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>  </code><code>
</code><code>        </code><code>
</code><code>       </code><code class="k">try</code><code class="p">:</code><code>
</code><code>           </code><code>
</code><code>   </code><strong><code>        </code><code class="c1"># Bullish pattern</code></strong><code>
</code><code>           </code><code class="k">if</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code class="p">:</code><code> </code><code>
</code><code>                  </code><code>
</code><code>                    </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">buy_column</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">1</code><code> </code><code>
</code><code>                    </code><code>
</code><strong><code>           </code><code class="c1"># Bearish pattern</code></strong><code>
</code><code>           </code><code class="k">elif</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code class="o">=</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code class="p">:</code><code>   </code><code>
</code><code>                  </code><code>
</code><code>                    </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="o">-</code><code class="mi">1</code><code> </code><code>
</code><code>                    </code><code>
</code><code>       </code><code class="k">except</code><code> </code><code class="ne">IndexError</code><code class="p">:</code><code>
</code><code>            </code><code>
</code><code>            </code><code class="k">pass</code><code>
</code><code>        </code><code>
</code><code>    </code><code class="k">return</code><code> </code><code class="n">data</code><code>
</code></pre>
<p class="pagebreak-before"><a data-type="xref" href="#figure5-17">Figure 5-17</a> shows an example of the gold commodity highlighting the signals given by the Slingshot pattern.</p>
<figure><div class="figure" id="figure5-17"><img alt="" height="434" src="assets/mfpr_0517.png" width="600"/>
<h6><span class="label">Figure 5-17. </span>Signal chart on gold</h6>
</div></figure>
<p>The pattern is usually for short-term trend continuation moves; therefore, the aim is not to continue for days in the same direction but at least shape marginal new highs (bullish Slingshot) or new lows (bearish Slingshot).</p>
<p>Hence, exit strategies<a contenteditable="false" data-primary="candlestick pattern charting" data-secondary="exit techniques" data-type="indexterm" id="idm46762865792512"/><a contenteditable="false" data-primary="exit techniques" data-secondary="and Slingshot pattern" data-secondary-sortas="Slingshot pattern" data-type="indexterm" id="idm46762866093856"/> can greatly impact the results of this pattern. Nevertheless, I back-test it using the same conditions as the rest of the patterns (by exiting upon the next signal whether bullish or bearish).</p>
<p>In reality, you must create your own entry and exit rules based on risk and reward preferences so that you optimize the expected results. <a data-type="xref" href="#figure5-18">Figure 5-18</a> shows an example for AUDNZD.</p>
<figure><div class="figure" id="figure5-18"><img alt="" height="428" src="assets/mfpr_0518.png" width="600"/>
<h6><span class="label">Figure 5-18. </span>Signal chart on AUDNZD</h6>
</div></figure>
<p><a data-type="xref" href="#table5-5">Table 5-5</a> summarizes the results of the Slingshot pattern.</p>
<table id="table5-5">
<caption><span class="label">Table 5-5. </span>Slingshot pattern: performance summary table</caption>
<thead>
<tr>
<th>
<p>Asset</p>
</th>
<th>
<p>Hit Ratio</p>
</th>
<th>
<p>Profit Factor</p>
</th>
<th>
<p>Risk-Reward Ratio</p>
</th>
<th>
<p>Signals</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>EURUSD</p>
</td>
<td>
<p>50.03%</p>
</td>
<td>
<p>0.98</p>
</td>
<td>
<p>0.98</p>
</td>
<td>
<p>1591</p>
</td>
</tr>
<tr>
<td>
<p>USDCHF</p>
</td>
<td>
<p>51.81%</p>
</td>
<td>
<p>0.96</p>
</td>
<td>
<p>0.90</p>
</td>
<td>
<p>1621</p>
</td>
</tr>
<tr>
<td>
<p>GBPUSD</p>
</td>
<td>
<p>48.27%</p>
</td>
<td>
<p>1.01</p>
</td>
<td>
<p>1.08</p>
</td>
<td>
<p>1622</p>
</td>
</tr>
<tr>
<td>
<p>USDCAD</p>
</td>
<td>
<p>48.61%</p>
</td>
<td>
<p>0.94</p>
</td>
<td>
<p>0.99</p>
</td>
<td>
<p>1728</p>
</td>
</tr>
<tr>
<td>
<p>BTCUSD</p>
</td>
<td>
<p>52.01%</p>
</td>
<td>
<p>0.88</p>
</td>
<td>
<p>0.82</p>
</td>
<td>
<p>721</p>
</td>
</tr>
<tr>
<td>
<p>ETHUSD</p>
</td>
<td>
<p>48.52%</p>
</td>
<td>
<p>1.01</p>
</td>
<td>
<p>1.07</p>
</td>
<td>
<p>577</p>
</td>
</tr>
<tr>
<td>
<p>GOLD</p>
</td>
<td>
<p>47.90%</p>
</td>
<td>
<p>0.85</p>
</td>
<td>
<p>0.93</p>
</td>
<td>
<p>1332</p>
</td>
</tr>
<tr>
<td>
<p>S&amp;P500</p>
</td>
<td>
<p>49.36%</p>
</td>
<td>
<p>1.01</p>
</td>
<td>
<p>1.04</p>
</td>
<td>
<p>158</p>
</td>
</tr>
<tr>
<td>
<p>FTSE100</p>
</td>
<td>
<p>57.14%</p>
</td>
<td>
<p>1.38</p>
</td>
<td>
<p>1.04</p>
</td>
<td>
<p>189</p>
</td>
</tr>
</tbody>
</table>
<p class="pagebreak-before">The Slingshot pattern has a relatively healthy number of signals when compared to other candlestick patterns. However, as it is greatly impacted by exit techniques (covered in subsequent chapters), its predictability is relatively low with the exception of the FTSE 100<a contenteditable="false" data-primary="" data-startref="ix_trend_slling_patt_ch5" data-type="indexterm" id="idm46762866729136"/><a contenteditable="false" data-primary="" data-startref="ix_mod_trend_sling_ch5" data-type="indexterm" id="idm46762866727104"/><a contenteditable="false" data-primary="" data-startref="ix_slingshot_patt_ch5" data-type="indexterm" id="idm46762866725728"/>.</p>
</div></section>
<section data-pdf-bookmark="The H Pattern" data-type="sect1"><div class="sect1" id="idm46762867128736">
<h1>The H Pattern</h1>
<p>The <em>H</em> pattern<a contenteditable="false" data-primary="modern trend-following patterns" data-secondary="H pattern" data-type="indexterm" id="ix_mod_trend_h_patt_ch5"/><a contenteditable="false" data-primary="trend-following patterns" data-secondary="H pattern" data-type="indexterm" id="ix_trend_h_patt_ch5"/><a contenteditable="false" data-primary="H pattern" data-type="indexterm" id="ix_h_patt_ch5"/> is a three-candle continuation configuration. The bullish H pattern (<a data-type="xref" href="#figure5-19">Figure 5-19</a>) is composed of a bullish candle followed by an indecision candlestick<sup><a data-type="noteref" href="ch05.xhtml#idm46762866479184" id="idm46762866479184-marker">3</a></sup> that has its open price equal to its close price. Next, the third candle must be bullish, and its close price must be higher than the indecision candle’s close. Finally, the low of the third candle must be higher than the low of the indecision candle.</p>
<figure><div class="figure" id="figure5-19"><img alt="" height="307" src="assets/mfpr_0519.png" width="600"/>
<h6><span class="label">Figure 5-19. </span>A bullish H pattern</h6>
</div></figure>
<p>The bearish H pattern (<a data-type="xref" href="#figure5-20">Figure 5-20</a>) is composed of a bearish candle followed by an indecision candle; next, the third candle must be bearish, and its close must be lower than the indecision candle’s close. Finally, the high of the third candle must be lower than the high of the indecision candle.</p>
<figure><div class="figure" id="figure5-20"><img alt="" height="307" src="assets/mfpr_0520.png" width="600"/>
<h6><span class="label">Figure 5-20. </span>A bearish H pattern</h6>
</div></figure>
<p class="pagebreak-before">The following code snippet shows how to scan for the H pattern:</p>
<pre data-code-language="python" data-executable="true" data-type="programlisting">
<code class="k">def</code><code> </code><code class="nf">signal</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">,</code><code> </code><code>
</code><code>           </code><code class="n">buy_column</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">)</code><code class="p">:</code><code>
</code><code>
</code><code>    </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">add_column</code><code class="p">(</code><code class="n">data</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">)</code><code>    </code><code>
</code><code>    </code><code>
</code><code>    </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">data</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>  </code><code>
</code><code>        </code><code>
</code><code>       </code><code class="k">try</code><code class="p">:</code><code>
</code><code>           </code><code>
</code><strong><code>           </code><code class="c1"># Bullish pattern</code></strong><code>
</code><code>           </code><code class="k">if</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>              </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">high_column</code><code class="p">]</code><code class="p">:</code><code>
</code><code>                  </code><code>
</code><code>                    </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">buy_column</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">1</code><code> </code><code>
</code><code>                    </code><code>
</code><strong><code>           </code><code class="c1"># Bearish pattern</code></strong><code>
</code><code>           </code><code class="k">elif</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">close_column</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">open_column</code><code class="p">]</code><code> </code><code class="ow">and</code><code> </code><code>\
</code><code>                </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code> </code><code class="o">&gt;</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">low_column</code><code class="p">]</code><code class="p">:</code><code>
</code><code>                  </code><code>
</code><code>                    </code><code class="n">data</code><code class="p">[</code><code class="n">i</code><code> </code><code class="o">+</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">sell_column</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="o">-</code><code class="mi">1</code><code> </code><code>
</code><code>                    </code><code>
</code><code>       </code><code class="k">except</code><code> </code><code class="ne">IndexError</code><code class="p">:</code><code>
</code><code>            </code><code>
</code><code>            </code><code class="k">pass</code><code>
</code><code>        </code><code>
</code><code>    </code><code class="k">return</code><code> </code><code class="n">data</code><code>
</code></pre>
<p><a data-type="xref" href="#figure5-21">Figure 5-21</a> shows an example of a signal generated by the S&amp;P 500. Visibly, the pattern may be rare depending on the market’s characteristics. As is the case theoretically, trend-following patterns have on average better results on trending markets than on ranging markets.</p>
<p>With equities being mostly trending, the results shown in the performance summary <a data-type="link" href="#table5-6">table</a> show that the H pattern outperforms on equity indices.</p>
<figure><div class="figure" id="figure5-21"><img alt="" height="434" src="assets/mfpr_0521.png" width="600"/>
<h6><span class="label">Figure 5-21. </span>Signal chart on the S&amp;P 500</h6>
</div></figure>
<p>Patterns<a contenteditable="false" data-primary="potential" data-type="indexterm" id="idm46762865974752"/> generally have targets that are called <em>potential</em>. Up to this point, you have been back-testing them with the assumption of an exit at the next signal. This is fine because you want to harmonize the results across the patterns to have an apples-to-apples comparison.</p>
<p>With the H pattern<a contenteditable="false" data-primary="candlestick pattern charting" data-secondary="exit techniques" data-type="indexterm" id="idm46762866551072"/><a contenteditable="false" data-primary="exit techniques" data-secondary="H pattern" data-type="indexterm" id="idm46762866549648"/> and the other modern candlestick patterns presented in this book, I have found that there is not really an added value of imposing a certain exit as each market performs differently. Therefore, I have found that it is better to use your own judgment, apply the exits from your own strategy, or simply exit at the next signal if you are just trading on the pattern.</p>
<p><a data-type="xref" href="#figure5-22">Figure 5-22</a> shows a signal generated on the hourly values of the AUDNZD pair.</p>
<figure><div class="figure" id="figure5-22"><img alt="" height="432" src="assets/mfpr_0522.png" width="600"/>
<h6><span class="label">Figure 5-22. </span>Signal chart on AUDNZD</h6>
</div></figure>
<p>Let’s now take a look at the back-testing results and see how you can interpret them (see <a data-type="xref" href="#table5-6">Table 5-6</a>).</p>
<table id="table5-6">
<caption><span class="label">Table 5-6. </span>H pattern: performance summary table</caption>
<thead>
<tr>
<th>
<p>Asset</p>
</th>
<th>
<p>Hit Ratio</p>
</th>
<th>
<p>Profit Factor</p>
</th>
<th>
<p>Risk-Reward Ratio</p>
</th>
<th>
<p>Signals</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>EURUSD</p>
</td>
<td>
<p>51.56%</p>
</td>
<td>
<p>0.89</p>
</td>
<td>
<p>0.84</p>
</td>
<td>
<p>128</p>
</td>
</tr>
<tr>
<td>
<p>USDCHF</p>
</td>
<td>
<p>45.83%</p>
</td>
<td>
<p>0.77</p>
</td>
<td>
<p>0.91</p>
</td>
<td>
<p>144</p>
</td>
</tr>
<tr>
<td>
<p>GBPUSD</p>
</td>
<td>
<p>44.68%</p>
</td>
<td>
<p>0.93</p>
</td>
<td>
<p>1.15</p>
</td>
<td>
<p>94</p>
</td>
</tr>
<tr>
<td>
<p>USDCAD</p>
</td>
<td>
<p>57.49%</p>
</td>
<td>
<p>1.31</p>
</td>
<td>
<p>0.97</p>
</td>
<td>
<p>120</p>
</td>
</tr>
<tr>
<td>
<p>BTCUSD</p>
</td>
<td>
<p>61.53%</p>
</td>
<td>
<p>3.25</p>
</td>
<td>
<p>2.03</p>
</td>
<td>
<p>26</p>
</td>
</tr>
<tr>
<td>
<p>ETHUSD</p>
</td>
<td>
<p>41.83%</p>
</td>
<td>
<p>0.55</p>
</td>
<td>
<p>0.77</p>
</td>
<td>
<p>98</p>
</td>
</tr>
<tr>
<td>
<p>GOLD</p>
</td>
<td>
<p>65.38%</p>
</td>
<td>
<p>2.55</p>
</td>
<td>
<p>1.34</p>
</td>
<td>
<p>52</p>
</td>
</tr>
<tr>
<td>
<p>S&amp;P500</p>
</td>
<td>
<p>59.64%</p>
</td>
<td>
<p>1.33</p>
</td>
<td>
<p>0.90</p>
</td>
<td>
<p>57</p>
</td>
</tr>
<tr>
<td>
<p>FTSE100</p>
</td>
<td>
<p>50.00%</p>
</td>
<td>
<p>1.35</p>
</td>
<td>
<p>1.35</p>
</td>
<td>
<p>36</p>
</td>
</tr>
</tbody>
</table>
<p class="pagebreak-before">There seems to be more predictive strength with this pattern, but the disadvantage is clear here: the frequency of signals<a contenteditable="false" data-primary="markets" data-secondary="trending" data-type="indexterm" id="idm46762866676352"/><a contenteditable="false" data-primary="trending market" data-type="indexterm" id="idm46762866675200"/><a contenteditable="false" data-primary="" data-startref="ix_trend_h_patt_ch5" data-type="indexterm" id="idm46762866674096"/><a contenteditable="false" data-primary="" data-startref="ix_h_patt_ch5" data-type="indexterm" id="idm46762866643504"/><a contenteditable="false" data-primary="" data-startref="ix_mod_trend_h_patt_ch5" data-type="indexterm" id="idm46762866642128"/><a contenteditable="false" data-primary="" data-startref="ix_mod_trend_follow_ch5" data-type="indexterm" id="idm46762866640752"/><a contenteditable="false" data-primary="" data-startref="ix_trend_follow_ch4_5" data-type="indexterm" id="idm46762865605920"/>. You can clearly see a lack of trades. As expected, you see better results on trending markets like the S&amp;P 500 and the FTSE 100 than on ranging markets like the USDCHF and GBPUSD.</p>
</div></section>
<div data-type="footnotes"><p data-type="footnote" id="idm46762868430992"><sup><a href="ch05.xhtml#idm46762868430992-marker">1</a></sup> This event occurs when market participants are expecting a reversal due to extreme conditions but the market continues its initial state.</p><p data-type="footnote" id="idm46762868428896"><sup><a href="ch05.xhtml#idm46762868428896-marker">2</a></sup> USDTRY is the value of 1 USD in terms of the Turkish lira.</p><p data-type="footnote" id="idm46762866479184"><sup><a href="ch05.xhtml#idm46762866479184-marker">3</a></sup> The indecision pattern is also called a Doji.</p></div></div></section></div></body></html>