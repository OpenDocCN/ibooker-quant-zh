- en: Chapter 10\. Automating Trading Operations
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç¬¬10ç«  è‡ªåŠ¨åŒ–äº¤æ˜“æ“ä½œ
- en: People worry that computers will get too smart and take over the world, but
    the real problem is that theyâ€™re too stupid and theyâ€™ve already taken over the
    world.
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: äººä»¬æ‹…å¿ƒè®¡ç®—æœºä¼šå˜å¾—å¤ªèªæ˜å¹¶æ¥ç®¡ä¸–ç•Œï¼Œä½†å®é™…é—®é¢˜æ˜¯å®ƒä»¬å¤ªæ„šè ¢ï¼Œè€Œå®ƒä»¬å·²ç»æ¥ç®¡äº†ä¸–ç•Œã€‚
- en: ''
  id: totrans-2
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Pedro Domingos
  id: totrans-3
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Pedro Domingos
- en: â€œNow what?â€ you might think. The trading platform that allows one to retrieve
    historical data and streaming data is available. It allows one to place buy and
    sell orders and to check the account status. A number of different methods have
    been introduced in this book to derive algorithmic trading strategies by predicting
    the direction of market price movements. You may ask, â€œHow, after all, can this
    all be put together to work in automated fashion?â€ This cannot be answered in
    any generality. However, this chapter addresses a number of topics that are important
    in this context. The chapter assumes that a single automated, algorithmic trading
    strategy is to be deployed. This simplifies, for example, aspects like capital
    and risk management.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: â€œç°åœ¨æ€ä¹ˆåŠï¼Ÿâ€ä½ å¯èƒ½ä¼šæƒ³ã€‚èƒ½å¤Ÿæ£€ç´¢å†å²æ•°æ®å’Œæµæ•°æ®çš„äº¤æ˜“å¹³å°å·²ç»å¯ç”¨ã€‚å®ƒå…è®¸ä¸‹å•ä¹°å–ï¼Œå¹¶æ£€æŸ¥è´¦æˆ·çŠ¶æ€ã€‚æœ¬ä¹¦ä»‹ç»äº†å¤šç§æ–¹æ³•æ¥é€šè¿‡é¢„æµ‹å¸‚åœºä»·æ ¼èµ°å‘æ¥åˆ¶å®šç®—æ³•äº¤æ˜“ç­–ç•¥ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œâ€œæ¯•ç«Ÿï¼Œå¦‚ä½•å°†è¿™äº›ç»„åˆåœ¨ä¸€èµ·ä»¥è‡ªåŠ¨åŒ–æ–¹å¼å·¥ä½œï¼Ÿâ€è¿™ä¸èƒ½ä»¥ä¸€èˆ¬æ€§å›ç­”ã€‚ç„¶è€Œï¼Œæœ¬ç« è®¨è®ºäº†åœ¨è¿™ä¸€èƒŒæ™¯ä¸‹é‡è¦çš„å‡ ä¸ªä¸»é¢˜ã€‚æœ¬ç« å‡è®¾è¦éƒ¨ç½²å•ä¸€çš„è‡ªåŠ¨åŒ–ç®—æ³•äº¤æ˜“ç­–ç•¥ã€‚è¿™ç®€åŒ–äº†èµ„æœ¬å’Œé£é™©ç®¡ç†ç­‰æ–¹é¢çš„å¤„ç†ã€‚
- en: The chapter covers the following topics. [â€œCapital Managementâ€](#auto_capital)
    discusses the *Kelly criterion*. Depending on the strategy characteristics and
    the trading capital available, the Kelly criterion helps with sizing the trades.
    To gain confidence in an algorithmic trading strategy, the strategy needs to be
    backtested thoroughly with regard to both performance and risk characteristics.
    [â€œML-Based Trading Strategyâ€](#auto_strat) backtests an example strategy based
    on a classification algorithm from machine learning (ML), as introduced in [â€œTrading
    Strategiesâ€](ch01.html#trading_strategies). To deploy the algorithmic trading
    strategy for automated trading, it needs to be translated into an online algorithm
    that works with incoming streaming data in real time. [â€œOnline Algorithmâ€](#auto_online)
    covers the transformation of an *offline* algorithm into an *online* algorithm.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬ç« æ¶µç›–ä»¥ä¸‹ä¸»é¢˜ã€‚[â€œèµ„æœ¬ç®¡ç†â€](#auto_capital)è®¨è®º*Kellyå‡†åˆ™*ã€‚æ ¹æ®ç­–ç•¥ç‰¹å¾å’Œå¯ç”¨çš„äº¤æ˜“èµ„æœ¬ï¼ŒKellyå‡†åˆ™æœ‰åŠ©äºç¡®å®šäº¤æ˜“è§„æ¨¡ã€‚è¦å¯¹ç®—æ³•äº¤æ˜“ç­–ç•¥è·å¾—ä¿¡å¿ƒï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œå…¨é¢çš„å›æµ‹ï¼Œè€ƒè™‘å…¶æ€§èƒ½å’Œé£é™©ç‰¹å¾ã€‚[â€œåŸºäºMLçš„äº¤æ˜“ç­–ç•¥â€](#auto_strat)å¯¹ä¸€ä¸ªåŸºäºæœºå™¨å­¦ä¹ ï¼ˆMLï¼‰åˆ†ç±»ç®—æ³•çš„ç¤ºä¾‹ç­–ç•¥è¿›è¡Œå›æµ‹ï¼Œæ­£å¦‚åœ¨[â€œäº¤æ˜“ç­–ç•¥â€](ch01.html#trading_strategies)ä¸­ä»‹ç»çš„é‚£æ ·ã€‚è¦å°†ç®—æ³•äº¤æ˜“ç­–ç•¥éƒ¨ç½²åˆ°è‡ªåŠ¨åŒ–äº¤æ˜“ä¸­ï¼Œéœ€è¦å°†å…¶è½¬åŒ–ä¸ºä¸€ä¸ªèƒ½å¤Ÿå®æ—¶å¤„ç†æµå…¥æ•°æ®çš„åœ¨çº¿ç®—æ³•ã€‚[â€œåœ¨çº¿ç®—æ³•â€](#auto_online)è®¨è®ºå°†*ç¦»çº¿*ç®—æ³•è½¬åŒ–ä¸º*åœ¨çº¿*ç®—æ³•çš„è¿‡ç¨‹ã€‚
- en: '[â€œInfrastructure and Deploymentâ€](#auto_infra_deploy) then sets out to make
    sure that the automated, algorithmic trading strategy runs robustly and reliably
    in the cloud. Not all topics of relevance can be covered in detail, but *cloud
    deployment* seems to be the only viable option from an availability, performance,
    and security point of view in this context. [â€œLogging and Monitoringâ€](#auto_logg_monit)
    covers logging and monitoring. Logging is important in order to be able to analyze
    the history and certain events during the deployment of an automated trading strategy.
    Monitoring via socket communication, as introduced in [ChapterÂ 7](ch07.html#realtime_sockets),
    allows one to observe events remotely in real time. The chapter concludes with
    [â€œVisual Step-by-Step Overviewâ€](#viz_summary), which provides a visual summary
    of the core steps for the automated deployment of algorithmic trading strategies
    in the cloud.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '[â€œåŸºç¡€è®¾æ–½å’Œéƒ¨ç½²â€](#auto_infra_deploy)è‡´åŠ›äºç¡®ä¿è‡ªåŠ¨åŒ–ç®—æ³•äº¤æ˜“ç­–ç•¥åœ¨äº‘ä¸­ç¨³å¥å¯é åœ°è¿è¡Œã€‚å¹¶ä¸èƒ½è¯¦ç»†æ¶µç›–æ‰€æœ‰ç›¸å…³ä¸»é¢˜ï¼Œä½†ä»å¯ç”¨æ€§ã€æ€§èƒ½å’Œå®‰å…¨æ€§çš„è§’åº¦çœ‹ï¼Œ*äº‘éƒ¨ç½²*ä¼¼ä¹æ˜¯å”¯ä¸€å¯è¡Œçš„é€‰æ‹©ã€‚[â€œæ—¥å¿—è®°å½•å’Œç›‘æ§â€](#auto_logg_monit)æ¶µç›–äº†æ—¥å¿—è®°å½•å’Œç›‘æ§ã€‚æ—¥å¿—è®°å½•å¯¹äºåˆ†æéƒ¨ç½²è‡ªåŠ¨åŒ–äº¤æ˜“ç­–ç•¥è¿‡ç¨‹ä¸­çš„å†å²å’ŒæŸäº›äº‹ä»¶è‡³å…³é‡è¦ã€‚é€šè¿‡åœ¨[ç¬¬7ç« ](ch07.html#realtime_sockets)ä»‹ç»çš„å¥—æ¥å­—é€šä¿¡è¿›è¡Œç›‘æ§ï¼Œå…è®¸è¿œç¨‹å®æ—¶è§‚å¯Ÿäº‹ä»¶ã€‚æœ¬ç« ä»¥[â€œè§†è§‰é€æ­¥æ¦‚è¿°â€](#viz_summary)ç»“æŸï¼Œæä¾›äº†äº‘ä¸­è‡ªåŠ¨éƒ¨ç½²ç®—æ³•äº¤æ˜“ç­–ç•¥æ ¸å¿ƒæ­¥éª¤çš„è§†è§‰æ¦‚è¿°ã€‚'
- en: Capital Management
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: èµ„æœ¬ç®¡ç†
- en: A central question in algorithmic trading is how much capital to deploy to a
    given algorithmic trading strategy given the total available capital. The answer
    to this question depends on the main goal one is trying to achieve by algorithmic
    trading. Most individuals and financial institutions will agree that the *maximization
    of long-term wealth* is a good candidate objective. This is what Edward Thorp
    had in mind when he derived the *Kelly criterion* to investing, as described in
    Rotando and Thorp (1992). Simply speaking, the Kelly criterion allows for an explicit
    calculation of the fraction of the available capital a trader should deploy to
    a strategy, given its statistical return characteristics.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: ç®—æ³•äº¤æ˜“ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜æ˜¯åœ¨æ€»å¯ç”¨èµ„é‡‘çš„åŸºç¡€ä¸Šï¼Œè¦ä¸ºç»™å®šçš„ç®—æ³•äº¤æ˜“ç­–ç•¥æŠ•å…¥å¤šå°‘èµ„é‡‘ã€‚è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆå–å†³äºä¸€ä¸ªäººé€šè¿‡ç®—æ³•äº¤æ˜“è¯•å›¾å®ç°çš„ä¸»è¦ç›®æ ‡ã€‚å¤§å¤šæ•°ä¸ªäººå’Œé‡‘èæœºæ„éƒ½ä¼šåŒæ„*æœ€å¤§åŒ–é•¿æœŸè´¢å¯Œ*æ˜¯ä¸€ä¸ªä¸é”™çš„å€™é€‰ç›®æ ‡ã€‚è¿™å°±æ˜¯çˆ±å¾·åÂ·ç´¢æ™®åœ¨æ¨å¯¼å‡ºç”¨äºæŠ•èµ„çš„*Kellyå‡†åˆ™*æ—¶æ‰€è€ƒè™‘çš„ï¼Œæ­£å¦‚Rotandoå’ŒThorpï¼ˆ1992å¹´ï¼‰æ‰€è¿°ã€‚ç®€å•æ¥è¯´ï¼ŒKellyå‡†åˆ™å…è®¸å¯¹ä¸€ä¸ªäº¤æ˜“å‘˜åº”è¯¥å°†å¤šå°‘èµ„é‡‘æŠ•å…¥åˆ°ä¸€ç§ç­–ç•¥ä¸­è¿›è¡Œæ˜ç¡®çš„è®¡ç®—ï¼Œè€ƒè™‘åˆ°äº†å…¶ç»Ÿè®¡å›æŠ¥ç‰¹å¾ã€‚
- en: Kelly Criterion in Binomial Setting
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: äºŒé¡¹å¼è®¾å®šä¸­çš„Kellyå‡†åˆ™
- en: 'The common way of introducing the theory of the Kelly criterion to investing
    is on the basis of a coin tossing game or, more generally, a binomial setting
    (only two outcomes are possible). This section follows that path. Assume a gambler
    is playing a coin tossing game against an infinitely rich bank or casino. Assume
    further that the probability for heads is some value <math alttext="p"><mi>p</mi></math>
    for which the following holds:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: å¼•å…¥Kellyå‡†åˆ™åˆ°æŠ•èµ„çš„å¸¸è§æ–¹æ³•æ˜¯åŸºäºä¸€ä¸ªæŠ›ç¡¬å¸æ¸¸æˆæˆ–è€…æ›´ä¸€èˆ¬åœ°ï¼Œä¸€ä¸ªäºŒé¡¹å¼è®¾ç½®ï¼ˆåªæœ‰ä¸¤ç§å¯èƒ½ç»“æœï¼‰ã€‚æœ¬èŠ‚éµå¾ªè¿™æ¡è·¯å¾„ã€‚å‡è®¾ä¸€ä¸ªèµŒå¾’æ­£åœ¨ä¸ä¸€ä¸ªèµ„é‡‘æ— é™çš„é“¶è¡Œæˆ–èµŒåœºç©æŠ›ç¡¬å¸æ¸¸æˆã€‚è¿›ä¸€æ­¥å‡è®¾æ­£é¢çš„æ¦‚ç‡æ˜¯ä¸€äº›å€¼
    <math alttext="p"><mi>p</mi></math>ï¼Œå¯¹äºè¿™ä¸ªå€¼æœ‰ä»¥ä¸‹æˆç«‹ï¼š
- en: <math alttext="one-half less-than p less-than 1" display="block"><mrow><mfrac><mn>1</mn>
    <mn>2</mn></mfrac> <mo><</mo> <mi>p</mi> <mo><</mo> <mn>1</mn></mrow></math>
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="one-half less-than p less-than 1" display="block"><mrow><mfrac><mn>1</mn>
    <mn>2</mn></mfrac> <mo><</mo> <mi>p</mi> <mo><</mo> <mn>1</mn></mrow></math>
- en: 'Probability for tails is defined by the following:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: å°¾éƒ¨æ¦‚ç‡ç”±ä»¥ä¸‹å…¬å¼å®šä¹‰ï¼š
- en: <math alttext="q equals 1 minus p less-than one-half" display="block"><mrow><mi>q</mi>
    <mo>=</mo> <mn>1</mn> <mo>-</mo> <mi>p</mi> <mo><</mo> <mfrac><mn>1</mn> <mn>2</mn></mfrac></mrow></math>
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="q equals 1 minus p less-than one-half" display="block"><mrow><mi>q</mi>
    <mo>=</mo> <mn>1</mn> <mo>-</mo> <mi>p</mi> <mo><</mo> <mfrac><mn>1</mn> <mn>2</mn></mfrac></mrow></math>
- en: The gambler can place bets <math alttext="b greater-than 0"><mrow><mi>b</mi>
    <mo>></mo> <mn>0</mn></mrow></math> of arbitrary size, whereby the gambler wins
    the same amount if right and loses it all if wrong. Given the assumptions about
    the probabilities, the gambler would of course want to bet on heads.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: èµŒå¾’å¯ä»¥ä¸‹ä»»æ„å¤§å°çš„èµŒæ³¨ <math alttext="b å¤§äº 0"><mrow><mi>b</mi> <mo>></mo> <mn>0</mn></mrow></math>ï¼Œå¦‚æœæ­£ç¡®åˆ™èµ¢å¾—ç›¸åŒé‡‘é¢ï¼Œå¦‚æœé”™è¯¯åˆ™å…¨éƒ¨è¾“æ‰ã€‚é‰´äºå¯¹æ¦‚ç‡çš„å‡è®¾ï¼ŒèµŒå¾’å½“ç„¶æƒ³è¦æŠ¼æ³¨äºæ­£é¢ã€‚
- en: 'Therefore, the expected value for this betting game <math alttext="upper B"><mi>B</mi></math>
    (that is, the random variable representing this game) in a one-shot setting is
    as follows:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œè¿™ä¸ªèµŒåšæ¸¸æˆåœ¨ä¸€æ¬¡æ€§è®¾ç½®ä¸­çš„é¢„æœŸä»·å€¼ <math alttext="upper B"><mi>B</mi></math>ï¼ˆå³ä»£è¡¨è¿™ä¸ªæ¸¸æˆçš„éšæœºå˜é‡ï¼‰å¦‚ä¸‹ï¼š
- en: <math alttext="bold upper E left-parenthesis upper B right-parenthesis equals
    p dot b minus q dot b equals left-parenthesis p minus q right-parenthesis dot
    b greater-than 0" display="block"><mrow><mi>ğ„</mi> <mo>(</mo> <mi>B</mi> <mo>)</mo>
    <mo>=</mo> <mi>p</mi> <mo>Â·</mo> <mi>b</mi> <mo>-</mo> <mi>q</mi> <mo>Â·</mo> <mi>b</mi>
    <mo>=</mo> <mo>(</mo> <mi>p</mi> <mo>-</mo> <mi>q</mi> <mo>)</mo> <mo>Â·</mo> <mi>b</mi>
    <mo>></mo> <mn>0</mn></mrow></math>
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="bold upper E left-parenthesis upper B right-parenthesis equals
    p dot b minus q dot b equals left-parenthesis p minus q right-parenthesis dot
    b greater-than 0" display="block"><mrow><mi>ğ„</mi> <mo>(</mo> <mi>B</mi> <mo>)</mo>
    <mo>=</mo> <mi>p</mi> <mo>Â·</mo> <mi>b</mi> <mo>-</mo> <mi>q</mi> <mo>Â·</mo> <mi>b</mi>
    <mo>=</mo> <mo>(</mo> <mi>p</mi> <mo>-</mo> <mi>q</mi> <mo>)</mo> <mo>Â·</mo> <mi>b</mi>
    <mo>></mo> <mn>0</mn></mrow></math>
- en: 'A risk-neutral gambler with unlimited funds would like to bet as large an amount
    as possible since this would maximize the expected payoff. However, trading in
    financial markets is not a one-shot game in general. It is a repeated game. Therefore,
    assume that <math alttext="b Subscript i"><msub><mi>b</mi> <mi>i</mi></msub></math>
    represents the amount that is bet on day <math alttext="i"><mi>i</mi></math> and
    that <math alttext="c 0"><msub><mi>c</mi> <mn>0</mn></msub></math> represents
    the initial capital. The capital <math alttext="c 1"><msub><mi>c</mi> <mn>1</mn></msub></math>
    at the end of day one depends on the betting success on that day and might be
    either <math alttext="c 0 plus b 1"><mrow><msub><mi>c</mi> <mn>0</mn></msub> <mo>+</mo>
    <msub><mi>b</mi> <mn>1</mn></msub></mrow></math> or <math alttext="c 0 minus b
    1"><mrow><msub><mi>c</mi> <mn>0</mn></msub> <mo>-</mo> <msub><mi>b</mi> <mn>1</mn></msub></mrow></math>
    . The expected value for a gamble that is repeated <math alttext="n"><mi>n</mi></math>
    times then is as follows:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªé£é™©ä¸­æ€§çš„èµŒå¾’å¸Œæœ›æŠ¼æ³¨å°½å¯èƒ½å¤šçš„èµ„é‡‘ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥æœ€å¤§åŒ–é¢„æœŸæ”¶ç›Šã€‚ç„¶è€Œï¼Œåœ¨é‡‘èå¸‚åœºä¸Šäº¤æ˜“é€šå¸¸ä¸æ˜¯ä¸€æ¬¡æ€§çš„æ¸¸æˆã€‚å®ƒæ˜¯ä¸€ä¸ªé‡å¤çš„æ¸¸æˆã€‚å› æ­¤ï¼Œå‡è®¾ <math
    alttext="b ä¸‹æ ‡ i"><msub><mi>b</mi> <mi>i</mi></msub></math>è¡¨ç¤ºåœ¨ç¬¬ <math alttext="i"><mi>i</mi></math>
    å¤©æŠ¼æ³¨çš„é‡‘é¢ï¼Œ<math alttext="c 0"><msub><mi>c</mi> <mn>0</mn></msub></math>è¡¨ç¤ºåˆå§‹èµ„æœ¬ã€‚ç¬¬ä¸€å¤©ç»“æŸæ—¶çš„èµ„æœ¬
    <math alttext="c 1"><msub><mi>c</mi> <mn>1</mn></msub></math> å–å†³äºå½“å¤©çš„æŠ¼æ³¨æˆåŠŸæƒ…å†µï¼Œå¯èƒ½æ˜¯
    <math alttext="c 0 plus b 1"><mrow><msub><mi>c</mi> <mn>0</mn></msub> <mo>+</mo>
    <msub><mi>b</mi> <mn>1</mn></msub></mrow></math> æˆ–è€… <math alttext="c 0 minus b
    1"><mrow><msub><mi>c</mi> <mn>0</mn></msub> <mo>-</mo> <msub><mi>b</mi> <mn>1</mn></msub></mrow></math>ã€‚é‚£ä¹ˆï¼Œä¸€ä¸ªèµŒå±€é‡å¤
    <math alttext="n"><mi>n</mi></math> æ¬¡çš„é¢„æœŸå€¼å¦‚ä¸‹ï¼š
- en: <math alttext="bold upper E left-parenthesis upper B Superscript n Baseline
    right-parenthesis equals c 0 plus sigma-summation Underscript i equals 1 Overscript
    n Endscripts left-parenthesis p minus q right-parenthesis dot b Subscript i" display="block"><mrow><mi>ğ„</mi>
    <mrow><mo>(</mo> <msup><mi>B</mi> <mi>n</mi></msup> <mo>)</mo></mrow> <mo>=</mo>
    <msub><mi>c</mi> <mn>0</mn></msub> <mo>+</mo> <munderover><mo>âˆ‘</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow>
    <mi>n</mi></munderover> <mrow><mo>(</mo> <mi>p</mi> <mo>-</mo> <mi>q</mi> <mo>)</mo></mrow>
    <mo>Â·</mo> <msub><mi>b</mi> <mi>i</mi></msub></mrow></math>
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="bold upper E left-parenthesis upper B Superscript n Baseline
    right-parenthesis equals c 0 plus sigma-summation Underscript i equals 1 Overscript
    n Endscripts left-parenthesis p minus q right-parenthesis dot b Subscript i" display="block"><mrow><mi>ğ„</mi>
    <mrow><mo>(</mo> <msup><mi>B</mi> <mi>n</mi></msup> <mo>)</mo></mrow> <mo>=</mo>
    <msub><mi>c</mi> <mn>0</mn></msub> <mo>+</mo> <munderover><mo>âˆ‘</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow>
    <mi>n</mi></munderover> <mrow><mo>(</mo> <mi>p</mi> <mo>-</mo> <mi>q</mi> <mo>)</mo></mrow>
    <mo>Â·</mo> <msub><mi>b</mi> <mi>i</mi></msub></mrow></math>
- en: In classical economic theory, with risk-neutral, expected utility-maximizing
    agents, a gambler would try to maximize the preceding expression. It is easily
    seen that it is maximized by betting all available funds, <math alttext="b Subscript
    i Baseline equals c Subscript i minus 1"><mrow><msub><mi>b</mi> <mi>i</mi></msub>
    <mo>=</mo> <msub><mi>c</mi> <mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></math>
    , like in the one-shot scenario. However, this in turn implies that a single loss
    will wipe out all available funds and will lead to ruin (unless unlimited borrowing
    is possible). Therefore, this strategy does not lead to a maximization of long-term
    wealth.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ç»å…¸ç»æµç†è®ºä¸­ï¼Œå¯¹äºé£é™©ä¸­æ€§ã€æœŸæœ›æ•ˆç”¨æœ€å¤§åŒ–çš„ä»£ç†äººæ¥è¯´ï¼ŒèµŒå¾’ä¼šè¯•å›¾æœ€å¤§åŒ–ä¸Šè¿°è¡¨è¾¾å¼ã€‚å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œé€šè¿‡ä¸‹æ³¨æ‰€æœ‰å¯ç”¨èµ„é‡‘ <math alttext="b
    Subscript i Baseline equals c Subscript i minus 1"><mrow><msub><mi>b</mi> <mi>i</mi></msub>
    <mo>=</mo> <msub><mi>c</mi> <mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></math>ï¼Œå°±åƒåœ¨ä¸€æ¬¡æ€§åœºæ™¯ä¸­ä¸€æ ·ï¼Œå¯ä»¥å®ç°æœ€å¤§åŒ–ã€‚ç„¶è€Œï¼Œè¿™åè¿‡æ¥æ„å‘³ç€å•æ¬¡æŸå¤±å°†æ¸…ç©ºæ‰€æœ‰å¯ç”¨èµ„é‡‘ï¼Œå¹¶å¯¼è‡´ç ´äº§ï¼ˆé™¤éå¯ä»¥æ— é™å€Ÿè´·ï¼‰ã€‚å› æ­¤ï¼Œè¿™ç§ç­–ç•¥å¹¶ä¸èƒ½å¯¼è‡´é•¿æœŸè´¢å¯Œçš„æœ€å¤§åŒ–ã€‚
- en: 'While betting the maximum capital available might lead to sudden ruin, betting
    nothing at all avoids any kind of loss but does not benefit from the advantageous
    gamble either. This is where the Kelly criterion comes into play since it derives
    the *optimal fraction* <math alttext="f Superscript asterisk"><msup><mi>f</mi>
    <mo>*</mo></msup></math> of the available capital to bet per round of betting.
    Assume that <math alttext="n equals h plus t"><mrow><mi>n</mi> <mo>=</mo> <mi>h</mi>
    <mo>+</mo> <mi>t</mi></mrow></math> where <math alttext="h"><mi>h</mi></math>
    stands for the number of heads observed during <math alttext="n"><mi>n</mi></math>
    rounds of betting and where <math alttext="t"><mi>t</mi></math> stands for the
    number of tails. With these definitions, the available capital after <math alttext="n"><mi>n</mi></math>
    rounds is the following:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: å°½ç®¡ä¸‹æœ€å¤§èµŒæ³¨ä¼šå¯¼è‡´çªç„¶ç ´äº§ï¼Œä¸ä¸‹èµŒæ³¨åˆ™é¿å…äº†ä»»ä½•å½¢å¼çš„æŸå¤±ï¼Œä½†ä¹Ÿæ— æ³•ä»æœ‰åˆ©çš„èµŒåšä¸­å—ç›Šã€‚è¿™å°±æ˜¯å‡¯åˆ©å‡†åˆ™çš„ä½œç”¨æ‰€åœ¨ï¼Œå› ä¸ºå®ƒç¡®å®šäº†æ¯è½®ä¸‹æ³¨æ—¶å¯ç”¨èµ„æœ¬çš„*æœ€ä¼˜æ¯”ä¾‹*
    <math alttext="f Superscript asterisk"><msup><mi>f</mi> <mo>*</mo></msup></math>ã€‚å‡è®¾
    <math alttext="n equals h plus t"><mrow><mi>n</mi> <mo>=</mo> <mi>h</mi> <mo>+</mo>
    <mi>t</mi></mrow></math>ï¼Œå…¶ä¸­ <math alttext="h"><mi>h</mi></math> è¡¨ç¤ºåœ¨ <math alttext="n"><mi>n</mi></math>
    è½®ä¸‹æ³¨æœŸé—´è§‚å¯Ÿåˆ°çš„æ­£é¢æ•°é‡ï¼Œè€Œ <math alttext="t"><mi>t</mi></math> è¡¨ç¤ºåé¢æ•°é‡ã€‚åŸºäºè¿™äº›å®šä¹‰ï¼Œç»è¿‡ <math alttext="n"><mi>n</mi></math>
    è½®ä¸‹æ³¨åçš„å¯ç”¨èµ„æœ¬å¦‚ä¸‹æ‰€ç¤ºï¼š
- en: <math alttext="c Subscript n Baseline equals c 0 dot left-parenthesis 1 plus
    f right-parenthesis Superscript h Baseline dot left-parenthesis 1 minus f right-parenthesis
    Superscript t" display="block"><mrow><msub><mi>c</mi> <mi>n</mi></msub> <mo>=</mo>
    <msub><mi>c</mi> <mn>0</mn></msub> <mo>Â·</mo> <msup><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>h</mi></msup> <mo>Â·</mo> <msup><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>t</mi></msup></mrow></math>
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="c Subscript n Baseline equals c 0 dot left-parenthesis 1 plus
    f right-parenthesis Superscript h Baseline dot left-parenthesis 1 minus f right-parenthesis
    Superscript t" display="block"><mrow><msub><mi>c</mi> <mi>n</mi></msub> <mo>=</mo>
    <msub><mi>c</mi> <mn>0</mn></msub> <mo>Â·</mo> <msup><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>h</mi></msup> <mo>Â·</mo> <msup><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>t</mi></msup></mrow></math>
- en: 'In such a context, long-term wealth maximization boils down to maximizing the
    average geometric growth rate per bet which is given as follows:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹ï¼Œé•¿æœŸè´¢å¯Œæœ€å¤§åŒ–å½’ç»“ä¸ºæœ€å¤§åŒ–æ¯æ¬¡ä¸‹æ³¨çš„å¹³å‡å‡ ä½•å¢é•¿ç‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
- en: <math alttext="StartLayout 1st Row 1st Column r Superscript g 2nd Column equals
    log left-parenthesis StartFraction c Subscript n Baseline Over c 0 EndFraction
    right-parenthesis Superscript 1 slash n Baseline 2nd Row 1st Column Blank 2nd
    Column equals log left-parenthesis StartFraction c 0 dot left-parenthesis 1 plus
    f right-parenthesis Superscript h Baseline dot left-parenthesis 1 minus f right-parenthesis
    Superscript t Baseline Over c 0 EndFraction right-parenthesis Superscript 1 slash
    n Baseline 3rd Row 1st Column Blank 2nd Column equals log left-parenthesis left-parenthesis
    1 plus f right-parenthesis Superscript h Baseline dot left-parenthesis 1 minus
    f right-parenthesis Superscript t Baseline right-parenthesis Superscript 1 slash
    n Baseline 4th Row 1st Column Blank 2nd Column equals StartFraction h Over n EndFraction
    log left-parenthesis 1 plus f right-parenthesis plus StartFraction t Over n EndFraction
    log left-parenthesis 1 minus f right-parenthesis EndLayout" display="block"><mtable
    displaystyle="true"><mtr><mtd columnalign="right"><msup><mi>r</mi> <mi>g</mi></msup></mtd>
    <mtd columnalign="left"><mrow><mo>=</mo> <mo form="prefix">log</mo> <msup><mfenced
    close=")" open="(" separators=""><mfrac><msub><mi>c</mi> <mi>n</mi></msub> <msub><mi>c</mi>
    <mn>0</mn></msub></mfrac></mfenced> <mrow><mn>1</mn><mo>/</mo><mi>n</mi></mrow></msup></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mo form="prefix">log</mo> <msup><mfenced
    close=")" open="(" separators=""><mfrac><mrow><msub><mi>c</mi> <mn>0</mn></msub>
    <mo>Â·</mo><msup><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>h</mi></msup> <mo>Â·</mo><msup><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>t</mi></msup></mrow> <msub><mi>c</mi> <mn>0</mn></msub></mfrac></mfenced>
    <mrow><mn>1</mn><mo>/</mo><mi>n</mi></mrow></msup></mrow></mtd></mtr> <mtr><mtd
    columnalign="left"><mrow><mo>=</mo> <mo form="prefix">log</mo> <msup><mfenced
    close=")" open="(" separators=""><msup><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>h</mi></msup> <mo>Â·</mo><msup><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>t</mi></msup></mfenced> <mrow><mn>1</mn><mo>/</mo><mi>n</mi></mrow></msup></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mfrac><mi>h</mi> <mi>n</mi></mfrac>
    <mo form="prefix">log</mo> <mrow><mo>(</mo> <mn>1</mn> <mo>+</mo> <mi>f</mi> <mo>)</mo></mrow>
    <mo>+</mo> <mfrac><mi>t</mi> <mi>n</mi></mfrac> <mo form="prefix">log</mo> <mrow><mo>(</mo>
    <mn>1</mn> <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow></mrow></mtd></mtr></mtable></math>
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="StartLayout 1st Row 1st Column r Superscript g 2nd Column equals
    log left-parenthesis StartFraction c Subscript n Baseline Over c 0 EndFraction
    right-parenthesis Superscript 1 slash n Baseline 2nd Row 1st Column Blank 2nd
    Column equals log left-parenthesis StartFraction c 0 dot left-parenthesis 1 plus
    f right-parenthesis Superscript h Baseline dot left-parenthesis 1 minus f right-parenthesis
    Superscript t Baseline Over c 0 EndFraction right-parenthesis Superscript 1 slash
    n Baseline 3rd Row 1st Column Blank 2nd Column equals log left-parenthesis left-parenthesis
    1 plus f right-parenthesis Superscript h Baseline dot left-parenthesis 1 minus
    f right-parenthesis Superscript t Baseline right-parenthesis Superscript 1 slash
    n Baseline 4th Row 1st Column Blank 2nd Column equals StartFraction h Over n EndFraction
    log left-parenthesis 1 plus f right-parenthesis plus StartFraction t Over n EndFraction
    log left-parenthesis 1 minus f right-parenthesis EndLayout" display="block"><mtable
    displaystyle="true"><mtr><mtd columnalign="right"><msup><mi>r</mi> <mi>g</mi></msup></mtd>
    <mtd columnalign="left"><mrow><mo>=</mo> <mo form="prefix">log</mo> <msup><mfenced
    close=")" open="(" separators=""><mfrac><msub><mi>c</mi> <mi>n</mi></msub> <msub><mi>c</mi>
    <mn>0</mn></msub></mfrac></mfenced> <mrow><mn>1</mn><mo>/</mo><mi>n</mi></mrow></msup></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mo form="prefix">log</mo> <msup><mfenced
    close=")" open="(" separators=""><mfrac><mrow><msub><mi>c</mi> <mn>0</mn></msub>
    <mo>Â·</mo><msup><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>h</mi></msup> <mo>Â·</mo><msup><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>t</mi></msup></mrow> <msub><mi>c</mi> <mn>0</mn></msub></mfrac></mfenced>
    <mrow><mn>1</mn><mo>/</mo><mi>n</mi></mrow></msup></mrow></mtd></mtr> <mtr><mtd
    columnalign="left"><mrow><mo>=</mo> <mo form="prefix">log</mo> <msup><mfenced
    close=")" open="(" separators=""><msup><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>h</mi></msup> <mo>Â·</mo><msup><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow>
    <mi>t</mi></msup></mfenced> <mrow><mn>1</mn><mo>/</mo><mi>n</mi></mrow></msup></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mfrac><mi>h</mi> <mi>n</mi></mfrac>
    <mo form="prefix">log</mo> <mrow><mo>(</mo> <mn>1</mn> <mo>+</mo> <mi>f</mi> <mo>)</mo></mrow>
    <mo>+</mo> <mfrac><mi>t</mi> <mi>n</mi></mfrac> <mo form="prefix">log</mo> <mrow><mo>(</mo>
    <mn>1</mn> <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow></mrow></mtd></mtr></mtable></math>
- en: 'The problem then formally is to maximize the *expected* average rate of growth
    by choosing <math alttext="f"><mi>f</mi></math> optimally. With <math alttext="bold
    upper E left-parenthesis h right-parenthesis equals n dot p"><mrow><mi>ğ„</mi>
    <mo>(</mo> <mi>h</mi> <mo>)</mo> <mo>=</mo> <mi>n</mi> <mo>Â·</mo> <mi>p</mi></mrow></math>
    and <math alttext="bold upper E left-parenthesis t right-parenthesis equals n
    dot q"><mrow><mi>ğ„</mi> <mo>(</mo> <mi>t</mi> <mo>)</mo> <mo>=</mo> <mi>n</mi>
    <mo>Â·</mo> <mi>q</mi></mrow></math> , one gets:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œé—®é¢˜çš„æ­£å¼è¡¨è¿°æ˜¯é€šè¿‡é€‰æ‹©æœ€ä¼˜çš„ <math alttext="f"><mi>f</mi></math> æ¥æœ€å¤§åŒ–*é¢„æœŸ*çš„å¹³å‡å¢é•¿ç‡ã€‚ä½¿ç”¨ <math
    alttext="bold upper E left-parenthesis h right-parenthesis equals n dot p"><mrow><mi>ğ„</mi>
    <mo>(</mo> <mi>h</mi> <mo>)</mo> <mo>=</mo> <mi>n</mi> <mo>Â·</mo> <mi>p</mi></mrow></math>
    å’Œ <math alttext="bold upper E left-parenthesis t right-parenthesis equals n dot
    q"><mrow><mi>ğ„</mi> <mo>(</mo> <mi>t</mi> <mo>)</mo> <mo>=</mo> <mi>n</mi> <mo>Â·</mo>
    <mi>q</mi></mrow></math>ï¼Œå¯ä»¥å¾—åˆ°ï¼š
- en: <math alttext="StartLayout 1st Row 1st Column bold upper E left-parenthesis
    r Superscript g Baseline right-parenthesis 2nd Column equals bold upper E left-parenthesis
    StartFraction h Over n EndFraction log left-parenthesis 1 plus f right-parenthesis
    plus StartFraction t Over n EndFraction log left-parenthesis 1 minus f right-parenthesis
    right-parenthesis 2nd Row 1st Column Blank 2nd Column equals bold upper E left-parenthesis
    p log left-parenthesis 1 plus f right-parenthesis plus q log left-parenthesis
    1 minus f right-parenthesis right-parenthesis 3rd Row 1st Column Blank 2nd Column
    equals p log left-parenthesis 1 plus f right-parenthesis plus q log left-parenthesis
    1 minus f right-parenthesis 4th Row 1st Column Blank 2nd Column identical-to upper
    G left-parenthesis f right-parenthesis EndLayout" display="block"><mtable displaystyle="true"><mtr><mtd
    columnalign="right"><mrow><mi>ğ„</mi> <mo>(</mo> <msup><mi>r</mi> <mi>g</mi></msup>
    <mo>)</mo></mrow></mtd> <mtd columnalign="left"><mrow><mo>=</mo> <mi>ğ„</mi> <mfenced
    close=")" open="(" separators=""><mfrac><mi>h</mi> <mi>n</mi></mfrac> <mo form="prefix">log</mo>
    <mrow><mo>(</mo> <mn>1</mn> <mo>+</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>+</mo>
    <mfrac><mi>t</mi> <mi>n</mi></mfrac> <mo form="prefix">log</mo> <mrow><mo>(</mo>
    <mn>1</mn> <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow></mfenced></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mi>ğ„</mi> <mo>(</mo> <mi>p</mi>
    <mo form="prefix">log</mo> <mo>(</mo> <mn>1</mn> <mo>+</mo> <mi>f</mi> <mo>)</mo>
    <mo>+</mo> <mi>q</mi> <mo form="prefix">log</mo> <mo>(</mo> <mn>1</mn> <mo>-</mo>
    <mi>f</mi> <mo>)</mo> <mo>)</mo></mrow></mtd></mtr> <mtr><mtd columnalign="left"><mrow><mo>=</mo>
    <mi>p</mi> <mo form="prefix">log</mo> <mo>(</mo> <mn>1</mn> <mo>+</mo> <mi>f</mi>
    <mo>)</mo> <mo>+</mo> <mi>q</mi> <mo form="prefix">log</mo> <mo>(</mo> <mn>1</mn>
    <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow></mtd></mtr> <mtr><mtd columnalign="left"><mrow><mo>â‰¡</mo>
    <mi>G</mi> <mo>(</mo> <mi>f</mi> <mo>)</mo></mrow></mtd></mtr></mtable></math>
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="StartLayout 1st Row 1st Column bold upper E left-parenthesis
    r Superscript g Baseline right-parenthesis 2nd Column equals bold upper E left-parenthesis
    StartFraction h Over n EndFraction log left-parenthesis 1 plus f right-parenthesis
    plus StartFraction t Over n EndFraction log left-parenthesis 1 minus f right-parenthesis
    right-parenthesis 2nd Row 1st Column Blank 2nd Column equals bold upper E left-parenthesis
    p log left-parenthesis 1 plus f right-parenthesis plus q log left-parenthesis
    1 minus f right-parenthesis right-parenthesis 3rd Row 1st Column Blank 2nd Column
    equals p log left-parenthesis 1 plus f right-parenthesis plus q log left-parenthesis
    1 minus f right-parenthesis 4th Row 1st Column Blank 2nd Column identical-to upper
    G left-parenthesis f right-parenthesis EndLayout" display="block"><mtable displaystyle="true"><mtr><mtd
    columnalign="right"><mrow><mi>ğ„</mi> <mo>(</mo> <msup><mi>r</mi> <mi>g</mi></msup>
    <mo>)</mo></mrow></mtd> <mtd columnalign="left"><mrow><mo>=</mo> <mi>ğ„</mi> <mfenced
    close=")" open="(" separators=""><mfrac><mi>h</mi> <mi>n</mi></mfrac> <mo form="prefix">log</mo>
    <mrow><mo>(</mo> <mn>1</mn> <mo>+</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>+</mo>
    <mfrac><mi>t</mi> <mi>n</mi></mfrac> <mo form="prefix">log</mo> <mrow><mo>(</mo>
    <mn>1</mn> <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow></mfenced></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mi>ğ„</mi> <mo>(</mo> <mi>p</mi>
    <mo form="prefix">log</mo> <mo>(</mo> <mn>1</mn> <mo>+</mo> <mi>f</mi> <mo>)</mo>
    <mo>+</mo> <mi>q</mi> <mo form="prefix">log</mo> <mo>(</mo> <mn>1</mn> <mo>-</mo>
    <mi>f</mi> <mo>)</mo> <mo>)</mo></mrow></mtd></mtr> <mtr><mtd columnalign="left"><mrow><mo>=</mo>
    <mi>p</mi> <mo form="prefix">log</mo> <mo>(</mo> <mn>1</mn> <mo>+</mo> <mi>f</mi>
    <mo>)</mo> <mo>+</mo> <mi>q</mi> <mo form="prefix">log</mo> <mo>(</mo> <mn>1</mn>
    <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow></mtd></mtr> <mtr><mtd columnalign="left"><mrow><mo>â‰¡</mo>
    <mi>G</mi> <mo>(</mo> <mi>f</mi> <mo>)</mo></mrow></mtd></mtr></mtable></math>
- en: 'One can now maximize the term by choosing the optimal fraction <math alttext="f
    Superscript asterisk"><msup><mi>f</mi> <mo>*</mo></msup></math> according to the
    first order condition. The first derivative is given by the following:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨å¯ä»¥é€šè¿‡æ ¹æ®ä¸€é˜¶æ¡ä»¶é€‰æ‹©æœ€ä¼˜æ¯”ä¾‹ <math alttext="f Superscript asterisk"><msup><mi>f</mi> <mo>*</mo></msup></math>
    æ¥æœ€å¤§åŒ–è¯¥é¡¹ã€‚ç¬¬ä¸€å¯¼æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š
- en: <math alttext="StartLayout 1st Row 1st Column upper G prime left-parenthesis
    f right-parenthesis 2nd Column equals StartFraction p Over 1 plus f EndFraction
    minus StartFraction q Over 1 minus f EndFraction 2nd Row 1st Column Blank 2nd
    Column equals StartFraction p minus p f minus q minus q f Over left-parenthesis
    1 plus f right-parenthesis left-parenthesis 1 minus f right-parenthesis EndFraction
    3rd Row 1st Column Blank 2nd Column equals StartFraction p minus q minus f Over
    left-parenthesis 1 plus f right-parenthesis left-parenthesis 1 minus f right-parenthesis
    EndFraction EndLayout" display="block"><mtable displaystyle="true"><mtr><mtd columnalign="right"><mrow><msup><mi>G</mi>
    <mo>'</mo></msup> <mrow><mo>(</mo> <mi>f</mi> <mo>)</mo></mrow></mrow></mtd> <mtd
    columnalign="left"><mrow><mo>=</mo> <mfrac><mi>p</mi> <mrow><mn>1</mn><mo>+</mo><mi>f</mi></mrow></mfrac>
    <mo>-</mo> <mfrac><mi>q</mi> <mrow><mn>1</mn><mo>-</mo><mi>f</mi></mrow></mfrac></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mfrac><mrow><mi>p</mi><mo>-</mo><mi>p</mi><mi>f</mi><mo>-</mo><mi>q</mi><mo>-</mo><mi>q</mi><mi>f</mi></mrow>
    <mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>f</mi><mo>)</mo><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow></mfrac></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mfrac><mrow><mi>p</mi><mo>-</mo><mi>q</mi><mo>-</mo><mi>f</mi></mrow>
    <mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>f</mi><mo>)</mo><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow></mfrac></mrow></mtd></mtr></mtable></math>
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="StartLayout 1st Row 1st Column upper G prime left-parenthesis
    f right-parenthesis 2nd Column equals StartFraction p Over 1 plus f EndFraction
    minus StartFraction q Over 1 minus f EndFraction 2nd Row 1st Column Blank 2nd
    Column equals StartFraction p minus p f minus q minus q f Over left-parenthesis
    1 plus f right-parenthesis left-parenthesis 1 minus f right-parenthesis EndFraction
    3rd Row 1st Column Blank 2nd Column equals StartFraction p minus q minus f Over
    left-parenthesis 1 plus f right-parenthesis left-parenthesis 1 minus f right-parenthesis
    EndFraction EndLayout" display="block"><mtable displaystyle="true"><mtr><mtd columnalign="right"><mrow><msup><mi>G</mi>
    <mo>'</mo></msup> <mrow><mo>(</mo> <mi>f</mi> <mo>)</mo></mrow></mrow></mtd> <mtd
    columnalign="left"><mrow><mo>=</mo> <mfrac><mi>p</mi> <mrow><mn>1</mn><mo>+</mo><mi>f</mi></mrow></mfrac>
    <mo>-</mo> <mfrac><mi>q</mi> <mrow><mn>1</mn><mo>-</mo><mi>f</mi></mrow></mfrac></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mfrac><mrow><mi>p</mi><mo>-</mo><mi>p</mi><mi>f</mi><mo>-</mo><mi>q</mi><mo>-</mo><mi>q</mi><mi>f</mi></mrow>
    <mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>f</mi><mo>)</mo><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow></mfrac></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mfrac><mrow><mi>p</mi><mo>-</mo><mi>q</mi><mo>-</mo><mi>f</mi></mrow>
    <mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>f</mi><mo>)</mo><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow></mfrac></mrow></mtd></mtr></mtable></math>
- en: 'From the first order condition, one gets the following:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®ä¸€é˜¶æ¡ä»¶ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š
- en: <math alttext="upper G prime left-parenthesis f right-parenthesis ModifyingAbove
    equals With factorial 0 right double arrow f Superscript asterisk Baseline equals
    p minus q" display="block"><mrow><msup><mi>G</mi> <mo>'</mo></msup> <mrow><mo>(</mo>
    <mi>f</mi> <mo>)</mo></mrow> <mover accent="true"><mo>=</mo> <mo>!</mo></mover>
    <mn>0</mn> <mo>â‡’</mo> <msup><mi>f</mi> <mo>*</mo></msup> <mo>=</mo> <mi>p</mi>
    <mo>-</mo> <mi>q</mi></mrow></math>
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="upper G prime left-parenthesis f right-parenthesis ModifyingAbove
    equals With factorial 0 right double arrow f Superscript asterisk Baseline equals
    p minus q" display="block"><mrow><msup><mi>G</mi> <mo>'</mo></msup> <mrow><mo>(</mo>
    <mi>f</mi> <mo>)</mo></mrow> <mover accent="true"><mo>=</mo> <mo>!</mo></mover>
    <mn>0</mn> <mo>â‡’</mo> <msup><mi>f</mi> <mo>*</mo></msup> <mo>=</mo> <mi>p</mi>
    <mo>-</mo> <mi>q</mi></mrow></math>
- en: If one trusts this to be the maximum (and not the minimum), this result implies
    that it is optimal to invest a fraction <math alttext="f Superscript asterisk
    Baseline equals p minus q"><mrow><msup><mi>f</mi> <mo>*</mo></msup> <mo>=</mo>
    <mi>p</mi> <mo>-</mo> <mi>q</mi></mrow></math> per round of betting. With, for
    example, <math alttext="p equals"><mrow><mi>p</mi> <mo>=</mo></mrow></math> 0.55,
    one has <math alttext="f Superscript asterisk Baseline equals"><mrow><msup><mi>f</mi>
    <mo>*</mo></msup> <mo>=</mo></mrow></math> 0.55 - 0.45 = 0.1, or that the optimal
    fraction is 10%.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœç›¸ä¿¡è¿™æ˜¯æœ€å¤§å€¼ï¼ˆè€Œä¸æ˜¯æœ€å°å€¼ï¼‰ï¼Œè¿™ä¸ªç»“æœæ„å‘³ç€åœ¨æ¯è½®æŠ•æ³¨ä¸­æŠ•èµ„ä¸€éƒ¨åˆ† <math alttext="f Superscript asterisk Baseline
    equals p minus q"><mrow><msup><mi>f</mi> <mo>*</mo></msup> <mo>=</mo> <mi>p</mi>
    <mo>-</mo> <mi>q</mi></mrow></math> æ˜¯æœ€ä¼˜çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ <math alttext="p equals"><mrow><mi>p</mi>
    <mo>=</mo></mrow></math> 0.55ï¼Œåˆ™ <math alttext="f Superscript asterisk Baseline
    equals"><mrow><msup><mi>f</mi> <mo>*</mo></msup> <mo>=</mo></mrow></math> 0.55
    - 0.45 = 0.1ï¼Œæˆ–è€…æœ€ä¼˜éƒ¨åˆ†æ˜¯10%ã€‚
- en: 'The following Python code formalizes these concepts and results through simulation.
    First, some imports and configurations:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢çš„Pythonä»£ç é€šè¿‡æ¨¡æ‹Ÿå½¢å¼åŒ–äº†è¿™äº›æ¦‚å¿µå’Œç»“æœã€‚é¦–å…ˆï¼Œä¸€äº›å¯¼å…¥å’Œé…ç½®ï¼š
- en: '[PRE0]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The idea is to simulate, for example, 50 series with 100 coin tosses per series.
    The Python code for this is straightforward:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªæƒ³æ³•æ˜¯æ¨¡æ‹Ÿï¼Œä¾‹å¦‚ï¼Œæ¯ä¸ªåºåˆ—è¿›è¡Œ50æ¬¡æŠ•æ·ã€‚è¿™ä¸ªPythonä»£ç å¾ˆç®€å•ï¼š
- en: '[PRE1]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO1-1)'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO1-1)'
- en: Fixes the probability for heads.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: è®¾å®šæ­£é¢çš„æ¦‚ç‡ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO1-2)'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO1-2)'
- en: Calculates the optimal fraction according to the Kelly criterion.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®å‡¯åˆ©å‡†åˆ™è®¡ç®—æœ€ä¼˜éƒ¨åˆ†ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO1-4)'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO1-4)'
- en: The number of series to be simulated.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: è¦æ¨¡æ‹Ÿçš„åºåˆ—æ•°ã€‚
- en: '[![4](assets/4.png)](#co_automating_trading_operations_CO1-5)'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_automating_trading_operations_CO1-5)'
- en: The number of trials per series.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯ä¸ªåºåˆ—çš„è¯•éªŒæ¬¡æ•°ã€‚
- en: 'The major part is the Python function `run_simulation()`, which achieves the
    simulation according to the preceding assumptions. [FigureÂ 10-1](#auto_plot_01)
    shows the simulation results:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸»è¦éƒ¨åˆ†æ˜¯Pythonå‡½æ•°`run_simulation()`ï¼Œå®ƒæ ¹æ®å‰è¿°å‡è®¾è¿›è¡Œæ¨¡æ‹Ÿã€‚[å›¾10-1](#auto_plot_01)å±•ç¤ºäº†æ¨¡æ‹Ÿç»“æœï¼š
- en: '[PRE2]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO2-1)'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO2-1)'
- en: Instantiates an `ndarray` object to store the simulation results.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: å®ä¾‹åŒ–ä¸€ä¸ª`ndarray`å¯¹è±¡æ¥å­˜å‚¨æ¨¡æ‹Ÿç»“æœã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO2-2)'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO2-2)'
- en: Initializes the starting capital with 100.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: å°†åˆå§‹èµ„æœ¬è®¾å®šä¸º100ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO2-3)'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO2-3)'
- en: Outer loop for the series simulations.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: å¤–éƒ¨å¾ªç¯å¤„ç†åºåˆ—æ¨¡æ‹Ÿã€‚
- en: '[![4](assets/4.png)](#co_automating_trading_operations_CO2-4)'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_automating_trading_operations_CO2-4)'
- en: Inner loop for the series itself.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: å†…éƒ¨å¾ªç¯å¤„ç†åºåˆ—æœ¬èº«ã€‚
- en: '[![5](assets/5.png)](#co_automating_trading_operations_CO2-5)'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '[![5](assets/5.png)](#co_automating_trading_operations_CO2-5)'
- en: Simulates the tossing of a coin.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: æ¨¡æ‹ŸæŠ›ç¡¬å¸ã€‚
- en: '[![6](assets/6.png)](#co_automating_trading_operations_CO2-6)'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: '[![6](assets/6.png)](#co_automating_trading_operations_CO2-6)'
- en: If `1` or headsâ€¦
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ˜¯`1`æˆ–æ­£é¢â€¦
- en: '[![7](assets/7.png)](#co_automating_trading_operations_CO2-7)'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '[![7](assets/7.png)](#co_automating_trading_operations_CO2-7)'
- en: â€¦then add the win to the capital.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: â€¦åˆ™å°†èµ¢åˆ©åŠ å…¥èµ„æœ¬ã€‚
- en: '[![8](assets/8.png)](#co_automating_trading_operations_CO2-8)'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '[![8](assets/8.png)](#co_automating_trading_operations_CO2-8)'
- en: If `0` or tailsâ€¦
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ˜¯`0`æˆ–åé¢â€¦
- en: '[![9](assets/9.png)](#co_automating_trading_operations_CO2-9)'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '[![9](assets/9.png)](#co_automating_trading_operations_CO2-9)'
- en: â€¦subtract the loss from the capital.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: â€¦ä»èµ„æœ¬ä¸­æ‰£é™¤æŸå¤±ã€‚
- en: '[![10](assets/10.png)](#co_automating_trading_operations_CO2-10)'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '[![10](assets/10.png)](#co_automating_trading_operations_CO2-10)'
- en: This runs the simulation.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°†è¿è¡Œæ¨¡æ‹Ÿã€‚
- en: '[![11](assets/11.png)](#co_automating_trading_operations_CO2-11)'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '[![11](assets/11.png)](#co_automating_trading_operations_CO2-11)'
- en: Plots all 50 series.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: ç»˜åˆ¶æ‰€æœ‰50ä¸ªåºåˆ—ã€‚
- en: '[![12](assets/12.png)](#co_automating_trading_operations_CO2-12)'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '[![12](assets/12.png)](#co_automating_trading_operations_CO2-12)'
- en: Plots the average over all 50 series.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: ç»˜åˆ¶æ‰€æœ‰50ä¸ªåºåˆ—çš„å¹³å‡å€¼ã€‚
- en: '![pfat 1001](assets/pfat_1001.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1001](assets/pfat_1001.png)'
- en: Figure 10-1\. 50 simulated series with 100 trials each (red line = average)
  id: totrans-70
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾10-1\. æ¯ä¸ªæœ‰100æ¬¡è¯•éªŒçš„50ä¸ªæ¨¡æ‹Ÿåºåˆ—ï¼ˆçº¢çº¿=å¹³å‡å€¼ï¼‰
- en: 'The following code repeats the simulation for different values of <math alttext="f"><mi>f</mi></math>
    . As shown in [FigureÂ 10-2](#auto_plot_02), a lower fraction leads to a lower
    growth rate on average. Higher values might lead both to a higher average capital
    at the end of the simulation ( <math alttext="f equals"><mrow><mi>f</mi> <mo>=</mo></mrow></math>
    0.25) or lead to a much lower average capital ( <math alttext="f equals"><mrow><mi>f</mi>
    <mo>=</mo></mrow></math> 0.5]). In both cases where the fraction <math alttext="f"><mi>f</mi></math>
    is higher, the volatility increases considerably:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢çš„ä»£ç é‡å¤äº†ä¸åŒ<math alttext="f"><mi>f</mi></math>å€¼çš„æ¨¡æ‹Ÿã€‚å¦‚å›¾[10-2](#auto_plot_02)æ‰€ç¤ºï¼Œè¾ƒä½çš„åˆ†æ•°é€šå¸¸å¯¼è‡´å¹³å‡å¢é•¿ç‡è¾ƒä½ã€‚è¾ƒé«˜çš„å€¼å¯èƒ½å¯¼è‡´æ¨¡æ‹Ÿç»“æŸæ—¶çš„å¹³å‡èµ„æœ¬è¾ƒé«˜ï¼ˆ
    <math alttext="f equals"><mrow><mi>f</mi> <mo>=</mo></mrow></math> 0.25ï¼‰ï¼Œæˆ–è€…å¯¼è‡´å¹³å‡èµ„æœ¬å¤§å¹…é™ä½ï¼ˆ
    <math alttext="f equals"><mrow><mi>f</mi> <mo>=</mo></mrow></math> 0.5ï¼‰ã€‚åœ¨åˆ†æ•°è¾ƒé«˜çš„ä¸¤ç§æƒ…å†µä¸‹ï¼Œæ³¢åŠ¨æ€§æ˜¾è‘—å¢åŠ ï¼š
- en: '[PRE3]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO3-1)'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO3-1)'
- en: Simulation with <math alttext="f equals"><mrow><mi>f</mi> <mo>=</mo></mrow></math>
    0.05.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨<math alttext="f equals"><mrow><mi>f</mi> <mo>=</mo></mrow></math> 0.05è¿›è¡Œæ¨¡æ‹Ÿã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO3-2)'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO3-2)'
- en: Simulation with <math alttext="f equals"><mrow><mi>f</mi> <mo>=</mo></mrow></math>
    0.25.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨<math alttext="f equals"><mrow><mi>f</mi> <mo>=</mo></mrow></math> 0.25è¿›è¡Œæ¨¡æ‹Ÿã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO3-3)'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO3-3)'
- en: Simulation with <math alttext="f equals"><mrow><mi>f</mi> <mo>=</mo></mrow></math>
    0.5.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨<math alttext="f equals"><mrow><mi>f</mi> <mo>=</mo></mrow></math> 0.5è¿›è¡Œæ¨¡æ‹Ÿã€‚
- en: '![pfat 1002](assets/pfat_1002.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1002](assets/pfat_1002.png)'
- en: Figure 10-2\. Average capital over time for different values of <math alttext="f"><mi>f</mi></math>
  id: totrans-80
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾10-2ã€‚ä¸åŒ<math alttext="f"><mi>f</mi></math>å€¼çš„æ—¶é—´å¹³å‡èµ„æœ¬ã€‚
- en: Kelly Criterion for Stocks and Indices
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è‚¡ç¥¨å’ŒæŒ‡æ•°çš„å‡¯åˆ©å‡†åˆ™
- en: 'Assume now a stock market setting in which the relevant stock (index) can take
    on only two values after a period of one year from today, given its known value
    today. The setting is again binomial but this time a bit closer on the modeling
    side to stock market realities.^([1](ch10.html#idm45785342245112)) Specifically,
    assume the following holds true:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨å‡è®¾è‚¡ç¥¨å¸‚åœºè®¾ç½®ä¸­ï¼Œç›¸å…³è‚¡ç¥¨ï¼ˆæŒ‡æ•°ï¼‰åœ¨ä»Šå¤©ä¹‹åçš„ä¸€å¹´å†…åªèƒ½é‡‡å–ä¸¤ä¸ªå€¼ï¼Œæ ¹æ®å…¶ä»Šå¤©å·²çŸ¥çš„å€¼ã€‚å†æ¬¡ï¼Œè¯¥è®¾ç½®æ˜¯äºŒé¡¹å¼çš„ï¼Œä½†è¿™æ¬¡åœ¨å»ºæ¨¡æ–¹é¢æ›´æ¥è¿‘è‚¡å¸‚å®é™…æƒ…å†µã€‚^([1](ch10.html#idm45785342245112))
    å…·ä½“å‡è®¾å¦‚ä¸‹ï¼š
- en: <math alttext="upper P left-parenthesis r Superscript upper S Baseline equals
    mu plus sigma right-parenthesis equals upper P left-parenthesis r Superscript
    upper S Baseline equals mu minus sigma right-parenthesis equals one-half" display="block"><mrow><mi>P</mi>
    <mfenced close=")" open="(" separators=""><msup><mi>r</mi> <mi>S</mi></msup> <mo>=</mo>
    <mi>Î¼</mi> <mo>+</mo> <mi>Ïƒ</mi></mfenced> <mo>=</mo> <mi>P</mi> <mfenced close=")"
    open="(" separators=""><msup><mi>r</mi> <mi>S</mi></msup> <mo>=</mo> <mi>Î¼</mi>
    <mo>-</mo> <mi>Ïƒ</mi></mfenced> <mo>=</mo> <mfrac><mn>1</mn> <mn>2</mn></mfrac></mrow></math>
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="upper P left-parenthesis r Superscript upper S Baseline equals
    mu plus sigma right-parenthesis equals upper P left-parenthesis r Superscript
    upper S Baseline equals mu minus sigma right-parenthesis equals one-half" display="block"><mrow><mi>P</mi>
    <mfenced close=")" open="(" separators=""><msup><mi>r</mi> <mi>S</mi></msup> <mo>=</mo>
    <mi>Î¼</mi> <mo>+</mo> <mi>Ïƒ</mi></mfenced> <mo>=</mo> <mi>P</mi> <mfenced close=")"
    open="(" separators=""><msup><mi>r</mi> <mi>S</mi></msup> <mo>=</mo> <mi>Î¼</mi>
    <mo>-</mo> <mi>Ïƒ</mi></mfenced> <mo>=</mo> <mfrac><mn>1</mn> <mn>2</mn></mfrac></mrow></math>
- en: 'Here, <math alttext="bold upper E left-parenthesis r Superscript upper S Baseline
    right-parenthesis equals mu greater-than 0"><mrow><mi>ğ„</mi> <mo>(</mo> <msup><mi>r</mi>
    <mi>S</mi></msup> <mo>)</mo> <mo>=</mo> <mi>Î¼</mi> <mo>></mo> <mn>0</mn></mrow></math>
    is the the expected return of the stock over one year, and <math alttext="sigma
    greater-than 0"><mrow><mi>Ïƒ</mi> <mo>></mo> <mn>0</mn></mrow></math> is the standard
    deviation of returns (volatility). In a one-period setting, one gets the following
    for the available capital after one year (with <math alttext="c 0"><msub><mi>c</mi>
    <mn>0</mn></msub></math> and <math alttext="f"><mi>f</mi></math> defined as before):'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œ<math alttext="bold upper E left-parenthesis r Superscript upper S Baseline
    right-parenthesis equals mu greater-than 0"><mrow><mi>ğ„</mi> <mo>(</mo> <msup><mi>r</mi>
    <mi>S</mi></msup> <mo>)</mo> <mo>=</mo> <mi>Î¼</mi> <mo>></mo> <mn>0</mn></mrow></math>
    æ˜¯è‚¡ç¥¨ä¸€å¹´æœŸé¢„æœŸæ”¶ç›Šï¼Œ<math alttext="sigma greater-than 0"><mrow><mi>Ïƒ</mi> <mo>></mo> <mn>0</mn></mrow></math>
    æ˜¯æ”¶ç›Šçš„æ ‡å‡†åå·®ï¼ˆæ³¢åŠ¨æ€§ï¼‰ã€‚åœ¨ä¸€ä¸ªæœŸé—´çš„è®¾å®šä¸­ï¼Œä¸€å¹´åçš„å¯ç”¨èµ„æœ¬å¦‚ä¸‹ï¼ˆå…¶ä¸­<math alttext="c 0"><msub><mi>c</mi> <mn>0</mn></msub></math>å’Œ<math
    alttext="f"><mi>f</mi></math>å¦‚å‰æ‰€å®šä¹‰ï¼‰ï¼š
- en: <math alttext="c left-parenthesis f right-parenthesis equals c 0 dot left-parenthesis
    1 plus left-parenthesis 1 minus f right-parenthesis dot r plus f dot r Superscript
    upper S Baseline right-parenthesis" display="block"><mrow><mi>c</mi> <mrow><mo>(</mo>
    <mi>f</mi> <mo>)</mo></mrow> <mo>=</mo> <msub><mi>c</mi> <mn>0</mn></msub> <mo>Â·</mo>
    <mfenced close=")" open="(" separators=""><mn>1</mn> <mo>+</mo> <mrow><mo>(</mo>
    <mn>1</mn> <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>Â·</mo> <mi>r</mi> <mo>+</mo>
    <mi>f</mi> <mo>Â·</mo> <msup><mi>r</mi> <mi>S</mi></msup></mfenced></mrow></math>
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="c left-parenthesis f right-parenthesis equals c 0 dot left-parenthesis
    1 plus left-parenthesis 1 minus f right-parenthesis dot r plus f dot r Superscript
    upper S Baseline right-parenthesis" display="block"><mrow><mi>c</mi> <mrow><mo>(</mo>
    <mi>f</mi> <mo>)</mo></mrow> <mo>=</mo> <msub><mi>c</mi> <mn>0</mn></msub> <mo>Â·</mo>
    <mfenced close=")" open="(" separators=""><mn>1</mn> <mo>+</mo> <mrow><mo>(</mo>
    <mn>1</mn> <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>Â·</mo> <mi>r</mi> <mo>+</mo>
    <mi>f</mi> <mo>Â·</mo> <msup><mi>r</mi> <mi>S</mi></msup></mfenced></mrow></math>
- en: 'Here, <math alttext="r"><mi>r</mi></math> is the constant short rate earned
    on cash not invested in the stock. Maximizing the geometric growth rate means
    maximizing the term:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œ<math alttext="r"><mi>r</mi></math> æ˜¯æœªæŠ•èµ„äºè‚¡ç¥¨çš„ç°é‡‘æ‰€èµšçš„å›ºå®šçŸ­æœŸåˆ©ç‡ã€‚æœ€å¤§åŒ–å‡ ä½•å¢é•¿ç‡æ„å‘³ç€æœ€å¤§åŒ–è¯¥æœ¯è¯­ï¼š
- en: <math alttext="upper G left-parenthesis f right-parenthesis equals bold upper
    E left-parenthesis log StartFraction c left-parenthesis f right-parenthesis Over
    c 0 EndFraction right-parenthesis" display="block"><mrow><mi>G</mi> <mrow><mo>(</mo>
    <mi>f</mi> <mo>)</mo></mrow> <mo>=</mo> <mi>ğ„</mi> <mfenced close=")" open="("
    separators=""><mo form="prefix">log</mo> <mfrac><mrow><mi>c</mi><mo>(</mo><mi>f</mi><mo>)</mo></mrow>
    <msub><mi>c</mi> <mn>0</mn></msub></mfrac></mfenced></mrow></math>
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="upper G left-parenthesis f right-parenthesis equals bold upper
    E left-parenthesis log StartFraction c left-parenthesis f right-parenthesis Over
    c 0 EndFraction right-parenthesis" display="block"><mrow><mi>G</mi> <mrow><mo>(</mo>
    <mi>f</mi> <mo>)</mo></mrow> <mo>=</mo> <mi>ğ„</mi> <mfenced close=")" open="("
    separators=""><mo form="prefix">log</mo> <mfrac><mrow><mi>c</mi><mo>(</mo><mi>f</mi><mo>)</mo></mrow>
    <msub><mi>c</mi> <mn>0</mn></msub></mfrac></mfenced></mrow></math>
- en: 'Assume now that there are <math alttext="n"><mi>n</mi></math> relevant trading
    days in the year so that for each such trading day <math alttext="i"><mi>i</mi></math>
    the following holds true:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨å‡è®¾ä¸€å¹´ä¸­æœ‰<math alttext="n"><mi>n</mi></math>ä¸ªç›¸å…³çš„äº¤æ˜“æ—¥ï¼Œä»¥ä¾¿å¯¹æ¯ä¸ªè¿™æ ·çš„äº¤æ˜“æ—¥<math alttext="i"><mi>i</mi></math>ï¼Œä»¥ä¸‹æƒ…å†µæˆç«‹ï¼š
- en: <math alttext="upper P left-parenthesis r Subscript i Superscript upper S Baseline
    equals StartFraction mu Over n EndFraction plus StartFraction sigma Over StartRoot
    n EndRoot EndFraction right-parenthesis equals upper P left-parenthesis r Subscript
    i Superscript upper S Baseline equals StartFraction mu Over n EndFraction minus
    StartFraction sigma Over StartRoot n EndRoot EndFraction right-parenthesis equals
    one-half" display="block"><mrow><mi>P</mi> <mfenced close=")" open="(" separators=""><msubsup><mi>r</mi>
    <mi>i</mi> <mi>S</mi></msubsup> <mo>=</mo> <mfrac><mi>Î¼</mi> <mi>n</mi></mfrac>
    <mo>+</mo> <mfrac><mi>Ïƒ</mi> <msqrt><mi>n</mi></msqrt></mfrac></mfenced> <mo>=</mo>
    <mi>P</mi> <mfenced close=")" open="(" separators=""><msubsup><mi>r</mi> <mi>i</mi>
    <mi>S</mi></msubsup> <mo>=</mo> <mfrac><mi>Î¼</mi> <mi>n</mi></mfrac> <mo>-</mo>
    <mfrac><mi>Ïƒ</mi> <msqrt><mi>n</mi></msqrt></mfrac></mfenced> <mo>=</mo> <mfrac><mn>1</mn>
    <mn>2</mn></mfrac></mrow></math>
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="upper P left-parenthesis r Subscript i Superscript upper S Baseline
    equals StartFraction mu Over n EndFraction plus StartFraction sigma Over StartRoot
    n EndRoot EndFraction right-parenthesis equals upper P left-parenthesis r Subscript
    i Superscript upper S Baseline equals StartFraction mu Over n EndFraction minus
    StartFraction sigma Over StartRoot n EndRoot EndFraction right-parenthesis equals
    one-half" display="block"><mrow><mi>P</mi> <mfenced close=")" open="(" separators=""><msubsup><mi>r</mi>
    <mi>i</mi> <mi>S</mi></msubsup> <mo>=</mo> <mfrac><mi>Î¼</mi> <mi>n</mi></mfrac>
    <mo>+</mo> <mfrac><mi>Ïƒ</mi> <msqrt><mi>n</mi></msqrt></mfrac></mfenced> <mo>=</mo>
    <mi>P</mi> <mfenced close=")" open="(" separators=""><msubsup><mi>r</mi> <mi>i</mi>
    <mi>S</mi></msubsup> <mo>=</mo> <mfrac><mi>Î¼</mi> <mi>n</mi></mfrac> <mo>-</mo>
    <mfrac><mi>Ïƒ</mi> <msqrt><mi>n</mi></msqrt></mfrac></mfenced> <mo>=</mo> <mfrac><mn>1</mn>
    <mn>2</mn></mfrac></mrow></math>
- en: 'Note that volatility scales with the square root of the number of trading days.
    Under these assumptions, the daily values scale up to the yearly ones from before
    and one gets the following:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„æ³¢åŠ¨æ€§éšç€äº¤æ˜“æ—¥æ•°çš„å¹³æ–¹æ ¹è€Œå¢åŠ ã€‚åœ¨è¿™äº›å‡è®¾ä¸‹ï¼Œæ—¥å¸¸ä»·å€¼ä»ä¹‹å‰çš„å¹´åº¦ä»·å€¼æ‰©å±•åˆ°ä»¥ä¸‹å†…å®¹ï¼š
- en: <math alttext="c Subscript n Baseline left-parenthesis f right-parenthesis equals
    c 0 dot product Underscript i equals 1 Overscript n Endscripts left-parenthesis
    1 plus left-parenthesis 1 minus f right-parenthesis dot StartFraction r Over n
    EndFraction plus f dot r Subscript i Superscript upper S Baseline right-parenthesis"
    display="block"><mrow><msub><mi>c</mi> <mi>n</mi></msub> <mrow><mo>(</mo> <mi>f</mi>
    <mo>)</mo></mrow> <mo>=</mo> <msub><mi>c</mi> <mn>0</mn></msub> <mo>Â·</mo> <munderover><mo>âˆ</mo>
    <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi></munderover> <mfenced close=")"
    open="(" separators=""><mn>1</mn> <mo>+</mo> <mrow><mo>(</mo> <mn>1</mn> <mo>-</mo>
    <mi>f</mi> <mo>)</mo></mrow> <mo>Â·</mo> <mfrac><mi>r</mi> <mi>n</mi></mfrac> <mo>+</mo>
    <mi>f</mi> <mo>Â·</mo> <msubsup><mi>r</mi> <mi>i</mi> <mi>S</mi></msubsup></mfenced></mrow></math>
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="c Subscript n Baseline left-parenthesis f right-parenthesis equals
    c 0 dot product Underscript i equals 1 Overscript n Endscripts left-parenthesis
    1 plus left-parenthesis 1 minus f right-parenthesis dot StartFraction r Over n
    EndFraction plus f dot r Subscript i Superscript upper S Baseline right-parenthesis"
    display="block"><mrow><msub><mi>c</mi> <mi>n</mi></msub> <mrow><mo>(</mo> <mi>f</mi>
    <mo>)</mo></mrow> <mo>=</mo> <msub><mi>c</mi> <mn>0</mn></msub> <mo>Â·</mo> <munderover><mo>âˆ</mo>
    <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi></munderover> <mfenced close=")"
    open="(" separators=""><mn>1</mn> <mo>+</mo> <mrow><mo>(</mo> <mn>1</mn> <mo>-</mo>
    <mi>f</mi> <mo>)</mo></mrow> <mo>Â·</mo> <mfrac><mi>r</mi> <mi>n</mi></mfrac> <mo>+</mo>
    <mi>f</mi> <mo>Â·</mo> <msubsup><mi>r</mi> <mi>i</mi> <mi>S</mi></msubsup></mfenced></mrow></math>
- en: 'One now has to maximize the following quantity to achieve maximum long-term
    wealth when investing in the stock:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: æŠ•èµ„è‚¡ç¥¨æ—¶ï¼Œä¸ºäº†å®ç°é•¿æœŸè´¢å¯Œæœ€å¤§åŒ–ï¼Œç°åœ¨å¿…é¡»æœ€å¤§åŒ–ä»¥ä¸‹æ•°é‡ï¼š
- en: <math alttext="StartLayout 1st Row 1st Column upper G Subscript n Baseline left-parenthesis
    f right-parenthesis 2nd Column equals bold upper E left-parenthesis log StartFraction
    c Subscript n Baseline left-parenthesis f right-parenthesis Over c 0 EndFraction
    right-parenthesis 2nd Row 1st Column Blank 2nd Column equals bold upper E left-parenthesis
    sigma-summation Underscript i equals 1 Overscript n Endscripts log left-parenthesis
    1 plus left-parenthesis 1 minus f right-parenthesis dot StartFraction r Over n
    EndFraction plus f dot r Subscript i Superscript upper S Baseline right-parenthesis
    right-parenthesis 3rd Row 1st Column Blank 2nd Column equals one-half sigma-summation
    Underscript i equals 1 Overscript n Endscripts log left-parenthesis 1 plus left-parenthesis
    1 minus f right-parenthesis dot StartFraction r Over n EndFraction plus f dot
    left-parenthesis StartFraction mu Over n EndFraction plus StartFraction sigma
    Over StartRoot n EndRoot EndFraction right-parenthesis right-parenthesis 4th Row
    1st Column Blank 2nd Column plus log left-parenthesis 1 plus left-parenthesis
    1 minus f right-parenthesis dot StartFraction r Over n EndFraction plus f dot
    left-parenthesis StartFraction mu Over n EndFraction minus StartFraction sigma
    Over StartRoot n EndRoot EndFraction right-parenthesis right-parenthesis 5th Row
    1st Column Blank 2nd Column equals StartFraction n Over 2 EndFraction log left-parenthesis
    left-parenthesis 1 plus left-parenthesis 1 minus f right-parenthesis dot StartFraction
    r Over n EndFraction plus f dot StartFraction mu Over n EndFraction right-parenthesis
    squared minus StartFraction f squared sigma squared Over n EndFraction right-parenthesis
    EndLayout" display="block"><mtable displaystyle="true"><mtr><mtd columnalign="right"><mrow><msub><mi>G</mi>
    <mi>n</mi></msub> <mrow><mo>(</mo> <mi>f</mi> <mo>)</mo></mrow></mrow></mtd> <mtd
    columnalign="left"><mrow><mo>=</mo> <mi>ğ„</mi> <mfenced close=")" open="(" separators=""><mo
    form="prefix">log</mo> <mfrac><mrow><msub><mi>c</mi> <mi>n</mi></msub> <mrow><mo>(</mo><mi>f</mi><mo>)</mo></mrow></mrow>
    <msub><mi>c</mi> <mn>0</mn></msub></mfrac></mfenced></mrow></mtd></mtr> <mtr><mtd
    columnalign="left"><mrow><mo>=</mo> <mi>ğ„</mi> <mfenced close=")" open="(" separators=""><munderover><mo>âˆ‘</mo>
    <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi></munderover> <mo form="prefix">log</mo>
    <mfenced close=")" open="(" separators=""><mn>1</mn> <mo>+</mo> <mrow><mo>(</mo>
    <mn>1</mn> <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>Â·</mo> <mfrac><mi>r</mi>
    <mi>n</mi></mfrac> <mo>+</mo> <mi>f</mi> <mo>Â·</mo> <msubsup><mi>r</mi> <mi>i</mi>
    <mi>S</mi></msubsup></mfenced></mfenced></mrow></mtd></mtr> <mtr><mtd columnalign="left"><mrow><mo>=</mo>
    <mfrac><mn>1</mn> <mn>2</mn></mfrac> <munderover><mo>âˆ‘</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow>
    <mi>n</mi></munderover> <mo form="prefix">log</mo> <mfenced close=")" open="("
    separators=""><mn>1</mn> <mo>+</mo> <mrow><mo>(</mo> <mn>1</mn> <mo>-</mo> <mi>f</mi>
    <mo>)</mo></mrow> <mo>Â·</mo> <mfrac><mi>r</mi> <mi>n</mi></mfrac> <mo>+</mo> <mi>f</mi>
    <mo>Â·</mo> <mfenced close=")" open="(" separators=""><mfrac><mi>Î¼</mi> <mi>n</mi></mfrac>
    <mo>+</mo> <mfrac><mi>Ïƒ</mi> <msqrt><mi>n</mi></msqrt></mfrac></mfenced></mfenced></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>+</mo> <mo form="prefix">log</mo> <mfenced
    close=")" open="(" separators=""><mn>1</mn> <mo>+</mo> <mrow><mo>(</mo> <mn>1</mn>
    <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>Â·</mo> <mfrac><mi>r</mi> <mi>n</mi></mfrac>
    <mo>+</mo> <mi>f</mi> <mo>Â·</mo> <mfenced close=")" open="(" separators=""><mfrac><mi>Î¼</mi>
    <mi>n</mi></mfrac> <mo>-</mo> <mfrac><mi>Ïƒ</mi> <msqrt><mi>n</mi></msqrt></mfrac></mfenced></mfenced></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mfrac><mi>n</mi> <mn>2</mn></mfrac>
    <mo form="prefix">log</mo> <mfenced close=")" open="(" separators=""><msup><mfenced
    close=")" open="(" separators=""><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow><mo>Â·</mo><mfrac><mi>r</mi>
    <mi>n</mi></mfrac><mo>+</mo><mi>f</mi><mo>Â·</mo><mfrac><mi>Î¼</mi> <mi>n</mi></mfrac></mfenced>
    <mn>2</mn></msup> <mo>-</mo> <mfrac><mrow><msup><mi>f</mi> <mn>2</mn></msup> <msup><mi>Ïƒ</mi>
    <mn>2</mn></msup></mrow> <mi>n</mi></mfrac></mfenced></mrow></mtd></mtr></mtable></math>
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="StartLayout 1st Row 1st Column upper G Subscript n Baseline left-parenthesis
    f right-parenthesis 2nd Column equals bold upper E left-parenthesis log StartFraction
    c Subscript n Baseline left-parenthesis f right-parenthesis Over c 0 EndFraction
    right-parenthesis 2nd Row 1st Column Blank 2nd Column equals bold upper E left-parenthesis
    sigma-summation Underscript i equals 1 Overscript n Endscripts log left-parenthesis
    1 plus left-parenthesis 1 minus f right-parenthesis dot StartFraction r Over n
    EndFraction plus f dot r Subscript i Superscript upper S Baseline right-parenthesis
    right-parenthesis 3rd Row 1st Column Blank 2nd Column equals one-half sigma-summation
    Underscript i equals 1 Overscript n Endscripts log left-parenthesis 1 plus left-parenthesis
    1 minus f right-parenthesis dot StartFraction r Over n EndFraction plus f dot
    left-parenthesis StartFraction mu Over n EndFraction plus StartFraction sigma
    Over StartRoot n EndRoot EndFraction right-parenthesis right-parenthesis 4th Row
    1st Column Blank 2nd Column plus log left-parenthesis 1 plus left-parenthesis
    1 minus f right-parenthesis dot StartFraction r Over n EndFraction plus f dot
    left-parenthesis StartFraction mu Over n EndFraction minus StartFraction sigma
    Over StartRoot n EndRoot EndFraction right-parenthesis right-parenthesis 5th Row
    1st Column Blank 2nd Column equals StartFraction n Over 2 EndFraction log left-parenthesis
    left-parenthesis 1 plus left-parenthesis 1 minus f right-parenthesis dot StartFraction
    r Over n EndFraction plus f dot StartFraction mu Over n EndFraction right-parenthesis
    squared minus StartFraction f squared sigma squared Over n EndFraction right-parenthesis
    EndLayout" display="block"><mtable displaystyle="true"><mtr><mtd columnalign="right"><mrow><msub><mi>G</mi>
    <mi>n</mi></msub> <mrow><mo>(</mo> <mi>f</mi> <mo>)</mo></mrow></mrow></mtd> <mtd
    columnalign="left"><mrow><mo>=</mo> <mi>ğ„</mi> <mfenced close=")" open="(" separators=""><mo
    form="prefix">log</mo> <mfrac><mrow><msub><mi>c</mi> <mi>n</mi></msub> <mrow><mo>(</mo><mi>f</mi><mo>)</mo></mrow></mrow>
    <msub><mi>c</mi> <mn>0</mn></msub></mfrac></mfenced></mrow></mtd></mtr> <mtr><mtd
    columnalign="left"><mrow><mo>=</mo> <mi>ğ„</mi> <mfenced close=")" open="(" separators=""><munderover><mo>âˆ‘</mo>
    <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi></munderover> <mo form="prefix">log</mo>
    <mfenced close=")" open="(" separators=""><mn>1</mn> <mo>+</mo> <mrow><mo>(</mo>
    <mn>1</mn> <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>Â·</mo> <mfrac><mi>r</mi>
    <mi>n</mi></mfrac> <mo>+</mo> <mi>f</mi> <mo>Â·</mo> <msubsup><mi>r</mi> <mi>i</mi>
    <mi>S</mi></msubsup></mfenced></mfenced></mrow></mtd></mtr> <mtr><mtd columnalign="left"><mrow><mo>=</mo>
    <mfrac><mn>1</mn> <mn>2</mn></mfrac> <munderover><mo>âˆ‘</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow>
    <mi>n</mi></munderover> <mo form="prefix">log</mo> <mfenced close=")" open="("
    separators=""><mn>1</mn> <mo>+</mo> <mrow><mo>(</mo> <mn>1</mn> <mo>-</mo> <mi>f</mi>
    <mo>)</mo></mrow> <mo>Â·</mo> <mfrac><mi>r</mi> <mi>n</mi></mfrac> <mo>+</mo> <mi>f</mi>
    <mo>Â·</mo> <mfenced close=")" open="(" separators=""><mfrac><mi>Î¼</mi> <mi>n</mi></mfrac>
    <mo>+</mo> <mfrac><mi>Ïƒ</mi> <msqrt><mi>n</mi></msqrt></mfrac></mfenced></mfenced></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>+</mo> <mo form="prefix">log</mo> <mfenced
    close=")" open="(" separators=""><mn>1</mn> <mo>+</mo> <mrow><mo>(</mo> <mn>1</mn>
    <mo>-</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>Â·</mo> <mfrac><mi>r</mi> <mi>n</mi></mfrac>
    <mo>+</mo> <mi>f</mi> <mo>Â·</mo> <mfenced close=")" open="(" separators=""><mfrac><mi>Î¼</mi>
    <mi>n</mi></mfrac> <mo>-</mo> <mfrac><mi>Ïƒ</mi> <msqrt><mi>n</mi></msqrt></mfrac></mfenced></mfenced></mrow></mtd></mtr>
    <mtr><mtd columnalign="left"><mrow><mo>=</mo> <mfrac><mi>n</mi> <mn>2</mn></mfrac>
    <mo form="prefix">log</mo> <mfenced close=")" open="(" separators=""><msup><mfenced
    close=")" open="(" separators=""><mn>1</mn><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>f</mi><mo>)</mo></mrow><mo>Â·</mo><mfrac><mi>r</mi>
    <mi>n</mi></mfrac><mo>+</mo><mi>f</mi><mo>Â·</mo><mfrac><mi>Î¼</mi> <mi>n</mi></mfrac></mfenced>
    <mn>2</mn></msup> <mo>-</mo> <mfrac><mrow><msup><mi>f</mi> <mn>2</mn></msup> <msup><mi>Ïƒ</mi>
    <mn>2</mn></msup></mrow> <mi>n</mi></mfrac></mfenced></mrow></mtd></mtr></mtable></math>
- en: 'Using a [Taylor series expansion](https://oreil.ly/xX4tA), one finally arrives
    at the following:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨[Taylorçº§æ•°å±•å¼€](https://oreil.ly/xX4tA)ï¼Œæœ€ç»ˆå¾—å‡ºä»¥ä¸‹ç»“æœï¼š
- en: <math alttext="upper G Subscript n Baseline left-parenthesis f right-parenthesis
    equals r plus left-parenthesis mu minus r right-parenthesis dot f minus StartFraction
    sigma squared Over 2 EndFraction dot f squared plus script upper O left-parenthesis
    StartFraction 1 Over StartRoot n EndRoot EndFraction right-parenthesis" display="block"><mrow><msub><mi>G</mi>
    <mi>n</mi></msub> <mrow><mo>(</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>=</mo> <mi>r</mi>
    <mo>+</mo> <mrow><mo>(</mo> <mi>Î¼</mi> <mo>-</mo> <mi>r</mi> <mo>)</mo></mrow>
    <mo>Â·</mo> <mi>f</mi> <mo>-</mo> <mfrac><msup><mi>Ïƒ</mi> <mn>2</mn></msup> <mn>2</mn></mfrac>
    <mo>Â·</mo> <msup><mi>f</mi> <mn>2</mn></msup> <mo>+</mo> <mi>ğ’ª</mi> <mfenced close=")"
    open="(" separators=""><mfrac><mn>1</mn> <msqrt><mi>n</mi></msqrt></mfrac></mfenced></mrow></math>
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="upper G Subscript n Baseline left-parenthesis f right-parenthesis
    equals r plus left-parenthesis mu minus r right-parenthesis dot f minus StartFraction
    sigma squared Over 2 EndFraction dot f squared plus script upper O left-parenthesis
    StartFraction 1 Over StartRoot n EndRoot EndFraction right-parenthesis" display="block"><mrow><msub><mi>G</mi>
    <mi>n</mi></msub> <mrow><mo>(</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>=</mo> <mi>r</mi>
    <mo>+</mo> <mrow><mo>(</mo> <mi>Î¼</mi> <mo>-</mo> <mi>r</mi> <mo>)</mo></mrow>
    <mo>Â·</mo> <mi>f</mi> <mo>-</mo> <mfrac><msup><mi>Ïƒ</mi> <mn>2</mn></msup> <mn>2</mn></mfrac>
    <mo>Â·</mo> <msup><mi>f</mi> <mn>2</mn></msup> <mo>+</mo> <mi>ğ’ª</mi> <mfenced close=")"
    open="(" separators=""><mfrac><mn>1</mn> <msqrt><mi>n</mi></msqrt></mfrac></mfenced></mrow></math>
- en: 'Or for infinitely many trading points in time (that is, for continuous trading),
    one arrives at the following:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ–è€…å¯¹äºæ— é™å¤šçš„äº¤æ˜“æ—¶é—´ç‚¹ï¼ˆå³è¿ç»­äº¤æ˜“ï¼‰ï¼Œæœ€ç»ˆå¾—å‡ºä»¥ä¸‹ç»“æœï¼š
- en: <math alttext="upper G Subscript normal infinity Baseline left-parenthesis f
    right-parenthesis equals r plus left-parenthesis mu minus r right-parenthesis
    dot f minus StartFraction sigma squared Over 2 EndFraction dot f squared" display="block"><mrow><msub><mi>G</mi>
    <mi>âˆ</mi></msub> <mrow><mo>(</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>=</mo> <mi>r</mi>
    <mo>+</mo> <mrow><mo>(</mo> <mi>Î¼</mi> <mo>-</mo> <mi>r</mi> <mo>)</mo></mrow>
    <mo>Â·</mo> <mi>f</mi> <mo>-</mo> <mfrac><msup><mi>Ïƒ</mi> <mn>2</mn></msup> <mn>2</mn></mfrac>
    <mo>Â·</mo> <msup><mi>f</mi> <mn>2</mn></msup></mrow></math>
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="upper G Subscript normal infinity Baseline left-parenthesis f
    right-parenthesis equals r plus left-parenthesis mu minus r right-parenthesis
    dot f minus StartFraction sigma squared Over 2 EndFraction dot f squared" display="block"><mrow><msub><mi>G</mi>
    <mi>âˆ</mi></msub> <mrow><mo>(</mo> <mi>f</mi> <mo>)</mo></mrow> <mo>=</mo> <mi>r</mi>
    <mo>+</mo> <mrow><mo>(</mo> <mi>Î¼</mi> <mo>-</mo> <mi>r</mi> <mo>)</mo></mrow>
    <mo>Â·</mo> <mi>f</mi> <mo>-</mo> <mfrac><msup><mi>Ïƒ</mi> <mn>2</mn></msup> <mn>2</mn></mfrac>
    <mo>Â·</mo> <msup><mi>f</mi> <mn>2</mn></msup></mrow></math>
- en: 'The optimal fraction <math alttext="f Superscript asterisk"><msup><mi>f</mi>
    <mo>*</mo></msup></math> then is given through the first order condition by the
    following expression:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œé€šè¿‡ä»¥ä¸‹è¡¨è¾¾å¼é€šè¿‡ä¸€é˜¶æ¡ä»¶ç¡®å®šæœ€ä¼˜åˆ†æ•° <math alttext="f Superscript asterisk"><msup><mi>f</mi>
    <mo>*</mo></msup></math> ï¼š
- en: <math alttext="f Superscript asterisk Baseline equals StartFraction mu minus
    r Over sigma squared EndFraction" display="block"><mrow><msup><mi>f</mi> <mo>*</mo></msup>
    <mo>=</mo> <mfrac><mrow><mi>Î¼</mi><mo>-</mo><mi>r</mi></mrow> <msup><mi>Ïƒ</mi>
    <mn>2</mn></msup></mfrac></mrow></math>
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="f Superscript asterisk Baseline equals StartFraction mu minus
    r Over sigma squared EndFraction" display="block"><mrow><msup><mi>f</mi> <mo>*</mo></msup>
    <mo>=</mo> <mfrac><mrow><mi>Î¼</mi><mo>-</mo><mi>r</mi></mrow> <msup><mi>Ïƒ</mi>
    <mn>2</mn></msup></mfrac></mrow></math>
- en: This represents the expected excess return of the stock over the risk-free rate
    divided by the variance of the returns. This expression looks similar to the Sharpe
    ratio but is different.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä»£è¡¨äº†è‚¡ç¥¨é¢„æœŸè¶…è¿‡æ— é£é™©åˆ©ç‡çš„å›æŠ¥ç‡ä¸å›æŠ¥ç‡æ–¹å·®çš„æ¯”å€¼ã€‚è¿™ä¸ªè¡¨è¾¾å¼çœ‹èµ·æ¥ç±»ä¼¼äºå¤æ™®æ¯”ç‡ï¼Œä½†æœ‰æ‰€ä¸åŒã€‚
- en: 'A real-world example shall illustrate the application of the preceding formula
    and its role in leveraging equity deployed to trading strategies. The trading
    strategy under consideration is simply a *passive long position in the S&P 500
    index*. To this end, base data is quickly retrieved and required statistics are
    easily derived:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªå®é™…æ¡ˆä¾‹å°†è¯´æ˜å‰è¿°å…¬å¼çš„åº”ç”¨åŠå…¶åœ¨äº¤æ˜“ç­–ç•¥ä¸­æ æ†åŒ–çš„ä½œç”¨ã€‚è€ƒè™‘çš„äº¤æ˜“ç­–ç•¥ç®€å•åœ°æ˜¯*æ ‡å‡†æ™®å°”500æŒ‡æ•°çš„è¢«åŠ¨é•¿æœŸæŒä»“*ã€‚ä¸ºæ­¤ï¼ŒåŸºç¡€æ•°æ®è¿…é€Ÿè·å–ï¼Œå¹¶ä¸”æ‰€éœ€çš„ç»Ÿè®¡æ•°æ®å¾ˆå®¹æ˜“è¡ç”Ÿï¼š
- en: '[PRE4]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The statistical properties of the S&P 500 index over the period covered suggest
    an optimal fraction of about 4.5 to be invested in the long position in the index.
    In other words, for every dollar available, 4.5 dollars shall be invested, implying
    a *leverage ratio* of 4.5 in accordance with the optimal Kelly fraction or, in
    this case, the optimal Kelly *factor*.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ¶µç›–æœŸé—´å†…ï¼Œæ ‡å‡†æ™®å°”500æŒ‡æ•°çš„ç»Ÿè®¡ç‰¹æ€§å»ºè®®å°†çº¦4.5çš„æœ€ä¼˜åˆ†æ•°æŠ•èµ„äºæŒ‡æ•°çš„é•¿æœŸæŒä»“ä¸­ã€‚æ¢å¥è¯è¯´ï¼Œå¯¹äºæ¯å¯ç”¨ç¾å…ƒï¼Œå°†æŠ•èµ„4.5ç¾å…ƒï¼Œè¿™æ„å‘³ç€æ ¹æ®æœ€ä¼˜å‡¯åˆ©åˆ†æ•°æˆ–åœ¨è¿™ç§æƒ…å†µä¸‹æœ€ä¼˜çš„å‡¯åˆ©*å› å­*ï¼Œæ æ†ç‡ä¸º4.5ã€‚
- en: 'Everything being equal, the Kelly criterion implies a higher leverage when
    the expected return is higher and the volatility (variance) is lower:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä»–æ¡ä»¶ç›¸ç­‰æ—¶ï¼Œå‡¯åˆ©å‡†åˆ™æ„å‘³ç€åœ¨é¢„æœŸå›æŠ¥è¾ƒé«˜ä¸”æ³¢åŠ¨æ€§ï¼ˆæ–¹å·®ï¼‰è¾ƒä½æ—¶ï¼Œæ æ†ç‡æ›´é«˜ï¼š
- en: '[PRE5]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO4-1)'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO4-1)'
- en: Calculates the annualized return.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—å¹´åŒ–å›æŠ¥ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO4-3)'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO4-3)'
- en: Calculates the annualized volatility.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—å¹´åŒ–æ³¢åŠ¨ç‡ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO4-5)'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO4-5)'
- en: Sets the risk-free rate to 0 (for simplicity).
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: å°†æ— é£é™©åˆ©ç‡è®¾ç½®ä¸º0ï¼ˆç®€åŒ–èµ·è§ï¼‰ã€‚
- en: '[![4](assets/4.png)](#co_automating_trading_operations_CO4-6)'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_automating_trading_operations_CO4-6)'
- en: Calculates the optimal Kelly fraction to be invested in the strategy.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—è¦æŠ•èµ„äºç­–ç•¥çš„æœ€ä¼˜å‡¯åˆ©åˆ†æ•°ã€‚
- en: 'The following Python code simulates the application of the Kelly criterion
    and the optimal leverage ratio. For simplicity and comparison reasons, the initial
    equity is set to 1 while the initially invested total capital is set to <math
    alttext="1 dot f Superscript asterisk"><mrow><mn>1</mn> <mo>Â·</mo> <msup><mi>f</mi>
    <mo>*</mo></msup></mrow></math> . Depending on the performance of the capital
    deployed to the strategy, the total capital itself is adjusted daily according
    to the available equity. After a loss, the capital is reduced; after a profit,
    the capital is increased. The evolution of the equity position compared to the
    index itself is shown in [FigureÂ 10-3](#auto_plot_03):'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹Pythonä»£ç æ¨¡æ‹Ÿäº†å‡¯åˆ©å‡†åˆ™åŠæœ€ä¼˜æ æ†æ¯”ç‡çš„åº”ç”¨ã€‚ä¸ºäº†ç®€åŒ–å’Œæ¯”è¾ƒçš„åŸå› ï¼Œåˆå§‹èµ„æœ¬è®¾ç½®ä¸º1ï¼Œè€Œåˆå§‹æŠ•èµ„æ€»èµ„æœ¬è®¾ç½®ä¸º<math alttext="1
    dot f Superscript asterisk"><mrow><mn>1</mn> <mo>Â·</mo> <msup><mi>f</mi> <mo>*</mo></msup></mrow></math>
    ã€‚æ ¹æ®ç­–ç•¥éƒ¨ç½²çš„èµ„æœ¬è¡¨ç°ï¼Œæ¯æ—¥è°ƒæ•´å¯ç”¨æƒç›Šæ¥è°ƒæ•´æ€»èµ„æœ¬ã€‚äºæŸåï¼Œèµ„æœ¬å‡å°‘ï¼›ç›ˆåˆ©åï¼Œèµ„æœ¬å¢åŠ ã€‚ç›¸å¯¹äºæŒ‡æ•°æœ¬èº«ï¼Œæƒç›Šä½ç½®çš„æ¼”å˜æ˜¾ç¤ºåœ¨[å›¾Â 10-3](#auto_plot_03)ä¸­ï¼š
- en: '[PRE6]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO5-1)'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO5-1)'
- en: Generates a new column for `equity` and sets the initial value to 1.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: ç”Ÿæˆä¸€ä¸ªåä¸º`equity`çš„æ–°åˆ—ï¼Œå¹¶å°†åˆå§‹å€¼è®¾ä¸º1ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO5-2)'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO5-2)'
- en: Generates a new column for `capital` and sets the initial value to <math alttext="1
    dot f Superscript asterisk"><mrow><mn>1</mn> <mo>Â·</mo> <msup><mi>f</mi> <mo>*</mo></msup></mrow></math>
    .
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: ç”Ÿæˆä¸€ä¸ªåä¸º`capital`çš„æ–°åˆ—ï¼Œå¹¶å°†åˆå§‹å€¼è®¾ä¸º<math alttext="1 dot f Superscript asterisk"><mrow><mn>1</mn>
    <mo>Â·</mo> <msup><mi>f</mi> <mo>*</mo></msup></mrow></math> ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO5-3)'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO5-3)'
- en: Picks the right `DatetimeIndex` value for the previous values.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: é€‰æ‹©å‰å€¼çš„æ­£ç¡® `DatetimeIndex` å€¼ã€‚
- en: '[![4](assets/4.png)](#co_automating_trading_operations_CO5-4)'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_automating_trading_operations_CO5-4)'
- en: Calculates the new capital position given the return.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®å›æŠ¥è®¡ç®—æ–°çš„èµ„æœ¬ä½ç½®ã€‚
- en: '[![5](assets/5.png)](#co_automating_trading_operations_CO5-5)'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '[![5](assets/5.png)](#co_automating_trading_operations_CO5-5)'
- en: Adjusts the equity value according to the capital position performance.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®èµ„æœ¬ä½ç½®çš„è¡¨ç°è°ƒæ•´æƒç›Šä»·å€¼ã€‚
- en: '[![6](assets/6.png)](#co_automating_trading_operations_CO5-6)'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '[![6](assets/6.png)](#co_automating_trading_operations_CO5-6)'
- en: Adjusts the capital position given the new equity position and the fixed leverage
    ratio.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®æ–°çš„æƒç›Šä½ç½®å’Œå›ºå®šæ æ†æ¯”ä¾‹è°ƒæ•´èµ„æœ¬ä½ç½®ã€‚
- en: '[![7](assets/7.png)](#co_automating_trading_operations_CO5-7)'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '[![7](assets/7.png)](#co_automating_trading_operations_CO5-7)'
- en: Simulates the Kelly criterion based strategy for half of <math alttext="f"><mi>f</mi></math>
    â€¦
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: æ¨¡æ‹ŸåŸºäº Kelly å‡†åˆ™çš„ç­–ç•¥ï¼Œé’ˆå¯¹ä¸€åŠçš„<math alttext="f"><mi>f</mi></math>â€¦
- en: '[![8](assets/8.png)](#co_automating_trading_operations_CO5-8)'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '[![8](assets/8.png)](#co_automating_trading_operations_CO5-8)'
- en: â€¦for two thirds of <math alttext="f"><mi>f</mi></math> â€¦
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: â€¦ä¸‰åˆ†ä¹‹äºŒçš„<math alttext="f"><mi>f</mi></math> â€¦
- en: '[![9](assets/9.png)](#co_automating_trading_operations_CO5-9)'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '[![9](assets/9.png)](#co_automating_trading_operations_CO5-9)'
- en: â€¦and <math alttext="f"><mi>f</mi></math> itself.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: â€¦å’Œ<math alttext="f"><mi>f</mi></math> æœ¬èº«ã€‚
- en: '![pfat 1003](assets/pfat_1003.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1003](assets/pfat_1003.png)'
- en: Figure 10-3\. Gross performance of S&P 500 compared to equity position given
    different values of <math alttext="f"><mi>f</mi></math>
  id: totrans-135
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾ 10-3\. S&P 500 çš„æ€»è¡¨ç°ä¸ç»™å®šä¸åŒ<math alttext="f"><mi>f</mi></math>å€¼çš„æƒç›Šä½ç½®çš„æ¯”è¾ƒ
- en: 'As [FigureÂ 10-3](#auto_plot_03) illustrates, applying the optimal Kelly leverage
    leads to a rather erratic evolution of the equity position (high volatility),
    which is intuitively plausible, given the leverage ratio of 4.59\. One would expect
    the volatility of the equity position to increase with increasing leverage. Therefore,
    practitioners often do not use â€œfull Kellyâ€ (4.6), but rather â€œhalf Kellyâ€ (2.3).
    In the current example, this is reduced to:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚[å›¾ 10-3](#auto_plot_03) æ‰€ç¤ºï¼Œåº”ç”¨æœ€ä¼˜ Kelly æ æ†å¯¼è‡´æƒç›Šä½ç½®çš„æ¼”å˜ç›¸å½“ä¸ç¨³å®šï¼ˆé«˜æ³¢åŠ¨æ€§ï¼‰ï¼Œè¿™åœ¨ç›´è§‰ä¸Šæ˜¯åˆç†çš„ï¼Œè€ƒè™‘åˆ°æ æ†æ¯”ç‡ä¸º
    4.59\. é¢„è®¡éšç€æ æ†å¢åŠ ï¼Œæƒç›Šä½ç½®çš„æ³¢åŠ¨æ€§ä¼šå¢åŠ ã€‚å› æ­¤ï¼Œä»ä¸šè€…é€šå¸¸ä¸ä½¿ç”¨â€œå…¨å‡¯åˆ©â€ï¼ˆ4.6ï¼‰ï¼Œè€Œæ˜¯ä½¿ç”¨â€œåŠå‡¯åˆ©â€ï¼ˆ2.3ï¼‰ã€‚åœ¨å½“å‰ç¤ºä¾‹ä¸­ï¼Œè¿™è¢«å‡å°‘åˆ°ï¼š
- en: <math alttext="one-half dot f Superscript asterisk Baseline almost-equals 2.3"
    display="block"><mrow><mfrac><mn>1</mn> <mn>2</mn></mfrac> <mo>â€¢</mo> <msup><mi>f</mi>
    <mo>*</mo></msup> <mo>â‰ˆ</mo> <mn>2.3</mn></mrow></math>
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="one-half dot f Superscript asterisk Baseline almost-equals 2.3"
    display="block"><mrow><mfrac><mn>1</mn> <mn>2</mn></mfrac> <mo>â€¢</mo> <msup><mi>f</mi>
    <mo>*</mo></msup> <mo>â‰ˆ</mo> <mn>2.3</mn></mrow></math>
- en: Against this background, [FigureÂ 10-3](#auto_plot_03) also shows the evolution
    of the equity position for values lower than â€œfull Kelly.â€ The risk indeed reduces
    with lower values of latexmath:[$f$].
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ­¤èƒŒæ™¯ä¸‹ï¼Œ[å›¾ 10-3](#auto_plot_03) è¿˜å±•ç¤ºäº†å¯¹â€œå…¨å‡¯åˆ©â€ä½äºçš„å€¼çš„æƒç›Šä½ç½®çš„æ¼”å˜ã€‚â€œå…¨å‡¯åˆ©â€çš„é£é™©ç¡®å®éšç€ latexmath:[$f$]
    çš„é™ä½è€Œå‡å°‘ã€‚
- en: ML-Based Trading Strategy
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åŸºäº ML çš„äº¤æ˜“ç­–ç•¥
- en: '[ChapterÂ 8](ch08.html#trading_oanda) introduces the Oanda trading platform,
    its RESTful API and the Python wrapper package `tpqoa`. This section combines
    an ML-based approach for predicting the direction of market price movements with
    historical data from the Oanda v20 RESTful API to backtest an algorithmic trading
    strategy for the EUR/USD currency pair. It uses vectorized backtesting, taking
    into account this time the bid-ask spread as proportional transactions costs.
    It also adds, compared to the plain vectorized backtesting approach introduced
    in [ChapterÂ 4](ch04.html#vectorized_backtesting), a more in-depth analysis of
    the risk characteristics of the trading strategy tested.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '[ç¬¬ 8 ç« ](ch08.html#trading_oanda) ä»‹ç»äº† Oanda äº¤æ˜“å¹³å°ï¼Œå…¶ RESTful API å’Œ Python å°è£…åŒ…
    `tpqoa`ã€‚æœ¬èŠ‚å°†åŸºäº Oanda v20 RESTful API çš„å†å²æ•°æ®ï¼Œç»“åˆåŸºäº ML çš„æ–¹æ³•æ¥é¢„æµ‹å¸‚åœºä»·æ ¼èµ°åŠ¿ï¼Œä»¥æµ‹è¯• EUR/USD è´§å¸å¯¹çš„ç®—æ³•äº¤æ˜“ç­–ç•¥ã€‚å®ƒä½¿ç”¨å‘é‡åŒ–å›æµ‹ï¼Œå¹¶è€ƒè™‘äº†ä¹°å–ä»·å·®ä½œä¸ºæ¯”ä¾‹äº¤æ˜“æˆæœ¬ã€‚ä¸[ç¬¬
    4 ç« ](ch04.html#vectorized_backtesting)ä»‹ç»çš„æ™®é€šå‘é‡åŒ–å›æµ‹æ–¹æ³•ç›¸æ¯”ï¼Œå®ƒè¿˜å¯¹æ‰€æµ‹è¯•çš„äº¤æ˜“ç­–ç•¥çš„é£é™©ç‰¹å¾è¿›è¡Œäº†æ›´æ·±å…¥çš„åˆ†æã€‚'
- en: Vectorized Backtesting
  id: totrans-141
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å‘é‡åŒ–å›æµ‹
- en: 'The backtest is based on intraday data, more specifically on bars of 10 minutes
    in length. The following code connects to the Oanda v20 API and retrieves 10-minute
    bar data for one week. [FigureÂ 10-4](#auto_plot_04) visualizes the mid close prices
    over the period for which data is retrieved:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: å›æµ‹åŸºäºæ—¥å†…æ•°æ®ï¼Œæ›´å…·ä½“åœ°è¯´æ˜¯ 10 åˆ†é’Ÿé•¿çš„æ¡å½¢å›¾ã€‚ä»¥ä¸‹ä»£ç è¿æ¥åˆ° Oanda v20 API å¹¶æ£€ç´¢ä¸€å‘¨çš„ 10 åˆ†é’Ÿæ¡å½¢å›¾æ•°æ®ã€‚[å›¾ 10-4](#auto_plot_04)
    å¯è§†åŒ–äº†æ‰€æ£€ç´¢æ•°æ®çš„æ—¶é—´æ®µå†…çš„ä¸­é—´æ”¶ç›˜ä»·æ ¼ï¼š
- en: '[PRE7]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO6-1)'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO6-1)'
- en: Connects to the API and retrieves the data.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: è¿æ¥åˆ° API å¹¶æ£€ç´¢æ•°æ®ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO6-4)'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO6-4)'
- en: Specifies the average bid-ask spread.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: æŒ‡å®šå¹³å‡ä¹°å–ä»·å·®ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO6-5)'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO6-5)'
- en: Calculates the mean closing price for the data set.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—æ•°æ®é›†çš„å¹³å‡æ”¶ç›˜ä»·ã€‚
- en: '[![4](assets/4.png)](#co_automating_trading_operations_CO6-6)'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_automating_trading_operations_CO6-6)'
- en: Calculates the average proportional transactions costs given the average spread
    and the average mid closing price.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—ç»™å®šå¹³å‡å·®ä»·å’Œå¹³å‡ä¸­é—´æ”¶ç›˜ä»·çš„å¹³å‡æ¯”ä¾‹äº¤æ˜“æˆæœ¬ã€‚
- en: '![pfat 1004](assets/pfat_1004.png)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1004](assets/pfat_1004.png)'
- en: Figure 10-4\. EUR/USD exchange rate (10-minute bars)
  id: totrans-153
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾10-4\. æ¬§å…ƒ/ç¾å…ƒæ±‡ç‡ï¼ˆ10åˆ†é’ŸæŸ±çŠ¶å›¾ï¼‰
- en: 'The ML-based strategy uses a number of time series features, such as the log
    return and the minimum and the maximum of the closing price. In addition, the
    features data is lagged. In other words, the ML algorithm shall learn from historical
    patterns as embodied by the lagged features data:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: åŸºäºMLçš„ç­–ç•¥ä½¿ç”¨äº†å¤šä¸ªæ—¶é—´åºåˆ—ç‰¹å¾ï¼Œå¦‚å¯¹æ•°æ”¶ç›Šç‡ä»¥åŠæ”¶ç›˜ä»·çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚æ­¤å¤–ï¼Œç‰¹å¾æ•°æ®æ˜¯æ»åçš„ã€‚æ¢å¥è¯è¯´ï¼ŒMLç®—æ³•å°†ä»å†å²æ¨¡å¼ä¸­å­¦ä¹ ï¼Œè¿™äº›æ¨¡å¼ç”±æ»åç‰¹å¾æ•°æ®ä½“ç°ï¼š
- en: '[PRE8]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO7-1)'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO7-1)'
- en: Specifies the window length for certain features.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: æŒ‡å®šæŸäº›ç‰¹å¾çš„çª—å£é•¿åº¦ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO7-2)'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO7-2)'
- en: Calculates the log returns from the closing prices.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—æ”¶ç›˜ä»·çš„å¯¹æ•°æ”¶ç›Šç‡ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO7-3)'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO7-3)'
- en: Calculates the rolling volatility.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—æ»šåŠ¨æ³¢åŠ¨ç‡ã€‚
- en: '[![4](assets/4.png)](#co_automating_trading_operations_CO7-4)'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_automating_trading_operations_CO7-4)'
- en: Derives the time series momentum as the mean of the recent log returns.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: å°†æ—¶é—´åºåˆ—åŠ¨é‡å®šä¹‰ä¸ºæœ€è¿‘å¯¹æ•°æ”¶ç›Šç‡çš„å¹³å‡å€¼ã€‚
- en: '[![5](assets/5.png)](#co_automating_trading_operations_CO7-5)'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: '[![5](assets/5.png)](#co_automating_trading_operations_CO7-5)'
- en: Calculates the simple moving average.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—ç®€å•ç§»åŠ¨å¹³å‡çº¿ã€‚
- en: '[![6](assets/6.png)](#co_automating_trading_operations_CO7-6)'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '[![6](assets/6.png)](#co_automating_trading_operations_CO7-6)'
- en: Calculates the rolling maximum value.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—æ»šåŠ¨æœ€å¤§å€¼ã€‚
- en: '[![7](assets/7.png)](#co_automating_trading_operations_CO7-7)'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: '[![7](assets/7.png)](#co_automating_trading_operations_CO7-7)'
- en: Calculates the rolling minimum value.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—æ»šåŠ¨æœ€å°å€¼ã€‚
- en: '[![8](assets/8.png)](#co_automating_trading_operations_CO7-8)'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '[![8](assets/8.png)](#co_automating_trading_operations_CO7-8)'
- en: Adds the lagged features data to the `DataFrame` object.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: å°†æ»åç‰¹å¾æ•°æ®æ·»åŠ åˆ°`DataFrame`å¯¹è±¡ä¸­ã€‚
- en: '[![9](assets/9.png)](#co_automating_trading_operations_CO7-11)'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: '[![9](assets/9.png)](#co_automating_trading_operations_CO7-11)'
- en: Defines the labels data as the market direction (`+1` or *up* and `-1` or *down*).
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: å°†æ ‡ç­¾æ•°æ®å®šä¹‰ä¸ºå¸‚åœºæ–¹å‘ï¼ˆ`+1`æˆ–*ä¸Šæ¶¨*å’Œ`-1`æˆ–*ä¸‹è·Œ*ï¼‰ã€‚
- en: '[![10](assets/10.png)](#co_automating_trading_operations_CO7-12)'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '[![10](assets/10.png)](#co_automating_trading_operations_CO7-12)'
- en: Shows a small sub-set from the resulting lagged features data.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜¾ç¤ºç»“æœæ»åç‰¹å¾æ•°æ®çš„ä¸€ä¸ªå°å­é›†ã€‚
- en: Given the features and label data, different supervised learning algorithms
    could now be applied. In what follows, a so-called *AdaBoost algorithm* for classification
    is used from the `scikit-learn` ML package (see [`AdaBoostClassifier`](https://oreil.ly/WIANy)).
    The idea of boosting in the context of classification is to use an *ensemble*
    of base classifiers to arrive at a superior predictor that is supposed to be less
    prone to overfitting (see [â€œData Snooping and Overfittingâ€](ch04.html#data_snooping)).
    As the base classifier, a *decision tree classification algorithm* from `scikit-learn`
    is used (see [`DecisionTreeClassifier`](https://oreil.ly/wb-wh)).
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: é’ˆå¯¹ç‰¹å¾å’Œæ ‡ç­¾æ•°æ®ï¼Œç°åœ¨å¯ä»¥åº”ç”¨ä¸åŒçš„ç›‘ç£å­¦ä¹ ç®—æ³•ã€‚æ¥ä¸‹æ¥ï¼Œä½¿ç”¨`scikit-learn` MLåŒ…ä¸­çš„æ‰€è°“*AdaBoostç®—æ³•*è¿›è¡Œåˆ†ç±»ï¼ˆå‚è§[`AdaBoostClassifier`](https://oreil.ly/WIANy)ï¼‰ã€‚åœ¨åˆ†ç±»çš„èƒŒæ™¯ä¸‹ï¼Œå¢å¼ºçš„æ¦‚å¿µæ˜¯ä½¿ç”¨åŸºåˆ†ç±»å™¨çš„*é›†æˆ*ï¼Œä»¥å¾—åˆ°ä¸€ä¸ªæ›´ä¼˜çš„é¢„æµ‹å™¨ï¼Œç†è®ºä¸Šä¸å¤ªå®¹æ˜“è¿‡æ‹Ÿåˆï¼ˆå‚è§[â€œæ•°æ®çª¥æ¢å’Œè¿‡æ‹Ÿåˆâ€](ch04.html#data_snooping)ï¼‰ã€‚ä½œä¸ºåŸºåˆ†ç±»å™¨ï¼Œä½¿ç”¨äº†`scikit-learn`ä¸­çš„*å†³ç­–æ ‘åˆ†ç±»ç®—æ³•*ï¼ˆå‚è§[`DecisionTreeClassifier`](https://oreil.ly/wb-wh)ï¼‰ã€‚
- en: 'The code trains and tests the algorithmic trading strategy based on a sequential
    train-test split. The accuracy scores of the model for the training and test data
    are both significantly above 50%. Instead of accuracy scores, one would also speak
    in a financial trading context of the *hit ratio* of the trading strategy (that
    is, the number of winning trades compared to all trades). Since the hit ratio
    is significantly greater than 50%, this might indicateâ€”in the context of the Kelly
    criterionâ€”a statistical edge compared to a random walk setting:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: è¯¥ä»£ç æ ¹æ®é¡ºåºè®­ç»ƒ-æµ‹è¯•åˆ†å‰²æ¥è®­ç»ƒå’Œæµ‹è¯•ç®—æ³•äº¤æ˜“ç­–ç•¥ã€‚æ¨¡å‹åœ¨è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ä¸Šçš„å‡†ç¡®ç‡åˆ†æ•°å‡æ˜¾è‘—é«˜äº50%ã€‚é™¤äº†å‡†ç¡®ç‡åˆ†æ•°å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨é‡‘èäº¤æ˜“çš„èƒŒæ™¯ä¸‹è®¨è®ºäº¤æ˜“ç­–ç•¥çš„*å‘½ä¸­ç‡*ï¼ˆå³è·èƒœäº¤æ˜“æ•°ä¸æ‰€æœ‰äº¤æ˜“æ•°çš„æ¯”ä¾‹ï¼‰ã€‚ç”±äºå‘½ä¸­ç‡æ˜¾è‘—é«˜äº50%ï¼Œè¿™å¯èƒ½è¡¨æ˜â€”â€”æ ¹æ®å‡¯åˆ©å‡†åˆ™çš„èƒŒæ™¯â€”â€”ç›¸å¯¹äºéšæœºè¡Œèµ°è®¾ç½®ï¼Œå­˜åœ¨ç»Ÿè®¡ä¼˜åŠ¿ï¼š
- en: '[PRE9]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO8-1)'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO9-1)'
- en: Specifies major parameters for the ML algorithm (see the references for the
    model classes provided previously).
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: æŒ‡å®šæœºå™¨å­¦ä¹ ç®—æ³•çš„ä¸»è¦å‚æ•°ï¼ˆè¯·å‚é˜…ä¹‹å‰æä¾›çš„æ¨¡å‹ç±»çš„å‚è€ƒèµ„æ–™ï¼‰ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO8-6)'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO8-6)'
- en: Instantiates the base classification algorithm (decision tree).
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: å®ä¾‹åŒ–åŸºç¡€åˆ†ç±»ç®—æ³•ï¼ˆå†³ç­–æ ‘ï¼‰ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO8-7)'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO9-3)'
- en: Instantiates the AdaBoost classification algorithm.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: å®ä¾‹åŒ–AdaBooståˆ†ç±»ç®—æ³•ã€‚
- en: '[![4](assets/4.png)](#co_automating_trading_operations_CO8-8)'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_automating_trading_operations_CO8-8)'
- en: Applies Gaussian normalization to the *training* features data set.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹*è®­ç»ƒ*ç‰¹å¾æ•°æ®é›†åº”ç”¨é«˜æ–¯å½’ä¸€åŒ–ã€‚
- en: '[![5](assets/5.png)](#co_automating_trading_operations_CO8-10)'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '[![5](assets/5.png)](#co_automating_trading_operations_CO8-10)'
- en: Fits the model based on the training data set.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®è®­ç»ƒæ•°æ®é›†æ‹Ÿåˆæ¨¡å‹ã€‚
- en: '[![6](assets/6.png)](#co_automating_trading_operations_CO8-11)'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: '[![6](assets/6.png)](#co_automating_trading_operations_CO8-11)'
- en: Shows the accuracy of the predictions from the trained model *in-sample* (training
    data set).
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: å±•ç¤ºæ¥è‡ªè®­ç»ƒæ¨¡å‹çš„*æ ·æœ¬å†…*é¢„æµ‹å‡†ç¡®ç‡ï¼ˆè®­ç»ƒæ•°æ®é›†ï¼‰ã€‚
- en: '[![7](assets/7.png)](#co_automating_trading_operations_CO8-12)'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: '[![7](assets/7.png)](#co_automating_trading_operations_CO8-12)'
- en: Applies Gaussian normalization to the *testing* features data set (using the
    parameters from the training features data set).
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹*æµ‹è¯•*ç‰¹å¾æ•°æ®é›†åº”ç”¨é«˜æ–¯å½’ä¸€åŒ–ï¼ˆä½¿ç”¨è®­ç»ƒç‰¹å¾æ•°æ®é›†çš„å‚æ•°ï¼‰ã€‚
- en: '[![8](assets/8.png)](#co_automating_trading_operations_CO8-14)'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: '[![8](assets/8.png)](#co_automating_trading_operations_CO8-14)'
- en: Generates the predictions for the test data set.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: ç”Ÿæˆæµ‹è¯•æ•°æ®é›†çš„é¢„æµ‹ã€‚
- en: '[![9](assets/9.png)](#co_automating_trading_operations_CO8-15)'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '[![9](assets/9.png)](#co_automating_trading_operations_CO8-15)'
- en: Shows the accuracy of the predictions from the trained model *out-of-sample*
    (test data set).
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: å±•ç¤ºæ¥è‡ªè®­ç»ƒæ¨¡å‹çš„*æ ·æœ¬å¤–*é¢„æµ‹å‡†ç¡®ç‡ã€‚
- en: 'It is well known that the hit ratio is only one side of the coin of success
    in financial trading. The other side comprises, among other things, getting the
    important trades right, as well as the transactions costs implied by the trading
    strategy.^([2](ch10.html#idm45785339950712)) To this end, only a formal vectorized
    backtesting approach allows one to judge the quality of the trading strategy.
    The following code takes into account the proportional transaction costs based
    on the average bid-ask spread. [FigureÂ 10-5](#auto_plot_05) compares the performance
    of the algorithmic trading strategy (without and with proportional transaction
    costs) to the performance of the passive benchmark investment:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: ä¼—æ‰€å‘¨çŸ¥ï¼Œå‘½ä¸­ç‡åªæ˜¯é‡‘èäº¤æ˜“æˆåŠŸçš„ä¸€æ–¹é¢ã€‚å¦ä¸€æ–¹é¢åŒ…æ‹¬æ­£ç¡®æŠŠæ¡é‡è¦äº¤æ˜“å’Œäº¤æ˜“ç­–ç•¥éšå«çš„äº¤æ˜“æˆæœ¬ç­‰å› ç´ ã€‚^([2](ch10.html#idm45785339950712))
    ä¸ºæ­¤ï¼Œåªæœ‰æ­£å¼çš„çŸ¢é‡åŒ–å›æµ‹æ–¹æ³•æ‰èƒ½è¯„ä¼°äº¤æ˜“ç­–ç•¥çš„è´¨é‡ã€‚ä»¥ä¸‹ä»£ç è€ƒè™‘äº†åŸºäºå¹³å‡ä¹°å–ä»·å·®çš„æ¯”ä¾‹äº¤æ˜“æˆæœ¬ã€‚[å›¾Â 10-5](#auto_plot_05) æ¯”è¾ƒäº†ç®—æ³•äº¤æ˜“ç­–ç•¥ï¼ˆæ— äº¤æ˜“æˆæœ¬å’Œæœ‰æ¯”ä¾‹äº¤æ˜“æˆæœ¬ï¼‰ä¸è¢«åŠ¨åŸºå‡†æŠ•èµ„çš„è¡¨ç°ï¼š
- en: '[PRE10]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO9-1)'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO9-1)'
- en: Derives the log returns for the ML-based algorithmic trading strategy.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: æ¨å¯¼åŸºäºæœºå™¨å­¦ä¹ çš„ç®—æ³•äº¤æ˜“ç­–ç•¥çš„å¯¹æ•°æ”¶ç›Šç‡ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO9-2)'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO9-2)'
- en: Calculates the number of trades implied by the trading strategy based on changes
    in the position.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®æŒä»“å˜åŠ¨è®¡ç®—äº¤æ˜“ç­–ç•¥æ¶‰åŠçš„äº¤æ˜“æ¬¡æ•°ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO9-3)'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO9-3)'
- en: Whenever a trade takes place, the proportional transaction costs are subtracted
    from the strategyâ€™s log return on that day.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯æ¬¡äº¤æ˜“å‘ç”Ÿæ—¶ï¼Œä»è¯¥æ—¥ç­–ç•¥çš„å¯¹æ•°æ”¶ç›Šä¸­æ‰£é™¤æ¯”ä¾‹äº¤æ˜“æˆæœ¬ã€‚
- en: '![pfat 1005](assets/pfat_1005.png)'
  id: totrans-205
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1005](assets/pfat_1005.png)'
- en: Figure 10-5\. Gross performance of EUR/USD exchange rate and algorithmic trading
    strategy (before and after transaction costs)
  id: totrans-206
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾ 10-5\. EUR/USDæ±‡ç‡å’Œç®—æ³•äº¤æ˜“ç­–ç•¥çš„æ€»ä½“è¡¨ç°ï¼ˆæ‰£é™¤äº¤æ˜“æˆæœ¬å‰åï¼‰
- en: Vectorized backtesting has its limits with regard to how close to market realities
    strategies can be tested. For example, it does not allow one to include fixed
    transaction costs per trade directly. One could, as an approximation, take a multiple
    of the average proportional transaction costs (based on average position sizes)
    to account indirectly for fixed transactions costs. However, this would not be
    precise in general. If a higher degree of precision is required, other approaches,
    such as *event-based backtesting* (see [ChapterÂ 6](ch06.html#event_based_backtesting))
    with explicit loops over every bar of the price data, need to be applied.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: çŸ¢é‡åŒ–å›æµ‹åœ¨æµ‹è¯•ç­–ç•¥æ¥è¿‘å¸‚åœºå®é™…æƒ…å†µæ–¹é¢å­˜åœ¨å±€é™æ€§ã€‚ä¾‹å¦‚ï¼Œå®ƒä¸å…è®¸ç›´æ¥åŒ…æ‹¬æ¯ç¬”äº¤æ˜“çš„å›ºå®šäº¤æ˜“æˆæœ¬ã€‚å¯ä»¥ä½œä¸ºä¸€ç§è¿‘ä¼¼ï¼Œé€šè¿‡å–å¹³å‡ä½ç½®å¤§å°çš„å¹³å‡æ¯”ä¾‹äº¤æ˜“æˆæœ¬çš„å€æ•°æ¥é—´æ¥è€ƒè™‘å›ºå®šäº¤æ˜“æˆæœ¬ã€‚ç„¶è€Œï¼Œè¿™ä¸€æ–¹æ³•é€šå¸¸ä¸å¤Ÿç²¾ç¡®ã€‚å¦‚æœéœ€è¦æ›´é«˜ç²¾åº¦ï¼Œéœ€è¦é‡‡ç”¨å…¶ä»–æ–¹æ³•ï¼Œæ¯”å¦‚*åŸºäºäº‹ä»¶çš„å›æµ‹*ï¼ˆè§[ç¬¬
    6 ç« ](ch06.html#event_based_backtesting)ï¼‰ ï¼Œé€šè¿‡å¯¹ä»·æ ¼æ•°æ®çš„æ¯ä¸ªæ¡å½¢å›¾è¿›è¡Œæ˜¾å¼å¾ªç¯ã€‚
- en: Optimal Leverage
  id: totrans-208
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æœ€ä½³æ æ†
- en: 'Equipped with the trading strategyâ€™s log returns data, the mean and variance
    values can be calculated in order to derive the optimal leverage according to
    the Kelly criterion. The code that follows scales the numbers to annualized values,
    although this does not change the optimal leverage values according to the Kelly
    criterion since the mean return and the variance scale with the same factor:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: é…å¤‡äº¤æ˜“ç­–ç•¥çš„å¯¹æ•°æ”¶ç›Šæ•°æ®ï¼Œå¯ä»¥è®¡ç®—å‡å€¼å’Œæ–¹å·®å€¼ï¼Œä»¥ä¾¿æ ¹æ®å‡¯åˆ©å‡†åˆ™ç¡®å®šæœ€ä½³æ æ†ã€‚æ¥ä¸‹æ¥çš„ä»£ç å°†è¿™äº›æ•°å­—ç¼©æ”¾ä¸ºå¹´åŒ–å€¼ï¼Œå°½ç®¡è¿™ä¸ä¼šæ”¹å˜æ ¹æ®å‡¯åˆ©å‡†åˆ™çš„æœ€ä½³æ æ†å€¼ï¼Œå› ä¸ºå‡å€¼å›æŠ¥å’Œæ–¹å·®éšç€åŒä¸€å› å­ç¼©æ”¾ï¼š
- en: '[PRE11]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO10-1)'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO10-1)'
- en: Annualized mean returns.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: å¹´åŒ–å¹³å‡å›æŠ¥ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO10-2)'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO10-2)'
- en: Annualized variances.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: å¹´åŒ–æ–¹å·®ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO10-3)'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO10-3)'
- en: Annualized volatilities.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: å¹´åŒ–æ³¢åŠ¨ç‡ã€‚
- en: '[![4](assets/4.png)](#co_automating_trading_operations_CO10-4)'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_automating_trading_operations_CO10-4)'
- en: Optimal leverage according to the Kelly criterion (â€œfull Kellyâ€).
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®å‡¯åˆ©å‡†åˆ™ç¡®å®šçš„æœ€ä½³æ æ†ï¼ˆâ€œå…¨å‡¯åˆ©â€ï¼‰ã€‚
- en: '[![5](assets/5.png)](#co_automating_trading_operations_CO10-5)'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: '[![5](assets/5.png)](#co_automating_trading_operations_CO10-5)'
- en: Optimal leverage according to the Kelly criterion (â€œhalf Kellyâ€).
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®å‡¯åˆ©å‡†åˆ™ï¼ˆâ€œåŠå‡¯åˆ©â€ï¼‰ç¡®å®šçš„æœ€ä½³æ æ†ã€‚
- en: 'Using the â€œhalf Kellyâ€ criterion, the optimal leverage for the trading strategy
    is above 50\. With a number of brokers, such as Oanda, and certain financial instruments,
    such as foreign exchange pairs and contracts for difference (CFDs), such leverage
    ratios are feasible, even for retail traders. [FigureÂ 10-6](#auto_plot_06) shows,
    in comparison, the performance of the trading strategy with transaction costs
    for different leverage values:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨â€œåŠå‡¯åˆ©â€å‡†åˆ™ï¼Œäº¤æ˜“ç­–ç•¥çš„æœ€ä½³æ æ†åœ¨50ä»¥ä¸Šã€‚å¯¹äºä¸€äº›ç»çºªå•†ï¼Œå¦‚Oandaï¼Œä»¥åŠæŸäº›é‡‘èå·¥å…·ï¼Œå¦‚å¤–æ±‡å¯¹å’Œå·®ä»·åˆçº¦ï¼ˆCFDsï¼‰ï¼Œå³ä½¿å¯¹äºé›¶å”®äº¤æ˜“è€…ï¼Œè¿™æ ·çš„æ æ†æ¯”ç‡ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚[å›¾
    10-6](#auto_plot_06)æ˜¾ç¤ºäº†å¸¦æœ‰äº¤æ˜“æˆæœ¬çš„ä¸åŒæ æ†å€¼ä¸‹äº¤æ˜“ç­–ç•¥çš„è¡¨ç°æ¯”è¾ƒï¼š
- en: '[PRE12]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO11-1)'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO11-1)'
- en: Scales the strategy returns for different leverage values.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: ç¼©æ”¾ä¸åŒæ æ†å€¼çš„ç­–ç•¥å›æŠ¥ã€‚
- en: '![pfat 1006](assets/pfat_1006.png)'
  id: totrans-225
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1006](assets/pfat_1006.png)'
- en: Figure 10-6\. Gross performance of the algorithmic trading strategy for different
    leverage values
  id: totrans-226
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾ 10-6\. ç®—æ³•äº¤æ˜“ç­–ç•¥åœ¨ä¸åŒæ æ†å€¼ä¸‹çš„æ€»ä½“è¡¨ç°
- en: Leverage increases risks associated with trading strategies significantly. Traders
    should read the risk disclaimers and regulations carefully. A positive backtesting
    performance is also no guarantee whatsoever for future performances. All results
    shown are illustrative only and are meant to demonstrate the application of programming
    and analytics approaches. In some jurisdictions, such as in Germany, leverage
    ratios are capped for retail traders based on different groups of financial instruments.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: æ æ†å¢åŠ äº†ä¸äº¤æ˜“ç­–ç•¥ç›¸å…³çš„é£é™©ã€‚äº¤æ˜“è€…åº”ä»”ç»†é˜…è¯»é£é™©å£°æ˜å’Œç›‘ç®¡è§„å®šã€‚ç§¯æçš„å›æµ‹è¡¨ç°ä¹Ÿä¸èƒ½ä¿è¯æœªæ¥çš„è¡¨ç°ã€‚æ‰€æœ‰å±•ç¤ºçš„ç»“æœä»…ç”¨äºè¯´æ˜ç¼–ç¨‹å’Œåˆ†ææ–¹æ³•çš„åº”ç”¨ã€‚åœ¨æŸäº›å¸æ³•ç®¡è¾–åŒºï¼Œå¦‚å¾·å›½ï¼Œé›¶å”®äº¤æ˜“è€…çš„æ æ†æ¯”ä¾‹æ ¹æ®ä¸åŒçš„é‡‘èå·¥å…·ç»„åˆ«è¿›è¡Œé™åˆ¶ã€‚
- en: Risk Analysis
  id: totrans-228
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é£é™©åˆ†æ
- en: 'Since leverage increases the risk associated with a certain trading strategy
    considerably, a more in-depth risk analysis seems in order. The risk analysis
    that follows assumes a leverage ratio of 30\. First, the maximum drawdown and
    the longest drawdown period shall be calculated. *Maximum drawdown* is the largest
    loss (dip) after a recent high. Accordingly, the *longest drawdown period* is
    the longest period that the trading strategy needs to get back to a recent high.
    The analysis assumes that the initial equity position is 3,333 EUR leading to
    an initial position size of 100,000 EUR for a leverage ratio of 30\. It also assumes
    that there are no adjustments with regard to the equity over time, no matter what
    the performance is:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºæ æ†æ˜¾è‘—å¢åŠ äº†ä¸æŸä¸€äº¤æ˜“ç­–ç•¥ç›¸å…³çš„é£é™©ï¼Œå› æ­¤éœ€è¦è¿›è¡Œæ›´æ·±å…¥çš„é£é™©åˆ†æã€‚éšåçš„é£é™©åˆ†æå‡è®¾æ æ†æ¯”ç‡ä¸º30ã€‚é¦–å…ˆï¼Œå°†è®¡ç®—æœ€å¤§å›æ’¤å’Œæœ€é•¿å›æ’¤æœŸã€‚*æœ€å¤§å›æ’¤*æ˜¯æœ€è¿‘é«˜ç‚¹åçš„æœ€å¤§æŸå¤±ï¼ˆä½ç‚¹ï¼‰ã€‚å› æ­¤ï¼Œ*æœ€é•¿å›æ’¤æœŸ*æ˜¯äº¤æ˜“ç­–ç•¥éœ€è¦æ¢å¤åˆ°æœ€è¿‘é«˜ç‚¹çš„æœ€é•¿æ—¶é—´ã€‚åˆ†æå‡è®¾åˆå§‹è‚¡æœ¬ä½ç½®ä¸º3,333æ¬§å…ƒï¼Œå¯¼è‡´æ æ†æ¯”ç‡ä¸º30çš„åˆå§‹å¤´å¯¸å¤§å°ä¸º100,000æ¬§å…ƒã€‚è¿˜å‡è®¾æ— è®ºç»©æ•ˆå¦‚ä½•ï¼Œè‚¡æœ¬éšæ—¶é—´ä¸ä¼šè°ƒæ•´ï¼š
- en: '[PRE13]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO12-1)'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO12-1)'
- en: The initial equity.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: åˆå§‹è‚¡æƒã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO12-2)'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO12-2)'
- en: The relevant log returns time seriesâ€¦
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: ç›¸å…³çš„å¯¹æ•°æ”¶ç›Šæ—¶é—´åºåˆ—â€¦
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO12-3)'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO12-3)'
- en: â€¦scaled by the initial equity.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: â€¦æŒ‰åˆå§‹è‚¡æƒç¼©æ”¾ã€‚
- en: '[![4](assets/4.png)](#co_automating_trading_operations_CO12-4)'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_automating_trading_operations_CO12-4)'
- en: The cumulative maximum values over time.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: éšæ—¶é—´çš„ç´¯è®¡æœ€å¤§å€¼ã€‚
- en: '[![5](assets/5.png)](#co_automating_trading_operations_CO12-5)'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: '[![5](assets/5.png)](#co_automating_trading_operations_CO12-5)'
- en: The drawdown values over time.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: éšæ—¶é—´å˜åŒ–çš„å›æ’¤æ•°å€¼ã€‚
- en: '[![6](assets/6.png)](#co_automating_trading_operations_CO12-6)'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: '[![6](assets/6.png)](#co_automating_trading_operations_CO12-6)'
- en: The maximum drawdown value.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€å¤§å›æ’¤å€¼ã€‚
- en: '[![7](assets/7.png)](#co_automating_trading_operations_CO12-7)'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: '[![7](assets/7.png)](#co_automating_trading_operations_CO12-7)'
- en: The point in time when it happens.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: å‘ç”Ÿæ—¶çš„æ—¶é—´ç‚¹ã€‚
- en: 'Technically, a new high is characterized by a drawdown value of 0\. The drawdown
    period is the time between two such highs. [FigureÂ 10-7](#auto_plot_07) visualizes
    both the maximum drawdown and the drawdown periods:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: æŠ€æœ¯ä¸Šï¼Œæ–°é«˜ç‚¹çš„ç‰¹å¾æ˜¯å›æ’¤å€¼ä¸º0ã€‚å›æ’¤æœŸæ˜¯ä¸¤ä¸ªè¿™æ ·çš„é«˜ç‚¹ä¹‹é—´çš„æ—¶é—´ã€‚[å›¾10-7](#auto_plot_07)å¯è§†åŒ–äº†æœ€å¤§å›æ’¤å’Œå›æ’¤æœŸï¼š
- en: '[PRE14]'
  id: totrans-246
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO13-1)'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO13-1)'
- en: Identifies highs for which the drawdown must be 0.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: ç¡®å®šéœ€è¦å°†å›æ’¤é™ä¸º0çš„é«˜ç‚¹ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO13-2)'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO13-2)'
- en: Calculates the `timedelta` values between all highs.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: è®¡ç®—æ‰€æœ‰é«˜ç‚¹ä¹‹é—´çš„`timedelta`å€¼ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO13-4)'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO13-4)'
- en: The longest drawdown period in *seconds*â€¦
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: '*ç§’*ä¸ºå•ä½çš„æœ€é•¿å›æ’¤æœŸâ€¦'
- en: '[![4](assets/4.png)](#co_automating_trading_operations_CO13-6)'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_automating_trading_operations_CO13-6)'
- en: â€¦transformed to *hours*.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: â€¦è½¬æ¢ä¸º*å°æ—¶*ã€‚
- en: Another important risk measure is *value-at-risk* (VaR). It is quoted as a currency
    amount and represents the maximum loss to be expected given both a certain time
    horizon and a confidence level.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: å¦ä¸€ä¸ªé‡è¦çš„é£é™©åº¦é‡æ˜¯*é£é™©ä»·å€¼*ï¼ˆVaRï¼‰ã€‚å®ƒä»¥è´§å¸é‡‘é¢è¡¨ç¤ºï¼Œä»£è¡¨åœ¨ç‰¹å®šæ—¶é—´æ®µå’Œç½®ä¿¡æ°´å¹³ä¸‹å¯èƒ½å‘ç”Ÿçš„æœ€å¤§æŸå¤±ã€‚
- en: '![pfat 1007](assets/pfat_1007.png)'
  id: totrans-256
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1007](assets/pfat_1007.png)'
- en: Figure 10-7\. Maximum drawdown (vertical line) and drawdown periods (horizontal
    lines)
  id: totrans-257
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾10-7ã€‚æœ€å¤§å›æ’¤ï¼ˆå‚ç›´çº¿ï¼‰å’Œå›æ’¤æœŸï¼ˆæ°´å¹³çº¿ï¼‰
- en: 'The following code derives VaR values based on the log returns of the equity
    position for the leveraged trading strategy over time for different confidence
    levels. The time interval is fixed to the bar length of ten minutes:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢çš„ä»£ç æ ¹æ®æ æ†äº¤æ˜“ç­–ç•¥çš„è‚¡æœ¬ä½ç½®çš„å¯¹æ•°æ”¶ç›Šéšæ—¶é—´çš„ä¸åŒç½®ä¿¡æ°´å¹³æ¨å¯¼VaRå€¼ã€‚æ—¶é—´é—´éš”å›ºå®šä¸ºååˆ†é’Ÿçš„æ¡é•¿åº¦ï¼š
- en: '[PRE15]'
  id: totrans-259
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO14-1)'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO14-1)'
- en: Defines the percentile values to be used.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: ç¡®å®šè¦ä½¿ç”¨çš„ç™¾åˆ†ä½å€¼ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO14-2)'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO14-2)'
- en: Calculates the VaR values given the percentile values.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®ç™¾åˆ†ä½å€¼è®¡ç®—VaRå€¼ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO14-3)'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO14-3)'
- en: Translates the percentile values into confidence levels and the VaR values (negative
    values) to positive values for printing.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: å°†ç™¾åˆ†ä½å€¼è½¬æ¢ä¸ºç½®ä¿¡æ°´å¹³ï¼Œå°†VaRå€¼ï¼ˆè´Ÿå€¼ï¼‰è½¬æ¢ä¸ºæ­£å€¼ä»¥ä¾›æ‰“å°ã€‚
- en: 'Finally, the following code calculates the VaR values for a time horizon of
    *one hour* by resampling the original `DataFrame` object. In effect, the VaR values
    are increased for all confidence levels:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œä»¥ä¸‹ä»£ç é€šè¿‡å¯¹åŸå§‹`DataFrame`å¯¹è±¡é‡æ–°é‡‡æ ·æ¥è®¡ç®—*ä¸€å°æ—¶*æ—¶é—´èŒƒå›´å†…çš„VaRå€¼ã€‚å®é™…ä¸Šï¼Œæ‰€æœ‰ç½®ä¿¡æ°´å¹³çš„VaRå€¼éƒ½ä¼šå¢åŠ ï¼š
- en: '[PRE16]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO15-1)'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO15-1)'
- en: Resamples the data from 10-minute to 1-hour bars.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: å°†æ•°æ®ä»10åˆ†é’Ÿé‡æ–°é‡‡æ ·ä¸º1å°æ—¶çš„æ¡å½¢å›¾ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO15-2)'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO15-2)'
- en: Calculates the VaR values given the percentile values.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®ç™¾åˆ†ä½å€¼è®¡ç®—VaRå€¼ã€‚
- en: Persisting the Model Object
  id: totrans-272
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æŒä¹…åŒ–æ¨¡å‹å¯¹è±¡
- en: Once the algorithmic trading strategy is accepted based on the backtesting,
    leveraging, and risk analysis results, the model object and other relevant algorithm
    components might be persisted for later use in deployment. It embodies now the
    ML-based trading strategy or the trading algorithm.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦åŸºäºå›æµ‹ã€æ æ†å’Œé£é™©åˆ†æç»“æœæ¥å—äº†ç®—æ³•äº¤æ˜“ç­–ç•¥ï¼Œæ¨¡å‹å¯¹è±¡å’Œå…¶ä»–ç›¸å…³çš„ç®—æ³•ç»„ä»¶å¯èƒ½ä¼šè¢«æŒä¹…åŒ–ä»¥å¤‡åç»­éƒ¨ç½²ä½¿ç”¨ã€‚å®ƒç°åœ¨ä½“ç°äº†åŸºäºæœºå™¨å­¦ä¹ çš„äº¤æ˜“ç­–ç•¥æˆ–äº¤æ˜“ç®—æ³•ã€‚
- en: '[PRE17]'
  id: totrans-274
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Online Algorithm
  id: totrans-275
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åœ¨çº¿ç®—æ³•
- en: The trading algorithm tested so far is an *offline algorithm*. Such algorithms
    use a complete data set to solve a problem at hand. The problem has been to train
    an AdaBoost classification algorithm based on a decision tree as the base classifier,
    a number of different time series features, and directional label data. In practice,
    when deploying the trading algorithm in financial markets, it must consume data
    piece by piece as it arrives to predict the direction of the market movement for
    the next time interval (bar). This section makes use of the persisted model object
    from the previous section and embeds it into a streaming data context.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ°ç›®å‰ä¸ºæ­¢æµ‹è¯•çš„äº¤æ˜“ç®—æ³•æ˜¯*ç¦»çº¿ç®—æ³•*ã€‚è¿™ç±»ç®—æ³•ä½¿ç”¨å®Œæ•´çš„æ•°æ®é›†æ¥è§£å†³æ‰‹å¤´çš„é—®é¢˜ã€‚é—®é¢˜åœ¨äºè®­ç»ƒä¸€ä¸ªåŸºäºå†³ç­–æ ‘ä½œä¸ºåŸºç¡€åˆ†ç±»å™¨çš„AdaBooståˆ†ç±»ç®—æ³•ï¼Œå¤šä¸ªä¸åŒçš„æ—¶é—´åºåˆ—ç‰¹å¾å’Œæ–¹å‘æ€§æ ‡ç­¾æ•°æ®ã€‚å®é™…ä¸Šï¼Œåœ¨é‡‘èå¸‚åœºä¸Šéƒ¨ç½²äº¤æ˜“ç®—æ³•æ—¶ï¼Œå®ƒå¿…é¡»é€æ­¥æ¶ˆè€—æ•°æ®ï¼Œä»¥é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´é—´éš”ï¼ˆæ¡ï¼‰å¸‚åœºè¿åŠ¨æ–¹å‘ã€‚æœ¬èŠ‚åˆ©ç”¨å‰ä¸€èŠ‚çš„æŒä¹…åŒ–æ¨¡å‹å¯¹è±¡ï¼Œå¹¶å°†å…¶åµŒå…¥åˆ°æµæ•°æ®ç¯å¢ƒä¸­ã€‚
- en: 'The code that transforms the *offline* trading algorithm into an *online* trading
    algorithm mainly addresses the following issues:'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: å°†*ç¦»çº¿*äº¤æ˜“ç®—æ³•è½¬åŒ–ä¸º*åœ¨çº¿*äº¤æ˜“ç®—æ³•çš„ä»£ç ä¸»è¦è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š
- en: Tick data
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: Tickæ•°æ®
- en: Tick data arrives in real time and is to be processed in real time, such as
    to be collected in a `DataFrame` object.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: Tickæ•°æ®ä»¥å®æ—¶æ–¹å¼åˆ°è¾¾å¹¶éœ€è¦å®æ—¶å¤„ç†ï¼Œä¾‹å¦‚è¢«æ”¶é›†åˆ°ä¸€ä¸ª`DataFrame`å¯¹è±¡ä¸­ã€‚
- en: Resampling
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: é‡æ–°é‡‡æ ·
- en: The tick data is to be resampled to the appropriate bar length given the trading
    algorithm. For illustration, a shorter bar length is used for resampling than
    for the training and backtesting.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: Tickæ•°æ®å°†æ ¹æ®äº¤æ˜“ç®—æ³•é‡æ–°é‡‡æ ·åˆ°é€‚å½“çš„æ¡å½¢é•¿åº¦ã€‚ä¸ºäº†è¯´æ˜ï¼Œé‡æ–°é‡‡æ ·æ—¶ä½¿ç”¨çš„æ¡å½¢é•¿åº¦æ¯”è®­ç»ƒå’Œå›æµ‹æ—¶ä½¿ç”¨çš„æ¡å½¢é•¿åº¦çŸ­ã€‚
- en: Prediction
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æµ‹
- en: The trading algorithm generates a prediction for the direction of the market
    movement over the relevant time interval that by nature lies in the future.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: äº¤æ˜“ç®—æ³•ä¸ºæœªæ¥çš„æ—¶é—´é—´éš”å†…å¸‚åœºè¿åŠ¨æ–¹å‘ç”Ÿæˆé¢„æµ‹ã€‚
- en: Orders
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: è®¢å•
- en: Given the current position and the prediction (â€œsignalâ€) generated by the algorithm,
    an order is placed or the position is kept unchanged.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®å½“å‰ä½ç½®å’Œç®—æ³•ç”Ÿæˆçš„é¢„æµ‹ï¼ˆâ€œä¿¡å·â€ï¼‰ï¼Œä¸‹è®¢å•æˆ–ä¿æŒä½ç½®ä¸å˜ã€‚
- en: '[ChapterÂ 8](ch08.html#trading_oanda), and in particular [â€œWorking with Streaming
    Dataâ€](ch08.html#oanda_streaming), shows how to retrieve tick data from the Oanda
    API in real time. The basic approach is to redefine the `.on_success()` method
    of the `tpqoa.tpqoa` class to implement the trading logic.'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: '[ç¬¬8ç« ](ch08.html#trading_oanda)ï¼Œç‰¹åˆ«æ˜¯[â€œä½¿ç”¨æµæ•°æ®â€](ch08.html#oanda_streaming)ï¼Œå±•ç¤ºäº†å¦‚ä½•å®æ—¶ä»Oanda
    APIè·å–Tickæ•°æ®ã€‚åŸºæœ¬æ–¹æ³•æ˜¯é‡æ–°å®šä¹‰`tpqoa.tpqoa`ç±»çš„`.on_success()`æ–¹æ³•ä»¥å®ç°äº¤æ˜“é€»è¾‘ã€‚'
- en: 'First, the persisted trading algorithm is loaded; it represents the trading
    logic to be followed. It consists of the trained model itself and the parameters
    for the normalization of the features data, which are integral parts of the algorithm:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆåŠ è½½æŒä¹…åŒ–çš„äº¤æ˜“ç®—æ³•ï¼›å®ƒä»£è¡¨äº†è¦éµå¾ªçš„äº¤æ˜“é€»è¾‘ã€‚å®ƒç”±è®­ç»ƒå¥½çš„æ¨¡å‹æœ¬èº«å’Œç”¨äºç‰¹å¾æ•°æ®å½’ä¸€åŒ–çš„å‚æ•°ç»„æˆï¼Œè¿™äº›éƒ½æ˜¯ç®—æ³•çš„æ•´ä½“éƒ¨åˆ†ï¼š
- en: '[PRE18]'
  id: totrans-288
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'In the following code, the new class `MLTrader`, which inherits from `tpqoa.tpqoa`
    and which, via the `.on_success()` and additional helper methods, transforms the
    trading algorithm into a real-time context. It is the transformation of the *offline
    algorithm* to a so-called *online algorithm*:'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæ–°ç±»`MLTrader`ç»§æ‰¿è‡ª`tpqoa.tpqoa`ï¼Œé€šè¿‡`.on_success()`å’Œé¢å¤–çš„è¾…åŠ©æ–¹æ³•ï¼Œå°†äº¤æ˜“ç®—æ³•è½¬æ¢ä¸ºå®æ—¶ç¯å¢ƒã€‚è¿™æ˜¯å°†*ç¦»çº¿ç®—æ³•*è½¬æ¢ä¸ºæ‰€è°“çš„*åœ¨çº¿ç®—æ³•*çš„è¿‡ç¨‹ï¼š
- en: '[PRE19]'
  id: totrans-290
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO16-1)'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO16-1)'
- en: The trained AdaBoost model object and the normalization parameters.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: å·²è®­ç»ƒçš„AdaBoostæ¨¡å‹å¯¹è±¡å’Œæ ‡å‡†åŒ–å‚æ•°ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO16-4)'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO16-4)'
- en: The number of units traded.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: äº¤æ˜“å•ä½æ•°ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO16-5)'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO16-5)'
- en: The initial, neutral position.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: åˆå§‹çš„ä¸­æ€§ä½ç½®ã€‚
- en: '[![4](assets/4.png)](#co_automating_trading_operations_CO16-6)'
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: '[![4](assets/4.png)](#co_automating_trading_operations_CO16-6)'
- en: The bar length on which the algorithm is implemented.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: å®æ–½ç®—æ³•çš„æ¡å½¢å›¾é•¿åº¦ã€‚
- en: '[![5](assets/5.png)](#co_automating_trading_operations_CO16-7)'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: '[![5](assets/5.png)](#co_automating_trading_operations_CO16-7)'
- en: The length of the window for selected features.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: é€‰å®šåŠŸèƒ½çš„çª—å£é•¿åº¦ã€‚
- en: '[![6](assets/6.png)](#co_automating_trading_operations_CO16-8)'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: '[![6](assets/6.png)](#co_automating_trading_operations_CO16-8)'
- en: The number of lags (must be in line with algorithm training).
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: æ»åæ•°ç›®ï¼ˆå¿…é¡»ä¸ç®—æ³•è®­ç»ƒä¸€è‡´ï¼‰ã€‚
- en: '[![7](assets/7.png)](#co_automating_trading_operations_CO16-9)'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: '[![7](assets/7.png)](#co_automating_trading_operations_CO16-9)'
- en: The method that generates the lagged features data.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: ç”Ÿæˆæ»åç‰¹å¾æ•°æ®çš„æ–¹æ³•ã€‚
- en: '[![8](assets/8.png)](#co_automating_trading_operations_CO16-10)'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: '[![8](assets/8.png)](#co_automating_trading_operations_CO16-10)'
- en: The redefined method that embodies the trading logic.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: å…·ä½“åŒ–ä½“ç°äº¤æ˜“é€»è¾‘çš„é‡æ–°å®šä¹‰æ–¹æ³•ã€‚
- en: '[![9](assets/9.png)](#co_automating_trading_operations_CO16-11)'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: '[![9](assets/9.png)](#co_automating_trading_operations_CO16-11)'
- en: Check for a long signal and long trade.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: æ£€æŸ¥é•¿ä¿¡å·å’Œé•¿äº¤æ˜“ã€‚
- en: '[![10](assets/10.png)](#co_automating_trading_operations_CO16-12)'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: '[![10](assets/10.png)](#co_automating_trading_operations_CO16-12)'
- en: Check for a short signal and short trade.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: æ£€æŸ¥çŸ­ä¿¡å·å’ŒçŸ­äº¤æ˜“ã€‚
- en: 'With the new class `MLTrader`, automated trading is made simple. A few lines
    of code are enough in an interactive context. The parameters are set such that
    the first order is placed after a short while. In reality, however, all parameters
    must, of course, be in line with original ones from the research and backtesting
    phase. They could, for example, also be persisted on disk and be read with the
    algorithm:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨æ–°çš„ç±»`MLTrader`ï¼Œè‡ªåŠ¨äº¤æ˜“å˜å¾—ç®€å•ã€‚åœ¨äº¤äº’å¼ç¯å¢ƒä¸­åªéœ€å‡ è¡Œä»£ç å³å¯ã€‚å‚æ•°è®¾ç½®ä½¿å¾—ç¬¬ä¸€ä¸ªè®¢å•åœ¨çŸ­æ—¶é—´åè¢«ä¸‹è¾¾ã€‚ç„¶è€Œï¼Œåœ¨å®é™…ä¸­ï¼Œæ‰€æœ‰å‚æ•°å½“ç„¶å¿…é¡»ä¸ç ”ç©¶å’Œå›æµ‹é˜¶æ®µçš„åŸå§‹å‚æ•°ä¿æŒä¸€è‡´ã€‚ä¾‹å¦‚ï¼Œå®ƒä»¬ä¹Ÿå¯ä»¥æŒä¹…åŒ–åœ¨ç£ç›˜ä¸Šï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç®—æ³•è¯»å–ï¼š
- en: '[PRE20]'
  id: totrans-312
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '[![1](assets/1.png)](#co_automating_trading_operations_CO17-1)'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: '[![1](assets/1.png)](#co_automating_trading_operations_CO17-1)'
- en: Instantiates the trading object.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: å®ä¾‹åŒ–äº¤æ˜“å¯¹è±¡ã€‚
- en: '[![2](assets/2.png)](#co_automating_trading_operations_CO17-2)'
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: '[![2](assets/2.png)](#co_automating_trading_operations_CO17-2)'
- en: Starts the streaming, data processing, and trading.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: å¼€å§‹æµå¼å¤„ç†ã€æ•°æ®å¤„ç†å’Œäº¤æ˜“ã€‚
- en: '[![3](assets/3.png)](#co_automating_trading_operations_CO17-3)'
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: '[![3](assets/3.png)](#co_automating_trading_operations_CO17-3)'
- en: Closes out the final open position.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: ç»“æŸæœ€åä¸€ä¸ªå¼€æ”¾ä½ç½®ã€‚
- en: 'The preceding code generates an output similar to the following:'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸Šè¿°ä»£ç ç”Ÿæˆç±»ä¼¼ä»¥ä¸‹è¾“å‡ºï¼š
- en: '[PRE21]'
  id: totrans-320
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Infrastructure and Deployment
  id: totrans-321
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åŸºç¡€è®¾æ–½å’Œéƒ¨ç½²
- en: 'Deploying an automated algorithmic trading strategy with real funds requires
    an appropriate infrastructure. Among other things, the infrastructure should satisfy
    the following:'
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨çœŸå®èµ„é‡‘éƒ¨ç½²è‡ªåŠ¨åŒ–ç®—æ³•äº¤æ˜“ç­–ç•¥éœ€è¦é€‚å½“çš„åŸºç¡€è®¾æ–½ã€‚åŸºç¡€è®¾æ–½åº”æ»¡è¶³ä»¥ä¸‹è¦æ±‚ä¹‹ä¸€ï¼š
- en: Reliability
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: å¯é æ€§
- en: The infrastructure on which to deploy an algorithmic trading strategy should
    allow for high availability (for example, 99.9% or higher) and should otherwise
    take care of reliability (automatic backups, redundancy of drives and web connections,
    and so on).
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: éƒ¨ç½²ç®—æ³•äº¤æ˜“ç­–ç•¥çš„åŸºç¡€è®¾æ–½åº”ç¡®ä¿é«˜å¯ç”¨æ€§ï¼ˆä¾‹å¦‚ï¼Œ99.9%æˆ–æ›´é«˜ï¼‰ï¼Œå¹¶åº”ç¡®ä¿å¯é æ€§ï¼ˆè‡ªåŠ¨å¤‡ä»½ã€ç£ç›˜å†—ä½™å’Œç½‘ç»œè¿æ¥å†—ä½™ç­‰ï¼‰ã€‚
- en: Performance
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: æ€§èƒ½
- en: Depending on the amount of data being processed and the computational demand
    the algorithms generate, the infrastructure must have enough CPU cores, working
    memory (RAM), and storage (SSD). In addition, the web connections should be fast
    enough.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®å¤„ç†æ•°æ®é‡å’Œç®—æ³•ç”Ÿæˆçš„è®¡ç®—éœ€æ±‚ï¼ŒåŸºç¡€è®¾æ–½å¿…é¡»å…·å¤‡è¶³å¤Ÿçš„CPUæ ¸å¿ƒã€å·¥ä½œå†…å­˜ï¼ˆRAMï¼‰å’Œå­˜å‚¨ï¼ˆSSDï¼‰ã€‚æ­¤å¤–ï¼Œç½‘ç»œè¿æ¥é€Ÿåº¦ä¹Ÿåº”è¶³å¤Ÿå¿«ã€‚
- en: Security
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: å®‰å…¨æ€§
- en: The operating system and the applications that run on it should be protected
    by strong passwords, as well as SSL encryption and hard drive encryption. The
    hardware should be protected from fire, water, and unauthorized physical access.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: æ“ä½œç³»ç»ŸåŠå…¶ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºåº”å—åˆ°å¼ºå¯†ç ã€SSL åŠ å¯†å’Œç¡¬ç›˜åŠ å¯†çš„ä¿æŠ¤ã€‚ç¡¬ä»¶åº”å—åˆ°é˜²ç«ã€é˜²æ°´å’Œæœªç»æˆæƒçš„ç‰©ç†è®¿é—®çš„ä¿æŠ¤ã€‚
- en: Basically, these requirements can only be fulfilled by renting an appropriate
    infrastructure from a professional data center or a cloud provider. Own investments
    in the physical infrastructure to satisfy the aforementioned requirements can
    in general only be justified by the bigger, or even the biggest, players in the
    financial markets.
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: åŸºæœ¬ä¸Šï¼Œè¿™äº›è¦æ±‚åªèƒ½é€šè¿‡å‘ä¸“ä¸šæ•°æ®ä¸­å¿ƒæˆ–äº‘æä¾›å•†ç§Ÿç”¨é€‚å½“çš„åŸºç¡€è®¾æ–½æ¥å®ç°ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œåªæœ‰é‡‘èå¸‚åœºä¸­æ›´å¤§ã€ç”šè‡³æœ€å¤§çš„å‚ä¸è€…æ‰èƒ½é€šè¿‡åœ¨ç‰©ç†åŸºç¡€è®¾æ–½ä¸Šè¿›è¡Œè‡ªæœ‰æŠ•èµ„æ¥æ»¡è¶³ä¸Šè¿°è¦æ±‚ã€‚
- en: From a development and testing point of view, even the smallest Droplet (cloud
    instance) from DigitalOcean ([*http://digitalocean.com*](http://digitalocean.com))
    is enough to get started. At the time of writing, such a Droplet costs 5 USD per
    month and is billed by the hour, created within minutes, and destroyed within
    seconds.^([3](ch10.html#idm45785334066856))
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: ä»å¼€å‘å’Œæµ‹è¯•çš„è§’åº¦æ¥çœ‹ï¼Œå³ä½¿æ˜¯ DigitalOcean çš„æœ€å° Dropletï¼ˆäº‘å®ä¾‹ï¼‰ä¹Ÿè¶³ä»¥å¼€å§‹ä½¿ç”¨ã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œè¿™æ ·ä¸€ä¸ª Droplet æ¯æœˆçš„æˆæœ¬æ˜¯
    5 ç¾å…ƒï¼Œå¹¶æŒ‰å°æ—¶è®¡è´¹ï¼Œå¯ä»¥åœ¨å‡ åˆ†é’Ÿå†…åˆ›å»ºï¼Œå¹¶åœ¨å‡ ç§’é’Ÿå†…é”€æ¯^([3](ch10.html#idm45785334066856))ã€‚
- en: How to set up a Droplet with DigitalOcean is explained in detail in [ChapterÂ 2](ch02.html#python_environment)
    (specifically in [â€œUsing Cloud Instancesâ€](ch02.html#cloud_instance)), with Bash
    scripts that can be adjusted to reflect individual requirements regarding Python
    packages, for example.
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚ä½•ä½¿ç”¨ DigitalOcean è®¾ç½® Droplet åœ¨[ç¬¬äºŒç« ](ch02.html#python_environment)ä¸­è¯¦ç»†è§£é‡Šï¼ˆå…·ä½“åœ¨[â€œä½¿ç”¨äº‘å®ä¾‹â€](ch02.html#cloud_instance)ï¼‰ï¼Œä½¿ç”¨å¯ä»¥è°ƒæ•´ä»¥åæ˜ ä¸ªäººå¯¹
    Python åŒ…çš„è¦æ±‚çš„ Bash è„šæœ¬ã€‚
- en: Although the development and testing of automated algorithmic trading strategies
    is possible from a local computer (desktop, notebook, or similar), it is not appropriate
    for the deployment of automated strategies trading real money. A simple loss of
    the web connection or a brief power outage might bring down the whole algorithm,
    leaving, for example, unintended open positions in the portfolio. As another example,
    it would cause one to miss out on real-time tick data and end up with corrupted
    data sets, potentially leading to wrong signals and unintended trades and positions.
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: å°½ç®¡å¯ä»¥ä»æœ¬åœ°è®¡ç®—æœºï¼ˆå°å¼æœºã€ç¬”è®°æœ¬ç”µè„‘æˆ–ç±»ä¼¼è®¾å¤‡ï¼‰è¿›è¡Œè‡ªåŠ¨åŒ–ç®—æ³•äº¤æ˜“ç­–ç•¥çš„å¼€å‘å’Œæµ‹è¯•ï¼Œä½†è¿™å¹¶ä¸é€‚ç”¨äºéƒ¨ç½²ç”¨äºäº¤æ˜“çœŸå®èµ„é‡‘çš„è‡ªåŠ¨åŒ–ç­–ç•¥ã€‚ç®€å•çš„ç½‘ç»œè¿æ¥ä¸­æ–­æˆ–çŸ­æš‚çš„åœç”µå¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªç®—æ³•å´©æºƒï¼Œä¾‹å¦‚ï¼Œåœ¨æŠ•èµ„ç»„åˆä¸­ç•™ä¸‹æ„å¤–çš„æœªå¹³ä»“å¤´å¯¸ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œè¿™å°†å¯¼è‡´é”™è¿‡å®æ—¶çš„
    tick æ•°æ®ï¼Œå¹¶æœ€ç»ˆå¾—åˆ°æŸåçš„æ•°æ®é›†ï¼Œå¯èƒ½å¯¼è‡´é”™è¯¯çš„ä¿¡å·å’Œæ„å¤–çš„äº¤æ˜“å’Œå¤´å¯¸ã€‚
- en: Logging and Monitoring
  id: totrans-333
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è®°å½•å’Œç›‘æ§
- en: Assume now that the automated algorithmic trading strategy is to be deployed
    on a remote server (virtual cloud instance or dedicated server). Further assume
    that all required Python packages have been installed (see [â€œUsing Cloud Instancesâ€](ch02.html#cloud_instance))
    and that, for instance, `Jupyter Lab` is running securely (see [Running a notebook
    server](https://oreil.ly/cnBHE)). What else needs to be considered from the algorithmic
    tradersâ€™ point of view if they do not want to sit all day in front of the screen
    being logged in to the server?
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾ç°åœ¨è‡ªåŠ¨åŒ–ç®—æ³•äº¤æ˜“ç­–ç•¥è¦éƒ¨ç½²åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼ˆè™šæ‹Ÿäº‘å®ä¾‹æˆ–ä¸“ç”¨æœåŠ¡å™¨ï¼‰ã€‚è¿›ä¸€æ­¥å‡è®¾æ‰€æœ‰å¿…éœ€çš„ Python åŒ…å·²ç»å®‰è£…å¥½ï¼ˆå‚è§[â€œä½¿ç”¨äº‘å®ä¾‹â€](ch02.html#cloud_instance)ï¼‰å¹¶ä¸”ï¼Œä¾‹å¦‚ï¼Œ`Jupyter
    Lab` æ­£åœ¨å®‰å…¨è¿è¡Œï¼ˆå‚è§[è¿è¡Œç¬”è®°æœ¬æœåŠ¡å™¨](https://oreil.ly/cnBHE)ï¼‰ã€‚ä»ç®—æ³•äº¤æ˜“å‘˜çš„è§’åº¦è€ƒè™‘ï¼Œå¦‚æœä»–ä»¬ä¸æƒ³æ•´å¤©ååœ¨å±å¹•å‰ç™»å½•åˆ°æœåŠ¡å™¨ä¸Šï¼Œè¿˜éœ€è¦è€ƒè™‘ä»€ä¹ˆï¼Ÿ
- en: 'This section addresses two important topics in this regard: *logging* and *real-time
    monitoring*. Logging persists information and events on disk for later inspection.
    It is standard practice in software application development and deployment. However,
    here the focus might be put instead on the financial side, logging important financial
    data and event information for later inspection and analysis. The same holds true
    for real-time monitoring making use of socket communication. Via sockets, a constant
    real-time stream of important financial aspects can be created that can then be
    retrieved and processed on a local computer, even if the deployment happens in
    the cloud.'
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸€èŠ‚æ¶‰åŠä¸¤ä¸ªé‡è¦ä¸»é¢˜ï¼š*æ—¥å¿—è®°å½•*å’Œ*å®æ—¶ç›‘æ§*ã€‚æ—¥å¿—è®°å½•å°†ä¿¡æ¯å’Œäº‹ä»¶æŒä¹…åŒ–åˆ°ç£ç›˜ä»¥ä¾›ä»¥åæ£€æŸ¥ã€‚è¿™æ˜¯è½¯ä»¶åº”ç”¨å¼€å‘å’Œéƒ¨ç½²çš„æ ‡å‡†åšæ³•ã€‚ç„¶è€Œï¼Œåœ¨è¿™é‡Œå¯èƒ½æ›´ä¾§é‡äºé‡‘èæ–¹é¢ï¼Œè®°å½•é‡è¦çš„è´¢åŠ¡æ•°æ®å’Œäº‹ä»¶ä¿¡æ¯ä»¥ä¾›ä»¥åæ£€æŸ¥å’Œåˆ†æã€‚å®æ—¶ç›‘æ§ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œåˆ©ç”¨å¥—æ¥å­—é€šä¿¡ã€‚é€šè¿‡å¥—æ¥å­—ï¼Œå¯ä»¥åˆ›å»ºé‡è¦è´¢åŠ¡æ–¹é¢çš„æŒç»­å®æ—¶æµï¼Œç„¶åå¯ä»¥åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šæ£€ç´¢å’Œå¤„ç†ï¼Œå³ä½¿éƒ¨ç½²åœ¨äº‘ç«¯ä¹Ÿå¯ä»¥ã€‚
- en: '[â€œAutomated Trading Strategyâ€](#auto_script) presents a Python script implementing
    all these aspects and making use of the code from [â€œOnline Algorithmâ€](#auto_online).
    The script brings the code in a shape that allows, for example, the *deployment*
    of the algorithmic trading strategyâ€”sbased on the persisted algorithm objectâ€”son
    a remote server. It adds both *logging and monitoring* capabilities based on a
    custom function that, among other things, makes use of `ZeroMQ` (see [*http://zeromq.org*](http://zeromq.org))
    for socket communication. In combination with the short script from [â€œStrategy
    Monitoringâ€](#auto_monitor), this allows for a remote real-time monitoring of
    the activity on a remote server.^([4](ch10.html#idm45785334006200))'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: '[â€œè‡ªåŠ¨äº¤æ˜“ç­–ç•¥â€](#auto_script)ä»‹ç»äº†ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ç°äº†æ‰€æœ‰è¿™äº›æ–¹é¢ï¼Œå¹¶åˆ©ç”¨äº†æ¥è‡ª[â€œåœ¨çº¿ç®—æ³•â€](#auto_online)çš„ä»£ç ã€‚è¯¥è„šæœ¬å°†ä»£ç æ•´ç†æˆä¸€ç§å½¢å¼ï¼Œä¾‹å¦‚*éƒ¨ç½²*ç®—æ³•äº¤æ˜“ç­–ç•¥â€”â€”åŸºäºæŒä¹…åŒ–çš„ç®—æ³•å¯¹è±¡â€”â€”åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šã€‚å®ƒè¿˜åŸºäºè‡ªå®šä¹‰å‡½æ•°å¢åŠ äº†*æ—¥å¿—è®°å½•å’Œç›‘æ§*åŠŸèƒ½ï¼Œå…¶ä¸­åŒ…æ‹¬ä½¿ç”¨`ZeroMQ`ï¼ˆå‚è§[*http://zeromq.org*](http://zeromq.org)ï¼‰è¿›è¡Œå¥—æ¥å­—é€šä¿¡ã€‚ç»“åˆæ¥è‡ª[â€œç­–ç•¥ç›‘æ§â€](#auto_monitor)çš„ç®€çŸ­è„šæœ¬ï¼Œè¿™å…è®¸å¯¹è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ´»åŠ¨è¿›è¡Œè¿œç¨‹å®æ—¶ç›‘æ§ã€‚^([4](ch10.html#idm45785334006200))'
- en: 'When the script from [â€œAutomated Trading Strategyâ€](#auto_script) is executed,
    either locally or remotely, the output that is logged and sent via the socket
    looks as follows:'
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æ‰§è¡Œ[â€œè‡ªåŠ¨äº¤æ˜“ç­–ç•¥â€](#auto_script)çš„è„šæœ¬æ—¶ï¼Œæ— è®ºæ˜¯æœ¬åœ°è¿˜æ˜¯è¿œç¨‹æ‰§è¡Œï¼Œè®°å½•å¹¶é€šè¿‡å¥—æ¥å­—å‘é€çš„è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '[PRE22]'
  id: totrans-338
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Running the script from [â€œStrategy Monitoringâ€](#auto_monitor) locally then
    allows for the real-time retrieval and processing of such information. Of course,
    it is easy to adjust the logging and streaming data to oneâ€™s own requirements.^([5](ch10.html#idm45785336429992))
    Furthermore, the trading script and the whole logic can be adjusted to include
    such elements as stop losses or take profit targets programmatically.
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: ä»[â€œç­–ç•¥ç›‘æ§â€](#auto_monitor)æœ¬åœ°è¿è¡Œè„šæœ¬ï¼Œç„¶åå…è®¸å®æ—¶æ£€ç´¢å’Œå¤„ç†è¿™ç±»ä¿¡æ¯ã€‚å½“ç„¶ï¼Œå¯ä»¥è½»æ¾è°ƒæ•´æ—¥å¿—è®°å½•å’Œæµæ•°æ®ä»¥ç¬¦åˆä¸ªäººéœ€æ±‚ã€‚^([5](ch10.html#idm45785336429992))æ­¤å¤–ï¼Œäº¤æ˜“è„šæœ¬å’Œæ•´ä½“é€»è¾‘å¯ä»¥è¿›è¡Œè°ƒæ•´ï¼Œä»¥ç¼–ç¨‹æ–¹å¼åŒ…æ‹¬æ­¢æŸæˆ–æ­¢ç›ˆç›®æ ‡ç­‰å…ƒç´ ã€‚
- en: Trading currency pairs and/or CFDs is associated with a number of financial
    risks. Implementing an algorithmic trading strategy for such instruments automatically
    leads to a number of additional risks. Among them are flaws in the trading and/or
    execution logic, as well as technical risks including problems associated with
    socket communication, delayed retrieval, or even loss of tick data during the
    deployment. Therefore, before one deploys a trading strategy in automated fashion
    one should make sure that all associated market, execution, operational, technical,
    and other risks have been identified, evaluated, and properly addressed. The code
    presented in this chapter is only for technical illustration purposes.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: äº¤æ˜“è´§å¸å¯¹å’Œ/æˆ–å·®ä»·åˆçº¦ä¼´éšç€å¤šç§è´¢åŠ¡é£é™©ã€‚ä¸ºè¿™äº›å·¥å…·å®æ–½ç®—æ³•äº¤æ˜“ç­–ç•¥è‡ªåŠ¨å¯¼è‡´è®¸å¤šé¢å¤–çš„é£é™©ã€‚å…¶ä¸­åŒ…æ‹¬äº¤æ˜“å’Œ/æˆ–æ‰§è¡Œé€»è¾‘ä¸­çš„ç¼ºé™·ï¼Œä»¥åŠæŠ€æœ¯é£é™©ï¼ŒåŒ…æ‹¬ä¸å¥—æ¥å­—é€šä¿¡ç›¸å…³çš„é—®é¢˜ï¼Œå»¶è¿Ÿçš„æ£€ç´¢ï¼Œç”šè‡³åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­ä¸¢å¤±Tickæ•°æ®ã€‚å› æ­¤ï¼Œåœ¨ä»¥è‡ªåŠ¨åŒ–æ–¹å¼éƒ¨ç½²äº¤æ˜“ç­–ç•¥ä¹‹å‰ï¼Œåº”ç¡®ä¿å·²è¯†åˆ«ã€è¯„ä¼°å’Œé€‚å½“å¤„ç†æ‰€æœ‰ç›¸å…³çš„å¸‚åœºã€æ‰§è¡Œã€æ“ä½œã€æŠ€æœ¯å’Œå…¶ä»–é£é™©ã€‚æœ¬ç« ä»‹ç»çš„ä»£ç ä»…ç”¨äºæŠ€æœ¯è¯´æ˜ç›®çš„ã€‚
- en: Visual Step-by-Step Overview
  id: totrans-341
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è§†è§‰é€æ­¥æ¦‚è¿°
- en: This final section provides a step-by-step overview in screenshots. While the
    previous sections are based on the FXCM trading platform, the visual overview
    is based on the Oanda trading platform.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åä¸€èŠ‚é€šè¿‡æˆªå›¾æä¾›äº†é€æ­¥æ¦‚è¿°ã€‚è™½ç„¶å‰å‡ èŠ‚åŸºäºFXCMäº¤æ˜“å¹³å°ï¼Œä½†è§†è§‰æ¦‚è¿°åŸºäºOandaäº¤æ˜“å¹³å°ã€‚
- en: Configuring Oanda Account
  id: totrans-343
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é…ç½®Oandaè´¦æˆ·
- en: The first step is to set up an account with Oanda (or any other trading platform
    to this end) and to set the correct leverage ratio for the account according to
    the Kelly criterion and as shown in [FigureÂ 10-8](#auto_00).
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: ç¬¬ä¸€æ­¥æ˜¯åœ¨Oandaï¼ˆæˆ–å…¶ä»–äº¤æ˜“å¹³å°ï¼‰ä¸Šè®¾ç½®è´¦æˆ·ï¼Œå¹¶æ ¹æ®å‡¯åˆ©å‡†åˆ™è®¾ç½®æ­£ç¡®çš„æ æ†æ¯”ç‡ï¼Œå¦‚[å›¾Â 10-8](#auto_00)æ‰€ç¤ºã€‚
- en: '![pfat 1008](assets/pfat_1008.png)'
  id: totrans-345
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1008](assets/pfat_1008.png)'
- en: Figure 10-8\. Setting leverage on Oanda
  id: totrans-346
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾Â 10-8\. åœ¨ Oanda ä¸Šè®¾ç½®æ æ†
- en: Setting Up the Hardware
  id: totrans-347
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®¾ç½®ç¡¬ä»¶
- en: The second step is to create a DigitalOcean droplet, as shown in [FigureÂ 10-9](#auto_01).
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: ç¬¬äºŒæ­¥æ˜¯åˆ›å»ºDigitalOcean dropletï¼Œå¦‚[å›¾Â 10-9](#auto_01)æ‰€ç¤ºã€‚
- en: '![pfat 1009](assets/pfat_1009.png)'
  id: totrans-349
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1009](assets/pfat_1009.png)'
- en: Figure 10-9\. DigitalOcean droplet
  id: totrans-350
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾Â 10-9\. DigitalOcean droplet
- en: Setting Up the Python Environment
  id: totrans-351
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è®¾ç½® Python ç¯å¢ƒ
- en: The third step is to put all the software on the droplet (see [FigureÂ 10-10](#auto_02))
    in order to set up the infrastructure. When it all works fine, you can create
    a new Jupyter Notebook and start your interactive Python session (see [FigureÂ 10-11](#auto_03)).
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: ç¬¬ä¸‰æ­¥æ˜¯å°†æ‰€æœ‰è½¯ä»¶æ”¾åœ¨ droplet ä¸Šï¼ˆå‚è§[å›¾Â 10-10](#auto_02)ï¼‰ï¼Œä»¥å»ºç«‹åŸºç¡€è®¾æ–½ã€‚å½“ä¸€åˆ‡æ­£å¸¸è¿è¡Œæ—¶ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Jupyter
    Notebook å¹¶å¼€å§‹äº¤äº’å¼Pythonä¼šè¯ï¼ˆå‚è§[å›¾Â 10-11](#auto_03)ï¼‰ã€‚
- en: '![pfat 1010](assets/pfat_1010.png)'
  id: totrans-353
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1010](assets/pfat_1010.png)'
- en: Figure 10-10\. Installing Python and packages
  id: totrans-354
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾Â 10-10\. å®‰è£… Python å’Œç›¸å…³åŒ…
- en: '![pfat 1011](assets/pfat_1011.png)'
  id: totrans-355
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1011](assets/pfat_1011.png)'
- en: Figure 10-11\. Testing Jupyter Lab
  id: totrans-356
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾Â 10-11\. æµ‹è¯• Jupyter Lab
- en: Uploading the Code
  id: totrans-357
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸Šä¼ ä»£ç 
- en: The fourth step is to upload the Python scripts for automated trading and real-time
    monitoring, as shown in [FigureÂ 10-12](#auto_04). The configuration file with
    the account credentials also needs to be uploaded.
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: ç¬¬å››æ­¥æ˜¯ä¸Šä¼ ç”¨äºè‡ªåŠ¨åŒ–äº¤æ˜“å’Œå®æ—¶ç›‘æ§çš„Pythonè„šæœ¬ï¼Œå¦‚[å›¾Â 10-12](#auto_04)æ‰€ç¤ºã€‚è¿˜éœ€ä¸Šä¼ åŒ…å«è´¦æˆ·å‡­è¯çš„é…ç½®æ–‡ä»¶ã€‚
- en: '![pfat 1012](assets/pfat_1012.png)'
  id: totrans-359
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1012](assets/pfat_1012.png)'
- en: Figure 10-12\. Uploading Python code files
  id: totrans-360
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾Â 10-12\. ä¸Šä¼  Python ä»£ç æ–‡ä»¶
- en: Running the Code
  id: totrans-361
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è¿è¡Œä»£ç 
- en: The fifth step is to run the Python script for automated trading, as shown in
    [FigureÂ 10-13](#auto_05). [FigureÂ 10-14](#auto_06) shows a trade that the Python
    script has initiated.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: ç¬¬äº”æ­¥æ˜¯è¿è¡ŒPythonè„šæœ¬è¿›è¡Œè‡ªåŠ¨åŒ–äº¤æ˜“ï¼Œå¦‚[å›¾Â 10-13](#auto_05)æ‰€ç¤ºã€‚[å›¾Â 10-14](#auto_06)å±•ç¤ºäº†Pythonè„šæœ¬å¯åŠ¨çš„äº¤æ˜“ã€‚
- en: '![pfat 1013](assets/pfat_1013.png)'
  id: totrans-363
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1013](assets/pfat_1013.png)'
- en: Figure 10-13\. Running the Python script
  id: totrans-364
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾Â 10-13\. è¿è¡Œ Python è„šæœ¬
- en: '![pfat 1014](assets/pfat_1014.png)'
  id: totrans-365
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1014](assets/pfat_1014.png)'
- en: Figure 10-14\. A trade initiated by the Python script
  id: totrans-366
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾Â 10-14\. Python è„šæœ¬å‘èµ·çš„äº¤æ˜“
- en: Real-Time Monitoring
  id: totrans-367
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å®æ—¶ç›‘æ§
- en: The final step is to run the monitoring script locally (provided you have set
    the correct IP in the local script), as seen in [FigureÂ 10-15](#auto_07). In practice,
    this means that you can monitor locally in real time what exactly is happening
    on your cloud instance.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åä¸€æ­¥æ˜¯åœ¨æœ¬åœ°è¿è¡Œç›‘æ§è„šæœ¬ï¼ˆå‡è®¾æ‚¨åœ¨æœ¬åœ°è„šæœ¬ä¸­è®¾ç½®äº†æ­£ç¡®çš„IPï¼‰ï¼Œå¦‚[å›¾Â 10-15](#auto_07)æ‰€ç¤ºã€‚å®é™…ä¸Šï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥å®æ—¶åœ¨æœ¬åœ°ç›‘æ§äº‘å®ä¾‹ä¸Šæ­£åœ¨å‘ç”Ÿçš„æƒ…å†µã€‚
- en: '![pfat 1015](assets/pfat_1015.png)'
  id: totrans-369
  prefs: []
  type: TYPE_IMG
  zh: '![pfat 1015](assets/pfat_1015.png)'
- en: Figure 10-15\. Local real-time monitoring via socket
  id: totrans-370
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: å›¾Â 10-15\. é€šè¿‡ socket è¿›è¡Œæœ¬åœ°å®æ—¶ç›‘æ§
- en: Conclusions
  id: totrans-371
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç»“è®º
- en: This chapter is about the deployment of an algorithmic trading strategy in automated
    fashion, based on a classification algorithm from machine learning to predict
    the direction of market movements. It addresses such important topics as capital
    management (based on the Kelly criterion), vectorized backtesting for performance
    and risk, the transformation of offline to online trading algorithms, an appropriate
    infrastructure for deployment, and logging and monitoring during deployment.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬ç« ä»‹ç»äº†åŸºäºæœºå™¨å­¦ä¹ åˆ†ç±»ç®—æ³•éƒ¨ç½²ç®—æ³•äº¤æ˜“ç­–ç•¥çš„è‡ªåŠ¨åŒ–æ–¹å¼ï¼Œæ¶µç›–äº†èµ„æœ¬ç®¡ç†ï¼ˆåŸºäºå‡¯åˆ©å‡†åˆ™ï¼‰ã€åŸºäºå‘é‡åŒ–çš„æ€§èƒ½å’Œé£é™©å›æµ‹ã€å°†ç¦»çº¿äº¤æ˜“ç®—æ³•è½¬åŒ–ä¸ºåœ¨çº¿çš„æ–¹å¼ã€é€‚å½“çš„éƒ¨ç½²åŸºç¡€è®¾æ–½ä»¥åŠéƒ¨ç½²è¿‡ç¨‹ä¸­çš„æ—¥å¿—è®°å½•å’Œç›‘æ§ã€‚
- en: The topic of this chapter is complex and requires a broad skill set from the
    algorithmic trading practitioner. On the other hand, having RESTful APIs for algorithmic
    trading available, such as the one from Oanda, simplifies the automation task
    considerably since the core part boils down mainly to making use of the capabilities
    of the Python wrapper package `tpqoa` for tick data retrieval and order placement.
    Around this core, elements to mitigate operational and technical risks should
    be added as far as appropriate and possible.
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬ç« ä¸»é¢˜å¤æ‚ï¼Œéœ€è¦ç®—æ³•äº¤æ˜“ä»ä¸šè€…å¹¿æ³›çš„æŠ€èƒ½é›†ã€‚å¦ä¸€æ–¹é¢ï¼Œæœ‰ RESTful API å¯ç”¨äºç®—æ³•äº¤æ˜“ï¼Œä¾‹å¦‚æ¥è‡ª Oanda çš„ APIï¼Œæ˜¾è‘—ç®€åŒ–äº†è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œå› ä¸ºæ ¸å¿ƒéƒ¨åˆ†ä¸»è¦æ˜¯åˆ©ç”¨
    Python å°è£…åŒ… `tpqoa` çš„èƒ½åŠ›è¿›è¡Œ tick æ•°æ®æ£€ç´¢å’Œè®¢å•ä¸‹è¾¾ã€‚åœ¨è¿™ä¸ªæ ¸å¿ƒå‘¨å›´ï¼Œåº”æ ¹æ®é€‚å½“å’Œå¯èƒ½æ€§åŠ å…¥å‡å°‘æ“ä½œå’ŒæŠ€æœ¯é£é™©çš„å…ƒç´ ã€‚
- en: References and Further Resources
  id: totrans-374
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å‚è€ƒæ–‡çŒ®å’Œè¿›ä¸€æ­¥èµ„æº
- en: 'Papers cited in this chapter:'
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬ç« å¼•ç”¨çš„è®ºæ–‡ï¼š
- en: 'Rotando, Louis, and Edward Thorp. 1992\. â€œThe Kelly Criterion and the Stock
    Market.â€ *The American Mathematical Monthly* 99 (10): 922-931.'
  id: totrans-376
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Rotando, Louis, and Edward Thorp. 1992\. â€œThe Kelly Criterion and the Stock
    Market.â€ *The American Mathematical Monthly* 99 (10): 922-931ã€‚'
- en: Hung, Jane. 2010\. â€œBetting with the Kelly Criterion.â€ [*http://bit.ly/betting_with_kelly*](http://bit.ly/betting_with_kelly).
  id: totrans-377
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Hung, Jane. 2010\. â€œBetting with the Kelly Criterion.â€ [*http://bit.ly/betting_with_kelly*](http://bit.ly/betting_with_kelly)ã€‚
- en: Python Script
  id: totrans-378
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Python è„šæœ¬
- en: This section contains Python scripts used in this chapter.
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬èŠ‚åŒ…å«æœ¬ç« ä¸­ä½¿ç”¨çš„ Python è„šæœ¬ã€‚
- en: Automated Trading Strategy
  id: totrans-380
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è‡ªåŠ¨åŒ–äº¤æ˜“ç­–ç•¥
- en: 'The following Python script contains the code for the automated deployment
    of the ML-based trading strategy, as discussed and backtested in this chapter:'
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢çš„ Python è„šæœ¬åŒ…å«äº†åŸºäºæœºå™¨å­¦ä¹ çš„äº¤æ˜“ç­–ç•¥çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ä»£ç ï¼Œæ­£å¦‚æœ¬ç« ä¸­æ‰€è®¨è®ºå’Œå›æµ‹çš„é‚£æ ·ï¼š
- en: '[PRE23]'
  id: totrans-382
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Strategy Monitoring
  id: totrans-383
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç­–ç•¥ç›‘æ§
- en: The following Python script contains code to remotely monitor the execution
    of the Python script from [â€œAutomated Trading Strategyâ€](#auto_script).
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢çš„ Python è„šæœ¬åŒ…å«äº†è¿œç¨‹ç›‘æ§ä»[â€œè‡ªåŠ¨åŒ–äº¤æ˜“ç­–ç•¥â€](#auto_script)ä¸­æ‰§è¡Œçš„ Python è„šæœ¬çš„ä»£ç ã€‚
- en: '[PRE24]'
  id: totrans-385
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: ^([1](ch10.html#idm45785342245112-marker)) The exposition follows Hung (2010).
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: ^([1](ch10.html#idm45785342245112-marker)) æœ¬æ–‡éµå¾ªäº† Hung (2010) çš„é˜è¿°ã€‚
- en: ^([2](ch10.html#idm45785339950712-marker)) It is a stylized empirical fact that
    it is of paramount importance for the investment and trading performance to get
    the largest market movements right (that is, the biggest winner *and* loser movements).
    This aspect is neatly illustrated in [FigureÂ 10-5](#auto_plot_05), which shows
    that the trading strategy gets a large downwards movement in the underlying instrument
    correct, leading to a larger jump for the trading strategy.
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: ^([2](ch10.html#idm45785339950712-marker)) é‡è¦çš„ç»éªŒäº‹å®æ˜¯ï¼Œå¯¹äºæŠ•èµ„å’Œäº¤æ˜“è¡¨ç°æ¥è¯´ï¼Œå‡†ç¡®æ•æ‰å¸‚åœºä¸Šçš„æœ€å¤§æ³¢åŠ¨è‡³å…³é‡è¦ï¼ˆå³æœ€å¤§çš„èµ¢å®¶*å’Œ*è¾“å®¶æ³¢åŠ¨ï¼‰ã€‚è¿™ä¸€æ–¹é¢åœ¨[å›¾Â 10-5](#auto_plot_05)ä¸­å¾—åˆ°äº†æ¸…æ™°çš„è¯´æ˜ï¼Œå›¾ç¤ºäº†äº¤æ˜“ç­–ç•¥å‡†ç¡®æ•æ‰åŸºç¡€å·¥å…·çš„å¤§å¹…ä¸‹è·Œè¿åŠ¨ï¼Œä»è€Œå¯¼è‡´äº¤æ˜“ç­–ç•¥è·³è·ƒè¾ƒå¤§ã€‚
- en: ^([3](ch10.html#idm45785334066856-marker)) Use the link [*http://bit.ly/do_sign_up*](http://bit.ly/do_sign_up)
    to get a 10 USD bonus on DigitalOcean when signing up for a new account.
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: ^([3](ch10.html#idm45785334066856-marker)) ä½¿ç”¨é“¾æ¥[*http://bit.ly/do_sign_up*](http://bit.ly/do_sign_up)æ³¨å†Œ
    DigitalOcean æ–°è´¦æˆ·æ—¶ï¼Œå¯è·å¾— 10 ç¾å…ƒçš„å¥–é‡‘ã€‚
- en: ^([4](ch10.html#idm45785334006200-marker)) The logging approach used here is
    pretty simple in the form of a simple text file. It is easy to change the logging
    and persisting of, say, the relevant financial data in the form of a database
    or appropriate binary storage formats, such as `HDF5` (see [ChapterÂ 3](ch03.html#financial_data)).
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: ^([4](ch10.html#idm45785334006200-marker)) è¿™é‡Œä½¿ç”¨çš„æ—¥å¿—è®°å½•æ–¹æ³•éå¸¸ç®€å•ï¼Œä»¥ç®€å•æ–‡æœ¬æ–‡ä»¶çš„å½¢å¼ã€‚å¯ä»¥è½»æ¾åœ°æ›´æ”¹æ—¥å¿—è®°å½•å’ŒæŒä¹…åŒ–ï¼Œæ¯”å¦‚å°†ç›¸å…³çš„é‡‘èæ•°æ®ä»¥æ•°æ®åº“æˆ–é€‚å½“çš„äºŒè¿›åˆ¶å­˜å‚¨æ ¼å¼ï¼ˆå¦‚`HDF5`ï¼‰çš„å½¢å¼å­˜å‚¨ï¼ˆå‚è§[ç¬¬Â 3
    ç« ](ch03.html#financial_data)ï¼‰ã€‚
- en: ^([5](ch10.html#idm45785336429992-marker)) Note that the socket communication,
    as implemented in the two scripts, is not encrypted and is sending plain text
    over the web, which might represent a security risk in production.
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: ^([5](ch10.html#idm45785336429992-marker)) è¯·æ³¨æ„ï¼Œå¦‚åŒä¸¤ä¸ªè„šæœ¬ä¸­å®ç°çš„é‚£æ ·ï¼Œå¥—æ¥å­—é€šä¿¡æœªåŠ å¯†ï¼Œé€šè¿‡ç½‘ç»œå‘é€æ˜æ–‡ï¼Œè¿™å¯èƒ½åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä»£è¡¨ç€å®‰å…¨é£é™©ã€‚
