# 前言

生成 AI，特别是 Chat GPT-4，如今非常流行。概率机器学习（ML）是一种非常适合金融和投资领域的生成 AI 类型。与 ChatGPT 基于的深度神经网络不同，概率机器学习模型不是黑箱。这些模型还使您能够以相当透明的方式从效果推断原因。这在金融和医疗保健等受严格监管的行业中非常重要，因为您必须向许多利益相关者解释决策的基础。

概率机器学习还使您能够明确且系统地将个人、经验和机构知识编码到机器学习模型中，以维持您组织的竞争优势。真正区别于传统模型的是，概率机器学习能够根据观察到的数据和模型假设无缝地模拟新数据和反事实知识，而不受数据集大小或数据排序的限制。概率模型是生成模型，它们了解自己的局限性，并通过扩展推断和预测范围来诚实地表达自己的无知。您不会从 ChatGPT 那自信的幻想中得到这样的量化怀疑，这些幻想更常被称为虚构和谎言。

所有机器学习模型都建立在这样一个假设上：在训练或样本内数据中发现的模式将在测试或样本外数据中持续存在。然而，当非概率机器学习模型遇到它们从未经过训练或测试的数据中的模式时，它们会因其统计模型的固有基础缺陷而做出严重的推断和预测。此外，这些机器学习模型会毫不犹豫地、完全自信地执行这些操作，而不会警告决策者其不确定性。

在金融和投资决策中，非概率机器学习模型的日益采用可能会对个人和社会造成灾难性后果，包括破产和经济衰退。所有机器学习模型必须量化其对未见数据的推断和预测的不确定性，以支持在充满三维不确定性的复杂世界中进行明智决策。领先的公司清楚地理解标准 AI 技术的局限性，并正在开发其概率版本，以扩展其应用于更复杂的问题。谷歌最近推出了 TensorFlow Probability，以扩展其已建立的 TensorFlow 平台。同样，Facebook 和 Uber 推出了 Pyro 来扩展其 PyTorch 平台。目前最受欢迎的开源概率机器学习技术是 PyMC 和 Stan。PyMC 是用 Python 编写的，而 Stan 是用 C++编写的。本书使用了用户友好的 Python 库广泛的生态系统。

# 谁应该阅读这本书？

本书的主要受众是金融和投资领域的思考实践者。思考实践者不仅仅想要遵循手册或食谱的指示。他们想要理解为什么必须采用某种过程、模型或技术的基本概念。一般来说，他们有求知欲，喜欢为了学习而学习。同时，他们不会寻找繁琐的数学证明或枯燥的学术著作。我在每一章中提供了许多学术参考资料，供那些寻找本书中所呈现的概念和推理的数学和技术细节的读者参考。

一个思考实践者可以是个人投资者、分析师、开发者、经理、项目经理、数据科学家、研究员、投资组合经理或量化交易员。这些思考实践者了解他们需要不断学习新的概念和技术来推动他们的职业和业务发展。实际的深度理解给了他们信心，使他们能够将所学应用于为他们独特的挑战开发创造性解决方案。它还为他们探索和更轻松地学习相关技术和概念提供了一个框架。

在这本书中，我假设读者对金融、统计、机器学习和 Python 有基本的了解。我并不假设他们读过任何特定的书或掌握了任何特定的技能。我只是假设他们有学习的意愿，特别是当 ChatGPT、Bard 和 Bing AI 可以轻松解释本书中的任何代码或公式时。

# 我写这本书的原因

普通概率 ML 书籍的数量很少，而且没有一本完全专注于金融和投资问题的书籍。由于这些领域的特异性复杂性，任何对 ML 的天真应用，特别是对概率 ML 的天真应用注定会失败。对这些领域基础的深入理解对于成功至关重要。这本书是一本入门书，旨在为思考实践者提供概率 ML 基础概念的扎实基础，以及如何使用简单的数学和 Python 代码将其应用于金融和投资问题。

我写这本书的另一个原因是有一个原因。直到今天，书籍仍然是进行严肃讨论的媒介。我想提醒读者现代金融理论和传统统计推断方法的严重缺陷仍然存在。令人震惊的是，尽管这些伪科学方法存在严重缺陷和可悲的表现，它们仍然被教授于学术界并在工业界实践。它们继续浪费数十亿研究经费产生垃圾研究，玷污了科学事业的声誉，并且在经济灾难和人类痛苦方面做出了重大贡献。

我们正处于人工智能技术发展的十字路口，大多数专家预测其使用将呈指数增长，从根本上改变我们生活、工作和彼此交往的方式。AI 系统将即将接管人类的危险是荒谬的科幻，因为即使是最先进的 AI 系统也缺乏婴儿的常识。真正的明显和当前的危险是愚人最终可能会根据传统金融和统计模型的虚假模型来开发和管理这些强大的智者。这很可能会导致比我们以往经历的灾难更快速、更大规模的灾难。

我的批评得到了简单的数学、常识、数据和学术作品的支持，这些作品在过去一个世纪已经发表。也许本书的一个附加价值在于从历史的尘封档案中找回许多被遗忘的学术出版物，并以清晰、明确的语言，使用任何高中毕业生都能理解的逻辑、简单数学或代码，使读者意识到它们的见解。显然，以传统方式表达这些批评完全没有效果。对于个人、社会和科学企业来说，赌注太高，我们不能在乎清楚陈述的数学和科学真理是否会冒犯某人或损害建立在编写或支持虚假理论基础上的声誉。

# 浏览本书

本书内容可以分为两个逻辑部分，不均匀地贯穿于每一章节中。一部分检验了现有经济学、统计学和机器学习模型在金融和投资领域的惊人无用性。另一部分探讨了为什么概率机器学习是这些问题领域中一个不那么错误、更有用的模型。本书的重点在于理解这一复杂的、跨学科的领域的基础知识。仅涵盖了关键概念和应用。有时候，确实少即是多。本书的组织如下，每一章都至少有一个主要概念在金融和投资中的应用，通过一个实际的 Python 代码练习进行说明：

+   第一章，“概率机器学习的必要性” 探讨了理论金融的一些严重不足之处，以及所有金融模型都存在三重错误的原因，以及为什么我们需要一种系统化的方法来量化推断和预测的不确定性。本章解释了为什么概率机器学习为金融和投资提供了一个有用的框架。

+   第二章，“分析和量化不确定性”使用蒙提霍尔问题（Monty Hall problem）回顾了概率论的基本规则，探讨了概率的含义，并探索了贯穿我们世界的不确定性三位一体。该章还探讨了归纳问题及其算法重述，即无免费午餐（NFL）定理，以及它们如何支撑金融、投资和概率机器学习。

+   第三章，“用蒙特卡罗模拟量化输出不确定性”回顾了重要的统计概念，解释了为什么蒙特卡罗模拟（MCS）作为最重要的数值技术之一，通过生成近似的概率解决了分析难题。

+   第四章，“传统统计方法的危险性”揭露了常见的研究和行业中使用的传统统计推断方法的欺诈行为，并解释了为什么它们是社会和经济科学中虚假研究发现的主要原因。

+   第五章，“概率机器学习框架”探索了概率机器学习框架，并演示了如何在这种生成模型中逻辑和无缝地进行数据推断和新数据模拟。

+   第六章，“传统 AI 系统的危险性”揭示了传统 AI 系统的危险性，尤其是它们缺乏基本常识，并且不了解自己的局限性，这对所有利益相关者和社会都构成了巨大的风险。马尔可夫链蒙特卡罗模拟被介绍为解决金融和投资中复杂问题的依赖抽样方法。

+   第七章，“用生成集成进行概率机器学习”解释了概率机器学习本质上是一种集成机器学习形式。它向读者展示了如何使用 PyMC、Xarray 和 ArviZ Python 库，在金融和投资中开发生成线性集成的原型。

+   第八章，“用生成集成做概率决策”展示了如何将生成集成应用于金融和投资中的风险管理和资本配置决策。探讨了遍历性的含义以及在金融决策中使用集成平均值的缺陷。还研究了包括凯利准则在内的资本配置算法的优缺点。

# 本书使用的约定

本书中使用以下排版约定：

*斜体*

标示新术语、网址、电子邮件地址、文件名和文件扩展名。

`等宽字体`

用于程序清单，以及在段落中引用程序元素，如变量或函数名称，数据库，数据类型，环境变量，语句和关键字。

**`Constant width bold`**

显示用户应该按照字面意义键入的命令或其他文本。

*`Constant width italic`*

显示应该由用户提供的值或由上下文确定的值替换的文本。

###### 提示

此元素表示提示或建议。

###### 注意

此元素表示一般说明。

###### 警告

此元素指示警告或注意事项。

# 使用代码示例

补充材料（代码示例）可在[*https://oreil.ly/supp-probabilistic-ML*](https://oreil.ly/supp-probabilistic-ML)下载。

如果您有技术问题或在使用代码示例时遇到问题，请发送电子邮件至*support@oreilly.com*。

本书旨在帮助您完成工作。一般情况下，如果本书提供示例代码，您可以在您的程序和文档中使用它。除非您复制了大量代码，否则无需征得我们的许可。例如，编写一个使用本书多个代码片段的程序不需要许可。销售或分发从 O’Reilly 书籍中提取的示例代码需要许可。引用本书并引用示例代码来回答问题不需要许可。将本书中大量示例代码合并到您产品的文档中需要许可。

我们欣赏但通常不要求署名。署名通常包括标题，作者，出版商和 ISBN。例如：“*Probabilistic Machine Learning for Finance and Investing* by Deepak K. Kanungo (O’Reilly). Copyright 2023 Hedged Capital L.L.C., 978-1-492-09767-9.”

如果您认为您使用的代码示例超出了合理使用范围或上述许可的范围，请随时通过*permissions@oreilly.com*与我们联系。

# O’Reilly 在线学习

###### 注意

40 多年来，[*O’Reilly Media*](https://oreilly.com)已经为公司的成功提供技术和商业培训，知识和洞察。

我们独特的专家和创新者网络通过书籍，文章以及我们的在线学习平台分享他们的知识和专长。O’Reilly 的在线学习平台为您提供按需访问的现场培训课程，深入学习路径，交互式编码环境以及来自 O’Reilly 和其他 200 多家出版商的大量文本和视频。有关更多信息，请访问[*https://oreilly.com*](https://oreilly.com)。

# 如何联系我们

请将有关本书的评论和问题发送至出版商：

+   O’Reilly Media, Inc.

+   1005 Gravenstein Highway North

+   加利福尼亚州塞巴斯托波尔，95472

+   800-889-8969（在美国或加拿大）

+   707-829-7019（国际或本地）

+   707-829-0104（传真）

+   *support@oreilly.com*

+   [*https://www.oreilly.com/about/contact.html*](https://www.oreilly.com/about/contact.html)

我们为本书创建了一个网页，列出勘误、示例和任何额外信息。您可以访问[*https://oreil.ly/Probabilistic_ML*](https://oreil.ly/Probabilistic_ML)。

欲了解我们的书籍和课程的最新消息，请访问[*https://oreilly.com*](https://oreilly.com)。

在 LinkedIn 上找到我们：[*https://linkedin.com/company/oreilly-media*](https://linkedin.com/company/oreilly-media)

在 Twitter 上关注我们：[*https://twitter.com/oreillymedia*](https://twitter.com/oreillymedia)

观看我们的 YouTube 频道：[*https://youtube.com/oreillymedia*](https://youtube.com/oreillymedia)

# 致谢

我要感谢 Michelle Smith，Jeff Bleiel 和整个 O’Reilly Media 团队，使得这本书的出版成为可能。很高兴能与大家合作，尤其是 Jeff，他诚实而富有洞察力的反馈帮助我改进了本书的内容。

我还要感谢我的书籍专家审阅者 Abdullah Karasan，Juan Manuel Contreras 和 Isaac Rhea，他们提供的宝贵意见。

此外，我要感谢以下早期版本读者对本书提供的同样宝贵的反馈意见：Ian Angell，Bruno Rignel，Jonathan Hugenschmidt，Autumn Peters 和 Mike Shwe。
