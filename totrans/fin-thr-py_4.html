<html><head></head><body><div id="sbo-rt-content" class="calibre1"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 4. Optimality and Equilibrium" class="calibre4"><div class="preface" id="optimality_equilibrium">
<h1 class="calibre11"><span class="firstname">Chapter 4. </span>Optimality and Equilibrium</h1>

<blockquote class="calibre12 pcalibre1 pcalibre2">
<p class="calibre13">Much <a data-type="indexterm" data-primary="Duffie, Darrell" id="idm44853700463032" class="calibre6"/>of economic theory is based on the premise: given two alternatives, an agent can, and will if able, choose a preferred one.</p>
<p data-type="attribution" class="pcalibre3 calibre16">Darrell Duffie (1988)</p>
</blockquote>
<blockquote class="calibre12 pcalibre1 pcalibre2">
<p class="calibre13">A <a data-type="indexterm" data-primary="Markowitz, Harry" id="idm44853700460200" class="calibre6"/>portfolio analysis starts with information concerning individual securities. It ends with conclusions concerning portfolios as a whole. The purpose of the analysis is to find portfolios which best meet the objectives of the investor.</p>
<p data-type="attribution" class="pcalibre3 calibre16">Harry Markowitz (1959)</p>
</blockquote>

<p class="author1">This chapter is about the modeling of agents and their optimization problems. It presents some of the fundamental building blocks of microeconomic theory (see Varian (1992)) and financial economics (see Eichberger and Harper (1997)). At the core of this chapter is<a data-type="indexterm" data-primary="expected utility maximization paradigm" id="idm44853700457560" class="calibre6"/> the <em class="calibre7">expected utility maximization</em> paradigm, which is the dominant way of modeling an agent’s preferences in financial economics. Based on this paradigm, two central topics are discussed.</p>

<p class="author1">First, we discuss how an agent chooses an optimal investment portfolio given their preferences and the initial wealth. This type of problem is typically <a data-type="indexterm" data-primary="optimal portfolio choice" id="idm44853700455512" class="calibre6"/>called <em class="calibre7">optimal portfolio choice</em>. The approach presented here does not rely on any form of simplification as seen with the mean-variance portfolio (MVP) approach and the Capital Asset Pricing Model (CAPM) that, for example, reduce the problem of choosing investment portfolios to the first and second moments of the return distributions of financial assets as well as their covariance.</p>

<p class="author1">Second, while prices for financial assets in the previous two chapters have been given a priori, this chapter derives them from fundamental principles in that it analyzes 
<span class="firstname">the <em class="calibre7">pricing</em></span> <em class="calibre7">of financial assets</em> based on the optimization problem of a <a data-type="indexterm" data-primary="agents" data-secondary="representative" id="idm44853700451608" class="calibre6"/><a data-type="indexterm" data-primary="representative agents" data-secondary="defined" id="idm44853700450632" class="calibre6"/>so-called <em class="calibre7">representative agent</em> in addition to <em class="calibre7">equilibrium arguments</em>. Loosely speaking, a representative agent can be thought of as the aggregation of (infinitely) many agents acting 
<span class="firstname">independently</span> in (financial) markets. Conditions for the existence of such a representative agent are well-known (see chapter 6 in Milne (1995))—however, they are not discussed in this chapter because financial theory in general simply postulates the 
<span class="firstname">existence</span>.</p>

<p class="author1">The current chapter mainly covers the following topics from finance, mathematics, and Python programming. On the Python side, not that many new elements are introduced. The basic mathematical and Python tool sets for doing finance in discrete models are already introduced and developed in the previous two chapters:</p>
<table class="calibre34">

<thead class="calibre35">
<tr class="calibre36">
<th class="calibre37">Finance</th>
<th class="calibre37">Mathematics</th>
<th class="calibre37">Python</th>
</tr>
</thead>
<tbody class="calibre38">
<tr class="calibre36">
<td class="calibre39"><p class="author1">Preferences and utility</p></td>
<td class="calibre39"><p class="author1">Utility function</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">NumPy</code></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Utility maximization</p></td>
<td class="calibre39"><p class="author1">Objective function, budget constraint, Theorem of Lagrange</p></td>
<td class="calibre39"><p class="author1"><span class="firstname"><code class="calibre40">scipy.optimize.minimize</code></span></p></td>
</tr>
<tr class="calibre36">
<td class="calibre39"><p class="author1">Indifference curves, budget line</p></td>
<td class="calibre39"><p class="author1">Function</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">NumPy</code>, <code class="calibre40">matplotlib</code></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Logarithmic utility</p></td>
<td class="calibre39"><p class="author1">Natural logarithm</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">NumPy</code>, <code class="calibre40">matplotlib</code></p></td>
</tr>
<tr class="calibre36">
<td class="calibre39"><p class="author1">Time-additive utility</p></td>
<td class="calibre39"><p class="author1">Utility function</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">NumPy</code>,
<span class="firstname"><code class="calibre40">scipy.optimize.minimize</code></span></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">(time-additive) expected utility</p></td>
<td class="calibre39"><p class="author1">Probability measure, Theorem of Lagrange</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">NumPy</code>,
<span class="firstname"><code class="calibre40">scipy.optimize.minimize</code></span></p></td>
</tr>
<tr class="calibre36">
<td class="calibre39"><p class="author1">Optimal investment portfolio</p></td>
<td class="calibre39"><p class="author1">Theorem of Lagrange, first-order conditions</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">NumPy</code>,
<span class="firstname"><code class="calibre40">scipy.optimize.minimize</code></span></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Equilibrium pricing, representative agent</p></td>
<td class="calibre39"><p class="author1">Theorem of Lagrange, first-order conditions</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">NumPy</code>,
<span class="firstname"><code class="calibre40">scipy.optimize.minimize</code></span>, <code class="calibre40">SymPy</code></p></td>
</tr>
<tr class="calibre36">
<td class="calibre39"><p class="author1">Martingale measures in incomplete markets</p></td>
<td class="calibre39"><p class="author1">Set of probability measures</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">SymPy</code>, <code class="calibre40">sy.Symbol</code>, <code class="calibre40">sy.solve</code></p></td>
</tr>
<tr class="calibre41">
<td class="calibre39"><p class="author1">Market completion by contingent claims</p></td>
<td class="calibre39"><p class="author1">Theorem of Lagrange, first-order conditions</p></td>
<td class="calibre39"><p class="author1"><code class="calibre40">NumPy</code>,
<span class="firstname"><code class="calibre40">scipy.optimize.minimize</code></span></p></td>
</tr>
</tbody>
</table>






<section data-type="sect1" data-pdf-bookmark="Utility Maximization" class="calibre4"><div class="preface" id="idm44853700412712">
<h1 class="calibre17">Utility Maximization</h1>

<p class="author1">Formally, <a data-type="indexterm" data-primary="agents" data-secondary="utility maximization" data-tertiary="utility functions" id="agent-utility" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" id="utility-optimize-problem" class="calibre6"/><a data-type="indexterm" data-primary="utility maximization" data-secondary="utility functions" id="utility-maximize-functions" class="calibre6"/>an agent is modeled by a <em class="calibre7">utility function</em>, which orders a set of choices the agent is faced with and which is a representation of the agent’s <em class="calibre7">preferences</em> (see chapter 7 in Varian (1992)).  Consider the static economy without uncertainty from <a data-type="xref" href="ch02_split_000.xhtml#two_state_economy" class="calibre6">Chapter 2</a>. In addition, assume that an agent is endowed with some initial wealth,
<math><mrow><mi>w</mi><mo>∈</mo><msub><mi>ℝ</mi> <mrow><mn>&gt;0</mn></mrow> </msub></mrow></math>.
The agent can decide how much of this wealth to spend today, <math alttext="t equals 0">
  <mrow>
    <mi>t</mi>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math>, and how much to save—via bank deposits—for future consumption. One can think of an agent faced with the question of how much to save for retirement.</p>

<p class="author1">The agent receives utility from money today, <math alttext="c 0">
  <msub><mi>c</mi> <mn>0</mn> </msub>
</math>, and in one year, <math alttext="c 1">
  <msub><mi>c</mi> <mn>1</mn> </msub>
</math>, according to the utility function:</p>
<div data-type="equation" class="calibre42">
<math mode="display">
  <mrow>
    <mi>U</mi>
    <mo>:</mo>
    <msubsup><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> <mn>2</mn> </msubsup>
    <mo>→</mo>
    <msub><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> </msub>
    <mo>,</mo>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msub><mi>c</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>↦</mo>
    <mi>u</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msub><mi>c</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">As an example, assume <math alttext="u left-parenthesis c 0 comma c 1 right-parenthesis equals c 0 dot c 1">
  <mrow>
    <mi>u</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msub><mi>c</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub><mi>c</mi> <mn>0</mn> </msub>
    <mo>·</mo>
    <msub><mi>c</mi> <mn>1</mn> </msub>
  </mrow>
</math>—expressing the idea that money today and in one year are substitutes, although not perfect ones (if either one is zero, utility is zero as well). What is the optimal consumption-saving plan for the agent? Their constrained optimization problem formally is:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row  max Underscript c 0 comma c 1 Endscripts c 0 dot c 1 2nd Row  s period t period c 0 plus c 1 equals w EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><msub><mi>c</mi> <mn>0</mn> </msub><mo>,</mo><msub><mi>c</mi> <mn>1</mn> </msub></mrow> </munder>
          <msub><mi>c</mi> <mn>0</mn> </msub>
          <mo>·</mo>
          <msub><mi>c</mi> <mn>1</mn> </msub>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mtext>s.t.</mtext>
          <mspace width="4.pt"/>
          <msub><mi>c</mi> <mn>0</mn> </msub>
          <mo>+</mo>
          <msub><mi>c</mi> <mn>1</mn> </msub>
          <mo>=</mo>
          <mi>w</mi>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">According to the Theorem of Lagrange (see chapter 5 in Sundaram (1996)), the constrained optimization problem can be transformed into an unconstrained one of the form:</p>
<div data-type="equation" class="calibre42">
<math alttext="max Underscript c 0 comma c 1 comma lamda Endscripts f left-parenthesis c 0 comma c 1 comma lamda right-parenthesis equals c 0 dot c 1 minus lamda dot left-parenthesis c 0 plus c 1 minus w right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><msub><mi>c</mi> <mn>0</mn> </msub><mo>,</mo><msub><mi>c</mi> <mn>1</mn> </msub><mo>,</mo><mi>λ</mi></mrow> </munder>
    <mi>f</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msub><mi>c</mi> <mn>1</mn> </msub>
      <mo>,</mo>
      <mi>λ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub><mi>c</mi> <mn>0</mn> </msub>
    <mo>·</mo>
    <msub><mi>c</mi> <mn>1</mn> </msub>
    <mo>-</mo>
    <mi>λ</mi>
    <mo>·</mo>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>+</mo>
      <msub><mi>c</mi> <mn>1</mn> </msub>
      <mo>-</mo>
      <mi>w</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">The first-order necessary conditions for optimality are:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row 1st Column StartFraction normal partial-differential f Over normal partial-differential c 0 EndFraction 2nd Column equals 3rd Column c 1 minus lamda equals 0 2nd Row 1st Column StartFraction normal partial-differential f Over normal partial-differential c 1 EndFraction 2nd Column equals 3rd Column c 0 minus lamda equals 0 3rd Row 1st Column StartFraction normal partial-differential f Over normal partial-differential lamda EndFraction 2nd Column equals 3rd Column c 0 plus c 1 minus w equals 0 EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><msub><mi>c</mi> <mn>0</mn> </msub></mrow></mfrac>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mrow>
            <msub><mi>c</mi> <mn>1</mn> </msub>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><msub><mi>c</mi> <mn>1</mn> </msub></mrow></mfrac>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mrow>
            <msub><mi>c</mi> <mn>0</mn> </msub>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>λ</mi></mrow></mfrac>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mrow>
            <msub><mi>c</mi> <mn>0</mn> </msub>
            <mo>+</mo>
            <msub><mi>c</mi> <mn>1</mn> </msub>
            <mo>-</mo>
            <mi>w</mi>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">From these, one easily derives <math alttext="c 0 equals c 1 equals StartFraction w Over 2 EndFraction">
  <mrow>
    <msub><mi>c</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <msub><mi>c</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mfrac><mi>w</mi> <mn>2</mn></mfrac>
  </mrow>
</math> as the optimal consumption-saving plan.</p>

<p class="author1">This optimization problem can be modeled and solved in Python numerically, for which <math alttext="w equals 10">
  <mrow>
    <mi>w</mi>
    <mo>=</mo>
    <mn>10</mn>
  </mrow>
</math> shall hold:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">def</code><code class="calibre22"> </code><code class="nf">u</code><code class="p">(</code><code class="n">c</code><code class="p">)</code><code class="p">:</code><code class="calibre22">
</code><code class="calibre22">            </code><code class="kn">return</code><code class="calibre22"> </code><code class="o">-</code><code class="n">c</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">c</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO1-1" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO1-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">2</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">w</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">10</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO1-2" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO1-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">3</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">from</code><code class="calibre22"> </code><code class="nn">scipy.optimize</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="n">minimize</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">cons</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="p">{</code><code class="s">'</code><code class="s">type</code><code class="s">'</code><code class="p">:</code><code class="calibre22"> </code><code class="s">'</code><code class="s">eq</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="s">'</code><code class="s">fun</code><code class="s">'</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">lambda</code><code class="calibre22"> </code><code class="n">c</code><code class="p">:</code><code class="calibre22"> </code><code class="n">c</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">c</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">w</code><code class="p">}</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO1-3" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO1-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">minimize</code><code class="p">(</code><code class="n">u</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">constraints</code><code class="o">=</code><code class="n">cons</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO1-4" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO1-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code class="calibre22">      </code><code class="n">fun</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">24.999999999999996</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">jac</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mi">5.</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">5.</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">message</code><code class="p">:</code><code class="calibre22"> </code><code class="s">'</code><code class="s">Optimization terminated successfully</code><code class="s">'</code><code class="calibre22">
</code><code class="calibre22">            </code><code class="n">nfev</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">6</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">nit</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">2</code><code class="calibre22">
</code><code class="calibre22">            </code><code class="n">njev</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">2</code><code class="calibre22">
</code><code class="calibre22">          </code><code class="n">status</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">success</code><code class="p">:</code><code class="calibre22"> </code><code class="nb">True</code><code class="calibre22">
</code><code class="calibre22">               </code><code class="n">x</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">5.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">5.</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO1-5" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO1-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">5.</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">5.</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">fun</code><code class="s">'</code><code class="p">]</code><code class="calibre22">   </code><a class="calibre6" id="co_optimality_and_equilibrium_CO1-6" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO1-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">24.999999999999996</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO1-1" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO1-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The utility function with a negative sign to accomplish a maximization through minimization.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO1-2" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO1-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The initial wealth of the agent to be distributed between today and the future.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO1-3" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO1-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The budget constraint as an equality constraint for the <code class="calibre22">minimize</code> function.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO1-4" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO1-4"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The optimization with initial guess and budget constraint.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO1-5" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO1-5"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The optimal consumption-saving plan.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO1-6" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO1-6"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The maximum utility gained through the optimal <a data-type="indexterm" data-primary="agents" data-secondary="utility maximization" data-tertiary="utility functions" data-startref="agent-utility" id="idm44853700238008" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-startref="utility-optimize-problem" id="idm44853700233960" class="calibre6"/><a data-type="indexterm" data-primary="utility maximization" data-secondary="utility functions" data-startref="utility-maximize-functions" id="idm44853700233000" class="calibre6"/>plan.</p></dd>
</dl>








<section data-type="sect2" data-pdf-bookmark="Indifference Curves" class="calibre4"><div class="preface" id="idm44853700215064">
<h2 class="calibre55">Indifference Curves</h2>

<p class="author1">The <a data-type="indexterm" data-primary="agents" data-secondary="utility maximization" data-tertiary="indifference curves" id="agent-utility-indifference" class="calibre6"/><a data-type="indexterm" data-primary="utility maximization" data-secondary="indifference curves" id="utility-indifference" class="calibre6"/><a data-type="indexterm" data-primary="indifference curves" id="indifference" class="calibre6"/>optimal solution from the previous section can be visualized by the means of <em class="calibre7">indifference curves</em>. An indifference curve is formed by all such combinations <math alttext="c equals left-parenthesis c 0 comma c 1 right-parenthesis">
  <mrow>
    <mi>c</mi>
    <mo>=</mo>
    <mo>(</mo>
    <msub><mi>c</mi> <mn>0</mn> </msub>
    <mo>,</mo>
    <msub><mi>c</mi> <mn>1</mn> </msub>
    <mo>)</mo>
  </mrow>
</math> that give the same utility <math alttext="u overbar">
  <mover accent="true"><mi>u</mi> <mo>¯</mo></mover>
</math>. The equation describing such a curve in <math alttext="left-parenthesis c 0 comma c 1 right-parenthesis">
  <mrow>
    <mo>(</mo>
    <msub><mi>c</mi> <mn>0</mn> </msub>
    <mo>,</mo>
    <msub><mi>c</mi> <mn>1</mn> </msub>
    <mo>)</mo>
  </mrow>
</math> space is:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column u overbar 2nd Column equals 3rd Column c 0 dot c 1 2nd Row 1st Column c 1 2nd Column equals 3rd Column StartFraction u overbar Over c 0 EndFraction EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mover accent="true"><mi>u</mi> <mo>¯</mo></mover>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <msub><mi>c</mi> <mn>0</mn> </msub>
          <mo>·</mo>
          <msub><mi>c</mi> <mn>1</mn> </msub>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msub><mi>c</mi> <mn>1</mn> </msub>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mfrac><mover accent="true"><mi>u</mi> <mo>¯</mo></mover> <msub><mi>c</mi> <mn>0</mn> </msub></mfrac>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">The equation describing the line<a data-type="indexterm" data-primary="budget constraints" id="idm44853699927400" class="calibre6"/> representing the <em class="calibre7">budget constraint</em> is:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column w 2nd Column equals 3rd Column c 0 plus c 1 2nd Row 1st Column c 1 2nd Column equals 3rd Column w minus c 0 EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mi>w</mi>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <msub><mi>c</mi> <mn>0</mn> </msub>
          <mo>+</mo>
          <msub><mi>c</mi> <mn>1</mn> </msub>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msub><mi>c</mi> <mn>1</mn> </msub>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>w</mi>
          <mo>-</mo>
          <msub><mi>c</mi> <mn>0</mn> </msub>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">The optimization problem is visualized in <a data-type="xref" href="ch04_split_000.xhtml#opt_01" class="calibre6">Figure 4-1</a>, where the optimal plan is given by the dot—this is where the indifference curve for <math alttext="u overbar equals 25">
  <mrow>
    <mover accent="true"><mi>u</mi> <mo>¯</mo></mover>
    <mo>=</mo>
    <mn>25</mn>
  </mrow>
</math> is tangent to the line representing the budget constraint.</p>

<p class="author1">In Python, this translates into the following code:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">9</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">def</code><code class="calibre22"> </code><code class="nf">iu</code><code class="p">(</code><code class="n">u</code><code class="p">,</code><code class="calibre22"> </code><code class="n">c0</code><code class="p">)</code><code class="p">:</code><code class="calibre22">
</code><code class="calibre22">            </code><code class="kn">return</code><code class="calibre22"> </code><code class="n">u</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">c0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO2-1" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO2-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">def</code><code class="calibre22"> </code><code class="nf">c1</code><code class="p">(</code><code class="n">c0</code><code class="p">)</code><code class="p">:</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="kn">return</code><code class="calibre22"> </code><code class="n">w</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">c0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO2-2" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO2-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="nn">numpy</code><code class="calibre22"> </code><code class="kn">as</code><code class="calibre22"> </code><code class="nn">np</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">np</code><code class="o">.</code><code class="n">set_printoptions</code><code class="p">(</code><code class="n">precision</code><code class="o">=</code><code class="mi">5</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">12</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">from</code><code class="calibre22"> </code><code class="nn">pylab</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="n">mpl</code><code class="p">,</code><code class="calibre22"> </code><code class="n">plt</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s">'</code><code class="s">seaborn</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s">'</code><code class="s">savefig.dpi</code><code class="s">'</code><code class="p">]</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">300</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">mpl</code><code class="o">.</code><code class="n">rcParams</code><code class="p">[</code><code class="s">'</code><code class="s">font.family</code><code class="s">'</code><code class="p">]</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="s">'</code><code class="s">serif</code><code class="s">'</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">13</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">c0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">w</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO2-3" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO2-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">14</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">c0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">c1</code><code class="p">(</code><code class="n">c0</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">budget constraint</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">lw</code><code class="o">=</code><code class="mi">3.0</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">c0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">iu</code><code class="p">(</code><code class="mi">15</code><code class="p">,</code><code class="calibre22"> </code><code class="n">c0</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="s">'</code><code class="s">--</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">$u=15$</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">c0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">iu</code><code class="p">(</code><code class="mi">25</code><code class="p">,</code><code class="calibre22"> </code><code class="n">c0</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">$u=25$</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">c0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">iu</code><code class="p">(</code><code class="mi">35</code><code class="p">,</code><code class="calibre22"> </code><code class="n">c0</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="s">'</code><code class="s">-.</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">$u=35$</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="s">'</code><code class="s">ro</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">$c=(5, 5)$</code><code class="s">'</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">loc</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO2-1" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO2-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Function for indifference curve.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO2-2" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO2-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Function for budget line.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO2-3" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO2-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The domain over which to plot<a data-type="indexterm" data-primary="agents" data-secondary="utility maximization" data-tertiary="indifference curves" data-startref="agent-utility-indifference" id="idm44853699721464" class="calibre6"/><a data-type="indexterm" data-primary="utility maximization" data-secondary="indifference curves" data-startref="utility-indifference" id="idm44853699775032" class="calibre6"/><a data-type="indexterm" data-primary="indifference curves" data-startref="indifference" id="idm44853699773816" class="calibre6"/> both.</p></dd>
</dl>

<figure class="calibre50"><div id="opt_01" class="figure">
<img src="Images/ftwp_0401.png" alt="ftwp 0401" class="calibre57"/>
<h6 class="calibre52"><span class="firstname">Figure 4-1. </span>The utility maximization problem</h6>
</div></figure>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Appropriate Utility Functions" class="calibre4"><div class="preface" id="idm44853700195672">
<h2 class="calibre55">Appropriate Utility Functions</h2>

<p class="author1">In finance, <a data-type="indexterm" data-primary="agents" data-secondary="utility maximization" data-tertiary="conditions for functions" id="idm44853699749000" class="calibre6"/><a data-type="indexterm" data-primary="utility maximization" data-secondary="conditions for functions" id="idm44853699747768" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-secondary="conditions for" id="idm44853699746808" class="calibre6"/>the utility that an agent gains from money they have available at a certain point in time—as a substitute for any other real asset that might be bought with the money, for instance—is typically expressed as a function
<math><mrow><mi>u</mi><mo>:</mo><msub><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> </msub><mo>→</mo><mi>ℝ</mi></mrow></math>,
which is assumed to satisfy three conditions:</p>
<ol class="calibre47">
<li class="calibre48">
<p class="author1"><math alttext="u left-parenthesis x right-parenthesis">
  <mrow>
    <mi>u</mi>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
  </mrow>
</math> is twice differentiable</p>
</li>
<li class="calibre48">
<p class="author1"><math alttext="StartFraction d u Over d x EndFraction greater-than 0">
  <mrow>
    <mfrac><mrow><mi>d</mi><mi>u</mi></mrow> <mrow><mi>d</mi><mi>x</mi></mrow></mfrac>
    <mo>&gt;</mo>
    <mn>0</mn>
  </mrow>
</math></p>
</li>
<li class="calibre48">
<p class="author1"><math alttext="StartFraction d squared u Over d x squared EndFraction less-than-or-equal-to 0">
  <mrow>
    <mfrac><mrow><msup><mi>d</mi> <mn>2</mn> </msup><mi>u</mi></mrow> <mrow><mi>d</mi><msup><mi>x</mi> <mn>2</mn> </msup></mrow></mfrac>
    <mo>≤</mo>
    <mn>0</mn>
  </mrow>
</math></p>
</li>

</ol>

<p class="author1">The first condition is a technical prerequisite for the other two. The second condition formalizes the idea that more money—everything else being equal—is better than less money. Agents are assumed to be insatiable. The third condition states that the marginal utility from an additional unit of money is smaller (or the same at the maximum) than the marginal utility of the previous marginal unit of money. The function is therewith assumed to be increasing and (quasi-)concave.</p>
</div></section>













<section data-type="sect2" class="calibre4" data-pdf-bookmark="Logarithmic Utility"><div class="preface" id="idm44853699732120">
<h2 class="calibre55">Logarithmic Utility</h2>

<p class="author1">This<a data-type="indexterm" data-primary="agents" data-secondary="utility maximization" data-tertiary="logarithmic utility function" id="agent-utility-logarithmic" class="calibre6"/><a data-type="indexterm" data-primary="utility maximization" data-secondary="logarithmic utility function" id="utility-maximize-logarithmic" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-secondary="logarithmic" id="utility-logarithmic" class="calibre6"/><a data-type="indexterm" data-primary="logarithmic utility functions" id="logarithmic-utility" class="calibre6"/> section introduces a type of function that is well suited for financial analyses based on a utility maximizing agent. Such a function—that satisfies the three conditions of the previous section and that is regularly used in finance to model the utility an agent receives from money (or consumption)—is <a data-type="indexterm" data-primary="natural logarithm" id="idm44853699730968" class="calibre6"/>the <em class="calibre7">natural logarithm</em> <math alttext="u left-parenthesis x right-parenthesis equals ln x">
  <mrow>
    <mi>u</mi>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
    <mo>=</mo>
    <mo form="prefix">ln</mo>
    <mi>x</mi>
  </mrow>
</math>. For it, one gets:</p>
<ol class="calibre47">
<li class="calibre48">
<p class="author1"><math alttext="StartFraction d u Over d x EndFraction equals StartFraction 1 Over x EndFraction greater-than 0 for x element-of double-struck upper R Subscript 0 Baseline">
  <mrow>
    <mfrac><mrow><mi>d</mi><mi>u</mi></mrow> <mrow><mi>d</mi><mi>x</mi></mrow></mfrac>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mi>x</mi></mfrac>
    <mo>&gt;</mo>
    <mn>0</mn>
    <mspace width="4.pt"/>
    <mtext>for</mtext>
    <mspace width="4.pt"/>
    <mi>x</mi>
    <mo>∈</mo>
    <msub><mi>ℝ</mi> <mrow><mo>&gt;</mo><mn>0</mn></mrow> </msub>
  </mrow>
</math></p>
</li>
<li class="calibre48">
<p class="author1"><math alttext="StartFraction d squared u Over d x squared EndFraction equals minus StartFraction 1 Over x squared EndFraction less-than 0">
  <mrow>
    <mfrac><mrow><msup><mi>d</mi> <mn>2</mn> </msup><mi>u</mi></mrow> <mrow><mi>d</mi><msup><mi>x</mi> <mn>2</mn> </msup></mrow></mfrac>
    <mo>=</mo>
    <mo>-</mo>
    <mfrac><mn>1</mn> <msup><mi>x</mi> <mn>2</mn> </msup></mfrac>
    <mo>&lt;</mo>
    <mn>0</mn>
  </mrow>
</math> for <math><mrow><mi>x</mi><mo>∈</mo><msub><mi>ℝ</mi> <mrow><mn>&gt;0</mn></mrow> </msub></mrow></math></p>
</li>

</ol>

<p class="author1">Python allows us to visualize the three relevant functions. <code class="calibre22">NumPy</code> is used in combination with vectorized calculations. <a data-type="xref" href="ch04_split_000.xhtml#natural_log" class="calibre6">Figure 4-2</a> shows the plot as generated by the following code:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">15</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">x</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0.5</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">50</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO3-1" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO3-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">16</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">x</code><code class="p">[</code><code class="p">:</code><code class="mi">5</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO3-2" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO3-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">16</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0.5</code><code class="calibre22">    </code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.69388</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.88776</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1.08163</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1.27551</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">17</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">u</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">log</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO3-3" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO3-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">18</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">u1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">x</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO3-4" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO3-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">u2</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">x</code><code class="calibre22"> </code><code class="o">*</code><code class="o">*</code><code class="calibre22"> </code><code class="mi">2</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO3-5" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO3-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">20</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO3-6" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO3-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code class="calibre22"> </code><code class="n">u</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">$u$</code><code class="s">'</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO3-7" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO3-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code class="calibre22"> </code><code class="n">u1</code><code class="p">,</code><code class="calibre22"> </code><code class="s">'</code><code class="s">--</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">$du/dx$</code><code class="s">'</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO3-8" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO3-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code class="calibre22"> </code><code class="n">u2</code><code class="p">,</code><code class="calibre22"> </code><code class="s">'</code><code class="s">-.</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="n">label</code><code class="o">=</code><code class="s">'</code><code class="s">$d^2u/dx^2$</code><code class="s">'</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO3-9" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO3-9"><img src="Images/9.png" alt="9" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">loc</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="p">;</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO3-10" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO3-10"><img src="Images/10.png" alt="10" class="calibre44"/></a></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO3-1" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO3-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Creates an <code class="calibre22">ndarray</code> object with floating point numbers between 0.5 and 10 and a homogeneous spacing to get 50 values.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO3-2" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO3-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Shows a selection of the resulting numbers.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO3-3" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO3-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Calculates the values for the utility function.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO3-4" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO3-4"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">And for its first derivative as well as…</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO3-5" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO3-5"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">…for its second derivative.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO3-6" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO3-6"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Creates a new canvas for plotting and provides sizing parameters.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO3-7" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO3-7"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Plots the utility function.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO3-8" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO3-8"><img src="Images/8.png" alt="8" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Plots the first derivative.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO3-9" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO3-9"><img src="Images/9.png" alt="9" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Plots the second derivative.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO3-10" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO3-10"><img src="Images/10.png" alt="10" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Puts a legend in the optimal <a data-type="indexterm" data-primary="agents" data-secondary="utility maximization" data-tertiary="logarithmic utility function" data-startref="agent-utility-logarithmic" id="idm44853699158744" class="calibre6"/><a data-type="indexterm" data-primary="utility maximization" data-secondary="logarithmic utility function" data-startref="utility-maximize-logarithmic" id="idm44853699157288" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-secondary="logarithmic" data-startref="utility-logarithmic" id="idm44853699156136" class="calibre6"/><a data-type="indexterm" data-primary="logarithmic utility functions" data-startref="logarithmic-utility" id="idm44853699154920" class="calibre6"/>location (<code class="calibre22">loc=0</code>).</p></dd>
</dl>

<figure class="calibre50"><div id="natural_log" class="figure">
<img src="Images/ftwp_0402.png" alt="ftwp 0402" class="calibre64"/>
<h6 class="calibre52"><span class="firstname">Figure 4-2. </span>The natural logarithm function and its first and second derivatives</h6>
</div></figure>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Time-Additive Utility" class="calibre4"><div class="preface" id="idm44853699151800">
<h2 class="calibre55">Time-Additive Utility</h2>

<p class="author1">Using <a data-type="indexterm" data-primary="agents" data-secondary="utility maximization" data-tertiary="time-additive" id="agent-utility-time-additive" class="calibre6"/><a data-type="indexterm" data-primary="utility maximization" data-secondary="time-additive utility function" id="utility-maximize-time-additive" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-secondary="time-additive" id="utility-time-additive" class="calibre6"/><a data-type="indexterm" data-primary="time-additive utility functions" id="time-additive-utility" class="calibre6"/>the natural logarithm as a function to model utility of an agent from money, the preferences of an agent over consumption-saving plans <math alttext="c equals left-parenthesis c 0 comma c 1 right-parenthesis">
  <mrow>
    <mi>c</mi>
    <mo>=</mo>
    <mo>(</mo>
    <msub><mi>c</mi> <mn>0</mn> </msub>
    <mo>,</mo>
    <msub><mi>c</mi> <mn>1</mn> </msub>
    <mo>)</mo>
  </mrow>
</math> can be described as a time-additive function of the following form:</p>
<div data-type="equation" class="calibre42">
<math mode="display">
  <mrow>
    <mi>U</mi>
    <mo>:</mo>
    <msubsup><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> <mn>2</mn> </msubsup>
    <mo>→</mo>
    <mi>ℝ</mi>
    <mo>,</mo>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msub><mi>c</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>↦</mo>
    <mo form="prefix">ln</mo>
    <msub><mi>c</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <mi>κ</mi>
    <mo>·</mo>
    <mo form="prefix">ln</mo>
    <msub><mi>c</mi> <mn>1</mn> </msub>
  </mrow>
</math>
</div>

<p class="author1"><math><mrow><mi>κ</mi><mo>∈</mo><msub><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> </msub></mrow></math>
is assumed to take on values <math alttext="0 less-than kappa less-than-or-equal-to 1">
  <mrow>
    <mn>0</mn>
    <mo>&lt;</mo>
    <mi>κ</mi>
    <mo>≤</mo>
    <mn>1</mn>
  </mrow>
</math> and represents the <em class="calibre7">time preference</em> of the agent. It embodies the idea that money and consumption today are valued higher than in one year. At least weakly, 100 USD now is preferred to 100 USD in one year—no matter what exact function describes utility (assuming consistency of preferences over time). It can be thought of as a nonmonetary discount factor. It is easily verified that this function satisfies the three conditions described previously—it is twice 
<span class="firstname">differentiable</span>, increasing, and concave—based on the partial derivatives with regard to both <math alttext="c 0">
  <msub><mi>c</mi> <mn>0</mn> </msub>
</math> and <math alttext="c 1">
  <msub><mi>c</mi> <mn>1</mn> </msub>
</math>.</p>

<p class="author1">If the agent has initial wealth of <math alttext="w">
  <mi>w</mi>
</math>, their constrained optimization problem is:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row  max Underscript c 0 comma c 1 Endscripts ln c 0 plus kappa dot ln c 1 2nd Row  s period t period c 0 plus c 1 equals w EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><msub><mi>c</mi> <mn>0</mn> </msub><mo>,</mo><msub><mi>c</mi> <mn>1</mn> </msub></mrow> </munder>
          <mo form="prefix">ln</mo>
          <msub><mi>c</mi> <mn>0</mn> </msub>
          <mo>+</mo>
          <mi>κ</mi>
          <mo>·</mo>
          <mo form="prefix">ln</mo>
          <msub><mi>c</mi> <mn>1</mn> </msub>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mtext>s.t.</mtext>
          <mspace width="4.pt"/>
          <msub><mi>c</mi> <mn>0</mn> </msub>
          <mo>+</mo>
          <msub><mi>c</mi> <mn>1</mn> </msub>
          <mo>=</mo>
          <mi>w</mi>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">or</p>
<div data-type="equation" class="calibre42">
<math alttext="max Underscript c 0 comma c 1 comma lamda Endscripts f left-parenthesis c 0 comma c 1 comma lamda right-parenthesis equals ln c 0 plus kappa dot ln c 1 minus lamda dot left-parenthesis c 0 plus c 1 minus w right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><msub><mi>c</mi> <mn>0</mn> </msub><mo>,</mo><msub><mi>c</mi> <mn>1</mn> </msub><mo>,</mo><mi>λ</mi></mrow> </munder>
    <mi>f</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msub><mi>c</mi> <mn>1</mn> </msub>
      <mo>,</mo>
      <mi>λ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mo form="prefix">ln</mo>
    <msub><mi>c</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <mi>κ</mi>
    <mo>·</mo>
    <mo form="prefix">ln</mo>
    <msub><mi>c</mi> <mn>1</mn> </msub>
    <mo>-</mo>
    <mi>λ</mi>
    <mo>·</mo>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>+</mo>
      <msub><mi>c</mi> <mn>1</mn> </msub>
      <mo>-</mo>
      <mi>w</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">The first-order necessary conditions for optimality are:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row 1st Column StartFraction normal partial-differential f Over normal partial-differential c 0 EndFraction 2nd Column equals 3rd Column StartFraction 1 Over c 0 EndFraction minus lamda equals 0 2nd Row 1st Column StartFraction normal partial-differential f Over normal partial-differential c 1 EndFraction 2nd Column equals 3rd Column kappa dot StartFraction 1 Over c 1 EndFraction minus lamda equals 0 3rd Row 1st Column StartFraction normal partial-differential f Over normal partial-differential lamda EndFraction 2nd Column equals 3rd Column c 0 plus c 1 minus w equals 0 EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><msub><mi>c</mi> <mn>0</mn> </msub></mrow></mfrac>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mrow>
            <mfrac><mn>1</mn> <msub><mi>c</mi> <mn>0</mn> </msub></mfrac>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><msub><mi>c</mi> <mn>1</mn> </msub></mrow></mfrac>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mrow>
            <mi>κ</mi>
            <mo>·</mo>
            <mfrac><mn>1</mn> <msub><mi>c</mi> <mn>1</mn> </msub></mfrac>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>λ</mi></mrow></mfrac>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mrow>
            <msub><mi>c</mi> <mn>0</mn> </msub>
            <mo>+</mo>
            <msub><mi>c</mi> <mn>1</mn> </msub>
            <mo>-</mo>
            <mi>w</mi>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">From these, one obtains:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column StartFraction 1 Over c 0 EndFraction 2nd Column equals 3rd Column kappa dot StartFraction 1 Over c 1 EndFraction 2nd Row 1st Column c 1 2nd Column equals 3rd Column kappa dot c 0 EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mfrac><mn>1</mn> <msub><mi>c</mi> <mn>0</mn> </msub></mfrac>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>κ</mi>
          <mo>·</mo>
          <mfrac><mn>1</mn> <msub><mi>c</mi> <mn>1</mn> </msub></mfrac>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msub><mi>c</mi> <mn>1</mn> </msub>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>κ</mi>
          <mo>·</mo>
          <msub><mi>c</mi> <mn>0</mn> </msub>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">The optimal consumption-saving plan now reflects the time preference in that consumption in one year <math alttext="c 1">
  <msub><mi>c</mi> <mn>1</mn> </msub>
</math> is set to <math alttext="kappa dot c 0">
  <mrow>
    <mi>κ</mi>
    <mo>·</mo>
    <msub><mi>c</mi> <mn>0</mn> </msub>
  </mrow>
</math>. It also holds</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column c 0 plus kappa dot c 0 2nd Column equals 3rd Column w 2nd Row 1st Column c 0 2nd Column equals 3rd Column StartFraction w Over 1 plus kappa EndFraction EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <msub><mi>c</mi> <mn>0</mn> </msub>
          <mo>+</mo>
          <mi>κ</mi>
          <mo>·</mo>
          <msub><mi>c</mi> <mn>0</mn> </msub>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mi>w</mi>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msub><mi>c</mi> <mn>0</mn> </msub>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mfrac><mi>w</mi> <mrow><mn>1</mn><mo>+</mo><mi>κ</mi></mrow></mfrac>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">and</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column StartFraction w Over 1 plus kappa EndFraction plus c 1 2nd Column equals 3rd Column w 2nd Row 1st Column c 1 2nd Column equals 3rd Column StartFraction kappa dot w Over 1 plus kappa EndFraction EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <mfrac><mi>w</mi> <mrow><mn>1</mn><mo>+</mo><mi>κ</mi></mrow></mfrac>
          <mo>+</mo>
          <msub><mi>c</mi> <mn>1</mn> </msub>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mi>w</mi>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>⇔</mo>
          <msub><mi>c</mi> <mn>1</mn> </msub>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mfrac><mrow><mi>κ</mi><mo>·</mo><mi>w</mi></mrow> <mrow><mn>1</mn><mo>+</mo><mi>κ</mi></mrow></mfrac>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">The budget constraint is binding:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartFraction w Over 1 plus kappa EndFraction plus StartFraction kappa dot w Over 1 plus kappa EndFraction equals StartFraction w plus kappa dot w Over 1 plus kappa EndFraction equals w" display="block">
  <mrow>
    <mfrac><mi>w</mi> <mrow><mn>1</mn><mo>+</mo><mi>κ</mi></mrow></mfrac>
    <mo>+</mo>
    <mfrac><mrow><mi>κ</mi><mo>·</mo><mi>w</mi></mrow> <mrow><mn>1</mn><mo>+</mo><mi>κ</mi></mrow></mfrac>
    <mo>=</mo>
    <mfrac><mrow><mi>w</mi><mo>+</mo><mi>κ</mi><mo>·</mo><mi>w</mi></mrow> <mrow><mn>1</mn><mo>+</mo><mi>κ</mi></mrow></mfrac>
    <mo>=</mo>
    <mi>w</mi>
  </mrow>
</math>
</div>

<p class="author1">The following code solves the optimization problem numerically for <math alttext="w equals 10">
  <mrow>
    <mi>w</mi>
    <mo>=</mo>
    <mn>10</mn>
  </mrow>
</math>. The optimal plan reflects the time preference:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">21</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="nn">math</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">from</code><code class="calibre22"> </code><code class="nn">scipy.optimize</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="n">minimize</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">23</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">kappa</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">10</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="mi">11</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">def</code><code class="calibre22"> </code><code class="nf">U</code><code class="p">(</code><code class="n">c</code><code class="p">)</code><code class="p">:</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="kn">return</code><code class="calibre22"> </code><code class="o">-</code><code class="p">(</code><code class="n">math</code><code class="o">.</code><code class="n">log</code><code class="p">(</code><code class="n">c</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">)</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22">  </code><code class="n">kappa</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">math</code><code class="o">.</code><code class="n">log</code><code class="p">(</code><code class="n">c</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO4-1" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO4-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">w</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">10</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">cons</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="p">{</code><code class="s">'</code><code class="s">type</code><code class="s">'</code><code class="p">:</code><code class="calibre22"> </code><code class="s">'</code><code class="s">eq</code><code class="s">'</code><code class="p">,</code><code class="calibre22"> </code><code class="s">'</code><code class="s">fun</code><code class="s">'</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">lambda</code><code class="calibre22"> </code><code class="n">c</code><code class="p">:</code><code class="calibre22"> </code><code class="n">c</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">c</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">w</code><code class="p">}</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO4-2" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO4-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">minimize</code><code class="p">(</code><code class="n">U</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">constraints</code><code class="o">=</code><code class="n">cons</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code class="calibre22">      </code><code class="n">fun</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">3.0747286083026886</code><code class="calibre22">
</code><code class="calibre22">              </code><code class="n">jac</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mi">0.19091</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">0.19091</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">          </code><code class="n">message</code><code class="p">:</code><code class="calibre22"> </code><code class="s">'</code><code class="s">Optimization terminated successfully</code><code class="s">'</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">nfev</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">18</code><code class="calibre22">
</code><code class="calibre22">              </code><code class="n">nit</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">6</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">njev</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">6</code><code class="calibre22">
</code><code class="calibre22">           </code><code class="n">status</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0</code><code class="calibre22">
</code><code class="calibre22">          </code><code class="n">success</code><code class="p">:</code><code class="calibre22"> </code><code class="nb">True</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="n">x</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">5.23811</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">4.76189</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">29</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO4-3" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO4-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">29</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">5.23811</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">4.76189</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">fun</code><code class="s">'</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO4-4" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO4-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">3.0747286083026886</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO4-1" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO4-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The utility function with a negative sign to accomplish a maximization through minimization.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO4-2" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO4-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The budget constraint as an equality constraint for the <code class="calibre22">minimize</code> function.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO4-3" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO4-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The optimal consumption-saving plan, reflecting the time preference in that <math alttext="c 0">
  <msub><mi>c</mi> <mn>0</mn> </msub>
</math> is higher than <math alttext="c 1">
  <msub><mi>c</mi> <mn>1</mn> </msub>
</math>—by exactly 10%.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO4-4" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO4-4"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The maximum utility gained through <a data-type="indexterm" data-primary="agents" data-secondary="utility maximization" data-tertiary="time-additive" data-startref="agent-utility-time-additive" id="idm44853698934664" class="calibre6"/><a data-type="indexterm" data-primary="utility maximization" data-secondary="time-additive utility function" data-startref="utility-maximize-time-additive" id="idm44853698933080" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-secondary="time-additive" data-startref="utility-time-additive" id="idm44853698914616" class="calibre6"/><a data-type="indexterm" data-primary="time-additive utility functions" data-startref="time-additive-utility" id="idm44853698913432" class="calibre6"/>the optimal plan.<sup class="calibre14"><a data-type="noteref" id="idm44853698912344-marker" href="ch04_split_001.xhtml#idm44853698912344" class="calibre15">1</a></sup></p></dd>
</dl>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Expected Utility" class="calibre4"><div class="preface" id="idm44853700412216">
<h1 class="calibre17">Expected Utility</h1>

<p class="author1">Now <a data-type="indexterm" data-primary="agents" data-secondary="expected utility" id="agents-expected" class="calibre6"/><a data-type="indexterm" data-primary="uncertainty" data-secondary="expected utility" id="uncertainty-expected" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-secondary="expected utility" id="utility-expected" class="calibre6"/><a data-type="indexterm" data-primary="expected utility function" id="expected-utility" class="calibre6"/>consider the static two-state economy with <em class="calibre7">uncertainty</em>. Assume that an agent, endowed with some initial wealth,
<math><mrow><mi>w</mi><mo>∈</mo><msub><mi>ℝ</mi> <mrow><mn>&gt;0</mn></mrow> </msub></mrow></math>,
gains utility only through money available in one year—but now distinguished in the two states that are possible then. This shall <a data-type="indexterm" data-primary="pure investment problem" id="idm44853698847944" class="calibre6"/>represent a <em class="calibre7">pure investment problem</em> where all available initial wealth shall be optimally invested in the traded financial assets.</p>

<p class="author1">Assume that <em class="calibre7">two financial assets</em> are traded, a risk-less bond with price process</p>
<div data-type="equation" class="calibre42">
<math alttext="upper B equals left-parenthesis upper B 0 comma left-parenthesis upper B 1 comma upper B 1 right-parenthesis Superscript upper T Baseline right-parenthesis" display="block">
  <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>B</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msup><mrow><mo>(</mo><msub><mi>B</mi> <mn>1</mn> </msub><mo>,</mo><msub><mi>B</mi> <mn>1</mn> </msub><mo>)</mo></mrow> <mi>T</mi> </msup>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">and a risky stock with price process</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S equals left-parenthesis upper S 0 comma left-parenthesis upper S 1 Superscript u Baseline comma upper S 1 Superscript d Baseline right-parenthesis Superscript upper T Baseline right-parenthesis" display="block">
  <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>S</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msup><mrow><mo>(</mo><msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup><mo>,</mo><msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup><mo>)</mo></mrow> <mi>T</mi> </msup>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">Financial assets are a means to transfer the initial wealth from today to a later point in time. The major decision problem of the agent is to decide what to consume in either one of the future states.</p>

<p class="author1">A model for the investment problem the agent is faced with under uncertainty is given by the <em class="calibre7">expected utility</em> of the agent that is to be maximized given <math alttext="w">
  <mi>w</mi>
</math>. The <em class="calibre7">expected utility function</em> is given by:</p>
<div data-type="equation" class="calibre42">
<math mode="display">
  <mrow>
    <mi>U</mi>
    <mo>:</mo>
    <msubsup><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> <mn>2</mn> </msubsup>
    <mo>→</mo>
    <mi>ℝ</mi>
    <mo>,</mo>
    <msub><mi>c</mi> <mn>1</mn> </msub>
    <mo>↦</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>u</mi>
      <mrow>
        <mo>(</mo>
        <msub><mi>c</mi> <mn>1</mn> </msub>
        <mo>)</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
</math></div>

<p class="author1">With the <em class="calibre7">price vector</em> <math alttext="script upper M 0 equals left-parenthesis upper B 0 comma upper S 0 right-parenthesis Superscript upper T">
  <mrow>
    <msub><mi>ℳ</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <msup><mrow><mo>(</mo><msub><mi>B</mi> <mn>0</mn> </msub><mo>,</mo><msub><mi>S</mi> <mn>0</mn> </msub><mo>)</mo></mrow> <mi>T</mi> </msup>
  </mrow>
</math>, the agent can distribute their initial wealth according to</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M 0 dot phi equals w left right double arrow upper B 0 dot b plus upper S 0 dot s equals w" display="block">
  <mrow>
    <msub><mi>ℳ</mi> <mn>0</mn> </msub>
    <mo>·</mo>
    <mi>ϕ</mi>
    <mo>=</mo>
    <mi>w</mi>
    <mo>⇔</mo>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>·</mo>
    <mi>b</mi>
    <mo>+</mo>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>·</mo>
    <mi>s</mi>
    <mo>=</mo>
    <mi>w</mi>
  </mrow>
</math>
</div>

<p class="author1">where
<math><mrow><mi>ϕ</mi><mo>=</mo><msup><mrow><mo>(</mo><mi>b</mi><mo>,</mo><mi>s</mi><mo>)</mo></mrow> <mi>T</mi> </msup><mo>∈</mo><msubsup><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> <mn>2</mn> </msubsup></mrow></math>
represents the <em class="calibre7">portfolio</em> consisting of the risk-less bond and the risky stock as composed by the agent. This <em class="calibre7">budget constraint</em> will<a data-type="indexterm" data-primary="budget constraints" id="idm44853698633256" class="calibre6"/> always be binding due to the agent being insatiable.  Short selling shall not be allowed.</p>

<p class="author1">The <em class="calibre7">market payoff matrix</em> is <a data-type="indexterm" data-primary="market payoff matrix" id="idm44853698631560" class="calibre6"/>as follows:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M equals Start 2 By 2 Matrix 1st Row 1st Column upper B 1 2nd Column upper S 1 Superscript u Baseline 2nd Row 1st Column upper B 1 2nd Column upper S 1 Superscript d EndMatrix" display="block">
  <mrow>
    <mi>ℳ</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <msub><mi>B</mi> <mn>1</mn> </msub>
          </mtd>
          <mtd>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub><mi>B</mi> <mn>1</mn> </msub>
          </mtd>
          <mtd>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">How much money does the agent have available in either state one year from today? This is determined by the portfolio the agent chooses to compose:</p>
<div data-type="equation" class="calibre42">
<math alttext="c 1 equals script upper M dot phi equals StartBinomialOrMatrix upper B 1 Choose upper B 1 EndBinomialOrMatrix dot b plus StartBinomialOrMatrix upper S 1 Superscript u Baseline Choose upper S 1 Superscript d Baseline EndBinomialOrMatrix dot s" display="block">
  <mrow>
    <msub><mi>c</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mi>ℳ</mi>
    <mo>·</mo>
    <mi>ϕ</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <msub><mi>B</mi> <mn>1</mn> </msub>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msub><mi>B</mi> <mn>1</mn> </msub>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>·</mo>
    <mi>b</mi>
    <mo>+</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
    <mo>·</mo>
    <mi>s</mi>
  </mrow>
</math>
</div>

<p class="author1">This leads to</p>
<div data-type="equation" class="calibre42">
<math alttext="c 1 equals StartBinomialOrMatrix b dot upper B 1 plus s dot upper S 1 Superscript u Baseline Choose b dot upper B 1 plus s dot upper S 1 Superscript d EndBinomialOrMatrix" display="block">
  <mrow>
    <msub><mi>c</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mi>b</mi>
              <mo>·</mo>
              <msub><mi>B</mi> <mn>1</mn> </msub>
              <mo>+</mo>
              <mi>s</mi>
              <mo>·</mo>
              <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mi>b</mi>
              <mo>·</mo>
              <msub><mi>B</mi> <mn>1</mn> </msub>
              <mo>+</mo>
              <mi>s</mi>
              <mo>·</mo>
              <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">or</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row 1st Column c 1 Superscript u 2nd Column equals 3rd Column b dot upper B 1 plus s dot upper S 1 Superscript u 2nd Row 1st Column c 1 Superscript d 2nd Column equals 3rd Column b dot upper B 1 plus s dot upper S 1 Superscript d EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <msubsup><mi>c</mi> <mn>1</mn> <mi>u</mi> </msubsup>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mrow>
            <mi>b</mi>
            <mo>·</mo>
            <msub><mi>B</mi> <mn>1</mn> </msub>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <msubsup><mi>c</mi> <mn>1</mn> <mi>d</mi> </msubsup>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mrow>
            <mi>b</mi>
            <mo>·</mo>
            <msub><mi>B</mi> <mn>1</mn> </msub>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">The <a data-type="indexterm" data-primary="optimal portfolio choice" data-secondary="constrained optimization problem" id="idm44853698446136" class="calibre6"/><a data-type="indexterm" data-primary="constrained optimization problem" id="idm44853698445144" class="calibre6"/>complete decision-making problem—with regard to <em class="calibre7">optimal portfolio choice</em>—of the agent can then be represented as the following <em class="calibre7">constrained optimization problem</em>:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column Blank 2nd Column max Underscript c 1 Endscripts 3rd Column bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis c 1 right-parenthesis right-parenthesis 2nd Row 1st Column left-parenthesis i right-parenthesis w 2nd Column equals 3rd Column script upper M 0 dot phi 3rd Row 1st Column left-parenthesis ii right-parenthesis c 1 2nd Column equals 3rd Column script upper M dot phi EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd/>
      <mtd>
        <munder><mo movablelimits="true" form="prefix">max</mo> <msub><mi>c</mi> <mn>1</mn> </msub> </munder>
      </mtd>
      <mtd>
        <mrow>
          <msup><mi>𝐄</mi> <mi>P</mi> </msup>
          <mrow>
            <mo>(</mo>
            <mi>u</mi>
            <mrow>
              <mo>(</mo>
              <msub><mi>c</mi> <mn>1</mn> </msub>
              <mo>)</mo>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mtext>(i)</mtext>
          <mspace width="4.pt"/>
          <mi>w</mi>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <msub><mi>ℳ</mi> <mn>0</mn> </msub>
          <mo>·</mo>
          <mi>ϕ</mi>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mtext>(ii)</mtext>
          <mspace width="4.pt"/>
          <msub><mi>c</mi> <mn>1</mn> </msub>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>ℳ</mi>
          <mo>·</mo>
          <mi>ϕ</mi>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">or after substituting for <math alttext="c 1">
  <msub><mi>c</mi> <mn>1</mn> </msub>
</math></p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column Blank 2nd Column max Underscript phi Endscripts 3rd Column bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis script upper M dot phi right-parenthesis right-parenthesis 2nd Row 1st Column w 2nd Column equals 3rd Column script upper M 0 dot phi EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd/>
      <mtd>
        <munder><mo movablelimits="true" form="prefix">max</mo> <mi>ϕ</mi> </munder>
      </mtd>
      <mtd>
        <mrow>
          <msup><mi>𝐄</mi> <mi>P</mi> </msup>
          <mrow>
            <mo>(</mo>
            <mi>u</mi>
            <mrow>
              <mo>(</mo>
              <mi>ℳ</mi>
              <mo>·</mo>
              <mi>ϕ</mi>
              <mo>)</mo>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mi>w</mi>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <msub><mi>ℳ</mi> <mn>0</mn> </msub>
          <mo>·</mo>
          <mi>ϕ</mi>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">According to the Theorem of Lagrange, one can transform this problem into an <em class="calibre7">unconstrained optimization problem</em> of <a data-type="indexterm" data-primary="optimal portfolio choice" data-secondary="unconstrained optimization problem" id="idm44853698396808" class="calibre6"/><a data-type="indexterm" data-primary="unconstrained optimization problem" id="idm44853698395752" class="calibre6"/>the form</p>
<div data-type="equation" class="calibre42">
<math alttext="max Underscript b comma s comma lamda Endscripts f left-parenthesis b comma s comma lamda right-parenthesis equals bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis b dot upper B 1 plus s dot upper S 1 right-parenthesis right-parenthesis minus lamda dot left-parenthesis b dot upper B 0 plus s dot upper S 0 minus w right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><mi>b</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>λ</mi></mrow> </munder>
    <mi>f</mi>
    <mrow>
      <mo>(</mo>
      <mi>b</mi>
      <mo>,</mo>
      <mi>s</mi>
      <mo>,</mo>
      <mi>λ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mfenced separators="" open="(" close=")">
      <mi>u</mi>
      <mo>(</mo>
      <mi>b</mi>
      <mo>·</mo>
      <msub><mi>B</mi> <mn>1</mn> </msub>
      <mo>+</mo>
      <mi>s</mi>
      <mo>·</mo>
      <msub><mi>S</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mfenced>
    <mo>-</mo>
    <mi>λ</mi>
    <mo>·</mo>
    <mrow>
      <mo>(</mo>
      <mi>b</mi>
      <mo>·</mo>
      <msub><mi>B</mi> <mn>0</mn> </msub>
      <mo>+</mo>
      <mi>s</mi>
      <mo>·</mo>
      <msub><mi>S</mi> <mn>0</mn> </msub>
      <mo>-</mo>
      <mi>w</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">where the agent chooses <math alttext="b">
  <mi>b</mi>
</math> and <math alttext="s">
  <mi>s</mi>
</math> to maximize expected utility given the budget 
<span class="firstname">constraint</span>.</p>
<div data-type="caution" class="calibre28"><h1 class="calibre49">Expected Utility Theory</h1>
<p class="author1">Decades after<a data-type="indexterm" data-primary="EUT (expected utility theory)" id="idm44853698363032" class="calibre6"/> its formulation and introduction, expected utility theory (EUT) is still the dominant decision-making paradigm in finance. One of its major assumptions—that agents have full knowledge of possible future states and their probabilities—is hardly ever fulfilled in reality. However, EUT is, to many, intellectually appealing and leads to “nice” results that are often easy to understand and interpret. For more on the problems with this<a data-type="indexterm" data-primary="agents" data-secondary="expected utility" data-startref="agents-expected" id="idm44853698361640" class="calibre6"/><a data-type="indexterm" data-primary="uncertainty" data-secondary="expected utility" data-startref="uncertainty-expected" id="idm44853698360424" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-secondary="expected utility" data-startref="utility-expected" id="idm44853698359208" class="calibre6"/><a data-type="indexterm" data-primary="expected utility function" data-startref="expected-utility" id="idm44853698357992" class="calibre6"/> central paradigm in finance, see Hilpisch (2020, chapters 3 and 4).</p>
</div>








<section data-type="sect2" data-pdf-bookmark="Optimal Investment Portfolio" class="calibre4"><div class="preface" id="idm44853698356648">
<h2 class="calibre55">Optimal Investment Portfolio</h2>

<p class="author1">What<a data-type="indexterm" data-primary="agents" data-secondary="expected utility" data-tertiary="optimal investment portfolio" id="agents-expected-optimal" class="calibre6"/><a data-type="indexterm" data-primary="uncertainty" data-secondary="expected utility" data-tertiary="optimal investment portfolio" id="uncertainty-expected-optimal" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-secondary="expected utility" data-tertiary="optimal investment portfolio" id="utility-expected-optimal" class="calibre6"/><a data-type="indexterm" data-primary="expected utility function" data-secondary="optimal investment portfolio" id="expected-utility-optimal" class="calibre6"/><a data-type="indexterm" data-primary="optimal portfolio choice" data-secondary="expected utility and" id="optimal-expected" class="calibre6"/> does an optimal solution for the expected utility maximizing agent look like? In general terms, the answer can be given based on the first-order conditions that are necessary and sufficient here for an optimal solution:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row 1st Column StartFraction normal partial-differential f Over normal partial-differential b EndFraction 2nd Column equals 3rd Column 0 2nd Row 1st Column StartFraction normal partial-differential f Over normal partial-differential s EndFraction 2nd Column equals 3rd Column 0 3rd Row 1st Column StartFraction normal partial-differential f Over normal partial-differential lamda EndFraction 2nd Column equals 3rd Column 0 EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>b</mi></mrow></mfrac>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mn>0</mn>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>s</mi></mrow></mfrac>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mn>0</mn>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>λ</mi></mrow></mfrac>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mn>0</mn>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">or</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column StartFraction normal partial-differential f Over normal partial-differential b EndFraction 2nd Column equals 3rd Column p dot upper B 1 dot u prime left-parenthesis b dot upper B 1 plus s dot upper S 1 Superscript u Baseline right-parenthesis 2nd Row 1st Column Blank 2nd Column plus 3rd Column left-parenthesis 1 minus p right-parenthesis dot upper B 1 dot u prime left-parenthesis b dot upper B 1 plus s dot upper S 1 Superscript d Baseline right-parenthesis minus lamda dot upper B 0 equals 0 EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>b</mi></mrow></mfrac>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>p</mi>
          <mo>·</mo>
          <msub><mi>B</mi> <mn>1</mn> </msub>
          <mo>·</mo>
          <msup><mi>u</mi> <mo>'</mo> </msup>
          <mfenced separators="" open="(" close=")">
            <mi>b</mi>
            <mo>·</mo>
            <msub><mi>B</mi> <mn>1</mn> </msub>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
          </mfenced>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd/>
      <mtd>
        <mo>+</mo>
      </mtd>
      <mtd>
        <mrow>
          <mrow>
            <mo>(</mo>
            <mn>1</mn>
            <mo>-</mo>
            <mi>p</mi>
            <mo>)</mo>
          </mrow>
          <mo>·</mo>
          <msub><mi>B</mi> <mn>1</mn> </msub>
          <mo>·</mo>
          <msup><mi>u</mi> <mo>'</mo> </msup>
          <mfenced separators="" open="(" close=")">
            <mi>b</mi>
            <mo>·</mo>
            <msub><mi>B</mi> <mn>1</mn> </msub>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
          </mfenced>
          <mo>-</mo>
          <mi>λ</mi>
          <mo>·</mo>
          <msub><mi>B</mi> <mn>0</mn> </msub>
          <mo>=</mo>
          <mn>0</mn>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">and</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column StartFraction normal partial-differential f Over normal partial-differential s EndFraction 2nd Column equals 3rd Column p dot upper S 1 Superscript u Baseline dot u prime left-parenthesis b dot upper B 1 plus s dot upper S 1 Superscript u Baseline right-parenthesis 2nd Row 1st Column Blank 2nd Column plus 3rd Column left-parenthesis 1 minus p right-parenthesis dot upper S 1 Superscript d Baseline dot u prime left-parenthesis b dot upper B 1 plus s dot upper S 1 Superscript d Baseline right-parenthesis minus lamda dot upper S 0 equals 0 EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>s</mi></mrow></mfrac>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>p</mi>
          <mo>·</mo>
          <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
          <mo>·</mo>
          <msup><mi>u</mi> <mo>'</mo> </msup>
          <mfenced separators="" open="(" close=")">
            <mi>b</mi>
            <mo>·</mo>
            <msub><mi>B</mi> <mn>1</mn> </msub>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>u</mi> </msubsup>
          </mfenced>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd/>
      <mtd>
        <mo>+</mo>
      </mtd>
      <mtd>
        <mrow>
          <mrow>
            <mo>(</mo>
            <mn>1</mn>
            <mo>-</mo>
            <mi>p</mi>
            <mo>)</mo>
          </mrow>
          <mo>·</mo>
          <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
          <mo>·</mo>
          <msup><mi>u</mi> <mo>'</mo> </msup>
          <mfenced separators="" open="(" close=")">
            <mi>b</mi>
            <mo>·</mo>
            <msub><mi>B</mi> <mn>1</mn> </msub>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <msubsup><mi>S</mi> <mn>1</mn> <mi>d</mi> </msubsup>
          </mfenced>
          <mo>-</mo>
          <mi>λ</mi>
          <mo>·</mo>
          <msub><mi>S</mi> <mn>0</mn> </msub>
          <mo>=</mo>
          <mn>0</mn>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">with the usual notation <math alttext="u prime left-parenthesis x right-parenthesis identical-to StartFraction d u Over d x EndFraction">
  <mrow>
    <msup><mi>u</mi> <mo>'</mo> </msup>
    <mrow>
      <mo>(</mo>
      <mi>x</mi>
      <mo>)</mo>
    </mrow>
    <mo>≡</mo>
    <mfrac><mrow><mi>d</mi><mi>u</mi></mrow> <mrow><mi>d</mi><mi>x</mi></mrow></mfrac>
  </mrow>
</math> as well as</p>
<div data-type="equation" class="calibre42">
<math alttext="b dot upper B 0 plus s dot upper S 0 equals w" display="block">
  <mrow>
    <mi>b</mi>
    <mo>·</mo>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <mi>s</mi>
    <mo>·</mo>
    <msub><mi>S</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mi>w</mi>
  </mrow>
</math>
</div>

<p class="author1">Assume logarithmic utility and for the price processes of the two traded financial assets <math alttext="upper B equals left-parenthesis 10 comma 11 right-parenthesis">
  <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <mo>(</mo>
    <mn>10</mn>
    <mo>,</mo>
    <mn>11</mn>
    <mo>)</mo>
  </mrow>
</math> and <math alttext="upper S equals left-parenthesis 10 comma left-parenthesis 20 comma 5 right-parenthesis Superscript upper T Baseline right-parenthesis">
  <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <mn>10</mn>
      <mo>,</mo>
      <msup><mrow><mo>(</mo><mn>20</mn><mo>,</mo><mn>5</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
    </mfenced>
  </mrow>
</math>, respectively. With <math alttext="w equals 10">
  <mrow>
    <mi>w</mi>
    <mo>=</mo>
    <mn>10</mn>
  </mrow>
</math>, it holds <math alttext="b plus s equals 1">
  <mrow>
    <mi>b</mi>
    <mo>+</mo>
    <mi>s</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math> such that the portfolio positions represent percent values.</p>

<p class="author1">In Python, <a data-type="indexterm" data-primary="SciPy" data-secondary="minimize function" id="idm44853698221160" class="calibre6"/><a data-type="indexterm" data-primary="minimize function (SciPy)" id="idm44853698220152" class="calibre6"/>the <code class="calibre22">minimize</code> function from the <code class="calibre22">scipy.optimize</code> subpackage is also appropriate to solve the investment problem of the agent:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">31</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">11</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-1" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">20</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">5</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-2" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">B</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="n">S</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-3" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">34</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">B</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="n">S</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">T</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-4" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">p</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">0.5</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-5" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">36</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">P</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">p</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="o">-</code><code class="n">p</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-6" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">37</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">def</code><code class="calibre22"> </code><code class="nf">U</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">:</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">c1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-7" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">             </code><code class="kn">return</code><code class="calibre22"> </code><code class="o">-</code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">P</code><code class="p">,</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">log</code><code class="p">(</code><code class="n">c1</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-8" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">38</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="n">U</code><code class="p">(</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-9" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">38</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">2.3978952727983707</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="n">U</code><code class="p">(</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-10" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">2.3025850929940455</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">40</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="n">U</code><code class="p">(</code><code class="p">(</code><code class="mi">0.5</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.5</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-11" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">40</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">2.410140782802518</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">41</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">w</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">10</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">42</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">cons</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="p">{</code><code class="s">'</code><code class="s">type</code><code class="s">'</code><code class="p">:</code><code class="calibre22"> </code><code class="s">'</code><code class="s">eq</code><code class="s">'</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                  </code><code class="s">'</code><code class="s">fun</code><code class="s">'</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">lambda</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">w</code><code class="p">}</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-12" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">43</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">minimize</code><code class="p">(</code><code class="n">U</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">constraints</code><code class="o">=</code><code class="n">cons</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-13" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-9"><img src="Images/9.png" alt="9" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">44</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">44</code><code class="p">]</code><code class="p">:</code><code class="calibre22">      </code><code class="n">fun</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">2.4183062699261972</code><code class="calibre22">
</code><code class="calibre22">              </code><code class="n">jac</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mi">1.</code><code class="calibre22">     </code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">0.99999</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">          </code><code class="n">message</code><code class="p">:</code><code class="calibre22"> </code><code class="s">'</code><code class="s">Optimization terminated successfully</code><code class="s">'</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">nfev</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">15</code><code class="calibre22">
</code><code class="calibre22">              </code><code class="n">nit</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">5</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">njev</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">5</code><code class="calibre22">
</code><code class="calibre22">           </code><code class="n">status</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0</code><code class="calibre22">
</code><code class="calibre22">          </code><code class="n">success</code><code class="p">:</code><code class="calibre22"> </code><code class="nb">True</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="n">x</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0.69442</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.30558</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">45</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-14" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-10"><img src="Images/10.png" alt="10" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">45</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0.69442</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.30558</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">46</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">fun</code><code class="s">'</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-15" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-11"><img src="Images/11.png" alt="11" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">46</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">2.4183062699261972</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">47</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="n">U</code><code class="p">(</code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-16" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-11"><img src="Images/11.png" alt="11" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">47</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">2.4183062699261972</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">48</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO5-17" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO5-12"><img src="Images/12.png" alt="12" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">48</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">13.75022</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">9.16652</code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-1" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The bond price process and…</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-2" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">…the stock price process.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-3" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The price vector of the two traded financial assets.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-4" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-4"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The market payoff matrix of the two traded financial assets.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-5" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-5"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The physical probability measure for the economy.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-6" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-7"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The expected utility function with logarithmic utility.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-7" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-9"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Some example values for total portfolio weights of 1—diversification pays off.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-8" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-12"><img src="Images/8.png" alt="8" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The budget constraint based on the dot product of the price and portfolio 
<span class="firstname">vectors</span>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-9" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-13"><img src="Images/9.png" alt="9" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The expected utility maximization problem as a minimization.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-10" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-14"><img src="Images/10.png" alt="10" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The optimal allocation between the bond and the stock.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-11" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-15"><img src="Images/11.png" alt="11" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The optimal expected utility value.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO5-12" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO5-17"><img src="Images/12.png" alt="12" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The state-contingent payoff from the optimal<a data-type="indexterm" data-primary="agents" data-secondary="expected utility" data-tertiary="optimal investment portfolio" data-startref="agents-expected-optimal" id="idm44853697588520" class="calibre6"/><a data-type="indexterm" data-primary="uncertainty" data-secondary="expected utility" data-tertiary="optimal investment portfolio" data-startref="uncertainty-expected-optimal" id="idm44853697587032" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-secondary="expected utility" data-tertiary="optimal investment portfolio" data-startref="utility-expected-optimal" id="idm44853697585608" class="calibre6"/><a data-type="indexterm" data-primary="expected utility function" data-secondary="optimal investment portfolio" data-startref="expected-utility-optimal" id="idm44853697584184" class="calibre6"/><a data-type="indexterm" data-primary="optimal portfolio choice" data-secondary="expected utility and" data-startref="optimal-expected" id="idm44853697583064" class="calibre6"/> portfolio.</p></dd>
</dl>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Time-Additive Expected Utility" class="calibre4"><div class="preface" id="idm44853698356056">
<h2 class="calibre55">Time-Additive Expected Utility</h2>

<p class="author1">It is <a data-type="indexterm" data-primary="agents" data-secondary="expected utility" data-tertiary="time-additive" id="agents-expected-time-additive" class="calibre6"/><a data-type="indexterm" data-primary="uncertainty" data-secondary="expected utility" data-tertiary="time-additive" id="uncertainty-expected-time-additive" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-secondary="expected utility" data-tertiary="time-additive" id="utility-expected-time-additive" class="calibre6"/><a data-type="indexterm" data-primary="expected utility function" data-secondary="time-additive" id="expected-utility-time-additive" class="calibre6"/><a data-type="indexterm" data-primary="time-additive expected utility function" id="time-additive-expected" class="calibre6"/>possible to formulate the decision-making problem of the agent to include utility from money today as well:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper U colon upper R Subscript 0 Baseline times double-struck upper R Subscript 0 Baseline right-arrow double-struck upper R comma left-parenthesis c 0 comma c 1 right-parenthesis right-arrow from bar u left-parenthesis c 0 right-parenthesis plus kappa dot bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis c 1 right-parenthesis right-parenthesis" display="block">
  <mrow>
    <mi>U</mi>
    <mo>:</mo>
    <msub><mi>R</mi> <mrow><mo>≥</mo><mn>0</mn></mrow> </msub>
    <mo>×</mo>
    <msub><mi>ℝ</mi> <mrow><mo>≥</mo><mn>0</mn></mrow> </msub>
    <mo>→</mo>
    <mi>ℝ</mi>
    <mo>,</mo>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msub><mi>c</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>↦</mo>
    <mi>u</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mi>κ</mi>
    <mo>·</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>u</mi>
      <mrow>
        <mo>(</mo>
        <msub><mi>c</mi> <mn>1</mn> </msub>
        <mo>)</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>
<math mode="display">
  <mrow>
    <mi>U</mi>
    <mo>:</mo>
    <msub><mi>R</mi> <mrow><mn>≥0</mn></mrow> </msub>
    <mo>×</mo>
    <msub><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> </msub>
    <mo>→</mo>
    <mi>ℝ</mi>
    <mo>,</mo>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msub><mi>c</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>↦</mo>
    <mi>u</mi>
    <mrow>
      <mo>(</mo>
      <msub><mi>c</mi> <mn>0</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mi>κ</mi>
    <mo>·</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>u</mi>
      <mrow>
        <mo>(</mo>
        <msub><mi>c</mi> <mn>1</mn> </msub>
        <mo>)</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>

<p class="author1">With initial wealth <math alttext="w">
  <mi>w</mi>
</math>, the optimization problem in unconstrained form becomes:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column max Underscript c 0 comma b comma s comma lamda Endscripts f left-parenthesis c 0 comma b comma s comma lamda right-parenthesis 2nd Column equals 3rd Column u left-parenthesis c 0 right-parenthesis plus kappa dot bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis b dot upper B 1 plus s dot upper S 1 right-parenthesis right-parenthesis 2nd Row 1st Column Blank 2nd Column minus 3rd Column lamda dot left-parenthesis c 0 plus b dot upper B 0 plus s dot upper S 0 minus w right-parenthesis EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><msub><mi>c</mi> <mn>0</mn> </msub><mo>,</mo><mi>b</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>λ</mi></mrow> </munder>
          <mi>f</mi>
          <mrow>
            <mo>(</mo>
            <msub><mi>c</mi> <mn>0</mn> </msub>
            <mo>,</mo>
            <mi>b</mi>
            <mo>,</mo>
            <mi>s</mi>
            <mo>,</mo>
            <mi>λ</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>u</mi>
          <mrow>
            <mo>(</mo>
            <msub><mi>c</mi> <mn>0</mn> </msub>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <mi>κ</mi>
          <mo>·</mo>
          <msup><mi>𝐄</mi> <mi>P</mi> </msup>
          <mfenced separators="" open="(" close=")">
            <mi>u</mi>
            <mo>(</mo>
            <mi>b</mi>
            <mo>·</mo>
            <msub><mi>B</mi> <mn>1</mn> </msub>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <msub><mi>S</mi> <mn>1</mn> </msub>
            <mo>)</mo>
          </mfenced>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd/>
      <mtd>
        <mo>-</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>λ</mi>
          <mo>·</mo>
          <mo>(</mo>
          <msub><mi>c</mi> <mn>0</mn> </msub>
          <mo>+</mo>
          <mi>b</mi>
          <mo>·</mo>
          <msub><mi>B</mi> <mn>0</mn> </msub>
          <mo>+</mo>
          <mi>s</mi>
          <mo>·</mo>
          <msub><mi>S</mi> <mn>0</mn> </msub>
          <mo>-</mo>
          <mi>w</mi>
          <mo>)</mo>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">With the assumptions from before, the optimal solution is derived with Python according to the following code:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">49</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">B</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="n">S</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO6-1" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO6-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">50</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">kappa</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">10</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="mi">11</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO6-2" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO6-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">51</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">def</code><code class="calibre22"> </code><code class="nf">U</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code><code class="p">:</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">c0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO6-3" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO6-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">c1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">phi</code><code class="p">[</code><code class="mi">1</code><code class="p">:</code><code class="p">]</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO6-4" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO6-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">             </code><code class="kn">return</code><code class="calibre22"> </code><code class="o">-</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">log</code><code class="p">(</code><code class="n">c0</code><code class="p">)</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">kappa</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">P</code><code class="p">,</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">log</code><code class="p">(</code><code class="n">c1</code><code class="p">)</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO6-5" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO6-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">52</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">minimize</code><code class="p">(</code><code class="n">U</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">constraints</code><code class="o">=</code><code class="n">cons</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">53</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">53</code><code class="p">]</code><code class="p">:</code><code class="calibre22">      </code><code class="n">fun</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">3.1799295980286093</code><code class="calibre22">
</code><code class="calibre22">              </code><code class="n">jac</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="o">-</code><code class="mi">0.19088</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">1.90932</code><code class="p">,</code><code class="calibre22"> </code><code class="o">-</code><code class="mi">1.90974</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">          </code><code class="n">message</code><code class="p">:</code><code class="calibre22"> </code><code class="s">'</code><code class="s">Optimization terminated successfully</code><code class="s">'</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">nfev</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">32</code><code class="calibre22">
</code><code class="calibre22">              </code><code class="n">nit</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">8</code><code class="calibre22">
</code><code class="calibre22">             </code><code class="n">njev</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">8</code><code class="calibre22">
</code><code class="calibre22">           </code><code class="n">status</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0</code><code class="calibre22">
</code><code class="calibre22">          </code><code class="n">success</code><code class="p">:</code><code class="calibre22"> </code><code class="nb">True</code><code class="calibre22">
</code><code class="calibre22">                </code><code class="n">x</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">5.23899</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.33087</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.14523</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">54</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="o">-</code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">fun</code><code class="s">'</code><code class="p">]</code><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">54</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">3.1799295980286093</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">55</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO6-6" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO6-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">55</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">5.23898714830318</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">56</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="p">,</code><code class="calibre22"> </code><code class="n">opt</code><code class="p">[</code><code class="s">'</code><code class="s">x</code><code class="s">'</code><code class="p">]</code><code class="p">[</code><code class="mi">1</code><code class="p">:</code><code class="p">]</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO6-7" href="ch04_split_000.xhtml#callout_optimality_and_equilibrium_CO6-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">56</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">6.54422</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">4.36571</code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO6-1" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO6-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The price vector including the price of 1 for consumption today.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO6-2" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO6-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The time preference factor.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO6-3" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO6-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The expected utility function taking into account consumption today and the time preference.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO6-4" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO6-6"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This is what the agent consumes today from <math alttext="w">
  <mi>w</mi>
</math>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO6-5" href="ch04_split_000.xhtml#co_optimality_and_equilibrium_CO6-7"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This is the state-contingent payoff from the bond and the stock <a data-type="indexterm" data-primary="agents" data-secondary="expected utility" data-tertiary="time-additive" data-startref="agents-expected-time-additive" id="idm44853697198872" class="calibre6"/><a data-type="indexterm" data-primary="uncertainty" data-secondary="expected utility" data-tertiary="time-additive" data-startref="uncertainty-expected-time-additive" id="idm44853697197336" class="calibre6"/><a data-type="indexterm" data-primary="utility functions" data-secondary="expected utility" data-tertiary="time-additive" data-startref="utility-expected-time-additive" id="idm44853697195832" class="calibre6"/><a data-type="indexterm" data-primary="expected utility function" data-secondary="time-additive" data-startref="expected-utility-time-additive" id="idm44853697194328" class="calibre6"/><a data-type="indexterm" data-primary="time-additive expected utility function" data-startref="time-additive-expected" id="idm44853697193080" class="calibre6"/>position.</p></dd>
</dl>
</div></section>





</div></section>













</div></section></div>

<div id="sbo-rt-content" class="calibre1">
<section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 4. Optimality and Equilibrium" class="calibre4">
<div class="preface" id="optimality_equilibrium">
<section data-type="sect1" data-pdf-bookmark="Pricing in Complete Markets" class="calibre4"><div class="preface" id="idm44853697423496">
<h1 class="calibre17">Pricing in Complete Markets</h1>

<p class="author1">In this <a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="complete market equilibrium pricing" id="asset-financial-complete" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="complete market equilibrium pricing" id="financial-assets-complete" class="calibre6"/><a data-type="indexterm" data-primary="complete market model" data-secondary="equilibrium pricing" id="complete-market-equilibrium" class="calibre6"/><a data-type="indexterm" data-primary="market completeness" data-secondary="equilibrium pricing" id="market-complete-equilibrium" class="calibre6"/><a data-type="indexterm" data-primary="equilibrium pricing" data-secondary="in complete market model" data-secondary-sortas="complete market model" id="equilibrium-complete" class="calibre6"/><a data-type="indexterm" data-primary="agents" data-secondary="representative" data-tertiary="complete market equilibrium pricing" id="agent-representative-complete" class="calibre6"/><a data-type="indexterm" data-primary="representative agents" data-secondary="complete market equilibrium pricing" id="representative-agent-complete" class="calibre6"/>section, the analysis is changed to a pricing setting based on optimization principles. Assume that the two Arrow-Debreu securities <a data-type="indexterm" data-primary="Arrow-Debreu securities" id="idm44853697261080" class="calibre6"/>are traded in the economy with two future states and that the <em class="calibre7">net supply</em> for both is one. The two payoff vectors form a <em class="calibre7">standard basis</em> for <math alttext="double-struck upper R squared">
  <msup><mi>ℝ</mi> <mn>2</mn> </msup>
</math>, and the market payoff matrix is:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M equals Start 2 By 2 Matrix 1st Row 1st Column 1 2nd Column 0 2nd Row 1st Column 0 2nd Column 1 EndMatrix" display="block">
  <mrow>
    <mi>ℳ</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>1</mn>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mn>1</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">Assume now that there is a <em class="calibre7">representative agent</em> in the economy that is the only one trading the two securities. In an <em class="calibre7">equilibrium</em>, the representative agent needs to hold the net supply of both securities because there is nobody else. The mechanism that ensures equilibrium is the prices of the two securities today, that is, the price vector:</p>
<div data-type="equation" class="calibre42">
<math mode="display">
  <mrow>
    <msub><mi>ℳ</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <msup><mrow><mo>(</mo><msup><mi>γ</mi> <mi>u</mi> </msup><mo>,</mo><msup><mi>γ</mi> <mi>d</mi> </msup><mo>)</mo></mrow> <mi>T</mi> </msup>
    <mo>∈</mo>
    <msubsup><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> <mn>2</mn> </msubsup>
  </mrow>
</math>
</div>

<p class="author1">The idea of equilibrium pricing is that this price vector needs to be adjusted in a way that the representative agent holds the net supply of all available financial assets. This is because otherwise there would be no equilibrium.</p>

<p class="author1">With the investment portfolio <math alttext="phi equals left-parenthesis phi Superscript u Baseline comma phi Superscript d Baseline right-parenthesis Superscript upper T">
  <mrow>
    <mi>ϕ</mi>
    <mo>=</mo>
    <msup><mfenced separators="" open="(" close=")"><msup><mi>ϕ</mi> <mi>u</mi> </msup><mo>,</mo><msup><mi>ϕ</mi> <mi>d</mi> </msup></mfenced> <mi>T</mi> </msup>
  </mrow>
</math>, the problem of the expected utility maximizing, representative agent is</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row  max Underscript phi Endscripts bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis script upper M dot phi right-parenthesis right-parenthesis 2nd Row  s period t period script upper M 0 dot phi equals w EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <munder><mo movablelimits="true" form="prefix">max</mo> <mi>ϕ</mi> </munder>
          <msup><mi>𝐄</mi> <mi>P</mi> </msup>
          <mrow>
            <mo>(</mo>
            <mi>u</mi>
            <mrow>
              <mo>(</mo>
              <mi>ℳ</mi>
              <mo>·</mo>
              <mi>ϕ</mi>
              <mo>)</mo>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mtext>s.t.</mtext>
          <mspace width="4.pt"/>
          <msub><mi>ℳ</mi> <mn>0</mn> </msub>
          <mo>·</mo>
          <mi>ϕ</mi>
          <mo>=</mo>
          <mi>w</mi>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">or</p>
<div data-type="equation" class="calibre42">
<math alttext="max Underscript phi comma lamda Endscripts bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis script upper M dot phi right-parenthesis right-parenthesis minus lamda dot left-parenthesis script upper M 0 dot phi minus w right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><mi>ϕ</mi><mo>,</mo><mi>λ</mi></mrow> </munder>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>u</mi>
      <mrow>
        <mo>(</mo>
        <mi>ℳ</mi>
        <mo>·</mo>
        <mi>ϕ</mi>
        <mo>)</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>-</mo>
    <mi>λ</mi>
    <mo>·</mo>
    <mrow>
      <mo>(</mo>
      <msub><mi>ℳ</mi> <mn>0</mn> </msub>
      <mo>·</mo>
      <mi>ϕ</mi>
      <mo>-</mo>
      <mi>w</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">Due to the special market payoff matrix, this translates into</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row  max Underscript phi Superscript u Baseline comma phi Superscript d Baseline Endscripts p dot u left-parenthesis phi Superscript u Baseline right-parenthesis plus left-parenthesis 1 minus p right-parenthesis dot u left-parenthesis phi Superscript d Baseline right-parenthesis 2nd Row  s period t period gamma Superscript u Baseline dot phi Superscript u Baseline plus gamma Superscript d Baseline dot phi Superscript d Baseline equals w EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><msup><mi>ϕ</mi> <mi>u</mi> </msup><mo>,</mo><msup><mi>ϕ</mi> <mi>d</mi> </msup></mrow> </munder>
          <mi>p</mi>
          <mo>·</mo>
          <mi>u</mi>
          <mfenced separators="" open="(" close=")">
            <msup><mi>ϕ</mi> <mi>u</mi> </msup>
          </mfenced>
          <mo>+</mo>
          <mrow>
            <mo>(</mo>
            <mn>1</mn>
            <mo>-</mo>
            <mi>p</mi>
            <mo>)</mo>
          </mrow>
          <mo>·</mo>
          <mi>u</mi>
          <mfenced separators="" open="(" close=")">
            <msup><mi>ϕ</mi> <mi>d</mi> </msup>
          </mfenced>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mtext>s.t.</mtext>
          <mspace width="4.pt"/>
          <msup><mi>γ</mi> <mi>u</mi> </msup>
          <mo>·</mo>
          <msup><mi>ϕ</mi> <mi>u</mi> </msup>
          <mo>+</mo>
          <msup><mi>γ</mi> <mi>d</mi> </msup>
          <mo>·</mo>
          <msup><mi>ϕ</mi> <mi>d</mi> </msup>
          <mo>=</mo>
          <mi>w</mi>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">and</p>
<div data-type="equation" class="calibre42">
<math alttext="max Underscript phi Superscript u Baseline comma phi Superscript d Baseline comma lamda Endscripts f left-parenthesis phi Superscript u Baseline comma phi Superscript d Baseline comma lamda right-parenthesis equals p dot u left-parenthesis phi Superscript u Baseline right-parenthesis plus left-parenthesis 1 minus p right-parenthesis dot u left-parenthesis phi Superscript d Baseline right-parenthesis minus lamda dot left-parenthesis gamma Superscript u Baseline dot phi Superscript u Baseline plus gamma Superscript d Baseline dot phi Superscript d Baseline minus w right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><msup><mi>ϕ</mi> <mi>u</mi> </msup><mo>,</mo><msup><mi>ϕ</mi> <mi>d</mi> </msup><mo>,</mo><mi>λ</mi></mrow> </munder>
    <mi>f</mi>
    <mrow>
      <mo>(</mo>
      <msup><mi>ϕ</mi> <mi>u</mi> </msup>
      <mo>,</mo>
      <msup><mi>ϕ</mi> <mi>d</mi> </msup>
      <mo>,</mo>
      <mi>λ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mi>p</mi>
    <mo>·</mo>
    <mi>u</mi>
    <mfenced separators="" open="(" close=")">
      <msup><mi>ϕ</mi> <mi>u</mi> </msup>
    </mfenced>
    <mo>+</mo>
    <mrow>
      <mo>(</mo>
      <mn>1</mn>
      <mo>-</mo>
      <mi>p</mi>
      <mo>)</mo>
    </mrow>
    <mo>·</mo>
    <mi>u</mi>
    <mfenced separators="" open="(" close=")">
      <msup><mi>ϕ</mi> <mi>d</mi> </msup>
    </mfenced>
    <mo>-</mo>
    <mi>λ</mi>
    <mo>·</mo>
    <mfenced separators="" open="(" close=")">
      <msup><mi>γ</mi> <mi>u</mi> </msup>
      <mo>·</mo>
      <msup><mi>ϕ</mi> <mi>u</mi> </msup>
      <mo>+</mo>
      <msup><mi>γ</mi> <mi>d</mi> </msup>
      <mo>·</mo>
      <msup><mi>ϕ</mi> <mi>d</mi> </msup>
      <mo>-</mo>
      <mi>w</mi>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">The three first-order conditions for the unconstrained problem are:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row  StartFraction normal partial-differential f Over normal partial-differential phi Superscript u Baseline EndFraction equals p dot u prime left-parenthesis phi Superscript u Baseline right-parenthesis minus lamda dot gamma Superscript u Baseline equals 0 2nd Row  StartFraction normal partial-differential f Over normal partial-differential phi Superscript d Baseline EndFraction equals left-parenthesis 1 minus p right-parenthesis dot u prime left-parenthesis phi Superscript d Baseline right-parenthesis minus lamda dot gamma Superscript d Baseline equals 0 3rd Row  StartFraction normal partial-differential f Over normal partial-differential lamda EndFraction equals gamma Superscript u Baseline dot phi Superscript u Baseline plus gamma Superscript d Baseline dot phi Superscript d Baseline minus w equals 0 EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><msup><mi>ϕ</mi> <mi>u</mi> </msup></mrow></mfrac>
            <mo>=</mo>
            <mi>p</mi>
            <mo>·</mo>
            <msup><mi>u</mi> <mo>'</mo> </msup>
            <mrow>
              <mo>(</mo>
              <msup><mi>ϕ</mi> <mi>u</mi> </msup>
              <mo>)</mo>
            </mrow>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>·</mo>
            <msup><mi>γ</mi> <mi>u</mi> </msup>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><msup><mi>ϕ</mi> <mi>d</mi> </msup></mrow></mfrac>
            <mo>=</mo>
            <mrow>
              <mo>(</mo>
              <mn>1</mn>
              <mo>-</mo>
              <mi>p</mi>
              <mo>)</mo>
            </mrow>
            <mo>·</mo>
            <msup><mi>u</mi> <mo>'</mo> </msup>
            <mrow>
              <mo>(</mo>
              <msup><mi>ϕ</mi> <mi>d</mi> </msup>
              <mo>)</mo>
            </mrow>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>·</mo>
            <msup><mi>γ</mi> <mi>d</mi> </msup>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>λ</mi></mrow></mfrac>
            <mo>=</mo>
            <msup><mi>γ</mi> <mi>u</mi> </msup>
            <mo>·</mo>
            <msup><mi>ϕ</mi> <mi>u</mi> </msup>
            <mo>+</mo>
            <msup><mi>γ</mi> <mi>d</mi> </msup>
            <mo>·</mo>
            <msup><mi>ϕ</mi> <mi>d</mi> </msup>
            <mo>-</mo>
            <mi>w</mi>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">What consequences for the prices <math alttext="script upper M 0">
  <msub><mi>ℳ</mi> <mn>0</mn> </msub>
</math> follow from these optimality conditions? The first is with regard to <a data-type="indexterm" data-primary="relative price" id="idm44853697088152" class="calibre6"/><a data-type="indexterm" data-primary="Arrow-Debreu securities" id="idm44853697087448" class="calibre6"/>the <em class="calibre7">relative price</em> of the two Arrow-Debreu securities:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartFraction gamma Superscript u Baseline Over gamma Superscript d Baseline EndFraction equals StartFraction p dot u prime left-parenthesis phi Superscript u Baseline right-parenthesis Over left-parenthesis 1 minus p right-parenthesis dot u prime left-parenthesis phi Superscript d Baseline right-parenthesis EndFraction" display="block">
  <mrow>
    <mfrac><msup><mi>γ</mi> <mi>u</mi> </msup> <msup><mi>γ</mi> <mi>d</mi> </msup></mfrac>
    <mo>=</mo>
    <mfrac><mrow><mi>p</mi><mo>·</mo><msup><mi>u</mi> <mo>'</mo> </msup><mrow><mo>(</mo><msup><mi>ϕ</mi> <mi>u</mi> </msup><mo>)</mo></mrow></mrow> <mrow><mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>p</mi><mo>)</mo></mrow><mo>·</mo><msup><mi>u</mi> <mo>'</mo> </msup><mrow><mo>(</mo><msup><mi>ϕ</mi> <mi>d</mi> </msup><mo>)</mo></mrow></mrow></mfrac>
  </mrow>
</math>
</div>

<p class="author1">The relative price is fully determined by the probabilities for the two states to occur and the marginal utilities gained from consumption in the two states. Factoring in that <em class="calibre7">in equilibrium</em> <math alttext="phi Superscript u Baseline equals phi Superscript d Baseline equals 1">
  <mrow>
    <msup><mi>ϕ</mi> <mi>u</mi> </msup>
    <mo>=</mo>
    <msup><mi>ϕ</mi> <mi>d</mi> </msup>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math> must hold, the relative price is determined by the probability measure only:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartFraction gamma Superscript u Baseline Over gamma Superscript d Baseline EndFraction equals StartFraction p Over left-parenthesis 1 minus p right-parenthesis EndFraction" display="block">
  <mrow>
    <mfrac><msup><mi>γ</mi> <mi>u</mi> </msup> <msup><mi>γ</mi> <mi>d</mi> </msup></mfrac>
    <mo>=</mo>
    <mfrac><mi>p</mi> <mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi>p</mi><mo>)</mo></mrow></mfrac>
  </mrow>
</math>
</div>

<p class="author1">With this additional condition, one also obtains:</p>
<div data-type="equation" class="calibre42">
<math alttext="gamma Superscript u Baseline plus gamma Superscript d Baseline equals w" display="block">
  <mrow>
    <msup><mi>γ</mi> <mi>u</mi> </msup>
    <mo>+</mo>
    <msup><mi>γ</mi> <mi>d</mi> </msup>
    <mo>=</mo>
    <mi>w</mi>
  </mrow>
</math>
</div>

<p class="author1">While the relative price is determined by the probability measure in this case, the<a data-type="indexterm" data-primary="absolute price" id="idm44853697051736" class="calibre6"/> absolute prices are determined by the initial wealth available. This is intuitively appealing in that the prices should be higher the more initial wealth there is, given that the net supply for two securities is fixed.</p>

<p class="author1">Normalizing initial wealth to <math alttext="w equals 1">
  <mrow>
    <mi>w</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>, for instance, fixes the prices via</p>
<div data-type="equation" class="calibre42">
<math alttext="gamma Superscript u Baseline equals 1 minus gamma Superscript d" display="block">
  <mrow>
    <msup><mi>γ</mi> <mi>u</mi> </msup>
    <mo>=</mo>
    <mn>1</mn>
    <mo>-</mo>
    <msup><mi>γ</mi> <mi>d</mi> </msup>
  </mrow>
</math>
</div>

<p class="author1">to finally arrive at the equilibrium prices of</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row  gamma Superscript u Baseline equals p 2nd Row  gamma Superscript d Baseline equals 1 minus p EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <msup><mi>γ</mi> <mi>u</mi> </msup>
            <mo>=</mo>
            <mi>p</mi>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <msup><mi>γ</mi> <mi>d</mi> </msup>
            <mo>=</mo>
            <mn>1</mn>
            <mo>-</mo>
            <mi>p</mi>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">or the equilibrium price vector <math alttext="script upper M 0 Superscript asterisk Baseline equals left-parenthesis p comma 1 minus p right-parenthesis Superscript upper T">
  <mrow>
    <msubsup><mi>ℳ</mi> <mn>0</mn> <mo>*</mo> </msubsup>
    <mo>=</mo>
    <msup><mrow><mo>(</mo><mi>p</mi><mo>,</mo><mn>1</mn><mo>-</mo><mi>p</mi><mo>)</mo></mrow> <mi>T</mi> </msup>
  </mrow>
</math>.</p>








<section data-type="sect2" data-pdf-bookmark="Arbitrage Pricing" class="calibre4"><div class="preface" id="idm44853697022248">
<h2 class="calibre55">Arbitrage Pricing</h2>

<p class="author1">What <a data-type="indexterm" data-primary="arbitrage pricing" data-secondary="equilibrium pricing and" id="idm44853696806344" class="calibre6"/>about arbitrage prices of contingent claims given the equilibrium price vector <math alttext="script upper M 0 Superscript asterisk">
  <msubsup><mi>ℳ</mi> <mn>0</mn> <mo>*</mo> </msubsup>
</math>? In complete markets, in which every contingent claim is attainable, the price of any such attainable contingent claim
<math><mrow><msub><mi>C</mi> <mn>1</mn> </msub><mo>∈</mo><mi>𝔸</mi><mo>=</mo><msubsup><mi>ℝ</mi> <mrow><mn>≥0</mn></mrow> <mn>2</mn> </msubsup></mrow></math>
is then given by:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper C 0 equals script upper M 0 Superscript asterisk Baseline dot upper C 1 equals gamma Superscript u Baseline dot upper C 1 Superscript u Baseline plus gamma Superscript d Baseline dot upper C 1 Superscript d" display="block">
  <mrow>
    <msub><mi>C</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <msubsup><mi>ℳ</mi> <mn>0</mn> <mo>*</mo> </msubsup>
    <mo>·</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <msup><mi>γ</mi> <mi>u</mi> </msup>
    <mo>·</mo>
    <msubsup><mi>C</mi> <mn>1</mn> <mi>u</mi> </msubsup>
    <mo>+</mo>
    <msup><mi>γ</mi> <mi>d</mi> </msup>
    <mo>·</mo>
    <msubsup><mi>C</mi> <mn>1</mn> <mi>d</mi> </msubsup>
  </mrow>
</math>
</div>

<p class="author1">This is because the replication portfolio is simply the state-contingent payoff itself <math alttext="phi equals upper C 1">
  <mrow>
    <mi>ϕ</mi>
    <mo>=</mo>
    <msub><mi>C</mi> <mn>1</mn> </msub>
  </mrow>
</math> in the special case of two Arrow-Debreu securities. The prices of Arrow-Debreu securities are therefore also called <em class="calibre7">state prices</em> because <a data-type="indexterm" data-primary="state prices" id="idm44853696779736" class="calibre6"/>they represent the price for one unit of currency (consumption) in a certain state.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Martingale Pricing" class="calibre4"><div class="preface" id="idm44853696778616">
<h2 class="calibre55">Martingale Pricing</h2>

<p class="author1">How does<a data-type="indexterm" data-primary="martingale measures" data-secondary="in equilibrium pricing" data-secondary-sortas="equilibrium pricing" id="martingale-equilibrium" class="calibre6"/> the unique martingale measure look for the current economy? The condition for the martingale measure <math alttext="upper Q">
  <mi>Q</mi>
</math> is that it makes all discounted price processes of traded financial assets a martingale. In matrix form, the conditions are:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M 0 Superscript asterisk Baseline equals StartFraction 1 Over 1 plus i EndFraction dot bold upper E Superscript upper Q Baseline left-parenthesis script upper M right-parenthesis" display="block">
  <mrow>
    <msubsup><mi>ℳ</mi> <mn>0</mn> <mo>*</mo> </msubsup>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mrow><mn>1</mn><mo>+</mo><mi>i</mi></mrow></mfrac>
    <mo>·</mo>
    <msup><mi>𝐄</mi> <mi>Q</mi> </msup>
    <mrow>
      <mo>(</mo>
      <mi>ℳ</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>

<p class="author1">More explicitly, one gets:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row 1st Column p dot left-parenthesis 1 plus i right-parenthesis 2nd Column equals 3rd Column q 2nd Row 1st Column left-parenthesis 1 minus p right-parenthesis dot left-parenthesis 1 plus i right-parenthesis 2nd Column equals 3rd Column 1 minus q EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mi>p</mi>
            <mo>·</mo>
            <mo>(</mo>
            <mn>1</mn>
            <mo>+</mo>
            <mi>i</mi>
            <mo>)</mo>
          </mrow>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mi>q</mi>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mo>(</mo>
            <mn>1</mn>
            <mo>-</mo>
            <mi>p</mi>
            <mo>)</mo>
            <mo>·</mo>
            <mo>(</mo>
            <mn>1</mn>
            <mo>+</mo>
            <mi>i</mi>
            <mo>)</mo>
          </mrow>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <mi>q</mi>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">From these, <math alttext="i equals 0">
  <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math> follows and also <math alttext="q equals p">
  <mrow>
    <mi>q</mi>
    <mo>=</mo>
    <mi>p</mi>
  </mrow>
</math>. The physical probability measure makes all probabilities already a martingale. The other way around, the prices for the two Arrow-Debreu securities are set in equilibrium in a way such that the discounted price processes are martingales.</p>

<p class="author1">Every attainable contingent claim <math alttext="upper C 1 element-of double-struck upper A">
  <mrow>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>∈</mo>
    <mi>𝔸</mi>
  </mrow>
</math> can be priced by simply taking the expectation under the physical probability measure in this special kind of representative agent economy. Formally, this translates into:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper C 0 equals bold upper E Superscript upper P Baseline left-parenthesis upper C 1 right-parenthesis" display="block">
  <mrow>
    <msub><mi>C</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mrow>
      <mo>(</mo>
      <msub><mi>C</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</div>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Risk-Less Interest Rate" class="calibre4"><div class="preface" id="idm44853697191736">
<h1 class="calibre17">Risk-Less Interest Rate</h1>

<p class="author1">Why is <a data-type="indexterm" data-primary="arbitrage pricing" data-secondary="risk-less interest rates" id="idm44853696724504" class="calibre6"/><a data-type="indexterm" data-primary="equilibrium pricing" data-secondary="risk-less interest rates" id="idm44853696723528" class="calibre6"/><a data-type="indexterm" data-primary="risk-less interest rates" id="idm44853696722568" class="calibre6"/><a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="risk-less interest rates" id="idm44853696721880" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="risk-less interest rates" id="idm44853696720648" class="calibre6"/>the equilibrium risk-less interest rate zero? The answer is quite simple: because there is no risk-less financial asset traded that fixes another interest rate. Consider a <em class="calibre7">risk-less financial asset</em> paying 1 in every state <math alttext="upper B 1 equals left-parenthesis 1 comma 1 right-parenthesis Superscript upper T">
  <mrow>
    <msub><mi>B</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <msup><mrow><mo>(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
  </mrow>
</math>. The <em class="calibre7">arbitrage price</em> for this financial asset is</p>
<div data-type="equation" class="calibre42">
<math alttext="upper B 0 equals script upper M 0 Superscript asterisk Baseline dot upper B 1 equals p plus left-parenthesis 1 minus p right-parenthesis equals 1" display="block">
  <mrow>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <msubsup><mi>ℳ</mi> <mn>0</mn> <mo>*</mo> </msubsup>
    <mo>·</mo>
    <msub><mi>B</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mi>p</mi>
    <mo>+</mo>
    <mrow>
      <mo>(</mo>
      <mn>1</mn>
      <mo>-</mo>
      <mi>p</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>
</div>

<p class="author1">implying a risk-less interest rate of <math alttext="i equals 0">
  <mrow>
    <mi>i</mi>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math>. Any other price <math alttext="0 less-than upper B 0 less-than 1">
  <mrow>
    <mn>0</mn>
    <mo>&lt;</mo>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>&lt;</mo>
    <mn>1</mn>
  </mrow>
</math>, implying a positive risk-less interest rate, would also imply arbitrage opportunities.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="A Numerical Example (I)" class="calibre4"><div class="preface" id="idm44853696693240">
<h1 class="calibre17">A Numerical Example (I)</h1>

<p class="author1">The equilibrium pricing analysis so far rests on a number of simplifying assumptions allowing for elegant solutions and simple relations. Consider now a case with the somehow more realistic numerical assumptions as used multiple times before.</p>

<p class="author1">Specifically, assume expected utility maximization based on logarithmic utility for the representative agent. Assume further price processes for the risk-less bond of</p>
<div data-type="equation" class="calibre42">
<math alttext="upper B equals left-parenthesis upper B 0 comma left-parenthesis 11 comma 11 right-parenthesis Superscript upper T Baseline right-parenthesis" display="block">
  <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>B</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msup><mrow><mo>(</mo><mn>11</mn><mo>,</mo><mn>11</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">and for the risky stock of</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S equals left-parenthesis upper S 0 comma left-parenthesis 20 comma 5 right-parenthesis Superscript upper T Baseline right-parenthesis" display="block">
  <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>S</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msup><mrow><mo>(</mo><mn>20</mn><mo>,</mo><mn>5</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">The market payoff matrix accordingly is:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M equals Start 2 By 2 Matrix 1st Row 1st Column 11 2nd Column 20 2nd Row 1st Column 11 2nd Column 5 EndMatrix" display="block">
  <mrow>
    <mi>ℳ</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>20</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>5</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">The physical probability measure is given by <math alttext="upper P equals left-parenthesis p comma left-parenthesis 1 minus p right-parenthesis right-parenthesis Superscript upper T">
  <mrow>
    <mi>P</mi>
    <mo>=</mo>
    <msup><mfenced separators="" open="(" close=")"><mi>p</mi><mo>,</mo><mo>(</mo><mn>1</mn><mo>-</mo><mi>p</mi><mo>)</mo></mfenced> <mi>T</mi> </msup>
  </mrow>
</math> with <math alttext="p equals one-third">
  <mrow>
    <mi>p</mi>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>3</mn></mfrac>
  </mrow>
</math>. The net supply of the risk-less bond is <math alttext="b equals 1">
  <mrow>
    <mi>b</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>, and it is <math alttext="s equals 1">
  <mrow>
    <mi>s</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math> for the risky stock. The initial wealth the agent has available shall be <math alttext="w equals 15">
  <mrow>
    <mi>w</mi>
    <mo>=</mo>
    <mn>15</mn>
  </mrow>
</math>.</p>

<p class="author1">The problem of the representative agent is</p>
<div data-type="equation" class="calibre42">
<math alttext="max Underscript phi comma lamda Endscripts f left-parenthesis phi comma lamda right-parenthesis equals bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis script upper M dot phi right-parenthesis right-parenthesis minus lamda dot left-parenthesis script upper M 0 dot phi minus w right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><mi>ϕ</mi><mo>,</mo><mi>λ</mi></mrow> </munder>
    <mi>f</mi>
    <mrow>
      <mo>(</mo>
      <mi>ϕ</mi>
      <mo>,</mo>
      <mi>λ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mfenced separators="" open="(" close=")">
      <mi>u</mi>
      <mo>(</mo>
      <mi>ℳ</mi>
      <mo>·</mo>
      <mi>ϕ</mi>
      <mo>)</mo>
    </mfenced>
    <mo>-</mo>
    <mi>λ</mi>
    <mo>·</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>ℳ</mi> <mn>0</mn> </msub>
      <mo>·</mo>
      <mi>ϕ</mi>
      <mo>-</mo>
      <mi>w</mi>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">or</p>
<div data-type="equation" class="calibre42">
<math alttext="max Underscript b comma s comma lamda Endscripts f left-parenthesis b comma s comma lamda right-parenthesis equals bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis b dot upper B 1 plus s dot upper S 1 right-parenthesis right-parenthesis minus lamda dot left-parenthesis b dot upper B 0 plus s dot upper S 0 minus w right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><mi>b</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>λ</mi></mrow> </munder>
    <mi>f</mi>
    <mrow>
      <mo>(</mo>
      <mi>b</mi>
      <mo>,</mo>
      <mi>s</mi>
      <mo>,</mo>
      <mi>λ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mfenced separators="" open="(" close=")">
      <mi>u</mi>
      <mo>(</mo>
      <mi>b</mi>
      <mo>·</mo>
      <msub><mi>B</mi> <mn>1</mn> </msub>
      <mo>+</mo>
      <mi>s</mi>
      <mo>·</mo>
      <msub><mi>S</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mfenced>
    <mo>-</mo>
    <mi>λ</mi>
    <mo>·</mo>
    <mfenced separators="" open="(" close=")">
      <mi>b</mi>
      <mo>·</mo>
      <msub><mi>B</mi> <mn>0</mn> </msub>
      <mo>+</mo>
      <mi>s</mi>
      <mo>·</mo>
      <msub><mi>S</mi> <mn>0</mn> </msub>
      <mo>-</mo>
      <mi>w</mi>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">The three first-order conditions are:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row  StartFraction normal partial-differential f Over normal partial-differential b EndFraction equals bold upper E Superscript upper P Baseline left-parenthesis upper B 1 dot u prime left-parenthesis b dot upper B 1 plus s dot upper S 1 right-parenthesis right-parenthesis minus lamda dot upper B 0 equals 0 2nd Row  StartFraction normal partial-differential f Over normal partial-differential s EndFraction equals bold upper E Superscript upper P Baseline left-parenthesis upper S 1 dot u prime left-parenthesis b dot upper B 1 plus s dot upper S 1 right-parenthesis right-parenthesis minus lamda dot upper S 0 equals 0 3rd Row  StartFraction normal partial-differential f Over normal partial-differential lamda EndFraction equals b dot upper B 0 plus s dot upper S 0 minus w equals 0 EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>b</mi></mrow></mfrac>
            <mo>=</mo>
            <msup><mi>𝐄</mi> <mi>P</mi> </msup>
            <mfenced separators="" open="(" close=")">
              <msub><mi>B</mi> <mn>1</mn> </msub>
              <mo>·</mo>
              <msup><mi>u</mi> <mo>'</mo> </msup>
              <mrow>
                <mo>(</mo>
                <mi>b</mi>
                <mo>·</mo>
                <msub><mi>B</mi> <mn>1</mn> </msub>
                <mo>+</mo>
                <mi>s</mi>
                <mo>·</mo>
                <msub><mi>S</mi> <mn>1</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mfenced>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>·</mo>
            <msub><mi>B</mi> <mn>0</mn> </msub>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>s</mi></mrow></mfrac>
            <mo>=</mo>
            <msup><mi>𝐄</mi> <mi>P</mi> </msup>
            <mfenced separators="" open="(" close=")">
              <msub><mi>S</mi> <mn>1</mn> </msub>
              <mo>·</mo>
              <msup><mi>u</mi> <mo>'</mo> </msup>
              <mrow>
                <mo>(</mo>
                <mi>b</mi>
                <mo>·</mo>
                <msub><mi>B</mi> <mn>1</mn> </msub>
                <mo>+</mo>
                <mi>s</mi>
                <mo>·</mo>
                <msub><mi>S</mi> <mn>1</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mfenced>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>·</mo>
            <msub><mi>S</mi> <mn>0</mn> </msub>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>λ</mi></mrow></mfrac>
            <mo>=</mo>
            <mi>b</mi>
            <mo>·</mo>
            <msub><mi>B</mi> <mn>0</mn> </msub>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <msub><mi>S</mi> <mn>0</mn> </msub>
            <mo>-</mo>
            <mi>w</mi>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">The <em class="calibre7">relative price</em> for<a data-type="indexterm" data-primary="relative price" id="idm44853696544712" class="calibre6"/> the two financial assets according to the optimality conditions—and taking into account the net supply of one for both financial assets as well as the logarithmic utility—is:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column StartFraction upper S 0 Over upper B 0 EndFraction 2nd Column equals 3rd Column StartFraction bold upper E Superscript upper P Baseline left-parenthesis upper S 1 dot u prime left-parenthesis b dot upper B 1 plus s dot upper S 1 right-parenthesis right-parenthesis Over bold upper E Superscript upper P Baseline left-parenthesis upper B 1 dot u prime left-parenthesis b dot upper B 1 plus s dot upper S 1 right-parenthesis right-parenthesis EndFraction 2nd Row 1st Column Blank 2nd Column equals 3rd Column StartStartFraction bold upper E Superscript upper P Baseline left-parenthesis StartFraction upper S 1 Over upper B 1 plus upper S 1 EndFraction right-parenthesis OverOver bold upper E Superscript upper P Baseline left-parenthesis StartFraction upper B 1 Over upper B 1 plus upper S 1 EndFraction right-parenthesis EndEndFraction identical-to zeta EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mfrac><msub><mi>S</mi> <mn>0</mn> </msub> <msub><mi>B</mi> <mn>0</mn> </msub></mfrac>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mfrac><mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mfenced separators="" open="(" close=")"><msub><mi>S</mi> <mn>1</mn> </msub><mo>·</mo><msup><mi>u</mi> <mo>'</mo> </msup><mrow><mo>(</mo><mi>b</mi><mo>·</mo><msub><mi>B</mi> <mn>1</mn> </msub><mo>+</mo><mi>s</mi><mo>·</mo><msub><mi>S</mi> <mn>1</mn> </msub><mo>)</mo></mrow></mfenced></mrow> <mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mfenced separators="" open="(" close=")"><msub><mi>B</mi> <mn>1</mn> </msub><mo>·</mo><msup><mi>u</mi> <mo>'</mo> </msup><mrow><mo>(</mo><mi>b</mi><mo>·</mo><msub><mi>B</mi> <mn>1</mn> </msub><mo>+</mo><mi>s</mi><mo>·</mo><msub><mi>S</mi> <mn>1</mn> </msub><mo>)</mo></mrow></mfenced></mrow></mfrac>
      </mtd>
    </mtr>
    <mtr>
      <mtd/>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mfrac><mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mfenced separators="" open="(" close=")"><mfrac><msub><mi>S</mi> <mn>1</mn> </msub> <mrow><msub><mi>B</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>S</mi> <mn>1</mn> </msub></mrow></mfrac></mfenced></mrow> <mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mfenced separators="" open="(" close=")"><mfrac><msub><mi>B</mi> <mn>1</mn> </msub> <mrow><msub><mi>B</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>S</mi> <mn>1</mn> </msub></mrow></mfrac></mfenced></mrow></mfrac>
          <mo>≡</mo>
          <mi>ζ</mi>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">Adding the budget constraint to the mix fixes not only the <em class="calibre7">relative price</em> <math alttext="zeta">
  <mi>ζ</mi>
</math> but also the <a data-type="indexterm" data-primary="absolute price" id="idm44853696500472" class="calibre6"/>absolute price levels:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper B 0 plus zeta dot upper B 0 equals w left right double arrow upper B 0 equals StartFraction w Over 1 plus zeta EndFraction" display="block">
  <mrow>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <mi>ζ</mi>
    <mo>·</mo>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mi>w</mi>
    <mo>⇔</mo>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mfrac><mi>w</mi> <mrow><mn>1</mn><mo>+</mo><mi>ζ</mi></mrow></mfrac>
  </mrow>
</math>
</div>

<p class="author1">In Python, these considerations translate into simple vectorized operations using <code class="calibre22">NumPy</code>:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">57</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">p</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="mi">3</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-1" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">58</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">P</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">p</code><code class="p">,</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="o">-</code><code class="n">p</code><code class="p">)</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-2" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">59</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">11</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">60</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">20</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">5</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">61</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">zeta</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">S1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">S1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">S1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-3" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">62</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">zeta</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-4" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">62</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.7342657342657343</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">63</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">w</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">15</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-5" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">64</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">w</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">zeta</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-6" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">65</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-7" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">65</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">8.649193548387098</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">66</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">zeta</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-8" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">67</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-9" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">67</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">6.350806451612904</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">68</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-10" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">68</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">15.000000000000002</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">69</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">i</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">B1</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-11" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">70</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">i</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-12" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">70</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.2717948717948717</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">71</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">mu</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">S1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-13" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">72</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">mu</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO7-14" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO7-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">72</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.5746031746031743</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO7-1" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO7-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The probability measure.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO7-2" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO7-3"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The price ratio <code class="calibre22">zeta</code> given optimality conditions.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO7-3" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO7-5"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The initial wealth.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO7-4" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO7-6"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equilibrium price level of the risk-less bond given the price ratio <code class="calibre22">zeta</code> and initial wealth <code class="calibre22">w</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO7-5" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO7-8"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The resulting equilibrium price level of the risky stock.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO7-6" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO7-10"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The budget constraint is binding.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO7-7" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO7-11"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equilibrium interest rate given the price level for the risk-less bond.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO7-8" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO7-13"><img src="Images/8.png" alt="8" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equilibrium expected rate of return of the risky stock.</p></dd>
</dl>

<p class="author1">Equilibrium pricing does not lead in this case to the discounted price processes being martingales under the physical probability measure. The <em class="calibre7">martingale measure</em> is<a data-type="indexterm" data-primary="martingale measures" data-secondary="in equilibrium pricing" data-secondary-sortas="equilibrium pricing" id="idm44853696082712" class="calibre6"/><a data-type="indexterm" data-primary="SymPy" data-secondary="martingale measures" id="idm44853696081432" class="calibre6"/> easily derived, however. The analysis uses the <a href="http://sympy.org" class="calibre6"><code class="calibre22">SymPy</code></a> package for symbolic computations with Python:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">73</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="kn">import</code><code class="calibre22"> </code><code class="nn">sympy</code><code class="calibre22"> </code><code class="kn">as</code><code class="calibre22"> </code><code class="nn">sy</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO8-1" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO8-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">74</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">q</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">sy</code><code class="o">.</code><code class="n">Symbol</code><code class="p">(</code><code class="s">'</code><code class="s">q</code><code class="s">'</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO8-2" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO8-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">75</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">eq</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="n">q</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="mi">20</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">q</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="mi">5</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">i</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO8-3" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO8-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">76</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">eq</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO8-4" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO8-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">76</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">11.7943548387097</code><code class="o">*</code><code class="n">q</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">2.41935483870968</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">77</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">q</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">sy</code><code class="o">.</code><code class="n">solve</code><code class="p">(</code><code class="n">eq</code><code class="p">)</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO8-5" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO8-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">78</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">q</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO8-6" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO8-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">78</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.205128205128205</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">79</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">Q</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">q</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">q</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO8-7" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO8-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">80</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">B1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">Q</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">i</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO8-8" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO8-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">80</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">8.64919354838710</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">81</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">S1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">Q</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">i</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO8-9" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO8-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">81</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">6.35080645161290</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO8-1" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO8-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Imports the symbolic computation package <code class="calibre22">SymPy</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO8-2" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO8-2"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Defining the symbol <code class="calibre22">q</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO8-3" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO8-3"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Formulating the equation for <code class="calibre22">q</code> given the martingale condition.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO8-4" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO8-4"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equation simplified.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO8-5" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO8-5"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This solves the equation numerically.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO8-6" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO8-6"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The resulting martingale measure.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO8-7" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO8-8"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Both discounted price processes are martingales<a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="complete market equilibrium pricing" data-startref="asset-financial-complete" id="idm44853695755288" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="complete market equilibrium pricing" data-startref="financial-assets-complete" id="idm44853695753832" class="calibre6"/><a data-type="indexterm" data-primary="complete market model" data-secondary="equilibrium pricing" data-startref="complete-market-equilibrium" id="idm44853695752680" class="calibre6"/><a data-type="indexterm" data-primary="market completeness" data-secondary="equilibrium pricing" data-startref="market-complete-equilibrium" id="idm44853695751496" class="calibre6"/><a data-type="indexterm" data-primary="equilibrium pricing" data-secondary="in complete market model" data-secondary-sortas="complete market model" data-startref="equilibrium-complete" id="idm44853695750312" class="calibre6"/><a data-type="indexterm" data-primary="agents" data-secondary="representative" data-tertiary="complete market equilibrium pricing" data-startref="agent-representative-complete" id="idm44853695748856" class="calibre6"/><a data-type="indexterm" data-primary="representative agents" data-secondary="complete market equilibrium pricing" data-startref="representative-agent-complete" id="idm44853695747432" class="calibre6"/> under <code class="calibre22">Q</code>.</p></dd>
</dl>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Pricing in Incomplete Markets" class="calibre4"><div class="preface" id="idm44853695820664">
<h1 class="calibre17">Pricing in Incomplete Markets</h1>

<p class="author1">How <a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="incomplete market equilibrium pricing" id="asset-financial-incomplete" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="incomplete market equilibrium pricing" id="financial-assets-incomplete" class="calibre6"/><a data-type="indexterm" data-primary="incomplete market model" data-secondary="equilibrium pricing" id="incomplete-market-equilibrium" class="calibre6"/><a data-type="indexterm" data-primary="market incompleteness" data-secondary="equilibrium pricing" id="market-incomplete-equilibrium" class="calibre6"/><a data-type="indexterm" data-primary="equilibrium pricing" data-secondary="in incomplete market model" data-secondary-sortas="incomplete market model" id="equilibrium-incomplete" class="calibre6"/><a data-type="indexterm" data-primary="agents" data-secondary="representative" data-tertiary="incomplete market equilibrium pricing" id="agent-representative-incomplete" class="calibre6"/><a data-type="indexterm" data-primary="representative agents" data-secondary="incomplete market equilibrium pricing" id="representative-agent-incomplete" class="calibre6"/>does representative agent pricing work in <em class="calibre7">incomplete markets</em>? The answer fortunately is: exactly the same way as in complete markets.</p>

<p class="author1">Assume the two date, three-state economy in which a <em class="calibre7">risk-less bond</em> with price process</p>
<div data-type="equation" class="calibre42">
<math alttext="upper B equals left-parenthesis upper B 0 comma left-parenthesis 11 comma 11 comma 11 right-parenthesis Superscript upper T Baseline right-parenthesis" display="block">
  <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>B</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msup><mrow><mo>(</mo><mn>11</mn><mo>,</mo><mn>11</mn><mo>,</mo><mn>11</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">and a <em class="calibre7">risky stock</em> with price process</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S equals left-parenthesis upper S 0 comma left-parenthesis 20 comma 10 comma 5 right-parenthesis Superscript upper T Baseline right-parenthesis" display="block">
  <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>S</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msup><mrow><mo>(</mo><mn>20</mn><mo>,</mo><mn>10</mn><mo>,</mo><mn>5</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">are traded. The physical probability measure is <math alttext="upper P equals left-parenthesis p comma p comma p right-parenthesis Superscript upper T">
  <mrow>
    <mi>P</mi>
    <mo>=</mo>
    <msup><mrow><mo>(</mo><mi>p</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>p</mi><mo>)</mo></mrow> <mi>T</mi> </msup>
  </mrow>
</math>, with <math alttext="p equals one-third">
  <mrow>
    <mi>p</mi>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>3</mn></mfrac>
  </mrow>
</math>. Everything else shall be as in the previous section.</p>

<p class="author1">Formally, the optimization problem of the representative agent does not change:</p>
<div data-type="equation" class="calibre42">
<math alttext="max Underscript b comma s comma lamda Endscripts f left-parenthesis b comma s comma lamda right-parenthesis equals bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis b dot upper B 1 plus s dot upper S 1 right-parenthesis right-parenthesis minus lamda dot left-parenthesis b dot upper B 0 plus s dot upper S 0 minus w right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><mi>b</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>λ</mi></mrow> </munder>
    <mi>f</mi>
    <mrow>
      <mo>(</mo>
      <mi>b</mi>
      <mo>,</mo>
      <mi>s</mi>
      <mo>,</mo>
      <mi>λ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mfenced separators="" open="(" close=")">
      <mi>u</mi>
      <mo>(</mo>
      <mi>b</mi>
      <mo>·</mo>
      <msub><mi>B</mi> <mn>1</mn> </msub>
      <mo>+</mo>
      <mi>s</mi>
      <mo>·</mo>
      <msub><mi>S</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mfenced>
    <mo>-</mo>
    <mi>λ</mi>
    <mo>·</mo>
    <mfenced separators="" open="(" close=")">
      <mi>b</mi>
      <mo>·</mo>
      <msub><mi>B</mi> <mn>0</mn> </msub>
      <mo>+</mo>
      <mi>s</mi>
      <mo>·</mo>
      <msub><mi>S</mi> <mn>0</mn> </msub>
      <mo>-</mo>
      <mi>w</mi>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">Nor does the formula for the relative price change:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column StartFraction upper S 0 Over upper B 0 EndFraction 2nd Column equals 3rd Column StartStartFraction bold upper E Superscript upper P Baseline left-parenthesis StartFraction upper S 1 Over upper B 1 plus upper S 1 EndFraction right-parenthesis OverOver bold upper E Superscript upper P Baseline left-parenthesis StartFraction upper B 1 Over upper B 1 plus upper S 1 EndFraction right-parenthesis EndEndFraction identical-to zeta EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mfrac><msub><mi>S</mi> <mn>0</mn> </msub> <msub><mi>B</mi> <mn>0</mn> </msub></mfrac>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <mfrac><mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mfenced separators="" open="(" close=")"><mfrac><msub><mi>S</mi> <mn>1</mn> </msub> <mrow><msub><mi>B</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>S</mi> <mn>1</mn> </msub></mrow></mfrac></mfenced></mrow> <mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mfenced separators="" open="(" close=")"><mfrac><msub><mi>B</mi> <mn>1</mn> </msub> <mrow><msub><mi>B</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>S</mi> <mn>1</mn> </msub></mrow></mfrac></mfenced></mrow></mfrac>
          <mo>≡</mo>
          <mi>ζ</mi>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">In Python, only the future price vectors of the financial assets and the vector representing the probability measure need to be adjusted:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">82</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">p</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="mi">3</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-1" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">83</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">P</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">p</code><code class="p">,</code><code class="calibre22"> </code><code class="n">p</code><code class="p">,</code><code class="calibre22"> </code><code class="n">p</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-2" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">84</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">11</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">85</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">20</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">5</code><code class="p">)</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">86</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">zeta</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">S1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">S1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">S1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-3" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">87</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">zeta</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-4" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">87</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.9155274934101636</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">88</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">w</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">15</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-5" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">89</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">w</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">zeta</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-6" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">90</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-7" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">90</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">7.8307411674347165</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">91</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">zeta</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-8" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">92</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-9" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">92</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">7.169258832565284</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">93</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-10" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">93</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">15.0</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">94</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">i</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">B1</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-11" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">95</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">i</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-12" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">95</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.40472016183411985</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">96</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">mu</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">S1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-13" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">97</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">mu</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO9-14" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO9-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">97</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.6273183796451287</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO9-1" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO9-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The probability measure.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO9-2" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO9-3"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The relative price <code class="calibre22">zeta</code> given optimality conditions.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO9-3" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO9-5"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The initial wealth.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO9-4" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO9-6"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equilibrium price level of the risk-less bond given the price ratio <code class="calibre22">zeta</code> and initial wealth <code class="calibre22">w</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO9-5" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO9-8"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The resulting equilibrium price level of the risky stock.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO9-6" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO9-10"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The budget constraint is binding.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO9-7" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO9-11"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equilibrium interest rate given the price level for the risk-less bond.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO9-8" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO9-13"><img src="Images/8.png" alt="8" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equilibrium expected rate of return of the risky stock.</p></dd>
</dl>
<div data-type="note" epub:type="note" class="calibre26"><h1 class="calibre33">Representative Agent Pricing</h1>
<p class="author1">The pricing of securities based on the optimization calculus of a representative agent is one approach that applies to both complete and incomplete markets. Instead of adjusting markets—for example, via market completion based on additional securities—additional assumptions are made with regard to the representative agent. For example, the initial wealth of the agent is required to arrive at specific, absolute prices for the securities instead of only relative prices.</p>
</div>








<section data-type="sect2" data-pdf-bookmark="Martingale Measures" class="calibre4"><div class="preface" id="idm44853695235432">
<h2 class="calibre55">Martingale Measures</h2>

<p class="author1">Although <a data-type="indexterm" data-primary="martingale measures" data-secondary="in equilibrium pricing" data-secondary-sortas="equilibrium pricing" id="idm44853695234040" class="calibre6"/>representative agent pricing works in incomplete markets the same way as in complete ones, it unfortunately does not directly solve the problem of pricing contingent claims that are not attainable. There are still infinitely many martingale measures that are consistent with the market.</p>

<p class="author1">The Python code that follows shows that there are infinitely many martingale measures that are consistent with the equilibrium price processes as derived in the previous section:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">98</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">qu</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">sy</code><code class="o">.</code><code class="n">Symbol</code><code class="p">(</code><code class="s">'</code><code class="s">qu</code><code class="s">'</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO10-1" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO10-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">         </code><code class="n">qm</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">sy</code><code class="o">.</code><code class="n">Symbol</code><code class="p">(</code><code class="s">'</code><code class="s">qm</code><code class="s">'</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO10-2" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO10-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">99</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">eq</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="n">qu</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="mi">20</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">qm</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="mi">10</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">qu</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">qm</code><code class="p">)</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="mi">5</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">i</code><code class="p">)</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO10-3" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO10-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">100</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">eq</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO10-4" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO10-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">100</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">3.55942780337942</code><code class="o">*</code><code class="n">qm</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="mi">10.6782834101383</code><code class="o">*</code><code class="n">qu</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">3.60983102918587</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">101</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">Q</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">sy</code><code class="o">.</code><code class="n">solve</code><code class="p">(</code><code class="n">eq</code><code class="p">,</code><code class="calibre22"> </code><code class="nb">set</code><code class="o">=</code><code class="nb">True</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO10-5" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO10-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">102</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">Q</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO10-6" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO10-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">102</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="p">(</code><code class="p">[</code><code class="n">qm</code><code class="p">]</code><code class="p">,</code><code class="calibre22"> </code><code class="p">{</code><code class="p">(</code><code class="mi">1.01416048550236</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">3.00000000000001</code><code class="o">*</code><code class="n">qu</code><code class="p">,</code><code class="p">)</code><code class="p">}</code><code class="p">)</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO10-1" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO10-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Defining the symbols <code class="calibre22">qu</code> and <code class="calibre22">qm</code>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO10-2" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO10-3"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">Formulating the equation for <code class="calibre22">qu</code> and <code class="calibre22">qm</code> given the martingale condition.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO10-3" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO10-4"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equation simplified.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO10-4" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO10-5"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This solves the equation numerically, providing a set of solutions as the result; this does not take into account the conditions <math alttext="0 less-than-or-equal-to q Superscript u Baseline comma q Superscript d Baseline less-than-or-equal-to 1">
  <mrow>
    <mn>0</mn>
    <mo>≤</mo>
    <msup><mi>q</mi> <mi>u</mi> </msup>
    <mo>,</mo>
    <msup><mi>q</mi> <mi>d</mi> </msup>
    <mo>≤</mo>
    <mn>1</mn>
  </mrow>
</math>.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO10-5" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO10-6"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The relationship between <code class="calibre22">qu</code> and <code class="calibre22">qm</code> as the solution—indicating infinitely many solutions.</p></dd>
</dl>
<div data-type="caution" class="calibre28"><h1 class="calibre49">Martingale Measure in Incomplete Markets</h1>
<p class="author1">Martingale pricing <a data-type="indexterm" data-primary="martingale measures" data-secondary="in incomplete market model" data-secondary-sortas="incomplete market model" id="idm44853694985272" class="calibre6"/>is a convenient and elegant approach in complete markets to value contingent claims. In incomplete markets, there are in general <em class="calibre7">infinitely many</em> martingale measures that are consistent with the market. In practice, one often solves this issue by relying on publicly observed market prices for liquidly trading contingent claims, such as plain vanilla European put or call options. These prices are used to calibrate model parameters or the martingale measure directly to be consistent with the market. For more background information and details about model calibration, see Hilpisch (2015).</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Equilibrium Pricing" class="calibre4"><div class="preface" id="idm44853694982648">
<h2 class="calibre55">Equilibrium Pricing</h2>

<p class="author1">What<a data-type="indexterm" data-primary="contingent claims" data-secondary="equilibrium pricing and" id="contingent-equilibrium" class="calibre6"/><a data-type="indexterm" data-primary="attainable contingent claims" id="idm44853694979544" class="calibre6"/> about pricing contingent claims? If they are <em class="calibre7">attainable</em> through replication portfolios composed of traded financial assets, their price can be fixed by the <em class="calibre7">usual arbitrage argument</em>. What if a contingent claim is <em class="calibre7">not attainable</em>? In the simple incomplete market setting currently under investigation, this can only mean that the payoff vector is linearly independent of the two future price vectors of the traded financial assets. This in turn implies that the introduction of a contingent claim with such a payoff vector is <em class="calibre7">market completing</em>—because three linearly independent vectors form in any case a basis of <math alttext="double-struck upper R cubed">
  <msup><mi>ℝ</mi> <mn>3</mn> </msup>
</math>.</p>

<p class="author1">Consider the market payoff matrix from the first two Arrow-Debreu securities, each available at a net supply of one:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M equals Start 3 By 2 Matrix 1st Row 1st Column 1 2nd Column 0 2nd Row 1st Column 0 2nd Column 1 3rd Row 1st Column 0 2nd Column 0 EndMatrix" display="block">
  <mrow>
    <mi>ℳ</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>1</mn>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mn>1</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">This market is obviously incomplete because the two securities do not span <math alttext="double-struck upper R cubed">
  <msup><mi>ℝ</mi> <mn>3</mn> </msup>
</math>. Introducing a contingent claim with net supply of one that pays one unit of currency in the <math alttext="d">
  <mi>d</mi>
</math> state—that is, a contingent claim that pays exactly what the third Arrow-Debreu security would pay—completes the market as seen by the resulting payoff matrix:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M equals Start 3 By 3 Matrix 1st Row 1st Column 1 2nd Column 0 3rd Column 0 2nd Row 1st Column 0 2nd Column 1 3rd Column 0 3rd Row 1st Column 0 2nd Column 0 3rd Column 1 EndMatrix" display="block">
  <mrow>
    <mi>ℳ</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>1</mn>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mn>1</mn>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <mn>1</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">The three payoff vectors now form a standard basis of the <math alttext="double-struck upper R cubed">
  <msup><mi>ℝ</mi> <mn>3</mn> </msup>
</math>.</p>

<p class="author1">Formally, the optimization problem of the representative agent is the same as before:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row  max Underscript phi Endscripts bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis script upper M dot phi right-parenthesis right-parenthesis 2nd Row  s period t period script upper M 0 dot phi equals w EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <munder><mo movablelimits="true" form="prefix">max</mo> <mi>ϕ</mi> </munder>
          <msup><mi>𝐄</mi> <mi>P</mi> </msup>
          <mrow>
            <mo>(</mo>
            <mi>u</mi>
            <mrow>
              <mo>(</mo>
              <mi>ℳ</mi>
              <mo>·</mo>
              <mi>ϕ</mi>
              <mo>)</mo>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mtext>s.t.</mtext>
          <mspace width="4.pt"/>
          <msub><mi>ℳ</mi> <mn>0</mn> </msub>
          <mo>·</mo>
          <mi>ϕ</mi>
          <mo>=</mo>
          <mi>w</mi>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">Here, <math alttext="script upper M 0 equals left-parenthesis gamma Superscript u Baseline comma gamma Superscript m Baseline comma gamma Superscript d Baseline right-parenthesis Superscript upper T">
  <mrow>
    <msub><mi>ℳ</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <msup><mfenced separators="" open="(" close=")"><msup><mi>γ</mi> <mi>u</mi> </msup><mo>,</mo><msup><mi>γ</mi> <mi>m</mi> </msup><mo>,</mo><msup><mi>γ</mi> <mi>d</mi> </msup></mfenced> <mi>T</mi> </msup>
  </mrow>
</math> as the state price vector and <math alttext="phi equals left-parenthesis 1 comma 1 comma 1 right-parenthesis Superscript upper T">
  <mrow>
    <mi>ϕ</mi>
    <mo>=</mo>
    <msup><mrow><mo>(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
  </mrow>
</math> as the market portfolio.</p>

<p class="author1">In explicit form, the unconstrained optimization problem according to the Theorem of Lagrange is:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout 1st Row 1st Column max Underscript phi Superscript u Baseline comma phi Superscript m Baseline comma phi Superscript d Baseline comma lamda Endscripts f left-parenthesis phi Superscript u Baseline comma phi Superscript m Baseline comma phi Superscript d Baseline comma lamda right-parenthesis 2nd Column equals 3rd Column p Superscript u Baseline dot u left-parenthesis phi Superscript u Baseline right-parenthesis plus p Superscript m Baseline dot u left-parenthesis phi Superscript m Baseline right-parenthesis plus p Superscript d Baseline dot u left-parenthesis phi Superscript d Baseline right-parenthesis 2nd Row 1st Column Blank 2nd Column minus 3rd Column lamda dot left-parenthesis gamma Superscript u Baseline dot phi Superscript u Baseline plus gamma Superscript m Baseline dot phi Superscript m Baseline plus gamma Superscript d Baseline dot phi Superscript d Baseline minus w right-parenthesis EndLayout" display="block">
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><msup><mi>ϕ</mi> <mi>u</mi> </msup><mo>,</mo><msup><mi>ϕ</mi> <mi>m</mi> </msup><mo>,</mo><msup><mi>ϕ</mi> <mi>d</mi> </msup><mo>,</mo><mi>λ</mi></mrow> </munder>
          <mi>f</mi>
          <mrow>
            <mo>(</mo>
            <msup><mi>ϕ</mi> <mi>u</mi> </msup>
            <mo>,</mo>
            <msup><mi>ϕ</mi> <mi>m</mi> </msup>
            <mo>,</mo>
            <msup><mi>ϕ</mi> <mi>d</mi> </msup>
            <mo>,</mo>
            <mi>λ</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd>
        <mrow>
          <msup><mi>p</mi> <mi>u</mi> </msup>
          <mo>·</mo>
          <mi>u</mi>
          <mfenced separators="" open="(" close=")">
            <msup><mi>ϕ</mi> <mi>u</mi> </msup>
          </mfenced>
          <mo>+</mo>
          <msup><mi>p</mi> <mi>m</mi> </msup>
          <mo>·</mo>
          <mi>u</mi>
          <mfenced separators="" open="(" close=")">
            <msup><mi>ϕ</mi> <mi>m</mi> </msup>
          </mfenced>
          <mo>+</mo>
          <msup><mi>p</mi> <mi>d</mi> </msup>
          <mo>·</mo>
          <mi>u</mi>
          <mfenced separators="" open="(" close=")">
            <msup><mi>ϕ</mi> <mi>d</mi> </msup>
          </mfenced>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd/>
      <mtd>
        <mo>-</mo>
      </mtd>
      <mtd>
        <mrow>
          <mi>λ</mi>
          <mo>·</mo>
          <mfenced separators="" open="(" close=")">
            <msup><mi>γ</mi> <mi>u</mi> </msup>
            <mo>·</mo>
            <msup><mi>ϕ</mi> <mi>u</mi> </msup>
            <mo>+</mo>
            <msup><mi>γ</mi> <mi>m</mi> </msup>
            <mo>·</mo>
            <msup><mi>ϕ</mi> <mi>m</mi> </msup>
            <mo>+</mo>
            <msup><mi>γ</mi> <mi>d</mi> </msup>
            <mo>·</mo>
            <msup><mi>ϕ</mi> <mi>d</mi> </msup>
            <mo>-</mo>
            <mi>w</mi>
          </mfenced>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p class="author1">The four first-order conditions for the unconstrained problem are:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row  StartFraction normal partial-differential f Over normal partial-differential phi Superscript u Baseline EndFraction equals p Superscript u Baseline dot u prime left-parenthesis phi Superscript u Baseline right-parenthesis minus lamda dot gamma Superscript u Baseline equals 0 2nd Row  StartFraction normal partial-differential f Over normal partial-differential phi Superscript m Baseline EndFraction equals p Superscript m Baseline dot u prime left-parenthesis phi Superscript m Baseline right-parenthesis minus lamda dot gamma Superscript m Baseline equals 0 3rd Row  StartFraction normal partial-differential f Over normal partial-differential phi Superscript d Baseline EndFraction equals p Superscript d Baseline dot u prime left-parenthesis phi Superscript d Baseline right-parenthesis minus lamda dot gamma Superscript d Baseline equals 0 4th Row  StartFraction normal partial-differential f Over normal partial-differential lamda EndFraction equals gamma Superscript u Baseline dot phi Superscript u Baseline plus gamma Superscript m Baseline dot phi Superscript m Baseline plus gamma Superscript d Baseline dot phi Superscript d Baseline minus w equals 0 EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><msup><mi>ϕ</mi> <mi>u</mi> </msup></mrow></mfrac>
            <mo>=</mo>
            <msup><mi>p</mi> <mi>u</mi> </msup>
            <mo>·</mo>
            <msup><mi>u</mi> <mo>'</mo> </msup>
            <mrow>
              <mo>(</mo>
              <msup><mi>ϕ</mi> <mi>u</mi> </msup>
              <mo>)</mo>
            </mrow>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>·</mo>
            <msup><mi>γ</mi> <mi>u</mi> </msup>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><msup><mi>ϕ</mi> <mi>m</mi> </msup></mrow></mfrac>
            <mo>=</mo>
            <msup><mi>p</mi> <mi>m</mi> </msup>
            <mo>·</mo>
            <msup><mi>u</mi> <mo>'</mo> </msup>
            <mrow>
              <mo>(</mo>
              <msup><mi>ϕ</mi> <mi>m</mi> </msup>
              <mo>)</mo>
            </mrow>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>·</mo>
            <msup><mi>γ</mi> <mi>m</mi> </msup>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><msup><mi>ϕ</mi> <mi>d</mi> </msup></mrow></mfrac>
            <mo>=</mo>
            <msup><mi>p</mi> <mi>d</mi> </msup>
            <mo>·</mo>
            <msup><mi>u</mi> <mo>'</mo> </msup>
            <mrow>
              <mo>(</mo>
              <msup><mi>ϕ</mi> <mi>d</mi> </msup>
              <mo>)</mo>
            </mrow>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>·</mo>
            <msup><mi>γ</mi> <mi>d</mi> </msup>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>λ</mi></mrow></mfrac>
            <mo>=</mo>
            <msup><mi>γ</mi> <mi>u</mi> </msup>
            <mo>·</mo>
            <msup><mi>ϕ</mi> <mi>u</mi> </msup>
            <mo>+</mo>
            <msup><mi>γ</mi> <mi>m</mi> </msup>
            <mo>·</mo>
            <msup><mi>ϕ</mi> <mi>m</mi> </msup>
            <mo>+</mo>
            <msup><mi>γ</mi> <mi>d</mi> </msup>
            <mo>·</mo>
            <msup><mi>ϕ</mi> <mi>d</mi> </msup>
            <mo>-</mo>
            <mi>w</mi>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">For the relative prices, one gets:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row  StartFraction gamma Superscript u Baseline Over gamma Superscript m Baseline EndFraction equals StartFraction p Superscript u Baseline dot u prime left-parenthesis phi Superscript u Baseline right-parenthesis Over p Superscript m Baseline dot u prime left-parenthesis phi Superscript m Baseline right-parenthesis EndFraction 2nd Row  StartFraction gamma Superscript u Baseline Over gamma Superscript d Baseline EndFraction equals StartFraction p Superscript u Baseline dot u prime left-parenthesis phi Superscript u Baseline right-parenthesis Over p Superscript d Baseline dot u prime left-parenthesis phi Superscript d Baseline right-parenthesis EndFraction EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><msup><mi>γ</mi> <mi>u</mi> </msup> <msup><mi>γ</mi> <mi>m</mi> </msup></mfrac>
            <mo>=</mo>
            <mfrac><mrow><msup><mi>p</mi> <mi>u</mi> </msup><mo>·</mo><msup><mi>u</mi> <mo>'</mo> </msup><mrow><mo>(</mo><msup><mi>ϕ</mi> <mi>u</mi> </msup><mo>)</mo></mrow></mrow> <mrow><msup><mi>p</mi> <mi>m</mi> </msup><mo>·</mo><msup><mi>u</mi> <mo>'</mo> </msup><mrow><mo>(</mo><msup><mi>ϕ</mi> <mi>m</mi> </msup><mo>)</mo></mrow></mrow></mfrac>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><msup><mi>γ</mi> <mi>u</mi> </msup> <msup><mi>γ</mi> <mi>d</mi> </msup></mfrac>
            <mo>=</mo>
            <mfrac><mrow><msup><mi>p</mi> <mi>u</mi> </msup><mo>·</mo><msup><mi>u</mi> <mo>'</mo> </msup><mrow><mo>(</mo><msup><mi>ϕ</mi> <mi>u</mi> </msup><mo>)</mo></mrow></mrow> <mrow><msup><mi>p</mi> <mi>d</mi> </msup><mo>·</mo><msup><mi>u</mi> <mo>'</mo> </msup><mrow><mo>(</mo><msup><mi>ϕ</mi> <mi>d</mi> </msup><mo>)</mo></mrow></mrow></mfrac>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">Through these, the third relative price is fixed as well. With logarithmic utility and an initial wealth fixed at <math alttext="w equals 1">
  <mrow>
    <mi>w</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>, one finally arrives in this special case at:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row  gamma Superscript u Baseline equals p Superscript u Baseline 2nd Row  gamma Superscript m Baseline equals p Superscript m Baseline 3rd Row  gamma Superscript d Baseline equals p Superscript d EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <msup><mi>γ</mi> <mi>u</mi> </msup>
            <mo>=</mo>
            <msup><mi>p</mi> <mi>u</mi> </msup>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <msup><mi>γ</mi> <mi>m</mi> </msup>
            <mo>=</mo>
            <msup><mi>p</mi> <mi>m</mi> </msup>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <msup><mi>γ</mi> <mi>d</mi> </msup>
            <mo>=</mo>
            <msup><mi>p</mi> <mi>d</mi> </msup>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">The equilibrium price vector is <math alttext="script upper M 0 Superscript asterisk Baseline equals left-parenthesis p Superscript u Baseline comma p Superscript m Baseline comma p Superscript d Baseline right-parenthesis Superscript upper T">
  <mrow>
    <msubsup><mi>ℳ</mi> <mn>0</mn> <mo>*</mo> </msubsup>
    <mo>=</mo>
    <msup><mrow><mo>(</mo><msup><mi>p</mi> <mi>u</mi> </msup><mo>,</mo><msup><mi>p</mi> <mi>m</mi> </msup><mo>,</mo><msup><mi>p</mi> <mi>d</mi> </msup><mo>)</mo></mrow> <mi>T</mi> </msup>
  </mrow>
</math>, which equals the vector representing the probability measure. This in turn implies that all discounted price processes are martingales under the physical probability measure.</p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="A Numerical Example (II)" class="calibre4"><div class="preface" id="idm44853694981976">
<h1 class="calibre17">A Numerical Example (II)</h1>

<p class="author1">Getting back to the numerical example from before: assume expected utility maximization based on <em class="calibre7">logarithmic utility</em> for the representative agent. Assume further price processes for the <em class="calibre7">risk-less bond</em> of</p>
<div data-type="equation" class="calibre42">
<math alttext="upper B equals left-parenthesis upper B 0 comma left-parenthesis 11 comma 11 comma 11 right-parenthesis Superscript upper T Baseline right-parenthesis" display="block">
  <mrow>
    <mi>B</mi>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>B</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msup><mrow><mo>(</mo><mn>11</mn><mo>,</mo><mn>11</mn><mo>,</mo><mn>11</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">and for the <em class="calibre7">risky stock</em> of</p>
<div data-type="equation" class="calibre42">
<math alttext="upper S equals left-parenthesis upper S 0 comma left-parenthesis 20 comma 10 comma 5 right-parenthesis Superscript upper T Baseline right-parenthesis" display="block">
  <mrow>
    <mi>S</mi>
    <mo>=</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>S</mi> <mn>0</mn> </msub>
      <mo>,</mo>
      <msup><mrow><mo>(</mo><mn>20</mn><mo>,</mo><mn>10</mn><mo>,</mo><mn>5</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">The market payoff matrix is:</p>
<div data-type="equation" class="calibre42">
<math alttext="script upper M equals Start 3 By 2 Matrix 1st Row 1st Column 11 2nd Column 20 2nd Row 1st Column 11 2nd Column 10 3rd Row 1st Column 11 2nd Column 5 EndMatrix" display="block">
  <mrow>
    <mi>ℳ</mi>
    <mo>=</mo>
    <mfenced open="(" close=")">
      <mtable>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>20</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>10</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>11</mn>
          </mtd>
          <mtd>
            <mn>5</mn>
          </mtd>
        </mtr>
      </mtable>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">The physical probability measure is given by <math alttext="upper P equals left-parenthesis p comma p comma p right-parenthesis Superscript upper T">
  <mrow>
    <mi>P</mi>
    <mo>=</mo>
    <msup><mfenced separators="" open="(" close=")"><mi>p</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>p</mi></mfenced> <mi>T</mi> </msup>
  </mrow>
</math>, with <math alttext="p equals one-third">
  <mrow>
    <mi>p</mi>
    <mo>=</mo>
    <mfrac><mn>1</mn> <mn>3</mn></mfrac>
  </mrow>
</math>. The net supply of the risk-less bond is <math alttext="b equals 1">
  <mrow>
    <mi>b</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>, and it is <math alttext="s equals 1">
  <mrow>
    <mi>s</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math> for the risky stock. The initial wealth the agent has available shall be <math alttext="w equals 15">
  <mrow>
    <mi>w</mi>
    <mo>=</mo>
    <mn>15</mn>
  </mrow>
</math>.</p>

<p class="author1">A contingent claim is introduced with payoff <math alttext="upper C 1 equals left-parenthesis 5 comma 0 comma 0 right-parenthesis Superscript upper T">
  <mrow>
    <msub><mi>C</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <msup><mrow><mo>(</mo><mn>5</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>)</mo></mrow> <mi>T</mi> </msup>
  </mrow>
</math> and a net supply of <math alttext="c equals 1">
  <mrow>
    <mi>c</mi>
    <mo>=</mo>
    <mn>1</mn>
  </mrow>
</math>.</p>

<p class="author1">Consequently, the problem of the representative agent is:</p>
<div data-type="equation" class="calibre42">
<math alttext="max Underscript phi comma lamda Endscripts f left-parenthesis phi comma lamda right-parenthesis equals bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis script upper M dot phi right-parenthesis right-parenthesis minus lamda dot left-parenthesis script upper M 0 dot phi minus w right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><mi>ϕ</mi><mo>,</mo><mi>λ</mi></mrow> </munder>
    <mi>f</mi>
    <mrow>
      <mo>(</mo>
      <mi>ϕ</mi>
      <mo>,</mo>
      <mi>λ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mfenced separators="" open="(" close=")">
      <mi>u</mi>
      <mo>(</mo>
      <mi>ℳ</mi>
      <mo>·</mo>
      <mi>ϕ</mi>
      <mo>)</mo>
    </mfenced>
    <mo>-</mo>
    <mi>λ</mi>
    <mo>·</mo>
    <mfenced separators="" open="(" close=")">
      <msub><mi>ℳ</mi> <mn>0</mn> </msub>
      <mo>·</mo>
      <mi>ϕ</mi>
      <mo>-</mo>
      <mi>w</mi>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">or</p>
<div data-type="equation" class="calibre42">
<math alttext="max Underscript b comma s comma c comma lamda Endscripts f left-parenthesis b comma s comma lamda right-parenthesis equals bold upper E Superscript upper P Baseline left-parenthesis u left-parenthesis b dot upper B 1 plus s dot upper S 1 plus c dot upper C 1 right-parenthesis right-parenthesis minus lamda dot left-parenthesis b dot upper B 0 plus s dot upper S 0 plus c dot upper C 0 minus w right-parenthesis" display="block">
  <mrow>
    <munder><mo movablelimits="true" form="prefix">max</mo> <mrow><mi>b</mi><mo>,</mo><mi>s</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>λ</mi></mrow> </munder>
    <mi>f</mi>
    <mrow>
      <mo>(</mo>
      <mi>b</mi>
      <mo>,</mo>
      <mi>s</mi>
      <mo>,</mo>
      <mi>λ</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup><mi>𝐄</mi> <mi>P</mi> </msup>
    <mfenced separators="" open="(" close=")">
      <mi>u</mi>
      <mo>(</mo>
      <mi>b</mi>
      <mo>·</mo>
      <msub><mi>B</mi> <mn>1</mn> </msub>
      <mo>+</mo>
      <mi>s</mi>
      <mo>·</mo>
      <msub><mi>S</mi> <mn>1</mn> </msub>
      <mo>+</mo>
      <mi>c</mi>
      <mo>·</mo>
      <msub><mi>C</mi> <mn>1</mn> </msub>
      <mo>)</mo>
    </mfenced>
    <mo>-</mo>
    <mi>λ</mi>
    <mo>·</mo>
    <mfenced separators="" open="(" close=")">
      <mi>b</mi>
      <mo>·</mo>
      <msub><mi>B</mi> <mn>0</mn> </msub>
      <mo>+</mo>
      <mi>s</mi>
      <mo>·</mo>
      <msub><mi>S</mi> <mn>0</mn> </msub>
      <mo>+</mo>
      <mi>c</mi>
      <mo>·</mo>
      <msub><mi>C</mi> <mn>0</mn> </msub>
      <mo>-</mo>
      <mi>w</mi>
    </mfenced>
  </mrow>
</math>
</div>

<p class="author1">The four first-order conditions are:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row  StartFraction normal partial-differential f Over normal partial-differential b EndFraction equals bold upper E Superscript upper P Baseline left-parenthesis upper B 1 dot u prime left-parenthesis b dot upper B 1 plus s dot upper S 1 plus c dot upper C 1 right-parenthesis right-parenthesis minus lamda dot upper B 0 equals 0 2nd Row  StartFraction normal partial-differential f Over normal partial-differential s EndFraction equals bold upper E Superscript upper P Baseline left-parenthesis upper S 1 dot u prime left-parenthesis b dot upper B 1 plus s dot upper S 1 plus c dot upper C 1 right-parenthesis right-parenthesis minus lamda dot upper S 0 equals 0 3rd Row  StartFraction normal partial-differential f Over normal partial-differential c EndFraction equals bold upper E Superscript upper P Baseline left-parenthesis upper C 1 dot u prime left-parenthesis b dot upper B 1 plus s dot upper S 1 plus c dot upper C 1 right-parenthesis right-parenthesis minus lamda dot upper C 0 equals 0 4th Row  StartFraction normal partial-differential f Over normal partial-differential lamda EndFraction equals b dot upper B 0 plus s dot upper S 0 plus c dot upper C 0 minus w equals 0 EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>b</mi></mrow></mfrac>
            <mo>=</mo>
            <msup><mi>𝐄</mi> <mi>P</mi> </msup>
            <mfenced separators="" open="(" close=")">
              <msub><mi>B</mi> <mn>1</mn> </msub>
              <mo>·</mo>
              <msup><mi>u</mi> <mo>'</mo> </msup>
              <mrow>
                <mo>(</mo>
                <mi>b</mi>
                <mo>·</mo>
                <msub><mi>B</mi> <mn>1</mn> </msub>
                <mo>+</mo>
                <mi>s</mi>
                <mo>·</mo>
                <msub><mi>S</mi> <mn>1</mn> </msub>
                <mo>+</mo>
                <mi>c</mi>
                <mo>·</mo>
                <msub><mi>C</mi> <mn>1</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mfenced>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>·</mo>
            <msub><mi>B</mi> <mn>0</mn> </msub>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>s</mi></mrow></mfrac>
            <mo>=</mo>
            <msup><mi>𝐄</mi> <mi>P</mi> </msup>
            <mfenced separators="" open="(" close=")">
              <msub><mi>S</mi> <mn>1</mn> </msub>
              <mo>·</mo>
              <msup><mi>u</mi> <mo>'</mo> </msup>
              <mrow>
                <mo>(</mo>
                <mi>b</mi>
                <mo>·</mo>
                <msub><mi>B</mi> <mn>1</mn> </msub>
                <mo>+</mo>
                <mi>s</mi>
                <mo>·</mo>
                <msub><mi>S</mi> <mn>1</mn> </msub>
                <mo>+</mo>
                <mi>c</mi>
                <mo>·</mo>
                <msub><mi>C</mi> <mn>1</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mfenced>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>·</mo>
            <msub><mi>S</mi> <mn>0</mn> </msub>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>c</mi></mrow></mfrac>
            <mo>=</mo>
            <msup><mi>𝐄</mi> <mi>P</mi> </msup>
            <mfenced separators="" open="(" close=")">
              <msub><mi>C</mi> <mn>1</mn> </msub>
              <mo>·</mo>
              <msup><mi>u</mi> <mo>'</mo> </msup>
              <mrow>
                <mo>(</mo>
                <mi>b</mi>
                <mo>·</mo>
                <msub><mi>B</mi> <mn>1</mn> </msub>
                <mo>+</mo>
                <mi>s</mi>
                <mo>·</mo>
                <msub><mi>S</mi> <mn>1</mn> </msub>
                <mo>+</mo>
                <mi>c</mi>
                <mo>·</mo>
                <msub><mi>C</mi> <mn>1</mn> </msub>
                <mo>)</mo>
              </mrow>
            </mfenced>
            <mo>-</mo>
            <mi>λ</mi>
            <mo>·</mo>
            <msub><mi>C</mi> <mn>0</mn> </msub>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mrow>
            <mfrac><mrow><mi>∂</mi><mi>f</mi></mrow> <mrow><mi>∂</mi><mi>λ</mi></mrow></mfrac>
            <mo>=</mo>
            <mi>b</mi>
            <mo>·</mo>
            <msub><mi>B</mi> <mn>0</mn> </msub>
            <mo>+</mo>
            <mi>s</mi>
            <mo>·</mo>
            <msub><mi>S</mi> <mn>0</mn> </msub>
            <mo>+</mo>
            <mi>c</mi>
            <mo>·</mo>
            <msub><mi>C</mi> <mn>0</mn> </msub>
            <mo>-</mo>
            <mi>w</mi>
            <mo>=</mo>
            <mn>0</mn>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">The <em class="calibre7">relative prices</em> for<a data-type="indexterm" data-primary="relative price" id="idm44853694546136" class="calibre6"/> the three financial assets are fixed through:</p>
<div data-type="equation" class="calibre42">
<math alttext="StartLayout Enlarged left-brace 1st Row 1st Column StartFraction upper S 0 Over upper B 0 EndFraction 2nd Column equals 3rd Column StartStartFraction bold upper E Superscript upper P Baseline left-parenthesis StartFraction upper S 1 Over upper B 1 plus upper S 1 plus upper C 1 EndFraction right-parenthesis OverOver bold upper E Superscript upper P Baseline left-parenthesis StartFraction upper B 1 Over upper B 1 plus upper S 1 plus upper C 1 EndFraction right-parenthesis EndEndFraction identical-to zeta 1 2nd Row 1st Column StartFraction upper C 0 Over upper B 0 EndFraction 2nd Column equals 3rd Column StartStartFraction bold upper E Superscript upper P Baseline left-parenthesis StartFraction upper C 1 Over upper B 1 plus upper S 1 plus upper C 1 EndFraction right-parenthesis OverOver bold upper E Superscript upper P Baseline left-parenthesis StartFraction upper B 1 Over upper B 1 plus upper S 1 plus upper C 1 EndFraction right-parenthesis EndEndFraction identical-to zeta 2 EndLayout" display="block">
  <mfenced separators="" open="{" close="">
    <mtable>
      <mtr>
        <mtd columnalign="left">
          <mfrac><msub><mi>S</mi> <mn>0</mn> </msub> <msub><mi>B</mi> <mn>0</mn> </msub></mfrac>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mrow>
            <mfrac><mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mfenced separators="" open="(" close=")"><mfrac><msub><mi>S</mi> <mn>1</mn> </msub> <mrow><msub><mi>B</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>S</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>C</mi> <mn>1</mn> </msub></mrow></mfrac></mfenced></mrow> <mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mfenced separators="" open="(" close=")"><mfrac><msub><mi>B</mi> <mn>1</mn> </msub> <mrow><msub><mi>B</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>S</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>C</mi> <mn>1</mn> </msub></mrow></mfrac></mfenced></mrow></mfrac>
            <mo>≡</mo>
            <msub><mi>ζ</mi> <mn>1</mn> </msub>
          </mrow>
        </mtd>
      </mtr>
      <mtr>
        <mtd columnalign="left">
          <mfrac><msub><mi>C</mi> <mn>0</mn> </msub> <msub><mi>B</mi> <mn>0</mn> </msub></mfrac>
        </mtd>
        <mtd columnalign="left">
          <mo>=</mo>
        </mtd>
        <mtd>
          <mrow>
            <mfrac><mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mfenced separators="" open="(" close=")"><mfrac><msub><mi>C</mi> <mn>1</mn> </msub> <mrow><msub><mi>B</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>S</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>C</mi> <mn>1</mn> </msub></mrow></mfrac></mfenced></mrow> <mrow><msup><mi>𝐄</mi> <mi>P</mi> </msup><mfenced separators="" open="(" close=")"><mfrac><msub><mi>B</mi> <mn>1</mn> </msub> <mrow><msub><mi>B</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>S</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>C</mi> <mn>1</mn> </msub></mrow></mfrac></mfenced></mrow></mfrac>
            <mo>≡</mo>
            <msub><mi>ζ</mi> <mn>2</mn> </msub>
          </mrow>
        </mtd>
      </mtr>
    </mtable>
  </mfenced>
</math>
</div>

<p class="author1">Adding the <em class="calibre7">budget constraint</em> to<a data-type="indexterm" data-primary="budget constraints" id="idm44853694495688" class="calibre6"/> the mix fixes not only the relative prices <math alttext="zeta 1">
  <msub><mi>ζ</mi> <mn>1</mn> </msub>
</math> and <math alttext="zeta 2">
  <msub><mi>ζ</mi> <mn>2</mn> </msub>
</math> but also the absolute price levels:</p>
<div data-type="equation" class="calibre42">
<math alttext="upper B 0 plus zeta 1 dot upper B 0 plus zeta 2 dot upper B 0 equals w left right double arrow upper B 0 equals StartFraction w Over 1 plus zeta 1 plus zeta 2 EndFraction" display="block">
  <mrow>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <msub><mi>ζ</mi> <mn>1</mn> </msub>
    <mo>·</mo>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <msub><mi>ζ</mi> <mn>2</mn> </msub>
    <mo>·</mo>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mi>w</mi>
    <mo>⇔</mo>
    <msub><mi>B</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mfrac><mi>w</mi> <mrow><mn>1</mn><mo>+</mo><msub><mi>ζ</mi> <mn>1</mn> </msub><mo>+</mo><msub><mi>ζ</mi> <mn>2</mn> </msub></mrow></mfrac>
  </mrow>
</math>
</div>

<p class="author1">The adjustments to the Python code are only minor compared to the complete markets case:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">103</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">p</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="mi">3</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-1" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">104</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">P</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">p</code><code class="p">,</code><code class="calibre22"> </code><code class="n">p</code><code class="p">,</code><code class="calibre22"> </code><code class="n">p</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-2" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">105</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">11</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-3" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">106</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">20</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">5</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-4" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">107</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="mi">5</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-5" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">108</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">zeta_1</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">S1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">S1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">C1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22">
</code><code class="calibre22">                    </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">S1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">C1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-6" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">109</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">zeta_1</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-7" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">109</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.8862001308044474</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">110</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">zeta_2</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">C1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">S1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">C1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22">
</code><code class="calibre22">                    </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="n">B1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">S1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">C1</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-8" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">111</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">zeta_2</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-9" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">111</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.09156311314584695</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">112</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">w</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="mi">15</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-10" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">113</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">w</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">zeta_1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">zeta_2</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-11" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">114</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-12" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-6"><img src="Images/6.png" alt="6" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">114</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">7.584325396825396</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">115</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">zeta_1</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-13" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">116</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-14" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-7"><img src="Images/7.png" alt="7" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">116</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">6.721230158730158</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">117</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">zeta_2</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-15" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">118</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">C0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-16" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-8"><img src="Images/8.png" alt="8" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">118</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.6944444444444443</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">119</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">C0</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-17" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-9"><img src="Images/9.png" alt="9" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">119</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">14.999999999999998</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">120</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">i</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">B1</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">B0</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-18" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-10"><img src="Images/10.png" alt="10" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">121</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">i</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-19" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-10"><img src="Images/10.png" alt="10" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">121</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.45035971223021587</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">122</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">muS</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">S1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">S0</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-20" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-11"><img src="Images/11.png" alt="11" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">123</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">muS</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-21" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-11"><img src="Images/11.png" alt="11" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">123</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">0.7357933579335794</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">124</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">muC</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">C1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">P</code><code class="p">)</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="n">C0</code><code class="calibre22"> </code><code class="o">-</code><code class="calibre22"> </code><code class="mi">1</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-22" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-12"><img src="Images/12.png" alt="12" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">125</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">muC</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO11-23" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO11-12"><img src="Images/12.png" alt="12" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">125</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">1.4000000000000004</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-1" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The probability measure.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-2" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-3"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The payoff vectors.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-3" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-6"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The first relative price.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-4" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-8"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The second relative price.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-5" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-10"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The initial wealth…</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-6" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-11"><img src="Images/6.png" alt="6" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">…and the resulting price for the risk-less bond.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-7" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-13"><img src="Images/7.png" alt="7" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equilibrium price for the risky stock.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-8" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-15"><img src="Images/8.png" alt="8" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equilibrium price for the contingent claim.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-9" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-17"><img src="Images/9.png" alt="9" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The budget constraint is binding.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-10" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-18"><img src="Images/10.png" alt="10" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The risk-less interest rate.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-11" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-20"><img src="Images/11.png" alt="11" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equilibrium expected rate of return for the risky stock.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO11-12" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO11-22"><img src="Images/12.png" alt="12" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The equilibrium expected rate of return for the contingent claim.</p></dd>
</dl>

<p class="author1">That the introduction of the contingent claim—as a third traded financial asset—is market completing can be seen by the fact that there is now a unique martingale measure:</p>

<pre data-type="programlisting" data-code-language="python" class="calibre43"><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">126</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">B1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">S1</code><code class="p">,</code><code class="calibre22"> </code><code class="n">C1</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">T</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO12-1" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO12-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">127</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO12-2" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO12-1"><img src="Images/1.png" alt="1" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">127</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">[</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">20</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">5</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                 </code><code class="p">[</code><code class="mi">11</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">10</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code class="calibre22">
</code><code class="calibre22">                 </code><code class="p">[</code><code class="mi">11</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">5</code><code class="p">,</code><code class="calibre22">  </code><code class="mi">0</code><code class="p">]</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">128</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="p">(</code><code class="n">B0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">S0</code><code class="p">,</code><code class="calibre22"> </code><code class="n">C0</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO12-3" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO12-2"><img src="Images/2.png" alt="2" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">129</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">Q</code><code class="calibre22"> </code><code class="o">=</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">linalg</code><code class="o">.</code><code class="n">solve</code><code class="p">(</code><code class="n">M</code><code class="o">.</code><code class="n">T</code><code class="calibre22"> </code><code class="o">/</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">i</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">M0</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO12-4" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO12-3"><img src="Images/3.png" alt="3" class="calibre44"/></a><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">130</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">Q</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO12-5" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO12-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">130</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="mi">0.20144</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.34532</code><code class="p">,</code><code class="calibre22"> </code><code class="mi">0.45324</code><code class="p">]</code><code class="p">)</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">131</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="nb">sum</code><code class="p">(</code><code class="n">Q</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO12-6" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO12-4"><img src="Images/4.png" alt="4" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">131</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="mi">1.0</code><code class="calibre22">
</code><code class="calibre22">
</code><code class="n">In</code><code class="calibre22"> </code><code class="p">[</code><code class="mi">132</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="n">np</code><code class="o">.</code><code class="n">allclose</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">M</code><code class="o">.</code><code class="n">T</code><code class="p">,</code><code class="calibre22"> </code><code class="n">Q</code><code class="p">)</code><code class="p">,</code><code class="calibre22"> </code><code class="n">M0</code><code class="calibre22"> </code><code class="o">*</code><code class="calibre22"> </code><code class="p">(</code><code class="mi">1</code><code class="calibre22"> </code><code class="o">+</code><code class="calibre22"> </code><code class="n">i</code><code class="p">)</code><code class="p">)</code><code class="calibre22">  </code><a class="calibre6" id="co_optimality_and_equilibrium_CO12-7" href="ch04_split_001.xhtml#callout_optimality_and_equilibrium_CO12-5"><img src="Images/5.png" alt="5" class="calibre44"/></a><code class="calibre22">
</code><code class="n">Out</code><code class="p">[</code><code class="mi">132</code><code class="p">]</code><code class="p">:</code><code class="calibre22"> </code><code class="nb">True</code></pre>
<dl class="calibre18">
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO12-1" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO12-1"><img src="Images/1.png" alt="1" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The new market payoff matrix including the contingent claim.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO12-2" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO12-3"><img src="Images/2.png" alt="2" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The vector with the prices of the three financial assets/contingent claims.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO12-3" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO12-4"><img src="Images/3.png" alt="3" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">This solves for the vector <code class="calibre22">Q</code> representing the martingale measure <math alttext="upper Q">
  <mi>Q</mi>
</math> (note the use of the transpose operator <code class="calibre22">.T</code>).</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO12-4" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO12-5"><img src="Images/4.png" alt="4" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">The solution vector whose components add up to 1.</p></dd>
<dt class="calibre19"><a class="calibre6" id="callout_optimality_and_equilibrium_CO12-5" href="ch04_split_001.xhtml#co_optimality_and_equilibrium_CO12-7"><img src="Images/5.png" alt="5" class="calibre44"/></a></dt>
<dd class="calibre45"><p class="calibre46">A final check whether all discounted price processes are <a data-type="indexterm" data-primary="assets" data-secondary="financial" data-tertiary="incomplete market equilibrium pricing" data-startref="asset-financial-incomplete" id="idm44853693586408" class="calibre6"/><a data-type="indexterm" data-primary="financial assets" data-secondary="incomplete market equilibrium pricing" data-startref="financial-assets-incomplete" id="idm44853693516680" class="calibre6"/><a data-type="indexterm" data-primary="incomplete market model" data-secondary="equilibrium pricing" data-startref="incomplete-market-equilibrium" id="idm44853693515528" class="calibre6"/><a data-type="indexterm" data-primary="market incompleteness" data-secondary="equilibrium pricing" data-startref="market-incomplete-equilibrium" id="idm44853693514344" class="calibre6"/><a data-type="indexterm" data-primary="equilibrium pricing" data-secondary="in incomplete market model" data-secondary-sortas="incomplete market model" data-startref="equilibrium-incomplete" id="idm44853693513160" class="calibre6"/><a data-type="indexterm" data-primary="agents" data-secondary="representative" data-tertiary="incomplete market equilibrium pricing" data-startref="agent-representative-incomplete" id="idm44853693511704" class="calibre6"/><a data-type="indexterm" data-primary="representative agents" data-secondary="incomplete market equilibrium pricing" data-startref="representative-agent-incomplete" id="idm44853693510280" class="calibre6"/>indeed martingales.</p></dd>
</dl>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Conclusions" class="calibre4"><div class="preface" id="idm44853693573624">
<h1 class="calibre17">Conclusions</h1>

<p class="author1">This chapter is concerned with the modeling of agents and their optimization problems, mainly on the basis of the expected utility maximization approach. Two central topics are discussed: <em class="calibre7">optimal portfolio choice</em> and <em class="calibre7">equilibrium pricing of financial assets and contingent claims</em> in complete and incomplete markets. While in the first case the prices are given and the quantities in the investment portfolio are chosen, in the latter case the quantities to be held in the investment portfolio are fixed, and the prices are adjusted for this to be optimal for the representative agent. Python proves once again a powerful ecosystem with helpful packages to model and solve the related optimization problems.</p>

<p class="author1">Although the model economies in this and the previous two chapters are admittedly simplistic, the techniques and methods introduced carry over to <em class="calibre7">general static model economies</em>, that is, those having many more—even countably infinite—different future states (instead of two or three only). With some additional formalism, they even carry over to <em class="calibre7">dynamic economies</em> with many—potentially countably infinite—relevant points in time (instead of just two).</p>
</div></section>













<section data-type="sect1" class="calibre4" data-pdf-bookmark="Further Resources"><div class="preface" id="idm44853693504904">
<h1 class="calibre17">Further Resources</h1>

<p class="author1">Books cited in this chapter:</p>

<ul class="printings">
<li class="calibre54">
<p class="author1">Duffie, Darrell. 1988. <em class="calibre7">Security Markets—Stochastic Models</em>. San Diego: Academic Press.</p>
</li>
<li class="calibre54">
<p class="author1">Eichberger, Jürgen and Ian Harper. 1997. <em class="calibre7">Financial Economics</em>. New York: Oxford University Press.</p>
</li>
<li class="calibre54">
<p class="author1">Hilpisch, Yves. 2020. <em class="calibre7">Artificial Intelligence in Finance</em>. Sebastopol: O’Reilly.</p>
</li>
<li class="calibre54">
<p class="author1">Hilpisch, Yves. 2015. <em class="calibre7">Derivatives Analytics with Python</em>. Wiley Finance.</p>
</li>
<li class="calibre54">
<p class="author1">Markowitz, Harry. 1959. <em class="calibre7">Portfolio Selection—Efficient Diversification of Investments</em>. New York: John Wiley &amp; Sons.</p>
</li>
<li class="calibre54">
<p class="author1">Milne, Frank. 1995. <em class="calibre7">Finance Theory and Asset Pricing</em>. New York: Oxford University Press.</p>
</li>
<li class="calibre54">
<p class="author1">Sundaram, Rangarajan. 1996. <em class="calibre7">A First Course in Optimization Theory.</em> Cambridge University Press, Cambridge.</p>
</li>
<li class="calibre54">
<p class="author1">Varian, Hal. 1992. <em class="calibre7">Microeconomic Analysis</em>. 3rd ed. New York and London: W.W. Norton &amp; Company.</p>
</li>
</ul>
</div></section>







<div data-type="footnotes" class="calibre30"><p data-type="footnote" id="idm44853698912344" class="calibre31"><sup class="calibre32"><a href="ch04_split_000.xhtml#idm44853698912344-marker" class="calibre15">1</a></sup> Utility is only to be understood in <em class="calibre7">ordinal terms</em>, that is, in terms of bringing different plans into a certain order. A comparison of this numerical value with the optimal one from before does not make any sense because the utility functions are different.</p></div></div></section></div></body></html>