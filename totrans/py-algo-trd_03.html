<html><head></head><body><section data-pdf-bookmark="Chapter 3. Working with Financial Data" data-type="chapter" epub:type="chapter"><div class="chapter" id="financial_data">&#13;
<h1><span class="label">Chapter 3. </span>Working with Financial Data</h1>&#13;
&#13;
<blockquote>&#13;
<p><a data-primary="financial data, working with" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc0"/>Clearly, <a data-primary="Thomas, Rob" data-type="indexterm" id="idm45785401127208"/>data beats algorithms. Without comprehensive data, you tend to get non-comprehensive predictions.</p>&#13;
<p data-type="attribution">Rob Thomas (2016)</p>&#13;
</blockquote>&#13;
&#13;
<p>In algorithmic trading, one generally has to deal with four types of data, as illustrated in <a data-type="xref" href="#types_of_data">Table 3-1</a>. Although it simplifies the financial data world, distinguishing data along the pairs <em>historical versus real-time</em> and <em>structured versus unstructured</em> often proves useful in technical settings.</p>&#13;
<table id="types_of_data">&#13;
<caption><span class="label">Table 3-1. </span>Types of financial data (examples)</caption>&#13;
<thead>&#13;
<tr>&#13;
  <th> </th>&#13;
  <th>Structured </th>&#13;
  <th>Unstructured</th>&#13;
</tr>&#13;
</thead>&#13;
<tr>&#13;
<th>Historical</th>&#13;
<td>End-of-day closing prices </td>&#13;
<td>Financial news articles</td>&#13;
</tr>&#13;
<tr>&#13;
<th>Real-time</th>&#13;
<td>Bid/ask prices for FX</td>&#13;
<td>Posts on Twitter</td>&#13;
</tr>&#13;
</table>&#13;
&#13;
<p>This book is mainly concerned with <em>structured data</em> (numerical, tabular data) of both historical and real-time types. This chapter in particular focuses on historical, structured data, like end-of-day closing values for the SAP SE stock traded at the Frankfurt Stock Exchange. However, this category also subsumes intraday data, such as 1-minute-bar data for the Apple, Inc. stock traded at the NASDAQ stock exchange. The processing of real-time, structured data is covered in <a data-type="xref" href="ch07.html#realtime_sockets">Chapter 7</a>.</p>&#13;
&#13;
<p>An algorithmic trading project typically starts with a trading idea or hypothesis that needs to be (back)tested based on historical financial data. This is the context for this chapter, the plan for which is as follows. <a data-type="xref" href="#reading_from_sources">“Reading Financial Data From Different Sources”</a> uses <code>pandas</code> to read data from different file- and web-based sources. <a data-type="xref" href="#open_data_sources">“Working with Open Data Sources”</a> introduces <a href="http://quandl.com">Quandl</a> as a popular open data source platform. <a data-type="xref" href="#eikon_data_api">“Eikon Data API”</a> introduces the Python wrapper for the Refinitiv Eikon Data API. Finally, <a data-type="xref" href="#storing_data">“Storing Financial Data Efficiently”</a> briefly shows how to store historical, structured data efficiently with <code>pandas</code> based on the <a href="http://hdfgroup.org">HDF5</a> binary storage format.</p>&#13;
&#13;
<p>The goal for this chapter is to have available financial data in a format with which the backtesting of trading ideas and hypotheses can be implemented effectively. The three major themes are the importing of data, the handling of the data, and the storage of it. This and subsequent chapters assume a Python 3.8 installation with Python packages installed as explained in detail in <a data-type="xref" href="ch02.html#python_environment">Chapter 2</a>. For the time being, it is not yet relevant on which infrastructure exactly this Python environment is provided. For more details on efficient input-output operations with Python, see Hilpisch (2018, ch. 9).</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Reading Financial Data From Different Sources" data-type="sect1"><div class="sect1" id="reading_from_sources">&#13;
<h1>Reading Financial Data From Different Sources</h1>&#13;
&#13;
<p><a data-primary="Apple, Inc." data-secondary="reading stock price data from different sources" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc1"/><a data-primary="financial data, working with" data-secondary="reading data from different sources" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc2"/>This section makes heavy use of the capabilities of <code>pandas</code>, the popular data analysis package for Python (see <a href="http://pandas.pydata.org"><code>pandas</code> home page</a>). <code>pandas</code> comprehensively supports the three main tasks this chapter is concerned with: <em>reading data</em>, <em>handling data</em>, and <em>storing data</em>. One of its strengths is the reading of data from different types of sources, as the remainder of this section illustrates.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="The Data Set" data-type="sect2"><div class="sect2" id="idm45785401097816">&#13;
<h2>The Data Set</h2>&#13;
&#13;
<p><a data-primary="financial data, working with" data-secondary="data set for examples" data-type="indexterm" id="idm45785401096376"/>In this section, we work with a fairly small data set for the Apple Inc. stock price (with symbol <code>AAPL</code> and Reuters Instrument Code or RIC <code>AAPL.O</code>) as retrieved from the Eikon Data API for April 2020.</p>&#13;
&#13;
<p>Since such historical financial data has been stored in a CSV file on disk, pure Python can be used to read and print its content:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">fn</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">../data/AAPL.csv</code><code class="s1">'</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO1-1" id="co_working_with_financial_data_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">2</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">with</code><code> </code><code class="nb">open</code><code class="p">(</code><code class="n">fn</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">)</code><code> </code><code class="k">as</code><code> </code><code class="n">f</code><code class="p">:</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO1-1" id="co_working_with_financial_data_CO1-2"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>            </code><code class="k">for</code><code> </code><code class="n">_</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code class="p">:</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO1-2" id="co_working_with_financial_data_CO1-3"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>                </code><code class="k">print</code><code class="p">(</code><code class="n">f</code><code class="o">.</code><code class="n">readline</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">end</code><code class="o">=</code><code class="s1">'</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO1-3" id="co_working_with_financial_data_CO1-4"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>        </code><code class="n">Date</code><code class="p">,</code><code class="n">HIGH</code><code class="p">,</code><code class="n">CLOSE</code><code class="p">,</code><code class="n">LOW</code><code class="p">,</code><code class="n">OPEN</code><code class="p">,</code><code class="n">COUNT</code><code class="p">,</code><code class="n">VOLUME</code><code>&#13;
</code><code>        </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">01</code><code class="p">,</code><code class="mf">248.72</code><code class="p">,</code><code class="mf">240.91</code><code class="p">,</code><code class="mf">239.13</code><code class="p">,</code><code class="mf">246.5</code><code class="p">,</code><code class="mf">460606.0</code><code class="p">,</code><code class="mf">44054638.0</code><code>&#13;
</code><code>        </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">02</code><code class="p">,</code><code class="mf">245.15</code><code class="p">,</code><code class="mf">244.93</code><code class="p">,</code><code class="mf">236.9</code><code class="p">,</code><code class="mf">240.34</code><code class="p">,</code><code class="mf">380294.0</code><code class="p">,</code><code class="mf">41483493.0</code><code>&#13;
</code><code>        </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">03</code><code class="p">,</code><code class="mf">245.7</code><code class="p">,</code><code class="mf">241.41</code><code class="p">,</code><code class="mf">238.9741</code><code class="p">,</code><code class="mf">242.8</code><code class="p">,</code><code class="mf">293699.0</code><code class="p">,</code><code class="mf">32470017.0</code><code>&#13;
</code><code>        </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">06</code><code class="p">,</code><code class="mf">263.11</code><code class="p">,</code><code class="mf">262.47</code><code class="p">,</code><code class="mf">249.38</code><code class="p">,</code><code class="mf">250.9</code><code class="p">,</code><code class="mf">486681.0</code><code class="p">,</code><code class="mf">50455071.0</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO1-1" id="callout_working_with_financial_data_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Opens the file on disk (adjust path and filename if necessary).</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO1-3" id="callout_working_with_financial_data_CO1-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Sets up a <code>for</code> loop with five iterations.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO1-4" id="callout_working_with_financial_data_CO1-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Prints the first five lines in the opened CSV file.</p></dd>&#13;
</dl>&#13;
&#13;
<p>This approach allows for simple inspection of the data. One learns that there is a header line and that the single data points per row represent <code>Date, OPEN, HIGH, LOW, CLOSE, COUNT</code>, and <code>VOLUME</code>, respectively. However, the data is not yet available in memory for further usage with Python.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Reading from a CSV File with Python" data-type="sect2"><div class="sect2" id="idm45785400996216">&#13;
<h2>Reading from a CSV File with Python</h2>&#13;
&#13;
<p><a data-primary="CSV files" data-secondary="reading from a CSV file with Python" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc3"/><a data-primary="financial data, working with" data-secondary="reading from a CSV file with Python" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc4"/><a data-primary="Python (generally)" data-secondary="reading from a CSV file" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc5"/>To work with data stored as a CSV file, the file needs to be parsed and the data needs to be stored in a Python data structure. Python has a built-in module called <code>csv</code> that supports the reading of data from a CSV file. <a data-primary="list objects" data-type="indexterm" id="idm45785400989912"/>The first approach yields a <code>list</code> object containing other <code>list</code> objects with the data from the file:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">3</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">csv</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO2-1" id="co_working_with_financial_data_CO2-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">csv_reader</code><code> </code><code class="o">=</code><code> </code><code class="n">csv</code><code class="o">.</code><code class="n">reader</code><code class="p">(</code><code class="nb">open</code><code class="p">(</code><code class="n">fn</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO2-2" id="co_working_with_financial_data_CO2-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="nb">list</code><code class="p">(</code><code class="n">csv_reader</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO2-3" id="co_working_with_financial_data_CO2-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="p">[</code><code class="p">:</code><code class="mi">5</code><code class="p">]</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO2-4" id="co_working_with_financial_data_CO2-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code> </code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">Date</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">HIGH</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">CLOSE</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">LOW</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">OPEN</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">COUNT</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">VOLUME</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>         </code><code class="p">[</code><code class="s1">'</code><code class="s1">2020-04-01</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">248.72</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">240.91</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">239.13</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">246.5</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">460606.0</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">44054638.0</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>         </code><code class="p">[</code><code class="s1">'</code><code class="s1">2020-04-02</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">245.15</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">244.93</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">236.9</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">240.34</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">380294.0</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">41483493.0</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>         </code><code class="p">[</code><code class="s1">'</code><code class="s1">2020-04-03</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">245.7</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">241.41</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">238.9741</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">242.8</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">293699.0</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">32470017.0</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>         </code><code class="p">[</code><code class="s1">'</code><code class="s1">2020-04-06</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">263.11</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">262.47</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">249.38</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">250.9</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">486681.0</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">50455071.0</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code></pre>&#13;
<dl class="calloutlist pagebreak-before">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO2-1" id="callout_working_with_financial_data_CO2-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Imports the <code>csv</code> module.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO2-2" id="callout_working_with_financial_data_CO2-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Instantiates a <code>csv.reader</code> iterator object.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO2-3" id="callout_working_with_financial_data_CO2-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>A <code>list</code> comprehension adding every single line from the CSV file as a <code>list</code> object to the resulting <code>list</code> object.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO2-4" id="callout_working_with_financial_data_CO2-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Prints out the first five elements of the <code>list</code> object.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Working with such a nested <code>list</code> object—for the calculation of the average closing price, for exammple—is possible in principle but not really efficient or intuitive. Using a <code>csv.DictReader</code> iterator object instead of the standard <code>csv.reader</code> object makes such tasks a bit more manageable. <a data-primary="dictionary (dict) objects" data-type="indexterm" id="idm45785398432440"/>Every row of data in the CSV file (apart from the header row) is then imported as a <code>dict</code> object so that single values can be accessed via the respective key:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">csv_reader</code><code> </code><code class="o">=</code><code> </code><code class="n">csv</code><code class="o">.</code><code class="n">DictReader</code><code class="p">(</code><code class="nb">open</code><code class="p">(</code><code class="n">fn</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO3-1" id="co_working_with_financial_data_CO3-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="nb">list</code><code class="p">(</code><code class="n">csv_reader</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">9</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="p">[</code><code class="p">:</code><code class="mi">3</code><code class="p">]</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">9</code><code class="p">]</code><code class="p">:</code><code> </code><code class="p">[</code><code class="p">{</code><code class="s1">'</code><code class="s1">Date</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">2020-04-01</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">HIGH</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">248.72</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">CLOSE</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">240.91</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">LOW</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">239.13</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">OPEN</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">246.5</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">COUNT</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">460606.0</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">VOLUME</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">44054638.0</code><code class="s1">'</code><code class="p">}</code><code class="p">,</code><code>&#13;
</code><code>         </code><code class="p">{</code><code class="s1">'</code><code class="s1">Date</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">2020-04-02</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">HIGH</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">245.15</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">CLOSE</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">244.93</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">LOW</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">236.9</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">OPEN</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">240.34</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">COUNT</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">380294.0</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">VOLUME</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">41483493.0</code><code class="s1">'</code><code class="p">}</code><code class="p">,</code><code>&#13;
</code><code>         </code><code class="p">{</code><code class="s1">'</code><code class="s1">Date</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">2020-04-03</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">HIGH</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">245.7</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">CLOSE</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">241.41</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">LOW</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">238.9741</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">OPEN</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">242.8</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">COUNT</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">293699.0</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="s1">'</code><code class="s1">VOLUME</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">32470017.0</code><code class="s1">'</code><code class="p">}</code><code class="p">]</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO3-1" id="callout_working_with_financial_data_CO3-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Here, the <code>csv.DictReader</code> iterator object is instantiated, which reads every data row into a <code>dict</code> object, given the information in the header row.</p></dd>&#13;
</dl>&#13;
&#13;
<p class="pagebreak-before">Based on the single <code>dict</code> objects, aggregations are now somewhat easier to accomplish. However, one still cannot speak of a convenient way of calculating the mean of the Apple closing stock price when inspecting the respective Python code:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code> </code><code class="nb">sum</code><code class="p">(</code><code class="p">[</code><code class="nb">float</code><code class="p">(</code><code class="n">l</code><code class="p">[</code><code class="s1">'</code><code class="s1">CLOSE</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code> </code><code class="k">for</code><code> </code><code class="n">l</code><code> </code><code class="ow">in</code><code> </code><code class="n">data</code><code class="p">]</code><code class="p">)</code><code> </code><code class="o">/</code><code> </code><code class="nb">len</code><code class="p">(</code><code class="n">data</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO4-1" id="co_working_with_financial_data_CO4-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mf">272.38619047619045</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO4-1" id="callout_working_with_financial_data_CO4-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>First, a <code>list</code> object is generated via a list comprehension with all closing values; second, the sum is taken over all these values; third, the resulting sum is divided by the number of closing values.</p></dd>&#13;
</dl>&#13;
&#13;
<p>This is one of the major reasons why <code>pandas</code> has gained such popularity in the Python community. It makes the importing of data and the handling of, for example, financial time series data sets more convenient (and also often considerably faster) than pure Python.<a data-startref="ix_03_working_with_financial_data_-asciidoc5" data-type="indexterm" id="idm45785400558792"/><a data-startref="ix_03_working_with_financial_data_-asciidoc4" data-type="indexterm" id="idm45785400558120"/><a data-startref="ix_03_working_with_financial_data_-asciidoc3" data-type="indexterm" id="idm45785400557480"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Reading from a CSV File with pandas" data-type="sect2"><div class="sect2" id="idm45785400995592">&#13;
<h2>Reading from a CSV File with pandas</h2>&#13;
&#13;
<p><a data-primary="CSV files" data-secondary="reading from a CSV file with pandas" data-type="indexterm" id="idm45785400555464"/><a data-primary="financial data, working with" data-secondary="reading from a CSV file with pandas" data-type="indexterm" id="idm45785400554120"/><a data-primary="pandas" data-secondary="reading from a CSV file" data-type="indexterm" id="idm45785400446984"/>From this point on, this section uses <code>pandas</code> to work with the Apple stock price data set. <a data-primary="read_csv() function" data-type="indexterm" id="idm45785400445528"/>The major function used is <code>read_csv()</code>, which allows for a number of customizations via different parameters (see the <a href="https://oreil.ly/IAVfO"><code>read_csv()</code> API reference</a>). <a data-primary="DataFrame class" data-type="indexterm" id="idm45785400443336"/><code>read_csv()</code> yields as a result of the data reading procedure a <code>DataFrame</code> object, which is the central means of storing (tabular) data with <code>pandas</code>. The <code>DataFrame</code> class has many powerful methods that are particularly helpful in financial applications (refer to the <a href="https://oreil.ly/5-sNr"><code>DataFrame</code> API reference</a>):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">pandas</code><code> </code><code class="kn">as</code><code> </code><code class="nn">pd</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO5-1" id="co_working_with_financial_data_CO5-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">12</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="n">fn</code><code class="p">,</code><code> </code><code class="n">index_col</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code><code>&#13;
</code><code>                            </code><code class="n">parse_dates</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO5-2" id="co_working_with_financial_data_CO5-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">13</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO5-3" id="co_working_with_financial_data_CO5-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>         </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>         </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">21</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="n">to</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">30</code><code>&#13;
</code><code>         </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">6</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>          </code><code class="c1">#   Column  Non-Null Count  Dtype</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>          </code><code class="mi">0</code><code>   </code><code class="n">HIGH</code><code>    </code><code class="mi">21</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">1</code><code>   </code><code class="n">CLOSE</code><code>   </code><code class="mi">21</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">2</code><code>   </code><code class="n">LOW</code><code>     </code><code class="mi">21</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">3</code><code>   </code><code class="n">OPEN</code><code>    </code><code class="mi">21</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">4</code><code>   </code><code class="n">COUNT</code><code>   </code><code class="mi">21</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">5</code><code>   </code><code class="n">VOLUME</code><code>  </code><code class="mi">21</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>         </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">6</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">1.1</code><code> </code><code class="n">KB</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">14</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">tail</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO5-4" id="co_working_with_financial_data_CO5-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">14</code><code class="p">]</code><code class="p">:</code><code>               </code><code class="n">HIGH</code><code>   </code><code class="n">CLOSE</code><code>     </code><code class="n">LOW</code><code>    </code><code class="n">OPEN</code><code>     </code><code class="n">COUNT</code><code>      </code><code class="n">VOLUME</code><code>&#13;
</code><code>         </code><code class="n">Date</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">24</code><code>  </code><code class="mf">283.01</code><code>  </code><code class="mf">282.97</code><code>  </code><code class="mf">277.00</code><code>  </code><code class="mf">277.20</code><code>  </code><code class="mf">306176.0</code><code>  </code><code class="mf">31627183.0</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">27</code><code>  </code><code class="mf">284.54</code><code>  </code><code class="mf">283.17</code><code>  </code><code class="mf">279.95</code><code>  </code><code class="mf">281.80</code><code>  </code><code class="mf">300771.0</code><code>  </code><code class="mf">29271893.0</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">28</code><code>  </code><code class="mf">285.83</code><code>  </code><code class="mf">278.58</code><code>  </code><code class="mf">278.20</code><code>  </code><code class="mf">285.08</code><code>  </code><code class="mf">285384.0</code><code>  </code><code class="mf">28001187.0</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">29</code><code>  </code><code class="mf">289.67</code><code>  </code><code class="mf">287.73</code><code>  </code><code class="mf">283.89</code><code>  </code><code class="mf">284.73</code><code>  </code><code class="mf">324890.0</code><code>  </code><code class="mf">34320204.0</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">30</code><code>  </code><code class="mf">294.53</code><code>  </code><code class="mf">293.80</code><code>  </code><code class="mf">288.35</code><code>  </code><code class="mf">289.96</code><code>  </code><code class="mf">471129.0</code><code>  </code><code class="mf">45765968.0</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO5-1" id="callout_working_with_financial_data_CO5-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>The <code>pandas</code> package is imported.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO5-2" id="callout_working_with_financial_data_CO5-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>This imports the data from the CSV file, indicating that the first column shall be treated as the index column and letting the entries in that column be interpreted as date-time information.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO5-3" id="callout_working_with_financial_data_CO5-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>This method call prints out meta information regarding the resulting <code>DataFrame</code> object.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO5-4" id="callout_working_with_financial_data_CO5-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>The <code>data.tail()</code> method prints out by default the five most recent data rows.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Calculating the mean of the Apple stock closing values now is only a single method call:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="n">data</code><code class="p">[</code><code class="s1">'CLOSE'</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">()</code>&#13;
<code class="n">Out</code><code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="mf">272.38619047619056</code></pre>&#13;
&#13;
<p><a data-type="xref" href="ch04.html#vectorized_backtesting">Chapter 4</a> introduces more functionality of <code>pandas</code> for the handling of financial data. For details on working with <code>pandas</code> and the powerful <code>DataFrame</code> class, also refer to the official <a href="https://oreil.ly/5PM-O"><code>pandas</code> Documentation page</a> and to McKinney (2017).</p>&#13;
<div data-type="tip">&#13;
<p>Although the Python standard library provides capabilities to read data from CSV files, <code>pandas</code> in general significantly simplifies and speeds up such operations. An additional benefit is that the data analysis capabilities of <code>pandas</code> are immediately available since <code>read_csv()</code> returns a <code>DataFrame</code> object.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Exporting to Excel and JSON" data-type="sect2"><div class="sect2" id="idm45785400616152">&#13;
<h2>Exporting to Excel and JSON</h2>&#13;
&#13;
<p><a data-primary="Excel" data-secondary="exporting financial data to" data-type="indexterm" id="idm45785397541576"/><a data-primary="financial data, working with" data-secondary="exporting to Excel/JSON" data-type="indexterm" id="idm45785397540632"/><a data-primary="JSON" data-secondary="exporting financial data to" data-type="indexterm" id="idm45785397539720"/><a data-primary="pandas" data-secondary="exporting financial data to Excel/JSON" data-type="indexterm" id="idm45785397538760"/><code>pandas</code> also excels at exporting data stored in <code>DataFrame</code> objects when this data needs to be shared in a non-Python specific format. Apart from being able to export to CSV files, <code>pandas</code> also allows one to do the export in the form of Excel spreadsheet files as well as JSON files, both of which are popular data exchange formats in the financial industry. Such an exporting procedure typically needs a single method call only:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">16</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">to_excel</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/aapl.xls</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">AAPL</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO6-1" id="co_working_with_financial_data_CO6-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">17</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">to_json</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/aapl.json</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO6-2" id="co_working_with_financial_data_CO6-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">18</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">ls</code><code> </code><code class="o">-</code><code class="n">n</code><code> </code><code class="n">data</code><code class="o">/</code><code>&#13;
</code><code>         </code><code class="n">total</code><code> </code><code class="mi">24</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="n">rw</code><code class="o">-</code><code class="n">r</code><code class="o">-</code><code class="o">-</code><code class="n">r</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="mi">1</code><code> </code><code class="mi">501</code><code>  </code><code class="mi">20</code><code>  </code><code class="mi">3067</code><code> </code><code class="n">Aug</code><code> </code><code class="mi">25</code><code> </code><code class="mi">11</code><code class="p">:</code><code class="mi">47</code><code> </code><code class="n">aapl</code><code class="o">.</code><code class="n">json</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="n">rw</code><code class="o">-</code><code class="n">r</code><code class="o">-</code><code class="o">-</code><code class="n">r</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="mi">1</code><code> </code><code class="mi">501</code><code>  </code><code class="mi">20</code><code>  </code><code class="mi">5632</code><code> </code><code class="n">Aug</code><code> </code><code class="mi">25</code><code> </code><code class="mi">11</code><code class="p">:</code><code class="mi">47</code><code> </code><code class="n">aapl</code><code class="o">.</code><code class="n">xls</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO6-1" id="callout_working_with_financial_data_CO6-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Exports the data to an Excel spreadsheet file on disk.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO6-2" id="callout_working_with_financial_data_CO6-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Exports the data to a JSON file on disk.</p></dd>&#13;
</dl>&#13;
&#13;
<p>In particular when it comes to the interaction with Excel spreadsheet files, there are more elegant ways than just doing a data dump to a new file. <code>xlwings</code>, for example, is a powerful Python package that allows for an efficient and intelligent interaction between Python and Excel (visit the <a href="http://xlwings.org"><code>xlwings</code> home page</a>).</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Reading from Excel and JSON" data-type="sect2"><div class="sect2" id="idm45785398126600">&#13;
<h2>Reading from Excel and JSON</h2>&#13;
&#13;
<p><a data-primary="Excel" data-secondary="reading financial data from" data-type="indexterm" id="idm45785398125160"/><a data-primary="financial data, working with" data-secondary="reading data from Excel/JSON" data-type="indexterm" id="idm45785398124216"/><a data-primary="JSON" data-secondary="reading financial data from" data-type="indexterm" id="idm45785398123240"/><a data-primary="pandas" data-secondary="reading financial data from Excel/JSON" data-type="indexterm" id="idm45785398122280"/>Now that the data is also available in the form of an Excel spreadsheet file and a JSON data file, <code>pandas</code> can read data from these sources, as well.&#13;
The approach is as straightforward as with CSV files:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data_copy_1</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">read_excel</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/aapl.xls</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">AAPL</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                     </code><code class="n">index_col</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO7-1" id="co_working_with_financial_data_CO7-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">20</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data_copy_1</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO7-2" id="co_working_with_financial_data_CO7-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">20</code><code class="p">]</code><code class="p">:</code><code>               </code><code class="n">HIGH</code><code>   </code><code class="n">CLOSE</code><code>       </code><code class="n">LOW</code><code>    </code><code class="n">OPEN</code><code>   </code><code class="n">COUNT</code><code>    </code><code class="n">VOLUME</code><code>&#13;
</code><code>         </code><code class="n">Date</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">01</code><code>  </code><code class="mf">248.72</code><code>  </code><code class="mf">240.91</code><code>  </code><code class="mf">239.1300</code><code>  </code><code class="mf">246.50</code><code>  </code><code class="mi">460606</code><code>  </code><code class="mi">44054638</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">02</code><code>  </code><code class="mf">245.15</code><code>  </code><code class="mf">244.93</code><code>  </code><code class="mf">236.9000</code><code>  </code><code class="mf">240.34</code><code>  </code><code class="mi">380294</code><code>  </code><code class="mi">41483493</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">03</code><code>  </code><code class="mf">245.70</code><code>  </code><code class="mf">241.41</code><code>  </code><code class="mf">238.9741</code><code>  </code><code class="mf">242.80</code><code>  </code><code class="mi">293699</code><code>  </code><code class="mi">32470017</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">06</code><code>  </code><code class="mf">263.11</code><code>  </code><code class="mf">262.47</code><code>  </code><code class="mf">249.3800</code><code>  </code><code class="mf">250.90</code><code>  </code><code class="mi">486681</code><code>  </code><code class="mi">50455071</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">07</code><code>  </code><code class="mf">271.70</code><code>  </code><code class="mf">259.43</code><code>  </code><code class="mf">259.0000</code><code>  </code><code class="mf">270.80</code><code>  </code><code class="mi">467375</code><code>  </code><code class="mi">50721831</code><code>&#13;
</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">21</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data_copy_2</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">read_json</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/aapl.json</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO7-3" id="co_working_with_financial_data_CO7-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data_copy_2</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO7-4" id="co_working_with_financial_data_CO7-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">22</code><code class="p">]</code><code class="p">:</code><code>               </code><code class="n">HIGH</code><code>   </code><code class="n">CLOSE</code><code>       </code><code class="n">LOW</code><code>    </code><code class="n">OPEN</code><code>   </code><code class="n">COUNT</code><code>    </code><code class="n">VOLUME</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">01</code><code>  </code><code class="mf">248.72</code><code>  </code><code class="mf">240.91</code><code>  </code><code class="mf">239.1300</code><code>  </code><code class="mf">246.50</code><code>  </code><code class="mi">460606</code><code>  </code><code class="mi">44054638</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">02</code><code>  </code><code class="mf">245.15</code><code>  </code><code class="mf">244.93</code><code>  </code><code class="mf">236.9000</code><code>  </code><code class="mf">240.34</code><code>  </code><code class="mi">380294</code><code>  </code><code class="mi">41483493</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">03</code><code>  </code><code class="mf">245.70</code><code>  </code><code class="mf">241.41</code><code>  </code><code class="mf">238.9741</code><code>  </code><code class="mf">242.80</code><code>  </code><code class="mi">293699</code><code>  </code><code class="mi">32470017</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">06</code><code>  </code><code class="mf">263.11</code><code>  </code><code class="mf">262.47</code><code>  </code><code class="mf">249.3800</code><code>  </code><code class="mf">250.90</code><code>  </code><code class="mi">486681</code><code>  </code><code class="mi">50455071</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mo">07</code><code>  </code><code class="mf">271.70</code><code>  </code><code class="mf">259.43</code><code>  </code><code class="mf">259.0000</code><code>  </code><code class="mf">270.80</code><code>  </code><code class="mi">467375</code><code>  </code><code class="mi">50721831</code><code>&#13;
</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">23</code><code class="p">]</code><code class="p">:</code><code> </code><code class="err">!</code><code class="n">rm</code><code> </code><code class="n">data</code><code class="o">/</code><code class="o">*</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO7-1" id="callout_working_with_financial_data_CO7-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>This reads the data from the Excel spreadsheet file to a new <code>DataFrame</code> object.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO7-2" id="callout_working_with_financial_data_CO7-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>The first five rows of the first in-memory copy of the data are printed.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO7-3" id="callout_working_with_financial_data_CO7-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>This reads the data from the JSON file to yet another <code>DataFrame</code> object.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO7-4" id="callout_working_with_financial_data_CO7-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>This then prints the first five rows of the second in-memory copy of the data.</p></dd>&#13;
</dl>&#13;
&#13;
<p><code>pandas</code> proves useful for reading and writing financial data from and to different types of data files. Often the reading might be tricky due to nonstandard storage &#13;
<span class="keep-together">formats</span> (like a “;” instead of a “,” as separator), but <code>pandas</code> generally provides the right set of parameter combinations to cope with such cases. Although all examples in this section use a small data set only, one can expect high performance input-output operations from <code>pandas</code> in the most important scenarios when the data sets are much larger.<a data-startref="ix_03_working_with_financial_data_-asciidoc2" data-type="indexterm" id="idm45785400419256"/><a data-startref="ix_03_working_with_financial_data_-asciidoc1" data-type="indexterm" id="idm45785400418584"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Working with Open Data Sources" data-type="sect1"><div class="sect1" id="open_data_sources">&#13;
<h1>Working with Open Data Sources</h1>&#13;
&#13;
<p><a data-primary="financial data, working with" data-secondary="open data sources" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc6"/><a data-primary="open data sources" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc7"/><a data-primary="Quandl" data-secondary="working with open data sources" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc8"/>To a great extent, the attractiveness of the Python ecosystem stems from the fact that almost all packages available are open source and can be used for free. Financial analytics in general and algorithmic trading in particular, however, cannot live with open source software and algorithms alone; data also plays a vital role, as the quotation at the beginning of the chapter emphasizes. The previous section uses a small data set from a commercial data source. While there have been helpful open (financial) data sources available for some years (such as the ones provided by Yahoo! Finance or Google Finance), there are not too many left at the time of this writing in 2020. One of the more obvious reasons for this trend might be the ever-changing terms of data licensing agreements.</p>&#13;
&#13;
<p>The one notable exception for the purposes of this book is <a href="http://quandl.com">Quandl</a>, a platform that aggregates a large number of open, as well as premium (i.e., to-be-paid-for) data sources. The data is provided via a unified API for which a Python wrapper package is available.</p>&#13;
&#13;
<p>The Python wrapper package for the Quandl data API (see the <a href="https://oreil.ly/xRt5x">Python wrapper page on Quandl</a> and the <a href="https://oreil.ly/LcJEo">GitHub page</a> of the package) is installed with <code>conda</code> through <code>conda install quandl</code>. <a data-primary="Bitcoin" data-type="indexterm" id="idm45785397942120"/>The first example shows how to retrieve historical average prices for the BTC/USD exchange rate since the introduction of Bitcoin as a cryptocurrency. With Quandl, requests always expect a combination of the <em>database</em> and the specific <em>data set</em> desired. (In the example, <code>BCHAIN</code> and <code>MKPRU</code>.) Such information can generally be looked up on the Quandl platform. For the example, the relevant page on Quandl is <a href="https://oreil.ly/APwvn">BCHAIN/MKPRU</a>.</p>&#13;
&#13;
<p>By default, the <code>quandl</code> package returns a <code>pandas</code> <code>DataFrame</code> object. In the example, the <code>Value</code> column is also presented in annualized fashion (that is, with year end &#13;
<span class="keep-together">values</span>). Note that the number shown for 2020 is the last available value in the data set (from May 2020) and not necessarily the year end value.</p>&#13;
&#13;
<p><a data-primary="API key, for data sets" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc9"/>While a large part of the data sets on the Quandl platform are free, some of the free data sets require an API key. Such a key is required after a certain limit of free API calls too. Every user obtains such a key by signing up for a free Quandl account on the <a href="https://oreil.ly/sbh9j">Quandl sign up page</a>. Data requests requiring an API key expect the key to be provided as the parameter <code>api_key</code>. In the example, the API key (which is found on the account settings page) is stored as a string in the variable <code>quandl_api_key</code>. The concrete value for the key is read from a configuration file via the <code>configparser</code> module:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">configparser</code><code>&#13;
</code><code>         </code><code class="n">config</code><code> </code><code class="o">=</code><code> </code><code class="n">configparser</code><code class="o">.</code><code class="n">ConfigParser</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">config</code><code class="o">.</code><code class="n">read</code><code class="p">(</code><code class="s1">'</code><code class="s1">../pyalgo.cfg</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">../pyalgo.cfg</code><code class="s1">'</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">quandl</code><code> </code><code class="kn">as</code><code> </code><code class="nn">q</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO8-1" id="co_working_with_financial_data_CO8-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">q</code><code class="o">.</code><code class="n">get</code><code class="p">(</code><code class="s1">'</code><code class="s1">BCHAIN/MKPRU</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">api_key</code><code class="o">=</code><code class="n">config</code><code class="p">[</code><code class="s1">'</code><code class="s1">quandl</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="s1">'</code><code class="s1">api_key</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO8-2" id="co_working_with_financial_data_CO8-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>         </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">4254</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2009</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">03</code><code> </code><code class="n">to</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">26</code><code>&#13;
</code><code>         </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">1</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>          </code><code class="c1">#   Column  Non-Null Count  Dtype</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>          </code><code class="mi">0</code><code>   </code><code class="n">Value</code><code>   </code><code class="mi">4254</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>   </code><code class="n">float64</code><code>&#13;
</code><code>         </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">66.5</code><code> </code><code class="n">KB</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">Value</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'</code><code class="s1">A</code><code class="s1">'</code><code class="p">)</code><code class="o">.</code><code class="n">last</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO8-3" id="co_working_with_financial_data_CO8-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">Date</code><code>&#13;
</code><code>         </code><code class="mi">2009</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>        </code><code class="mf">0.000000</code><code>&#13;
</code><code>         </code><code class="mi">2010</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>        </code><code class="mf">0.299999</code><code>&#13;
</code><code>         </code><code class="mi">2011</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>        </code><code class="mf">4.995000</code><code>&#13;
</code><code>         </code><code class="mi">2012</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>       </code><code class="mf">13.590000</code><code>&#13;
</code><code>         </code><code class="mi">2013</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>      </code><code class="mf">731.000000</code><code>&#13;
</code><code>         </code><code class="mi">2014</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>      </code><code class="mf">317.400000</code><code>&#13;
</code><code>         </code><code class="mi">2015</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>      </code><code class="mf">428.000000</code><code>&#13;
</code><code>         </code><code class="mi">2016</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>      </code><code class="mf">952.150000</code><code>&#13;
</code><code>         </code><code class="mi">2017</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>    </code><code class="mf">13215.574000</code><code>&#13;
</code><code>         </code><code class="mi">2018</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>     </code><code class="mf">3832.921667</code><code>&#13;
</code><code>         </code><code class="mi">2019</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>     </code><code class="mf">7385.360000</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>    </code><code class="mf">11763.930000</code><code>&#13;
</code><code>         </code><code class="n">Freq</code><code class="p">:</code><code> </code><code class="n">A</code><code class="o">-</code><code class="n">DEC</code><code class="p">,</code><code> </code><code class="n">Name</code><code class="p">:</code><code> </code><code class="n">Value</code><code class="p">,</code><code> </code><code class="n">dtype</code><code class="p">:</code><code> </code><code class="n">float64</code></pre>&#13;
<dl class="calloutlist pagebreak-before">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO8-1" id="callout_working_with_financial_data_CO8-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Imports the Python wrapper package for Quandl.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO8-2" id="callout_working_with_financial_data_CO8-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Reads historical data for the BTC/USD exchange rate.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO8-3" id="callout_working_with_financial_data_CO8-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Selects the <code>Value</code> column, resamples it—from the originally <em>daily</em> values to <em>yearly</em> values—and defines the last available observation to be the relevant one.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Quandl also provides, for example, diverse data sets for single stocks, like end-of-day stock prices, stock fundamentals, or data sets related to options traded on a certain stock:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">29</code><code class="p">]:</code> <code class="n">data</code> <code class="o">=</code> <code class="n">q</code><code class="o">.</code><code class="n">get</code><code class="p">(</code><code class="s1">'FSE/SAP_X'</code><code class="p">,</code> <code class="n">start_date</code><code class="o">=</code><code class="s1">'2018-1-1'</code><code class="p">,</code>&#13;
                      <code class="n">end_date</code><code class="o">=</code><code class="s1">'2020-05-01'</code><code class="p">,</code>&#13;
                      <code class="n">api_key</code><code class="o">=</code><code class="n">config</code><code class="p">[</code><code class="s1">'quandl'</code><code class="p">][</code><code class="s1">'api_key'</code><code class="p">])</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">30</code><code class="p">]:</code> <code class="n">data</code><code class="o">.</code><code class="n">info</code><code class="p">()</code>&#13;
         <code class="o">&lt;</code><code class="k">class</code> <code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'&gt;</code>&#13;
         <code class="n">DatetimeIndex</code><code class="p">:</code> <code class="mi">579</code> <code class="n">entries</code><code class="p">,</code> <code class="mi">2018</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">02</code> <code class="n">to</code> <code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">30</code>&#13;
         <code class="n">Data</code> <code class="n">columns</code> <code class="p">(</code><code class="n">total</code> <code class="mi">10</code> <code class="n">columns</code><code class="p">):</code>&#13;
          <code class="c1">#   Column                 Non-Null Count  Dtype</code>&#13;
         <code class="o">---</code>  <code class="o">------</code>                 <code class="o">--------------</code>  <code class="o">-----</code>&#13;
          <code class="mi">0</code>   <code class="n">Open</code>                   <code class="mi">257</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>    <code class="n">float64</code>&#13;
          <code class="mi">1</code>   <code class="n">High</code>                   <code class="mi">579</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>    <code class="n">float64</code>&#13;
          <code class="mi">2</code>   <code class="n">Low</code>                    <code class="mi">579</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>    <code class="n">float64</code>&#13;
          <code class="mi">3</code>   <code class="n">Close</code>                  <code class="mi">579</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>    <code class="n">float64</code>&#13;
          <code class="mi">4</code>   <code class="n">Change</code>                 <code class="mi">0</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>      <code class="nb">object</code>&#13;
          <code class="mi">5</code>   <code class="n">Traded</code> <code class="n">Volume</code>          <code class="mi">533</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>    <code class="n">float64</code>&#13;
          <code class="mi">6</code>   <code class="n">Turnover</code>               <code class="mi">533</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>    <code class="n">float64</code>&#13;
          <code class="mi">7</code>   <code class="n">Last</code> <code class="n">Price</code> <code class="n">of</code> <code class="n">the</code> <code class="n">Day</code>  <code class="mi">0</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>      <code class="nb">object</code>&#13;
          <code class="mi">8</code>   <code class="n">Daily</code> <code class="n">Traded</code> <code class="n">Units</code>     <code class="mi">0</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>      <code class="nb">object</code>&#13;
          <code class="mi">9</code>   <code class="n">Daily</code> <code class="n">Turnover</code>         <code class="mi">0</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>      <code class="nb">object</code>&#13;
         <code class="n">dtypes</code><code class="p">:</code> <code class="n">float64</code><code class="p">(</code><code class="mi">6</code><code class="p">),</code> <code class="nb">object</code><code class="p">(</code><code class="mi">4</code><code class="p">)</code>&#13;
         <code class="n">memory</code> <code class="n">usage</code><code class="p">:</code> <code class="mf">49.8</code><code class="o">+</code> <code class="n">KB</code></pre>&#13;
&#13;
<p>The API key can also be configured permanently with the Python wrapper via the &#13;
<span class="keep-together">following:</span></p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">q</code><code class="o">.</code><code class="n">ApiConfig</code><code class="o">.</code><code class="n">api_key</code> <code class="o">=</code> <code class="s1">'YOUR_API_KEY'</code></pre>&#13;
&#13;
<p>The<a data-startref="ix_03_working_with_financial_data_-asciidoc9" data-type="indexterm" id="idm45785392142968"/> Quandl platform also offers <a data-primary="Quandl" data-secondary="premium data sets" data-type="indexterm" id="idm45785392118344"/>premium data sets for which a subscription or fee is required. Most of these data sets offer free samples. The example retrieves option implied volatilities for the Microsoft Corp. stock. The free sample data set is quite large, with more than 4,100 rows and many columns (only a subset is shown). The last lines of code display the 30, 60, and 90 days implied volatility values for the five most recent days available:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">31</code><code class="p">]:</code> <code class="n">q</code><code class="o">.</code><code class="n">ApiConfig</code><code class="o">.</code><code class="n">api_key</code> <code class="o">=</code> <code class="n">config</code><code class="p">[</code><code class="s1">'quandl'</code><code class="p">][</code><code class="s1">'api_key'</code><code class="p">]</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">32</code><code class="p">]:</code> <code class="n">vol</code> <code class="o">=</code> <code class="n">q</code><code class="o">.</code><code class="n">get</code><code class="p">(</code><code class="s1">'VOL/MSFT'</code><code class="p">)</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">33</code><code class="p">]:</code> <code class="n">vol</code><code class="o">.</code><code class="n">iloc</code><code class="p">[:,</code> <code class="p">:</code><code class="mi">10</code><code class="p">]</code><code class="o">.</code><code class="n">info</code><code class="p">()</code>&#13;
         <code class="o">&lt;</code><code class="k">class</code> <code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'&gt;</code>&#13;
         <code class="n">DatetimeIndex</code><code class="p">:</code> <code class="mi">1006</code> <code class="n">entries</code><code class="p">,</code> <code class="mi">2015</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">02</code> <code class="n">to</code> <code class="mi">2018</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code>&#13;
         <code class="n">Data</code> <code class="n">columns</code> <code class="p">(</code><code class="n">total</code> <code class="mi">10</code> <code class="n">columns</code><code class="p">):</code>&#13;
          <code class="c1">#   Column  Non-Null Count  Dtype</code>&#13;
         <code class="o">---</code>  <code class="o">------</code>  <code class="o">--------------</code>  <code class="o">-----</code>&#13;
          <code class="mi">0</code>   <code class="n">Hv10</code>    <code class="mi">1006</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>   <code class="n">float64</code>&#13;
          <code class="mi">1</code>   <code class="n">Hv20</code>    <code class="mi">1006</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>   <code class="n">float64</code>&#13;
          <code class="mi">2</code>   <code class="n">Hv30</code>    <code class="mi">1006</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>   <code class="n">float64</code>&#13;
          <code class="mi">3</code>   <code class="n">Hv60</code>    <code class="mi">1006</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>   <code class="n">float64</code>&#13;
          <code class="mi">4</code>   <code class="n">Hv90</code>    <code class="mi">1006</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>   <code class="n">float64</code>&#13;
          <code class="mi">5</code>   <code class="n">Hv120</code>   <code class="mi">1006</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>   <code class="n">float64</code>&#13;
          <code class="mi">6</code>   <code class="n">Hv150</code>   <code class="mi">1006</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>   <code class="n">float64</code>&#13;
          <code class="mi">7</code>   <code class="n">Hv180</code>   <code class="mi">1006</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>   <code class="n">float64</code>&#13;
          <code class="mi">8</code>   <code class="n">Phv10</code>   <code class="mi">1006</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>   <code class="n">float64</code>&#13;
          <code class="mi">9</code>   <code class="n">Phv20</code>   <code class="mi">1006</code> <code class="n">non</code><code class="o">-</code><code class="n">null</code>   <code class="n">float64</code>&#13;
         <code class="n">dtypes</code><code class="p">:</code> <code class="n">float64</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code>&#13;
         <code class="n">memory</code> <code class="n">usage</code><code class="p">:</code> <code class="mf">86.5</code> <code class="n">KB</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">34</code><code class="p">]:</code> <code class="n">vol</code><code class="p">[[</code><code class="s1">'IvMean30'</code><code class="p">,</code> <code class="s1">'IvMean60'</code><code class="p">,</code> <code class="s1">'IvMean90'</code><code class="p">]]</code><code class="o">.</code><code class="n">tail</code><code class="p">()</code>&#13;
<code class="n">Out</code><code class="p">[</code><code class="mi">34</code><code class="p">]:</code>             <code class="n">IvMean30</code>  <code class="n">IvMean60</code>  <code class="n">IvMean90</code>&#13;
         <code class="n">Date</code>&#13;
         <code class="mi">2018</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">24</code>    <code class="mf">0.4310</code>    <code class="mf">0.4112</code>    <code class="mf">0.3829</code>&#13;
         <code class="mi">2018</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">26</code>    <code class="mf">0.4059</code>    <code class="mf">0.3844</code>    <code class="mf">0.3587</code>&#13;
         <code class="mi">2018</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">27</code>    <code class="mf">0.3918</code>    <code class="mf">0.3879</code>    <code class="mf">0.3618</code>&#13;
         <code class="mi">2018</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">28</code>    <code class="mf">0.3940</code>    <code class="mf">0.3736</code>    <code class="mf">0.3482</code>&#13;
         <code class="mi">2018</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code>    <code class="mf">0.3760</code>    <code class="mf">0.3519</code>    <code class="mf">0.3310</code></pre>&#13;
&#13;
<p>This concludes the overview of the Python wrapper package <code>quandl</code> for the Quandl data API. The Quandl platform and service is growing rapidly and proves to be a &#13;
<span class="keep-together">valuable</span> source for financial data in an algorithmic trading context.</p>&#13;
<div data-type="note" epub:type="note">&#13;
<p>Open source software is a trend that started many years ago. It has lowered the barriers to entry in many areas and also in algorithmic trading. A new, reinforcing trend in this regard is open data sources. In some cases, such as with Quandl, they even provide high quality data sets. It cannot be expected that open data will completely replace professional data subscriptions any time soon, but they represent a valuable means to get started with algorithmic trading in a cost efficient manner.<a data-startref="ix_03_working_with_financial_data_-asciidoc8" data-type="indexterm" id="idm45785392125864"/><a data-startref="ix_03_working_with_financial_data_-asciidoc7" data-type="indexterm" id="idm45785392125128"/><a data-startref="ix_03_working_with_financial_data_-asciidoc6" data-type="indexterm" id="idm45785392124424"/></p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Eikon Data API" data-type="sect1"><div class="sect1" id="eikon_data_api">&#13;
<h1>Eikon Data API</h1>&#13;
&#13;
<p><a data-primary="Eikon Data API" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc10"/><a data-primary="financial data, working with" data-secondary="Eikon Data API" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc11"/>Open data sources are a blessing for algorithmic traders wanting to get started in the space and wanting to be able to quickly test hypotheses and ideas based on real financial data sets. Sooner or later, however, open data sets will not suffice anymore to &#13;
<span class="keep-together">satisfy</span> the requirements of more ambitious traders and professionals.</p>&#13;
&#13;
<p><a data-primary="Refinitiv" data-type="indexterm" id="idm45785391887464"/><a href="http://refinitiv.com">Refinitiv</a> is one of the biggest financial data and news providers in the world. Its current desktop flagship product is <a href="https://oreil.ly/foYNk">Eikon</a>, which is the equivalent to the <a href="https://oreil.ly/kMJl7">Terminal</a> by Bloomberg, the major competitor in the data services field. <a data-type="xref" href="#eikon_terminal">Figure 3-1</a> shows a screenshot of Eikon in the browser-based version. Eikon provides access to petabytes of data via a single access point.</p>&#13;
&#13;
<figure><div class="figure" id="eikon_terminal">&#13;
<img alt="pfat 0301" src="assets/pfat_0301.png"/>&#13;
<h6><span class="label">Figure 3-1. </span>Browser version of Eikon terminal</h6>&#13;
</div></figure>&#13;
&#13;
<p>Recently, Refinitiv have streamlined their API landscape and have released a Python wrapper package, called <code>eikon</code>, for the Eikon data API, which is installed via <code>pip install eikon</code>. If you have a subscription to the Refinitiv Eikon data services, you can use the Python package to programmatically retrieve historical data, as well as streaming structured and unstructured data, from the unified API. A technical prerequisite is that a local desktop application is running that provides a desktop API session. The latest such desktop application at the time of this writing is called Workspace (see <a data-type="xref" href="#workspace_charting">Figure 3-2</a>).</p>&#13;
&#13;
<p>If you are an Eikon subscriber and have an account for the <a href="https://oreil.ly/xowdi">Developer Community pages</a>, you will find an overview of the Python Eikon Scripting Library under <a href="https://oreil.ly/7dnQx">Quick Start</a>.</p>&#13;
&#13;
<figure><div class="figure" id="workspace_charting">&#13;
<img alt="pfat 0302" src="assets/pfat_0302.png"/>&#13;
<h6><span class="label">Figure 3-2. </span>Workspace application with desktop API services</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-primary="app_key, for Eikon Data API" data-type="indexterm" id="idm45785391874840"/>In order to use the Eikon Data API, the Eikon <code>app_key</code> needs to be set. You get it via the App Key Generator (<code>APPKEY</code>) application in either Eikon or Workspace:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">eikon</code><code> </code><code class="kn">as</code><code> </code><code class="nn">ek</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO9-1" id="co_working_with_financial_data_CO9-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">36</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">ek</code><code class="o">.</code><code class="n">set_app_key</code><code class="p">(</code><code class="n">config</code><code class="p">[</code><code class="s1">'</code><code class="s1">eikon</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="s1">'</code><code class="s1">app_key</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO9-2" id="co_working_with_financial_data_CO9-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">37</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">help</code><code class="p">(</code><code class="n">ek</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO9-3" id="co_working_with_financial_data_CO9-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>         </code><code class="n">Help</code><code> </code><code class="n">on</code><code> </code><code class="n">package</code><code> </code><code class="n">eikon</code><code class="p">:</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="n">NAME</code><code>&#13;
</code><code>           </code><code class="n">eikon</code><code> </code><code class="o">-</code><code> </code><code class="c1"># coding: utf-8</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="n">PACKAGE</code><code> </code><code class="n">CONTENTS</code><code>&#13;
</code><code>           </code><code class="n">Profile</code><code>&#13;
</code><code>           </code><code class="n">data_grid</code><code>&#13;
</code><code>           </code><code class="n">eikonError</code><code>&#13;
</code><code>           </code><code class="n">json_requests</code><code>&#13;
</code><code>           </code><code class="n">news_request</code><code>&#13;
</code><code>           </code><code class="n">streaming_session</code><code> </code><code class="p">(</code><code class="n">package</code><code class="p">)</code><code>&#13;
</code><code>           </code><code class="n">symbology</code><code>&#13;
</code><code>           </code><code class="n">time_series</code><code>&#13;
</code><code>           </code><code class="n">tools</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="n">SUBMODULES</code><code>&#13;
</code><code>           </code><code class="n">cache</code><code>&#13;
</code><code>           </code><code class="n">desktop_session</code><code>&#13;
</code><code>           </code><code class="n">istream_callback</code><code>&#13;
</code><code>           </code><code class="n">itemstream</code><code>&#13;
</code><code>           </code><code class="n">session</code><code>&#13;
</code><code>           </code><code class="n">stream</code><code>&#13;
</code><code>           </code><code class="n">stream_connection</code><code>&#13;
</code><code>           </code><code class="n">streamingprice</code><code>&#13;
</code><code>           </code><code class="n">streamingprice_callback</code><code>&#13;
</code><code>           </code><code class="n">streamingprices</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="n">VERSION</code><code>&#13;
</code><code>           </code><code class="mf">1.1</code><code class="o">.</code><code class="mi">5</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="n">FILE</code><code>&#13;
</code><code>&#13;
</code><code>            </code><code class="o">/</code><code class="n">Users</code><code class="o">/</code><code class="n">yves</code><code class="o">/</code><code class="n">Python</code><code class="o">/</code><code class="n">envs</code><code class="o">/</code><code class="n">py38</code><code class="o">/</code><code class="n">lib</code><code class="o">/</code><code class="n">python3</code><code class="o">.</code><code class="mi">8</code><code class="o">/</code><code class="n">site</code><code class="o">-</code><code class="n">packages</code><code class="o">/</code><code class="n">eikon</code><code class="o">/</code><code class="nf-Magic">__init__</code><code>&#13;
</code><code>         </code><code class="o">.</code><code class="n">py</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO9-1" id="callout_working_with_financial_data_CO9-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Imports the <code>eikon</code> package as <code>ek</code>.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO9-2" id="callout_working_with_financial_data_CO9-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Sets the <code>app_key</code>.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO9-3" id="callout_working_with_financial_data_CO9-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Shows the help text for the main module.</p></dd>&#13;
</dl>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="title-nudge-down" data-pdf-bookmark="Retrieving Historical Structured Data" data-type="sect2"><div class="sect2" id="idm45785391772312">&#13;
<h2>Retrieving Historical Structured Data</h2>&#13;
&#13;
<p><a data-primary="Eikon Data API" data-secondary="retrieving historical structured data" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc12"/>The retrieval of historical financial time series data is as straightforward as with the other wrappers used before:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">39</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">symbols</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">AAPL.O</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">MSFT.O</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">GOOG.O</code><code class="s1">'</code><code class="p">]</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO10-1" id="co_working_with_financial_data_CO10-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">40</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">ek</code><code class="o">.</code><code class="n">get_timeseries</code><code class="p">(</code><code class="n">symbols</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO10-2" id="co_working_with_financial_data_CO10-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>                                  </code><code class="n">start_date</code><code class="o">=</code><code class="s1">'</code><code class="s1">2020-01-01</code><code class="s1">'</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO10-3" id="co_working_with_financial_data_CO10-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>                                  </code><code class="n">end_date</code><code class="o">=</code><code class="s1">'</code><code class="s1">2020-05-01</code><code class="s1">'</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO10-4" id="co_working_with_financial_data_CO10-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>                                  </code><code class="n">interval</code><code class="o">=</code><code class="s1">'</code><code class="s1">daily</code><code class="s1">'</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO10-5" id="co_working_with_financial_data_CO10-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>                                  </code><code class="n">fields</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">*</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO10-6" id="co_working_with_financial_data_CO10-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">41</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">keys</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO10-7" id="co_working_with_financial_data_CO10-7"><img alt="7" src="assets/7.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">41</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">MultiIndex</code><code class="p">(</code><code class="p">[</code><code class="p">(</code><code class="s1">'</code><code class="s1">AAPL.O</code><code class="s1">'</code><code class="p">,</code><code>   </code><code class="s1">'</code><code class="s1">HIGH</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">AAPL.O</code><code class="s1">'</code><code class="p">,</code><code>  </code><code class="s1">'</code><code class="s1">CLOSE</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">AAPL.O</code><code class="s1">'</code><code class="p">,</code><code>    </code><code class="s1">'</code><code class="s1">LOW</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">AAPL.O</code><code class="s1">'</code><code class="p">,</code><code>   </code><code class="s1">'</code><code class="s1">OPEN</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">AAPL.O</code><code class="s1">'</code><code class="p">,</code><code>  </code><code class="s1">'</code><code class="s1">COUNT</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">AAPL.O</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">VOLUME</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">MSFT.O</code><code class="s1">'</code><code class="p">,</code><code>   </code><code class="s1">'</code><code class="s1">HIGH</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">MSFT.O</code><code class="s1">'</code><code class="p">,</code><code>  </code><code class="s1">'</code><code class="s1">CLOSE</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">MSFT.O</code><code class="s1">'</code><code class="p">,</code><code>    </code><code class="s1">'</code><code class="s1">LOW</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">MSFT.O</code><code class="s1">'</code><code class="p">,</code><code>   </code><code class="s1">'</code><code class="s1">OPEN</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">MSFT.O</code><code class="s1">'</code><code class="p">,</code><code>  </code><code class="s1">'</code><code class="s1">COUNT</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">MSFT.O</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">VOLUME</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">GOOG.O</code><code class="s1">'</code><code class="p">,</code><code>   </code><code class="s1">'</code><code class="s1">HIGH</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">GOOG.O</code><code class="s1">'</code><code class="p">,</code><code>  </code><code class="s1">'</code><code class="s1">CLOSE</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">GOOG.O</code><code class="s1">'</code><code class="p">,</code><code>    </code><code class="s1">'</code><code class="s1">LOW</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">GOOG.O</code><code class="s1">'</code><code class="p">,</code><code>   </code><code class="s1">'</code><code class="s1">OPEN</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">GOOG.O</code><code class="s1">'</code><code class="p">,</code><code>  </code><code class="s1">'</code><code class="s1">COUNT</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                     </code><code class="p">(</code><code class="s1">'</code><code class="s1">GOOG.O</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">VOLUME</code><code class="s1">'</code><code class="p">)</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>                    </code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">42</code><code class="p">]</code><code class="p">:</code><code> </code><code class="nb">type</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">AAPL.O</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO10-8" id="co_working_with_financial_data_CO10-8"><img alt="8" src="assets/8.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">42</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">43</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">AAPL.O</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO10-9" id="co_working_with_financial_data_CO10-9"><img alt="9" src="assets/9.png"/></a><code>&#13;
</code><code>         </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>         </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">84</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">02</code><code> </code><code class="n">to</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code>&#13;
</code><code>         </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">6</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>          </code><code class="c1">#   Column  Non-Null Count  Dtype</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>          </code><code class="mi">0</code><code>   </code><code class="n">HIGH</code><code>    </code><code class="mi">84</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">1</code><code>   </code><code class="n">CLOSE</code><code>   </code><code class="mi">84</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">2</code><code>   </code><code class="n">LOW</code><code>     </code><code class="mi">84</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">3</code><code>   </code><code class="n">OPEN</code><code>    </code><code class="mi">84</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">4</code><code>   </code><code class="n">COUNT</code><code>   </code><code class="mi">84</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">Int64</code><code>&#13;
</code><code>          </code><code class="mi">5</code><code>   </code><code class="n">VOLUME</code><code>  </code><code class="mi">84</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>     </code><code class="n">Int64</code><code>&#13;
</code><code>         </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">Int64</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">4</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">4.8</code><code> </code><code class="n">KB</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">44</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">AAPL.O</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">tail</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO10-10" id="co_working_with_financial_data_CO10-10"><img alt="10" src="assets/10.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">44</code><code class="p">]</code><code class="p">:</code><code>               </code><code class="n">HIGH</code><code>   </code><code class="n">CLOSE</code><code>     </code><code class="n">LOW</code><code>    </code><code class="n">OPEN</code><code>   </code><code class="n">COUNT</code><code>    </code><code class="n">VOLUME</code><code>&#13;
</code><code>         </code><code class="n">Date</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">27</code><code>  </code><code class="mf">284.54</code><code>  </code><code class="mf">283.17</code><code>  </code><code class="mf">279.95</code><code>  </code><code class="mf">281.80</code><code>  </code><code class="mi">300771</code><code>  </code><code class="mi">29271893</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">28</code><code>  </code><code class="mf">285.83</code><code>  </code><code class="mf">278.58</code><code>  </code><code class="mf">278.20</code><code>  </code><code class="mf">285.08</code><code>  </code><code class="mi">285384</code><code>  </code><code class="mi">28001187</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">29</code><code>  </code><code class="mf">289.67</code><code>  </code><code class="mf">287.73</code><code>  </code><code class="mf">283.89</code><code>  </code><code class="mf">284.73</code><code>  </code><code class="mi">324890</code><code>  </code><code class="mi">34320204</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">30</code><code>  </code><code class="mf">294.53</code><code>  </code><code class="mf">293.80</code><code>  </code><code class="mf">288.35</code><code>  </code><code class="mf">289.96</code><code>  </code><code class="mi">471129</code><code>  </code><code class="mi">45765968</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">05</code><code class="o">-</code><code class="mo">01</code><code>  </code><code class="mf">299.00</code><code>  </code><code class="mf">289.07</code><code>  </code><code class="mf">285.85</code><code>  </code><code class="mf">286.25</code><code>  </code><code class="mi">558319</code><code>  </code><code class="mi">60154175</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO10-1" id="callout_working_with_financial_data_CO10-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Defines a few symbols as a <code>list</code> object.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO10-2" id="callout_working_with_financial_data_CO10-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>The central line of code that retrieves data for the first symbol…</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO10-3" id="callout_working_with_financial_data_CO10-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>…for the given start date and…</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO10-4" id="callout_working_with_financial_data_CO10-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>…the given end date.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO10-5" id="callout_working_with_financial_data_CO10-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>The time interval is here chosen to be <code>daily</code>.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO10-6" id="callout_working_with_financial_data_CO10-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>All fields are requested.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO10-7" id="callout_working_with_financial_data_CO10-7"><img alt="7" src="assets/7.png"/></a></dt>&#13;
<dd><p>The function <code>get_timeseries()</code> returns a multi-index <code>DataFrame</code> object.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO10-8" id="callout_working_with_financial_data_CO10-8"><img alt="8" src="assets/8.png"/></a></dt>&#13;
<dd><p>The values corresponding to each level are regular <code>DataFrame</code> objects.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO10-9" id="callout_working_with_financial_data_CO10-9"><img alt="9" src="assets/9.png"/></a></dt>&#13;
<dd><p>This provides an overview of the data stored in the <code>DataFrame</code> object.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO10-10" id="callout_working_with_financial_data_CO10-10"><img alt="10" src="assets/10.png"/></a></dt>&#13;
<dd><p>The final five rows of data are shown.</p></dd>&#13;
</dl>&#13;
&#13;
<p>The beauty of working with a professional data service API becomes evident when one wishes to work with multiple symbols and in particular with a different granularity of the financial data (that is, other time intervals):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">45</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="o">%</code><code class="n">time</code><code>&#13;
</code><code>         </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">ek</code><code class="o">.</code><code class="n">get_timeseries</code><code class="p">(</code><code class="n">symbols</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO11-1" id="co_working_with_financial_data_CO11-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>                                  </code><code class="n">start_date</code><code class="o">=</code><code class="s1">'</code><code class="s1">2020-08-14</code><code class="s1">'</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO11-2" id="co_working_with_financial_data_CO11-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>                                  </code><code class="n">end_date</code><code class="o">=</code><code class="s1">'</code><code class="s1">2020-08-15</code><code class="s1">'</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO11-3" id="co_working_with_financial_data_CO11-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>                                  </code><code class="n">interval</code><code class="o">=</code><code class="s1">'</code><code class="s1">minute</code><code class="s1">'</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO11-4" id="co_working_with_financial_data_CO11-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>                                  </code><code class="n">fields</code><code class="o">=</code><code class="s1">'</code><code class="s1">*</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mf">58.2</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mf">3.16</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mf">61.4</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>         </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mf">2.02</code><code> </code><code class="n">s</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">46</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">print</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="s1">'</code><code class="s1">GOOG.O</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">loc</code><code class="p">[</code><code class="s1">'</code><code class="s1">2020-08-14 16:00:00</code><code class="s1">'</code><code class="p">:</code><code>&#13;
</code><code>                                  </code><code class="s1">'</code><code class="s1">2020-08-14 16:04:00</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO11-5" id="co_working_with_financial_data_CO11-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>&#13;
</code><code>                               </code><code class="n">HIGH</code><code>       </code><code class="n">LOW</code><code>      </code><code class="n">OPEN</code><code>     </code><code class="n">CLOSE</code><code>   </code><code class="n">COUNT</code><code> </code><code class="n">VOLUME</code><code>&#13;
</code><code>     </code><code class="n">Date</code><code>&#13;
</code><code>&#13;
</code><code>     </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">16</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1510.7439</code><code>  </code><code class="mf">1509.220</code><code>  </code><code class="mf">1509.940</code><code>  </code><code class="mf">1510.5239</code><code>     </code><code class="mi">48</code><code>   </code><code class="mi">1362</code><code>&#13;
</code><code>     </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">16</code><code class="p">:</code><code class="mo">01</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1511.2900</code><code>  </code><code class="mf">1509.980</code><code>  </code><code class="mf">1510.500</code><code>  </code><code class="mf">1511.2900</code><code>     </code><code class="mi">52</code><code>   </code><code class="mi">1002</code><code>&#13;
</code><code>     </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">16</code><code class="p">:</code><code class="mo">02</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1513.0000</code><code>  </code><code class="mf">1510.964</code><code>  </code><code class="mf">1510.964</code><code>  </code><code class="mf">1512.8600</code><code>     </code><code class="mi">72</code><code>   </code><code class="mi">1762</code><code>&#13;
</code><code>     </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">16</code><code class="p">:</code><code class="mo">03</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1513.6499</code><code>  </code><code class="mf">1512.160</code><code>  </code><code class="mf">1512.990</code><code>  </code><code class="mf">1513.2300</code><code>    </code><code class="mi">108</code><code>   </code><code class="mi">4534</code><code>&#13;
</code><code>     </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">16</code><code class="p">:</code><code class="mo">04</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1513.6500</code><code>  </code><code class="mf">1511.540</code><code>  </code><code class="mf">1513.418</code><code>  </code><code class="mf">1512.7100</code><code>     </code><code class="mi">40</code><code>   </code><code class="mi">1364</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">47</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">for</code><code> </code><code class="n">sym</code><code> </code><code class="ow">in</code><code> </code><code class="n">symbols</code><code class="p">:</code><code>&#13;
</code><code>             </code><code class="k">print</code><code class="p">(</code><code class="s1">'</code><code class="se">\n</code><code class="s1">'</code><code> </code><code class="o">+</code><code> </code><code class="n">sym</code><code> </code><code class="o">+</code><code> </code><code class="s1">'</code><code class="se">\n</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">data</code><code class="p">[</code><code class="n">sym</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="o">-</code><code class="mi">300</code><code class="p">:</code><code class="o">-</code><code class="mi">295</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO11-6" id="co_working_with_financial_data_CO11-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>&#13;
</code><code>       </code><code class="n">AAPL</code><code class="o">.</code><code class="n">O</code><code>&#13;
</code><code>                                </code><code class="n">HIGH</code><code>       </code><code class="n">LOW</code><code>      </code><code class="n">OPEN</code><code>    </code><code class="n">CLOSE</code><code>  </code><code class="n">COUNT</code><code>  </code><code class="n">VOLUME</code><code>&#13;
</code><code>       </code><code class="n">Date</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">01</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">457.1699</code><code>  </code><code class="mf">456.6300</code><code>    </code><code class="mf">457.14</code><code>   </code><code class="mf">456.83</code><code>   </code><code class="mi">1457</code><code>  </code><code class="mi">104693</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">02</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">456.9399</code><code>  </code><code class="mf">456.4255</code><code>    </code><code class="mf">456.81</code><code>   </code><code class="mf">456.45</code><code>   </code><code class="mi">1178</code><code>   </code><code class="mi">79740</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">03</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">456.8199</code><code>  </code><code class="mf">456.4402</code><code>    </code><code class="mf">456.45</code><code>   </code><code class="mf">456.67</code><code>    </code><code class="mi">908</code><code>   </code><code class="mi">68517</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">04</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">456.9800</code><code>  </code><code class="mf">456.6100</code><code>    </code><code class="mf">456.67</code><code>   </code><code class="mf">456.97</code><code>    </code><code class="mi">665</code><code>   </code><code class="mi">53649</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">05</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">457.1900</code><code>  </code><code class="mf">456.9300</code><code>    </code><code class="mf">456.98</code><code>   </code><code class="mf">457.00</code><code>    </code><code class="mi">679</code><code>   </code><code class="mi">49636</code><code>&#13;
</code><code>&#13;
</code><code>       </code><code class="n">MSFT</code><code class="o">.</code><code class="n">O</code><code>&#13;
</code><code>                                </code><code class="n">HIGH</code><code>       </code><code class="n">LOW</code><code>      </code><code class="n">OPEN</code><code>     </code><code class="n">CLOSE</code><code>  </code><code class="n">COUNT</code><code> </code><code class="n">VOLUME</code><code>&#13;
</code><code>       </code><code class="n">Date</code><code>&#13;
</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">01</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">208.6300</code><code>  </code><code class="mf">208.5083</code><code>  </code><code class="mf">208.5500</code><code>  </code><code class="mf">208.5674</code><code>    </code><code class="mi">333</code><code>  </code><code class="mi">21368</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">02</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">208.5750</code><code>  </code><code class="mf">208.3550</code><code>  </code><code class="mf">208.5501</code><code>  </code><code class="mf">208.3600</code><code>    </code><code class="mi">513</code><code>  </code><code class="mi">37270</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">03</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">208.4923</code><code>  </code><code class="mf">208.3000</code><code>  </code><code class="mf">208.3600</code><code>  </code><code class="mf">208.4000</code><code>    </code><code class="mi">303</code><code>  </code><code class="mi">23903</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">04</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">208.4200</code><code>  </code><code class="mf">208.3301</code><code>  </code><code class="mf">208.3901</code><code>  </code><code class="mf">208.4099</code><code>    </code><code class="mi">222</code><code>  </code><code class="mi">15861</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">05</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">208.4699</code><code>  </code><code class="mf">208.3600</code><code>  </code><code class="mf">208.3920</code><code>  </code><code class="mf">208.4069</code><code>    </code><code class="mi">235</code><code>   </code><code class="mi">9569</code><code>&#13;
</code><code>&#13;
</code><code>       </code><code class="n">GOOG</code><code class="o">.</code><code class="n">O</code><code>&#13;
</code><code>                                </code><code class="n">HIGH</code><code>       </code><code class="n">LOW</code><code>       </code><code class="n">OPEN</code><code>   </code><code class="n">CLOSE</code><code>   </code><code class="n">COUNT</code><code> </code><code class="n">VOLUME</code><code>&#13;
</code><code>       </code><code class="n">Date</code><code>&#13;
</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">01</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1510.42</code><code>  </code><code class="mf">1509.3288</code><code>  </code><code class="mf">1509.5100</code><code>  </code><code class="mf">1509.8550</code><code>   </code><code class="mi">47</code><code>   </code><code class="mi">1577</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">02</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1510.30</code><code>  </code><code class="mf">1508.8000</code><code>  </code><code class="mf">1509.7559</code><code>  </code><code class="mf">1508.8647</code><code>   </code><code class="mi">71</code><code>   </code><code class="mi">2950</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">03</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1510.21</code><code>  </code><code class="mf">1508.7200</code><code>  </code><code class="mf">1508.7200</code><code>  </code><code class="mf">1509.8100</code><code>   </code><code class="mi">33</code><code>    </code><code class="mi">603</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">04</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1510.21</code><code>  </code><code class="mf">1508.7200</code><code>  </code><code class="mf">1509.8800</code><code>  </code><code class="mf">1509.8299</code><code>   </code><code class="mi">41</code><code>    </code><code class="mi">934</code><code>&#13;
</code><code>       </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">19</code><code class="p">:</code><code class="mo">05</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">1510.21</code><code>  </code><code class="mf">1508.7300</code><code>  </code><code class="mf">1509.5500</code><code>  </code><code class="mf">1509.6600</code><code>   </code><code class="mi">30</code><code>    </code><code class="mi">445</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO11-1" id="callout_working_with_financial_data_CO11-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Data is retrieved for all symbols at once.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO11-2" id="callout_working_with_financial_data_CO11-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>The time interval…</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO11-3" id="callout_working_with_financial_data_CO11-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>…is drastically shortened.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO11-4" id="callout_working_with_financial_data_CO11-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>The function call retrieves minute bars for the symbols.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO11-5" id="callout_working_with_financial_data_CO11-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Prints five rows from the Google, LLC, data set.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO11-6" id="callout_working_with_financial_data_CO11-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>Prints three data rows from every <code>DataFrame</code> object.</p></dd>&#13;
</dl>&#13;
&#13;
<p>The preceding code illustrates how convenient it is to retrieve historical financial time series data from the Eikon API with Python. <a data-primary="get_timeseries() function" data-type="indexterm" id="idm45785388370168"/>By default, the function <code>get_timeseries()</code> provides the following options for the <code>interval</code> parameter: <code>tick</code>, <code>minute</code>, <code>hour</code>, <code>daily</code>, <code>weekly</code>, <code>monthly</code>, <code>quarterly</code>, and <code>yearly</code>. This gives all the flexibility needed in an algorithmic trading context, particularly when combined with the resampling capabilities of <code>pandas</code> as shown in the following code:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">48</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="o">%</code><code class="n">time</code><code>&#13;
</code><code>         </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">ek</code><code class="o">.</code><code class="n">get_timeseries</code><code class="p">(</code><code class="n">symbols</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>                                  </code><code class="n">start_date</code><code class="o">=</code><code class="s1">'</code><code class="s1">2020-08-14 15:00:00</code><code class="s1">'</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO12-1" id="co_working_with_financial_data_CO12-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>                                  </code><code class="n">end_date</code><code class="o">=</code><code class="s1">'</code><code class="s1">2020-08-14 15:30:00</code><code class="s1">'</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO12-2" id="co_working_with_financial_data_CO12-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>                                  </code><code class="n">interval</code><code class="o">=</code><code class="s1">'</code><code class="s1">tick</code><code class="s1">'</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO12-3" id="co_working_with_financial_data_CO12-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>                                  </code><code class="n">fields</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">*</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mi">257</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mf">17.3</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mi">274</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>         </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mf">2.31</code><code> </code><code class="n">s</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">49</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO12-4" id="co_working_with_financial_data_CO12-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>         </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>         </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">47346</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">15</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mf">00.019000</code><code> </code><code class="n">to</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code>&#13;
</code><code>          </code><code class="mi">15</code><code class="p">:</code><code class="mi">29</code><code class="p">:</code><code class="mf">59.987000</code><code>&#13;
</code><code>         </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">2</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>          </code><code class="c1">#   Column  Non-Null Count  Dtype</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>          </code><code class="mi">0</code><code>   </code><code class="n">VALUE</code><code>   </code><code class="mi">47311</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">1</code><code>   </code><code class="n">VOLUME</code><code>  </code><code class="mi">47346</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">Int64</code><code>&#13;
</code><code>         </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">Int64</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">1.1</code><code> </code><code class="n">MB</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">50</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO12-5" id="co_working_with_financial_data_CO12-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">50</code><code class="p">]</code><code class="p">:</code><code>                             </code><code class="n">VALUE</code><code>  </code><code class="n">VOLUME</code><code>&#13;
</code><code>         </code><code class="n">Date</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">15</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mf">00.019</code><code>  </code><code class="mf">453.2499</code><code>      </code><code class="mi">60</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">15</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mf">00.036</code><code>  </code><code class="mf">453.2294</code><code>       </code><code class="mi">3</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">15</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mf">00.146</code><code>  </code><code class="mf">453.2100</code><code>       </code><code class="mi">5</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">15</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mf">00.146</code><code>  </code><code class="mf">453.2100</code><code>     </code><code class="mi">100</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">15</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mf">00.236</code><code>  </code><code class="mf">453.2100</code><code>       </code><code class="mi">2</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">51</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">resampled</code><code> </code><code class="o">=</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'</code><code class="s1">30s</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">label</code><code class="o">=</code><code class="s1">'</code><code class="s1">right</code><code class="s1">'</code><code class="p">)</code><code class="o">.</code><code class="n">agg</code><code class="p">(</code><code>&#13;
</code><code>                     </code><code class="p">{</code><code class="s1">'</code><code class="s1">VALUE</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">last</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">VOLUME</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">sum</code><code class="s1">'</code><code class="p">}</code><code class="p">)</code><code> </code><a class="co" href="#callout_working_with_financial_data_CO12-6" id="co_working_with_financial_data_CO12-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">52</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">resampled</code><code class="o">.</code><code class="n">tail</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO12-7" id="co_working_with_financial_data_CO12-7"><img alt="7" src="assets/7.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">52</code><code class="p">]</code><code class="p">:</code><code>                         </code><code class="n">VALUE</code><code>  </code><code class="n">VOLUME</code><code>&#13;
</code><code>         </code><code class="n">Date</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">15</code><code class="p">:</code><code class="mi">28</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">453.9000</code><code>   </code><code class="mi">29746</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">15</code><code class="p">:</code><code class="mi">28</code><code class="p">:</code><code class="mi">30</code><code>  </code><code class="mf">454.2869</code><code>   </code><code class="mi">86441</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">15</code><code class="p">:</code><code class="mi">29</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">454.3900</code><code>   </code><code class="mi">49513</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">15</code><code class="p">:</code><code class="mi">29</code><code class="p">:</code><code class="mi">30</code><code>  </code><code class="mf">454.7550</code><code>   </code><code class="mi">98520</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mi">08</code><code class="o">-</code><code class="mi">14</code><code> </code><code class="mi">15</code><code class="p">:</code><code class="mi">30</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">454.6200</code><code>   </code><code class="mi">55592</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO12-1" id="callout_working_with_financial_data_CO12-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>A time interval of…</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO12-2" id="callout_working_with_financial_data_CO12-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>…one hour is chosen (due to data retrieval limits).</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO12-3" id="callout_working_with_financial_data_CO12-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>The <code>interval</code> parameter is set to <code>tick</code>.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO12-4" id="callout_working_with_financial_data_CO12-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Close to 50,000 price ticks are retrieved for the interval.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO12-5" id="callout_working_with_financial_data_CO12-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>The time series data set shows highly irregular (heterogeneous) interval lengths between two ticks.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO12-6" id="callout_working_with_financial_data_CO12-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>The tick data is resampled to a 30 second interval length (by taking the last value  and the sum, respectively)…</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO12-7" id="callout_working_with_financial_data_CO12-7"><img alt="7" src="assets/7.png"/></a></dt>&#13;
<dd><p>…which is reflected in the <code>DatetimeIndex</code> of the new <code>DataFrame</code> object.<a data-startref="ix_03_working_with_financial_data_-asciidoc12" data-type="indexterm" id="idm45785388524968"/></p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Retrieving Historical Unstructured Data" data-type="sect2"><div class="sect2" id="idm45785391771848">&#13;
<h2>Retrieving Historical Unstructured Data</h2>&#13;
&#13;
<p><a data-primary="Eikon Data API" data-secondary="retrieving historical unstructured data" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc13"/>A major strength of working with the Eikon API via Python is the easy retrieval of unstructured data, which can then be parsed and analyzed with Python packages for <a data-primary="natural language processing (NLP)" data-type="indexterm" id="idm45785388592920"/><a data-primary="NLP (natural language processing)" data-type="indexterm" id="idm45785388592280"/>natural language processing (NLP). Such a procedure is as simple and straightforward as for financial time series data.</p>&#13;
&#13;
<p class="pagebreak-before">The code that follows retrieves news headlines for a fixed time interval that includes <a data-primary="Apple, Inc." data-secondary="retrieving historical unstructured data about" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc14"/>Apple Inc. as a company and “Macbook” as a word. The five most recent hits are displayed as a maximum:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">53</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">headlines</code><code> </code><code class="o">=</code><code> </code><code class="n">ek</code><code class="o">.</code><code class="n">get_news_headlines</code><code class="p">(</code><code class="n">query</code><code class="o">=</code><code class="s1">'</code><code class="s1">R:AAPL.O macbook</code><code class="s1">'</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO13-1" id="co_working_with_financial_data_CO13-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>                                           </code><code class="n">count</code><code class="o">=</code><code class="mi">5</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO13-2" id="co_working_with_financial_data_CO13-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>                                           </code><code class="n">date_from</code><code class="o">=</code><code class="s1">'</code><code class="s1">2020-4-1</code><code class="s1">'</code><code class="p">,</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO13-3" id="co_working_with_financial_data_CO13-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>                                           </code><code class="n">date_to</code><code class="o">=</code><code class="s1">'</code><code class="s1">2020-5-1</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO13-4" id="co_working_with_financial_data_CO13-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">54</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">headlines</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO13-5" id="co_working_with_financial_data_CO13-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">54</code><code class="p">]</code><code class="p">:</code><code>                                           </code><code class="n">versionCreated</code><code>  </code><code>\&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">33</code><code class="p">:</code><code class="mf">37.332</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">33</code><code class="p">:</code><code class="mf">37.332000</code><code class="o">+</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">10</code><code class="p">:</code><code class="mi">20</code><code class="p">:</code><code class="mf">23.201</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">10</code><code class="p">:</code><code class="mi">20</code><code class="p">:</code><code class="mf">23.201000</code><code class="o">+</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mo">02</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">27.721</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mo">02</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">27.721000</code><code class="o">+</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">15</code><code> </code><code class="mi">12</code><code class="p">:</code><code class="mo">06</code><code class="p">:</code><code class="mf">58.693</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">15</code><code> </code><code class="mi">12</code><code class="p">:</code><code class="mo">06</code><code class="p">:</code><code class="mf">58.693000</code><code class="o">+</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">09</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">34</code><code class="p">:</code><code class="mf">08.671</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">09</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">34</code><code class="p">:</code><code class="mf">08.671000</code><code class="o">+</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>&#13;
</code><code>                                                                             </code><code class="n">text</code><code>  </code><code>\&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">33</code><code class="p">:</code><code class="mf">37.332</code><code>  </code><code class="n">Apple</code><code> </code><code class="n">said</code><code> </code><code class="n">to</code><code> </code><code class="n">launch</code><code> </code><code class="n">new</code><code> </code><code class="n">AirPods</code><code class="p">,</code><code> </code><code class="n">MacBook</code><code> </code><code class="n">Pro</code><code> </code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">10</code><code class="p">:</code><code class="mi">20</code><code class="p">:</code><code class="mf">23.201</code><code>  </code><code class="n">Apple</code><code> </code><code class="n">might</code><code> </code><code class="n">launch</code><code> </code><code class="n">upgraded</code><code> </code><code class="n">AirPods</code><code class="p">,</code><code> </code><code class="mi">13</code><code class="o">-</code><code class="n">inch</code><code> </code><code class="n">M</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mo">02</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">27.721</code><code>  </code><code class="n">Apple</code><code> </code><code class="n">to</code><code> </code><code class="n">reportedly</code><code> </code><code class="n">launch</code><code> </code><code class="n">new</code><code> </code><code class="n">AirPods</code><code> </code><code class="n">alongsi</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">15</code><code> </code><code class="mi">12</code><code class="p">:</code><code class="mo">06</code><code class="p">:</code><code class="mf">58.693</code><code>  </code><code class="n">Apple</code><code> </code><code class="n">files</code><code> </code><code class="n">a</code><code> </code><code class="n">patent</code><code> </code><code class="k">for</code><code> </code><code class="n">iPhones</code><code class="p">,</code><code> </code><code class="n">MacBook</code><code> </code><code class="n">indu</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">09</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">34</code><code class="p">:</code><code class="mf">08.671</code><code>  </code><code class="n">Apple</code><code> </code><code class="n">rolls</code><code> </code><code class="n">out</code><code> </code><code class="n">new</code><code> </code><code class="n">software</code><code> </code><code class="n">update</code><code> </code><code class="k">for</code><code> </code><code class="n">MacBoo</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>&#13;
</code><code>&#13;
</code><code>                                                                       </code><code class="n">storyId</code><code>  </code><code>\&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">33</code><code class="p">:</code><code class="mf">37.332</code><code>  </code><code class="n">urn</code><code class="p">:</code><code class="n">newsml</code><code class="p">:</code><code class="n">reuters</code><code class="o">.</code><code class="n">com</code><code class="p">:</code><code class="mi">20200420</code><code class="p">:</code><code class="n">nNRAble9rq</code><code class="p">:</code><code class="mi">1</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">10</code><code class="p">:</code><code class="mi">20</code><code class="p">:</code><code class="mf">23.201</code><code>  </code><code class="n">urn</code><code class="p">:</code><code class="n">newsml</code><code class="p">:</code><code class="n">reuters</code><code class="o">.</code><code class="n">com</code><code class="p">:</code><code class="mi">20200420</code><code class="p">:</code><code class="n">nNRAbl8eob</code><code class="p">:</code><code class="mi">1</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mo">02</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">27.721</code><code>  </code><code class="n">urn</code><code class="p">:</code><code class="n">newsml</code><code class="p">:</code><code class="n">reuters</code><code class="o">.</code><code class="n">com</code><code class="p">:</code><code class="mi">20200420</code><code class="p">:</code><code class="n">nNRAbl4mfz</code><code class="p">:</code><code class="mi">1</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">15</code><code> </code><code class="mi">12</code><code class="p">:</code><code class="mo">06</code><code class="p">:</code><code class="mf">58.693</code><code>  </code><code class="n">urn</code><code class="p">:</code><code class="n">newsml</code><code class="p">:</code><code class="n">reuters</code><code class="o">.</code><code class="n">com</code><code class="p">:</code><code class="mi">20200415</code><code class="p">:</code><code class="n">nNRAbjvsix</code><code class="p">:</code><code class="mi">1</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">09</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">34</code><code class="p">:</code><code class="mf">08.671</code><code>  </code><code class="n">urn</code><code class="p">:</code><code class="n">newsml</code><code class="p">:</code><code class="n">reuters</code><code class="o">.</code><code class="n">com</code><code class="p">:</code><code class="mi">20200409</code><code class="p">:</code><code class="n">nNRAbi2nbb</code><code class="p">:</code><code class="mi">1</code><code>&#13;
</code><code>&#13;
</code><code>                                 </code><code class="n">sourceCode</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">33</code><code class="p">:</code><code class="mf">37.332</code><code>  </code><code class="n">NS</code><code class="p">:</code><code class="n">TIMIND</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">10</code><code class="p">:</code><code class="mi">20</code><code class="p">:</code><code class="mf">23.201</code><code>  </code><code class="n">NS</code><code class="p">:</code><code class="n">BUSSTA</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mo">02</code><code class="p">:</code><code class="mi">32</code><code class="p">:</code><code class="mf">27.721</code><code>  </code><code class="n">NS</code><code class="p">:</code><code class="n">HINDUT</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">15</code><code> </code><code class="mi">12</code><code class="p">:</code><code class="mo">06</code><code class="p">:</code><code class="mf">58.693</code><code>  </code><code class="n">NS</code><code class="p">:</code><code class="n">HINDUT</code><code>&#13;
</code><code>         </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">09</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">34</code><code class="p">:</code><code class="mf">08.671</code><code>  </code><code class="n">NS</code><code class="p">:</code><code class="n">TIMIND</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">55</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">story</code><code> </code><code class="o">=</code><code> </code><code class="n">headlines</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO13-6" id="co_working_with_financial_data_CO13-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">56</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">story</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO13-7" id="co_working_with_financial_data_CO13-7"><img alt="7" src="assets/7.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">56</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">versionCreated</code><code>                     </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">33</code><code class="p">:</code><code class="mf">37.332000</code><code class="o">+</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>         </code><code class="n">text</code><code>              </code><code class="n">Apple</code><code> </code><code class="n">said</code><code> </code><code class="n">to</code><code> </code><code class="n">launch</code><code> </code><code class="n">new</code><code> </code><code class="n">AirPods</code><code class="p">,</code><code> </code><code class="n">MacBook</code><code> </code><code class="n">Pro</code><code> </code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>&#13;
</code><code>         </code><code class="n">storyId</code><code>                </code><code class="n">urn</code><code class="p">:</code><code class="n">newsml</code><code class="p">:</code><code class="n">reuters</code><code class="o">.</code><code class="n">com</code><code class="p">:</code><code class="mi">20200420</code><code class="p">:</code><code class="n">nNRAble9rq</code><code class="p">:</code><code class="mi">1</code><code>&#13;
</code><code>         </code><code class="n">sourceCode</code><code>                                                </code><code class="n">NS</code><code class="p">:</code><code class="n">TIMIND</code><code>&#13;
</code><code>         </code><code class="n">Name</code><code class="p">:</code><code> </code><code class="mi">2020</code><code class="o">-</code><code class="mo">04</code><code class="o">-</code><code class="mi">20</code><code> </code><code class="mi">21</code><code class="p">:</code><code class="mi">33</code><code class="p">:</code><code class="mf">37.332000</code><code class="p">,</code><code> </code><code class="n">dtype</code><code class="p">:</code><code> </code><code class="nb">object</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">57</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">news_text</code><code> </code><code class="o">=</code><code> </code><code class="n">ek</code><code class="o">.</code><code class="n">get_news_story</code><code class="p">(</code><code class="n">story</code><code class="p">[</code><code class="s1">'</code><code class="s1">storyId</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO13-8" id="co_working_with_financial_data_CO13-8"><img alt="8" src="assets/8.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">58</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">from</code><code> </code><code class="nn">IPython.display</code><code> </code><code class="kn">import</code><code> </code><code class="n">HTML</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO13-9" id="co_working_with_financial_data_CO13-9"><img alt="9" src="assets/9.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">59</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">HTML</code><code class="p">(</code><code class="n">news_text</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO13-10" id="co_working_with_financial_data_CO13-10"><img alt="10" src="assets/10.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">59</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">&lt;</code><code class="n">IPython</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">display</code><code class="o">.</code><code class="n">HTML</code><code> </code><code class="nb">object</code><code class="o">&gt;</code></pre>&#13;
&#13;
<pre data-type="programlisting">NEW DELHI: Apple recently launched its much-awaited affordable smartphone&#13;
iPhone SE. Now it seems that the company is gearing up for another launch.&#13;
Apple is said to launch the next generation of AirPods and the all-new&#13;
13-inch MacBook Pro next month.&#13;
&#13;
In February an online report revealed that the Cupertino-based tech giant&#13;
is working on AirPods Pro Lite. Now a tweet by tipster Job Posser has&#13;
revealed that Apple will soon come up with new AirPods and MacBook Pro.&#13;
Jon Posser tweeted, "New AirPods (which were supposed to be at the&#13;
March Event) is now ready to go.&#13;
&#13;
Probably alongside the MacBook Pro next month." However, not many details&#13;
about the upcoming products are available right now. The company was&#13;
supposed to launch these products at the March event along with the iPhone SE.&#13;
&#13;
But due to the ongoing pandemic coronavirus, the event got cancelled.&#13;
It is expected that Apple will launch the AirPods Pro Lite and the 13-inch&#13;
MacBook Pro just like the way it launched the iPhone SE. Meanwhile,&#13;
Apple has scheduled its annual developer conference WWDC to take place in June.&#13;
&#13;
This year the company has decided to hold an online-only event due to&#13;
the outbreak of coronavirus. Reports suggest that this year the company&#13;
is planning to launch the all-new AirTags and a premium pair of over-ear&#13;
Bluetooth headphones at the event. Using the Apple AirTags, users will&#13;
be able to locate real-world items such as keys or suitcase in the Find My app.&#13;
&#13;
The AirTags will also have offline finding capabilities that the company&#13;
introduced in the core of iOS 13. Apart from this, Apple is also said to&#13;
unveil its high-end Bluetooth headphones. It is expected that the Bluetooth&#13;
headphones will offer better sound quality and battery backup as compared&#13;
to the AirPods.&#13;
&#13;
For Reprint Rights: timescontent.com&#13;
&#13;
Copyright (c) 2020 BENNETT, COLEMAN &amp; CO.LTD.</pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO13-1" id="callout_working_with_financial_data_CO13-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>The <code>query</code> parameter for the retrieval operation.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO13-2" id="callout_working_with_financial_data_CO13-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Sets the maximum number of hits to five.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO13-3" id="callout_working_with_financial_data_CO13-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Defines the interval…</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO13-4" id="callout_working_with_financial_data_CO13-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>…for which to look for news headlines.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO13-5" id="callout_working_with_financial_data_CO13-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Gives out the results object (output shortened).</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO13-6" id="callout_working_with_financial_data_CO13-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>One particular headline is picked…</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO13-7" id="callout_working_with_financial_data_CO13-7"><img alt="7" src="assets/7.png"/></a></dt>&#13;
<dd><p>…and the <code>story_id</code> shown.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO13-8" id="callout_working_with_financial_data_CO13-8"><img alt="8" src="assets/8.png"/></a></dt>&#13;
<dd><p>This retrieves the news text as html code.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO13-9" id="callout_working_with_financial_data_CO13-9"><img alt="9" src="assets/9.png"/></a></dt>&#13;
<dd><p>In <code>Jupyter Notebook</code>, for example, the html code…</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO13-10" id="callout_working_with_financial_data_CO13-10"><img alt="10" src="assets/10.png"/></a></dt>&#13;
<dd><p>…can be rendered for better reading.</p></dd>&#13;
</dl>&#13;
&#13;
<p>This concludes the illustration of the Python wrapper package for the Refinitiv Eikon data <a data-startref="ix_03_working_with_financial_data_-asciidoc14" data-type="indexterm" id="idm45785385317672"/>API<a data-startref="ix_03_working_with_financial_data_-asciidoc13" data-type="indexterm" id="idm45785385434888"/>.<a data-startref="ix_03_working_with_financial_data_-asciidoc11" data-type="indexterm" id="idm45785385434088"/><a data-startref="ix_03_working_with_financial_data_-asciidoc10" data-type="indexterm" id="idm45785385433416"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Storing Financial Data Efficiently" data-type="sect1"><div class="sect1" id="storing_data">&#13;
<h1>Storing Financial Data Efficiently</h1>&#13;
&#13;
<p><a data-primary="data storage" data-secondary="storing data efficiently" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc15"/><a data-primary="financial data, working with" data-secondary="storing data efficiently" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc16"/>In algorithmic trading, one of the most important scenarios for the management of data sets is “retrieve once, use multiple times.” Or from an input-output (IO) perspective, it is “write once, read multiple times.” In the first case, data might be retrieved from a web service and then used to backtest a strategy multiple times based on a temporary, in-memory copy of the data set. In the second case, tick data that is received continually is written to disk and later on again used multiple times for certain manipulations (like aggregations) in combination with a backtesting procedure.</p>&#13;
&#13;
<p>This section assumes that the in-memory data structure to store the data is a <code>pandas</code> <code>DataFrame</code> object, no matter from which source the data is acquired (from a CSV file, a web service, etc.).</p>&#13;
&#13;
<p>To have a somewhat meaningful data set available in terms of size, the section uses a sample financial data set generated by the use of pseudorandom numbers. <a data-primary="generate_sample_data()" data-type="indexterm" id="idm45785385354920"/><a data-type="xref" href="#sample_data">“Python Scripts”</a> presents the Python module with a function called <code>generate_sample_data()</code> that accomplishes the task.</p>&#13;
&#13;
<p>In principle, this function generates a sample financial data set in tabular form of arbitrary size (available memory, of course, sets a limit):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">60</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">from</code><code> </code><code class="nn">sample_data</code><code> </code><code class="kn">import</code><code> </code><code class="n">generate_sample_data</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO14-1" id="co_working_with_financial_data_CO14-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">61</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">print</code><code class="p">(</code><code class="n">generate_sample_data</code><code class="p">(</code><code class="n">rows</code><code class="o">=</code><code class="mi">5</code><code class="p">,</code><code> </code><code class="n">cols</code><code class="o">=</code><code class="mi">4</code><code class="p">)</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO14-2" id="co_working_with_financial_data_CO14-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>                                     </code><code class="n">No0</code><code>         </code><code class="n">No1</code><code>         </code><code class="n">No2</code><code>         </code><code class="n">No3</code><code>&#13;
</code><code>         </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">100.000000</code><code>  </code><code class="mf">100.000000</code><code>  </code><code class="mf">100.000000</code><code>  </code><code class="mf">100.000000</code><code>&#13;
</code><code>         </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mo">00</code><code class="p">:</code><code class="mo">01</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">100.019641</code><code>   </code><code class="mf">99.950661</code><code>  </code><code class="mf">100.052993</code><code>   </code><code class="mf">99.913841</code><code>&#13;
</code><code>         </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mo">00</code><code class="p">:</code><code class="mo">02</code><code class="p">:</code><code class="mo">00</code><code>   </code><code class="mf">99.998164</code><code>   </code><code class="mf">99.796667</code><code>  </code><code class="mf">100.109971</code><code>   </code><code class="mf">99.955398</code><code>&#13;
</code><code>         </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mo">00</code><code class="p">:</code><code class="mo">03</code><code class="p">:</code><code class="mo">00</code><code>  </code><code class="mf">100.051537</code><code>   </code><code class="mf">99.660550</code><code>  </code><code class="mf">100.136336</code><code>  </code><code class="mf">100.024150</code><code>&#13;
</code><code>         </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mo">00</code><code class="p">:</code><code class="mo">04</code><code class="p">:</code><code class="mo">00</code><code>   </code><code class="mf">99.984614</code><code>   </code><code class="mf">99.729158</code><code>  </code><code class="mf">100.210888</code><code>   </code><code class="mf">99.976584</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO14-1" id="callout_working_with_financial_data_CO14-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Imports the function from the Python script.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO14-2" id="callout_working_with_financial_data_CO14-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Prints a sample financial data set with five rows and four columns.</p></dd>&#13;
</dl>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Storing DataFrame Objects" data-type="sect2"><div class="sect2" id="idm45785388321512">&#13;
<h2>Storing DataFrame Objects</h2>&#13;
&#13;
<p><a data-primary="data storage" data-secondary="storing DataFrame objects" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc17"/><a data-primary="DataFrame objects" data-secondary="storing" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc18"/><a data-primary="HDFStore wrapper" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc19"/><a data-primary="pandas" data-secondary="storing DataFrame objects" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc20"/>The storage of a <code>pandas</code> <code>DataFrame</code> object as a whole is made simple by the <code>pandas</code> <code>HDFStore</code> wrapper functionality for the <a href="http://hdfgroup.org">HDF5</a> binary storage standard. It allows one to dump complete <code>DataFrame</code> objects in a single step to a file-based database object. To illustrate the implementation, the first step is to create a sample data set of meaningful size. Here the size of the <code>DataFrame</code> generated is about 420 MB:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">62</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="n">time</code><code> </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">generate_sample_data</code><code class="p">(</code><code class="n">rows</code><code class="o">=</code><code class="mf">5e6</code><code class="p">,</code><code> </code><code class="n">cols</code><code class="o">=</code><code class="mi">10</code><code class="p">)</code><code class="o">.</code><code class="n">round</code><code class="p">(</code><code class="mi">4</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO15-1" id="co_working_with_financial_data_CO15-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>         </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mf">3.88</code><code> </code><code class="n">s</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mi">830</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mf">4.71</code><code> </code><code class="n">s</code><code>&#13;
</code><code>         </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mf">4.72</code><code> </code><code class="n">s</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">63</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>         </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">5000000</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code> </code><code class="n">to</code><code> </code><code class="mi">2030</code><code class="o">-</code><code class="mo">07</code><code class="o">-</code><code class="mo">05</code><code>&#13;
</code><code>          </code><code class="mo">05</code><code class="p">:</code><code class="mi">19</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>         </code><code class="n">Freq</code><code class="p">:</code><code> </code><code class="n">T</code><code>&#13;
</code><code>         </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">10</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>          </code><code class="c1">#   Column  Dtype</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>          </code><code class="mi">0</code><code>   </code><code class="n">No0</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">1</code><code>   </code><code class="n">No1</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">2</code><code>   </code><code class="n">No2</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">3</code><code>   </code><code class="n">No3</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">4</code><code>   </code><code class="n">No4</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">5</code><code>   </code><code class="n">No5</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">6</code><code>   </code><code class="n">No6</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">7</code><code>   </code><code class="n">No7</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">8</code><code>   </code><code class="n">No8</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">9</code><code>   </code><code class="n">No9</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>         </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">419.6</code><code> </code><code class="n">MB</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO15-1" id="callout_working_with_financial_data_CO15-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>A sample financial data set with 5,000,000 rows and ten columns is generated; the generation takes a couple of seconds.</p></dd>&#13;
</dl>&#13;
&#13;
<p>The second step is to open a <code>HDFStore</code> object (that is, a HDF5 database file) on disk and to write the <code>DataFrame</code> object to it.<sup><a data-type="noteref" href="ch03.html#idm45785385472888" id="idm45785385472888-marker">1</a></sup> The size on disk of about 440 MB is a bit larger than for the in-memory <code>DataFrame</code> object. However, the writing speed is about five times faster than the in-memory generation of the sample data set.</p>&#13;
&#13;
<p class="pagebreak-before">Working in Python with binary stores like HDF5 database files usually gets you writing speeds close to the theoretical maximum of the hardware available:<sup><a data-type="noteref" href="ch03.html#idm45785385469896" id="idm45785385469896-marker">2</a></sup></p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">64</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">HDFStore</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/data.h5</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">w</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO16-1" id="co_working_with_financial_data_CO16-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">65</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="n">time</code><code> </code><code class="n">h5</code><code class="p">[</code><code class="s1">'</code><code class="s1">data</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">data</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO16-2" id="co_working_with_financial_data_CO16-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>         </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mi">356</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mi">472</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mi">828</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>         </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mf">1.08</code><code> </code><code class="n">s</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">66</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO16-3" id="co_working_with_financial_data_CO16-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">66</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">io</code><code class="o">.</code><code class="n">pytables</code><code class="o">.</code><code class="n">HDFStore</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>         </code><code class="n">File</code><code> </code><code class="n">path</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">/</code><code class="n">data</code><code class="o">.</code><code class="n">h5</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">67</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">ls</code><code> </code><code class="o">-</code><code class="n">n</code><code> </code><code class="n">data</code><code class="o">/</code><code class="n">data</code><code class="o">.</code><code class="o">*</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="n">rw</code><code class="o">-</code><code class="n">r</code><code class="o">-</code><code class="o">-</code><code class="n">r</code><code class="o">-</code><code class="o">-</code><code class="err">@</code><code> </code><code class="mi">1</code><code> </code><code class="mi">501</code><code>  </code><code class="mi">20</code><code>  </code><code class="mi">440007240</code><code> </code><code class="n">Aug</code><code> </code><code class="mi">25</code><code> </code><code class="mi">11</code><code class="p">:</code><code class="mi">48</code><code> </code><code class="n">data</code><code class="o">/</code><code class="n">data</code><code class="o">.</code><code class="n">h5</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">68</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code class="o">.</code><code class="n">close</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO16-4" id="co_working_with_financial_data_CO16-4"><img alt="4" src="assets/4.png"/></a></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO16-1" id="callout_working_with_financial_data_CO16-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>This opens the database file on disk for writing (and overwrites a potentially existing file with the same name).</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO16-2" id="callout_working_with_financial_data_CO16-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Writing the <code>DataFrame</code> object to disk takes less than a second.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO16-3" id="callout_working_with_financial_data_CO16-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>This prints out meta information for the database file.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO16-4" id="callout_working_with_financial_data_CO16-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>This closes the database file.</p></dd>&#13;
</dl>&#13;
&#13;
<p>The third step is to read the data from the file-based <code>HDFStore</code> object. Reading also generally takes place close to the theoretical maximum speed:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">69</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">HDFStore</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/data.h5</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO17-1" id="co_working_with_financial_data_CO17-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">70</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="n">time</code><code> </code><code class="n">data_copy</code><code> </code><code class="o">=</code><code> </code><code class="n">h5</code><code class="p">[</code><code class="s1">'</code><code class="s1">data</code><code class="s1">'</code><code class="p">]</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO17-2" id="co_working_with_financial_data_CO17-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>         </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mi">388</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mi">425</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mi">813</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>         </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mi">812</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">71</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data_copy</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>         </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">5000000</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code> </code><code class="n">to</code><code> </code><code class="mi">2030</code><code class="o">-</code><code class="mo">07</code><code class="o">-</code><code class="mo">05</code><code>&#13;
</code><code>          </code><code class="mo">05</code><code class="p">:</code><code class="mi">19</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>         </code><code class="n">Freq</code><code class="p">:</code><code> </code><code class="n">T</code><code>&#13;
</code><code>         </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">10</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>          </code><code class="c1">#   Column  Dtype</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>          </code><code class="mi">0</code><code>   </code><code class="n">No0</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">1</code><code>   </code><code class="n">No1</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">2</code><code>   </code><code class="n">No2</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">3</code><code>   </code><code class="n">No3</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">4</code><code>   </code><code class="n">No4</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">5</code><code>   </code><code class="n">No5</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">6</code><code>   </code><code class="n">No6</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">7</code><code>   </code><code class="n">No7</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">8</code><code>   </code><code class="n">No8</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">9</code><code>   </code><code class="n">No9</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>         </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">419.6</code><code> </code><code class="n">MB</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">72</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code class="o">.</code><code class="n">close</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">73</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rm</code><code> </code><code class="n">data</code><code class="o">/</code><code class="n">data</code><code class="o">.</code><code class="n">h5</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO17-1" id="callout_working_with_financial_data_CO17-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Opens the database file for reading.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO17-2" id="callout_working_with_financial_data_CO17-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Reading takes less than half of a second.</p></dd>&#13;
</dl>&#13;
&#13;
<p>There is another, somewhat more flexible way of writing the data from a <code>DataFrame</code> object to an <code>HDFStore</code> object. <a data-primary=".to_hdf() method" data-primary-sortas="to_hdf" data-type="indexterm" id="idm45785388895032"/>To this end, one can use the <code>to_hdf()</code> method of the <code>DataFrame</code> object and set the <code>format</code> parameter to <code>table</code> (see the <a href="https://oreil.ly/uu0_j"><code>to_hdf</code> API reference page</a>). This allows the appending of new data to the <code>table</code> object on disk and also, for example, the searching over the data on disk, which is not possible with the first approach. The price to pay is slower writing and reading speeds:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">74</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="n">time</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">to_hdf</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/data.h5</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">data</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">format</code><code class="o">=</code><code class="s1">'</code><code class="s1">table</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO18-1" id="co_working_with_financial_data_CO18-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>         </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mf">3.25</code><code> </code><code class="n">s</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mi">491</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mf">3.74</code><code> </code><code class="n">s</code><code>&#13;
</code><code>         </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mf">3.8</code><code> </code><code class="n">s</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">75</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">ls</code><code> </code><code class="o">-</code><code class="n">n</code><code> </code><code class="n">data</code><code class="o">/</code><code class="n">data</code><code class="o">.</code><code class="o">*</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="n">rw</code><code class="o">-</code><code class="n">r</code><code class="o">-</code><code class="o">-</code><code class="n">r</code><code class="o">-</code><code class="o">-</code><code class="err">@</code><code> </code><code class="mi">1</code><code> </code><code class="mi">501</code><code>  </code><code class="mi">20</code><code>  </code><code class="mi">446911563</code><code> </code><code class="n">Aug</code><code> </code><code class="mi">25</code><code> </code><code class="mi">11</code><code class="p">:</code><code class="mi">48</code><code> </code><code class="n">data</code><code class="o">/</code><code class="n">data</code><code class="o">.</code><code class="n">h5</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">76</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="n">time</code><code> </code><code class="n">data_copy</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">read_hdf</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/data.h5</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">data</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO18-2" id="co_working_with_financial_data_CO18-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>         </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mi">236</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mi">266</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mi">502</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>         </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mi">503</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">77</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data_copy</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>         </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">5000000</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code> </code><code class="n">to</code><code> </code><code class="mi">2030</code><code class="o">-</code><code class="mo">07</code><code class="o">-</code><code class="mo">05</code><code>&#13;
</code><code>          </code><code class="mo">05</code><code class="p">:</code><code class="mi">19</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>         </code><code class="n">Freq</code><code class="p">:</code><code> </code><code class="n">T</code><code>&#13;
</code><code>         </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">10</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>          </code><code class="c1">#   Column  Dtype</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>          </code><code class="mi">0</code><code>   </code><code class="n">No0</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">1</code><code>   </code><code class="n">No1</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">2</code><code>   </code><code class="n">No2</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">3</code><code>   </code><code class="n">No3</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">4</code><code>   </code><code class="n">No4</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">5</code><code>   </code><code class="n">No5</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">6</code><code>   </code><code class="n">No6</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">7</code><code>   </code><code class="n">No7</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">8</code><code>   </code><code class="n">No8</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">9</code><code>   </code><code class="n">No9</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>         </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">419.6</code><code> </code><code class="n">MB</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO18-1" id="callout_working_with_financial_data_CO18-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>This defines the writing format to be of type <code>table</code>. Writing becomes slower since this format type involves a bit more overhead and leads to a somewhat increased file size.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO18-2" id="callout_working_with_financial_data_CO18-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Reading is also slower in this application scenario.</p></dd>&#13;
</dl>&#13;
&#13;
<p>In practice, the advantage of this approach is that one can work with the <code>table_frame</code> object on disk like with any other <code>table</code> object of the <code>PyTables</code> package that is used by <code>pandas</code> in this context. This provides access to certain basic capabilities of the &#13;
<span class="keep-together"><a href="http://pytables.org"><code>PyTables</code></a></span> package, such as appending rows to a <code>table</code> object:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">78</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">tables</code><code> </code><code class="kn">as</code><code> </code><code class="nn">tb</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO19-1" id="co_working_with_financial_data_CO19-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">79</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code> </code><code class="o">=</code><code> </code><code class="n">tb</code><code class="o">.</code><code class="n">open_file</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/data.h5</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO19-2" id="co_working_with_financial_data_CO19-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">80</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO19-3" id="co_working_with_financial_data_CO19-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">80</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">File</code><code class="p">(</code><code class="n">filename</code><code class="o">=</code><code class="n">data</code><code class="o">/</code><code class="n">data</code><code class="o">.</code><code class="n">h5</code><code class="p">,</code><code> </code><code class="n">title</code><code class="o">=</code><code class="s1">'</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">mode</code><code class="o">=</code><code class="s1">'</code><code class="s1">r</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">root_uep</code><code class="o">=</code><code class="s1">'</code><code class="s1">/</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="n">filters</code><code class="o">=</code><code class="n">Filters</code><code class="p">(</code><code class="n">complevel</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="n">shuffle</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code><code> </code><code class="n">bitshuffle</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="n">fletcher32</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code><code> </code><code class="n">least_significant_digit</code><code class="o">=</code><code class="bp">None</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="o">/</code><code> </code><code class="p">(</code><code class="n">RootGroup</code><code class="p">)</code><code> </code><code class="s1">'</code><code class="s1">'</code><code>&#13;
</code><code>         </code><code class="o">/</code><code class="n">data</code><code> </code><code class="p">(</code><code class="n">Group</code><code class="p">)</code><code> </code><code class="s1">'</code><code class="s1">'</code><code>&#13;
</code><code>         </code><code class="o">/</code><code class="n">data</code><code class="o">/</code><code class="n">table</code><code> </code><code class="p">(</code><code class="n">Table</code><code class="p">(</code><code class="mi">5000000</code><code class="p">,</code><code class="p">)</code><code class="p">)</code><code> </code><code class="s1">'</code><code class="s1">'</code><code>&#13;
</code><code>           </code><code class="n">description</code><code> </code><code class="p">:</code><code class="o">=</code><code> </code><code class="p">{</code><code>&#13;
</code><code>           </code><code class="s2">"</code><code class="s2">index</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">Int64Col</code><code class="p">(</code><code class="n">shape</code><code class="o">=</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">dflt</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="n">pos</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>           </code><code class="s2">"</code><code class="s2">values_block_0</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">Float64Col</code><code class="p">(</code><code class="n">shape</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">dflt</code><code class="o">=</code><code class="mf">0.0</code><code class="p">,</code><code> </code><code class="n">pos</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code class="p">}</code><code>&#13;
</code><code>           </code><code class="n">byteorder</code><code> </code><code class="p">:</code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">little</code><code class="s1">'</code><code>&#13;
</code><code>           </code><code class="n">chunkshape</code><code> </code><code class="p">:</code><code class="o">=</code><code> </code><code class="p">(</code><code class="mi">2978</code><code class="p">,</code><code class="p">)</code><code>&#13;
</code><code>           </code><code class="n">autoindex</code><code> </code><code class="p">:</code><code class="o">=</code><code> </code><code class="bp">True</code><code>&#13;
</code><code>           </code><code class="n">colindexes</code><code> </code><code class="p">:</code><code class="o">=</code><code> </code><code class="p">{</code><code>&#13;
</code><code>             </code><code class="s2">"</code><code class="s2">index</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">Index</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code><code> </code><code class="n">medium</code><code class="p">,</code><code> </code><code class="n">shuffle</code><code class="p">,</code><code> </code><code class="n">zlib</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code class="o">.</code><code class="n">is_csi</code><code class="o">=</code><code class="bp">False</code><code class="p">}</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">81</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code class="o">.</code><code class="n">root</code><code class="o">.</code><code class="n">data</code><code class="o">.</code><code class="n">table</code><code class="p">[</code><code class="p">:</code><code class="mi">3</code><code class="p">]</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO19-4" id="co_working_with_financial_data_CO19-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">81</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">array</code><code class="p">(</code><code class="p">[</code><code class="p">(</code><code class="mi">1609459200000000000</code><code class="p">,</code><code> </code><code class="p">[</code><code class="mf">100.</code><code>    </code><code class="p">,</code><code> </code><code class="mf">100.</code><code>    </code><code class="p">,</code><code> </code><code class="mf">100.</code><code>    </code><code class="p">,</code><code> </code><code class="mf">100.</code><code>    </code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="mf">100.</code><code>    </code><code class="p">,</code><code> </code><code class="mf">100.</code><code>    </code><code class="p">,</code><code> </code><code class="mf">100.</code><code>    </code><code class="p">,</code><code> </code><code class="mf">100.</code><code>    </code><code class="p">,</code><code> </code><code class="mf">100.</code><code>    </code><code class="p">,</code><code> </code><code class="mf">100.</code><code>    </code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>         </code><code class="p">(</code><code class="mi">1609459260000000000</code><code class="p">,</code><code> </code><code class="p">[</code><code class="mf">100.0752</code><code class="p">,</code><code> </code><code class="mf">100.1164</code><code class="p">,</code><code> </code><code class="mf">100.0224</code><code class="p">,</code><code> </code><code class="mf">100.0073</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="mf">100.1142</code><code class="p">,</code><code> </code><code class="mf">100.0474</code><code class="p">,</code><code>  </code><code class="mf">99.9329</code><code class="p">,</code><code> </code><code class="mf">100.0254</code><code class="p">,</code><code> </code><code class="mf">100.1009</code><code class="p">,</code><code> </code><code class="mf">100.066</code><code> </code><code class="p">]</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>         </code><code class="p">(</code><code class="mi">1609459320000000000</code><code class="p">,</code><code> </code><code class="p">[</code><code class="mf">100.1593</code><code class="p">,</code><code> </code><code class="mf">100.1721</code><code class="p">,</code><code> </code><code class="mf">100.0519</code><code class="p">,</code><code> </code><code class="mf">100.0933</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="mf">100.1578</code><code class="p">,</code><code> </code><code class="mf">100.0301</code><code class="p">,</code><code>  </code><code class="mf">99.92</code><code>  </code><code class="p">,</code><code> </code><code class="mf">100.0965</code><code class="p">,</code><code> </code><code class="mf">100.1441</code><code class="p">,</code><code> </code><code class="mf">100.0717</code><code class="p">]</code><code class="p">)</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>               </code><code class="n">dtype</code><code class="o">=</code><code class="p">[</code><code class="p">(</code><code class="s1">'</code><code class="s1">index</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">&lt;i8</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'</code><code class="s1">values_block_0</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">&lt;f8</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="p">(</code><code class="mi">10</code><code class="p">,</code><code class="p">)</code><code class="p">)</code><code class="p">]</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">82</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code class="o">.</code><code class="n">close</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO19-5" id="co_working_with_financial_data_CO19-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">83</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rm</code><code> </code><code class="n">data</code><code class="o">/</code><code class="n">data</code><code class="o">.</code><code class="n">h5</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO19-1" id="callout_working_with_financial_data_CO19-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Imports the <code>PyTables</code> package.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO19-2" id="callout_working_with_financial_data_CO19-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Opens the database file for reading.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO19-3" id="callout_working_with_financial_data_CO19-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Shows the contents of the database file.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO19-4" id="callout_working_with_financial_data_CO19-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Prints the first three rows in the table.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO19-5" id="callout_working_with_financial_data_CO19-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Closes the database.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Although this second approach provides <em>more</em> flexibility, it does not open the doors to the full capabilities of the <code>PyTables</code> package. Nevertheless, the two approaches introduced in this sub-section are convenient and efficient when you are working with more or less <em>immutable data sets that fit into memory</em>. Nowadays, algorithmic trading, however, has to deal in general with continuously and rapidly growing data sets like, for example, tick data with regard to stock prices or foreign exchange rates. To cope with the requirements of such a scenario, alternative approaches might prove useful.</p>&#13;
<div data-type="tip">&#13;
<p>Using the <code>HDFStore</code> wrapper for the HDF5 binary storage standard, <code>pandas</code> is able to write and read financial data almost at the maximum speed the available hardware allows. Exports to other file-based formats, like CSV, are generally much slower alternatives.<a data-startref="ix_03_working_with_financial_data_-asciidoc20" data-type="indexterm" id="idm45785386679928"/><a data-startref="ix_03_working_with_financial_data_-asciidoc19" data-type="indexterm" id="idm45785386650232"/><a data-startref="ix_03_working_with_financial_data_-asciidoc18" data-type="indexterm" id="idm45785386649592"/><a data-startref="ix_03_working_with_financial_data_-asciidoc17" data-type="indexterm" id="idm45785386648952"/></p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Using TsTables" data-type="sect2"><div class="sect2" id="idm45785388320920">&#13;
<h2>Using TsTables</h2>&#13;
&#13;
<p><a data-primary="data storage" data-secondary="TsTables package for" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc21"/><a data-primary="HDF5 binary storage library" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc22"/><a data-primary="time series data sets" data-secondary="TsTables for storing" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc23"/><a data-primary="TsTables package" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc24"/>The <code>PyTables</code> package, with the import name <code>tables</code>, is a wrapper for the HDF5 binary storage library that is also used by <code>pandas</code> for its <code>HDFStore</code> implementation presented in the previous sub-section. The <code>TsTables</code> package (see the <a href="https://oreil.ly/VGPas">GitHub page for the package</a>) in turn is dedicated to the efficient handling of large financial time series data sets based on the HDF5 binary storage library. It is effectively an enhancement of the <code>PyTables</code> package and adds support for time series data to its capabilities. It implements a hierarchical storage approach that allows for a fast retrieval of data sub-sets selected by providing start and end dates and times, respectively. The major scenario supported by <code>TsTables</code> is “write once, retrieve multiple times.”</p>&#13;
&#13;
<p>The setup illustrated in this sub-section is that data is continuously collected from a web source, professional data provider, etc. and is stored interim and in-memory in a <code>DataFrame</code> object. After a while or a certain number of data points retrieved, the collected data is then stored in a <code>TsTables</code> <code>table</code> object in an HDF5 database.</p>&#13;
&#13;
<p class="pagebreak-before">First, here is the generation of the sample data:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">84</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="o">%</code><code class="n">time</code><code>&#13;
</code><code>         </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">generate_sample_data</code><code class="p">(</code><code class="n">rows</code><code class="o">=</code><code class="mf">2.5e6</code><code class="p">,</code><code> </code><code class="n">cols</code><code class="o">=</code><code class="mi">5</code><code class="p">,</code><code>&#13;
</code><code>                                     </code><code class="n">freq</code><code class="o">=</code><code class="s1">'</code><code class="s1">1s</code><code class="s1">'</code><code class="p">)</code><code class="o">.</code><code class="n">round</code><code class="p">(</code><code class="mi">4</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO20-1" id="co_working_with_financial_data_CO20-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>         </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mi">915</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mi">191</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mf">1.11</code><code> </code><code class="n">s</code><code>&#13;
</code><code>         </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mf">1.14</code><code> </code><code class="n">s</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">85</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>         </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">2500000</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code> </code><code class="n">to</code><code> </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mi">29</code><code>&#13;
</code><code>          </code><code class="mi">22</code><code class="p">:</code><code class="mi">26</code><code class="p">:</code><code class="mi">39</code><code>&#13;
</code><code>         </code><code class="n">Freq</code><code class="p">:</code><code> </code><code class="n">S</code><code>&#13;
</code><code>         </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">5</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>          </code><code class="c1">#   Column  Dtype</code><code>&#13;
</code><code>         </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>          </code><code class="mi">0</code><code>   </code><code class="n">No0</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">1</code><code>   </code><code class="n">No1</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">2</code><code>   </code><code class="n">No2</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">3</code><code>   </code><code class="n">No3</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="mi">4</code><code>   </code><code class="n">No4</code><code>     </code><code class="n">float64</code><code>&#13;
</code><code>         </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">114.4</code><code> </code><code class="n">MB</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO20-1" id="callout_working_with_financial_data_CO20-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>This generates a sample financial data set with 2,500,000 rows and five columns with a one second frequency; the sample data is rounded to two digits.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Second, some more imports and the creation of the <code>TsTables</code> <code>table</code> object. The major part is the definition of the <code>desc</code> class, which provides the description for the <code>table</code> object’s data structure:</p>&#13;
<div data-type="caution">&#13;
<p>Currently, <code>TsTables</code> only works with the old <code>pandas</code> version 0.19. A friendly fork, working with newer versions of <code>pandas</code> is available under <a href="http://github.com/yhilpisch/tstables"><em class="hyperlink">http://github.com/yhilpisch/tstables</em></a> which can be installed with the following:</p>&#13;
<pre>pip install git+https://github.com/yhilpisch/tstables.git</pre>&#13;
</div>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">86</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">tstables</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO21-1" id="co_working_with_financial_data_CO21-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">87</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">tables</code><code> </code><code class="kn">as</code><code> </code><code class="nn">tb</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO21-2" id="co_working_with_financial_data_CO21-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">88</code><code class="p">]</code><code class="p">:</code><code> </code><code class="k">class</code><code> </code><code class="nc">desc</code><code class="p">(</code><code class="n">tb</code><code class="o">.</code><code class="n">IsDescription</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>             </code><code class="sd">''' Description of TsTables table structure.&#13;
             '''</code><code>&#13;
</code><code>             </code><code class="n">timestamp</code><code> </code><code class="o">=</code><code> </code><code class="n">tb</code><code class="o">.</code><code class="n">Int64Col</code><code class="p">(</code><code class="n">pos</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO21-3" id="co_working_with_financial_data_CO21-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>             </code><code class="n">No0</code><code> </code><code class="o">=</code><code> </code><code class="n">tb</code><code class="o">.</code><code class="n">Float64Col</code><code class="p">(</code><code class="n">pos</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO21-4" id="co_working_with_financial_data_CO21-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>             </code><code class="n">No1</code><code> </code><code class="o">=</code><code> </code><code class="n">tb</code><code class="o">.</code><code class="n">Float64Col</code><code class="p">(</code><code class="n">pos</code><code class="o">=</code><code class="mi">2</code><code class="p">)</code><code>&#13;
</code><code>             </code><code class="n">No2</code><code> </code><code class="o">=</code><code> </code><code class="n">tb</code><code class="o">.</code><code class="n">Float64Col</code><code class="p">(</code><code class="n">pos</code><code class="o">=</code><code class="mi">3</code><code class="p">)</code><code>&#13;
</code><code>             </code><code class="n">No3</code><code> </code><code class="o">=</code><code> </code><code class="n">tb</code><code class="o">.</code><code class="n">Float64Col</code><code class="p">(</code><code class="n">pos</code><code class="o">=</code><code class="mi">4</code><code class="p">)</code><code>&#13;
</code><code>             </code><code class="n">No4</code><code> </code><code class="o">=</code><code> </code><code class="n">tb</code><code class="o">.</code><code class="n">Float64Col</code><code class="p">(</code><code class="n">pos</code><code class="o">=</code><code class="mi">5</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">89</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code> </code><code class="o">=</code><code> </code><code class="n">tb</code><code class="o">.</code><code class="n">open_file</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/data.h5ts</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">w</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO21-5" id="co_working_with_financial_data_CO21-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">90</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">ts</code><code> </code><code class="o">=</code><code> </code><code class="n">h5</code><code class="o">.</code><code class="n">create_ts</code><code class="p">(</code><code class="s1">'</code><code class="s1">/</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">data</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">desc</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO21-6" id="co_working_with_financial_data_CO21-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">91</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO21-7" id="co_working_with_financial_data_CO21-7"><img alt="7" src="assets/7.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">91</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">File</code><code class="p">(</code><code class="n">filename</code><code class="o">=</code><code class="n">data</code><code class="o">/</code><code class="n">data</code><code class="o">.</code><code class="n">h5ts</code><code class="p">,</code><code> </code><code class="n">title</code><code class="o">=</code><code class="s1">'</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">mode</code><code class="o">=</code><code class="s1">'</code><code class="s1">w</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">root_uep</code><code class="o">=</code><code class="s1">'</code><code class="s1">/</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="n">filters</code><code class="o">=</code><code class="n">Filters</code><code class="p">(</code><code class="n">complevel</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="n">shuffle</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code><code> </code><code class="n">bitshuffle</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="n">fletcher32</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code><code> </code><code class="n">least_significant_digit</code><code class="o">=</code><code class="bp">None</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="o">/</code><code> </code><code class="p">(</code><code class="n">RootGroup</code><code class="p">)</code><code> </code><code class="s1">'</code><code class="s1">'</code><code>&#13;
</code><code>         </code><code class="o">/</code><code class="n">data</code><code> </code><code class="p">(</code><code class="n">Group</code><code class="o">/</code><code class="n">Timeseries</code><code class="p">)</code><code> </code><code class="s1">'</code><code class="s1">'</code><code>&#13;
</code><code>         </code><code class="o">/</code><code class="n">data</code><code class="o">/</code><code class="n">y2020</code><code> </code><code class="p">(</code><code class="n">Group</code><code class="p">)</code><code> </code><code class="s1">'</code><code class="s1">'</code><code>&#13;
</code><code>         </code><code class="o">/</code><code class="n">data</code><code class="o">/</code><code class="n">y2020</code><code class="o">/</code><code class="n">m08</code><code> </code><code class="p">(</code><code class="n">Group</code><code class="p">)</code><code> </code><code class="s1">'</code><code class="s1">'</code><code>&#13;
</code><code>         </code><code class="o">/</code><code class="n">data</code><code class="o">/</code><code class="n">y2020</code><code class="o">/</code><code class="n">m08</code><code class="o">/</code><code class="n">d25</code><code> </code><code class="p">(</code><code class="n">Group</code><code class="p">)</code><code> </code><code class="s1">'</code><code class="s1">'</code><code>&#13;
</code><code>         </code><code class="o">/</code><code class="n">data</code><code class="o">/</code><code class="n">y2020</code><code class="o">/</code><code class="n">m08</code><code class="o">/</code><code class="n">d25</code><code class="o">/</code><code class="n">ts_data</code><code> </code><code class="p">(</code><code class="n">Table</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code class="p">)</code><code class="p">)</code><code> </code><code class="s1">'</code><code class="s1">'</code><code>&#13;
</code><code>           </code><code class="n">description</code><code> </code><code class="p">:</code><code class="o">=</code><code> </code><code class="p">{</code><code>&#13;
</code><code>           </code><code class="s2">"</code><code class="s2">timestamp</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">Int64Col</code><code class="p">(</code><code class="n">shape</code><code class="o">=</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">dflt</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="n">pos</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>           </code><code class="s2">"</code><code class="s2">No0</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">Float64Col</code><code class="p">(</code><code class="n">shape</code><code class="o">=</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">dflt</code><code class="o">=</code><code class="mf">0.0</code><code class="p">,</code><code> </code><code class="n">pos</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>           </code><code class="s2">"</code><code class="s2">No1</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">Float64Col</code><code class="p">(</code><code class="n">shape</code><code class="o">=</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">dflt</code><code class="o">=</code><code class="mf">0.0</code><code class="p">,</code><code> </code><code class="n">pos</code><code class="o">=</code><code class="mi">2</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>           </code><code class="s2">"</code><code class="s2">No2</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">Float64Col</code><code class="p">(</code><code class="n">shape</code><code class="o">=</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">dflt</code><code class="o">=</code><code class="mf">0.0</code><code class="p">,</code><code> </code><code class="n">pos</code><code class="o">=</code><code class="mi">3</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>           </code><code class="s2">"</code><code class="s2">No3</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">Float64Col</code><code class="p">(</code><code class="n">shape</code><code class="o">=</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">dflt</code><code class="o">=</code><code class="mf">0.0</code><code class="p">,</code><code> </code><code class="n">pos</code><code class="o">=</code><code class="mi">4</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>           </code><code class="s2">"</code><code class="s2">No4</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">Float64Col</code><code class="p">(</code><code class="n">shape</code><code class="o">=</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">dflt</code><code class="o">=</code><code class="mf">0.0</code><code class="p">,</code><code> </code><code class="n">pos</code><code class="o">=</code><code class="mi">5</code><code class="p">)</code><code class="p">}</code><code>&#13;
</code><code>           </code><code class="n">byteorder</code><code> </code><code class="p">:</code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">little</code><code class="s1">'</code><code>&#13;
</code><code>           </code><code class="n">chunkshape</code><code> </code><code class="p">:</code><code class="o">=</code><code> </code><code class="p">(</code><code class="mi">1365</code><code class="p">,</code><code class="p">)</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO21-1" id="callout_working_with_financial_data_CO21-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p><code>TsTables</code> (installed from <a href="https://github.com/yhilpisch/tstables"><em class="hyperlink">https://github.com/yhilpisch/tstables</em></a>)…</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO21-2" id="callout_working_with_financial_data_CO21-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>…<code>PyTables</code> are imported.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO21-3" id="callout_working_with_financial_data_CO21-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>The first column of the table is a <code>timestamp</code> represented as an <code>int</code> value.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO21-4" id="callout_working_with_financial_data_CO21-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>All data columns contain <code>float</code> values.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO21-5" id="callout_working_with_financial_data_CO21-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>This opens a new database file for writing.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO21-6" id="callout_working_with_financial_data_CO21-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>The <code>TsTables</code> table is created at the root node, with name <code>data</code> and given the class-based description <code>desc</code>.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO21-7" id="callout_working_with_financial_data_CO21-7"><img alt="7" src="assets/7.png"/></a></dt>&#13;
<dd><p>Inspecting the database file reveals the basic principle behind the hierarchical structuring in years, months, and days.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Third is the writing of the sample data stored in a <code>DataFrame</code> object to the <code>table</code> object on disk. One of the major benefits of <code>TsTables</code> is the convenience with which this operation is accomplished, namely by a simple method call. Even better, that convenience here is coupled with speed. With regard to the structure in the database, <code>TsTables</code> chunks the data into sub-sets of a single day. In the example case where the frequency is set to one second, this translates into 24 x 60 x 60 = 86,400 data rows per full day’s worth of data:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">92</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="n">time</code><code> </code><code class="n">ts</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">data</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO22-1" id="co_working_with_financial_data_CO22-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>         </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mi">476</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mi">238</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mi">714</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>         </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mi">739</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">93</code><code class="p">]</code><code class="p">:</code><code> </code><code class="c1"># h5  </code><a class="co" href="#callout_working_with_financial_data_CO22-2" id="co_working_with_financial_data_CO22-2"><img alt="2" src="assets/2.png"/></a></pre>&#13;
&#13;
<pre data-type="programlisting">File(filename=data/data.h5ts, title='', mode='w', root_uep='/',&#13;
	filters=Filters(complevel=0, shuffle=False, bitshuffle=False,&#13;
	fletcher32=False, least_significant_digit=None))&#13;
/ (RootGroup) ''&#13;
/data (Group/Timeseries) ''&#13;
/data/y2020 (Group) ''&#13;
/data/y2021 (Group) ''&#13;
/data/y2021/m01 (Group) ''&#13;
/data/y2021/m01/d01 (Group) ''&#13;
/data/y2021/m01/d01/ts_data (Table(86400,)) ''&#13;
  description := {&#13;
  "timestamp": Int64Col(shape=(), dflt=0, pos=0),&#13;
  "No0": Float64Col(shape=(), dflt=0.0, pos=1),&#13;
  "No1": Float64Col(shape=(), dflt=0.0, pos=2),&#13;
  "No2": Float64Col(shape=(), dflt=0.0, pos=3),&#13;
  "No3": Float64Col(shape=(), dflt=0.0, pos=4),&#13;
  "No4": Float64Col(shape=(), dflt=0.0, pos=5)}&#13;
  byteorder := 'little'&#13;
  chunkshape := (1365,)&#13;
/data/y2021/m01/d02 (Group) ''&#13;
/data/y2021/m01/d02/ts_data (Table(86400,)) ''&#13;
  description := {&#13;
  "timestamp": Int64Col(shape=(), dflt=0, pos=0),&#13;
  "No0": Float64Col(shape=(), dflt=0.0, pos=1),&#13;
  "No1": Float64Col(shape=(), dflt=0.0, pos=2),&#13;
  "No2": Float64Col(shape=(), dflt=0.0, pos=3),&#13;
  "No3": Float64Col(shape=(), dflt=0.0, pos=4),&#13;
  "No4": Float64Col(shape=(), dflt=0.0, pos=5)}&#13;
  byteorder := 'little'&#13;
  chunkshape := (1365,)&#13;
/data/y2021/m01/d03 (Group) ''&#13;
/data/y2021/m01/d03/ts_data (Table(86400,)) ''&#13;
  description := {&#13;
  "timestamp": Int64Col(shape=(), dflt=0, pos=0),&#13;
	...</pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO22-1" id="callout_working_with_financial_data_CO22-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>This appends the <code>DataFrame</code> object via a simple method call.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO22-2" id="callout_working_with_financial_data_CO22-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>The <code>table</code> object shows 86,400 rows per day after the <code>append()</code> operation.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Reading sub-sets of the data from a <code>TsTables</code> <code>table</code> object is generally really fast since this is what it is optimized for in the first place. In this regard, <code>TsTables</code> supports typical algorithmic trading applications, like backtesting, pretty well. Another contributing factor is that <code>TsTables</code> returns the data already as a <code>DataFrame</code> object such that additional conversions are not necessary in general:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">94</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">datetime</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">95</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">start</code><code> </code><code class="o">=</code><code> </code><code class="n">datetime</code><code class="o">.</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2021</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO23-1" id="co_working_with_financial_data_CO23-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">96</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">end</code><code> </code><code class="o">=</code><code> </code><code class="n">datetime</code><code class="o">.</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2021</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO23-2" id="co_working_with_financial_data_CO23-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">97</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="n">time</code><code> </code><code class="n">subset</code><code> </code><code class="o">=</code><code> </code><code class="n">ts</code><code class="o">.</code><code class="n">read_range</code><code class="p">(</code><code class="n">start</code><code class="p">,</code><code> </code><code class="n">end</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO23-3" id="co_working_with_financial_data_CO23-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>         </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mf">10.3</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mf">3.63</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mi">14</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>         </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mf">12.8</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">98</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">start</code><code> </code><code class="o">=</code><code> </code><code class="n">datetime</code><code class="o">.</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2021</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">12</code><code class="p">,</code><code> </code><code class="mi">30</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">99</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">end</code><code> </code><code class="o">=</code><code> </code><code class="n">datetime</code><code class="o">.</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2021</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">,</code><code> </code><code class="mi">17</code><code class="p">,</code><code> </code><code class="mi">15</code><code class="p">,</code><code> </code><code class="mi">30</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">100</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="n">time</code><code> </code><code class="n">subset</code><code> </code><code class="o">=</code><code> </code><code class="n">ts</code><code class="o">.</code><code class="n">read_range</code><code class="p">(</code><code class="n">start</code><code class="p">,</code><code> </code><code class="n">end</code><code class="p">)</code><code>&#13;
</code><code>          </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mf">28.6</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mf">18.5</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mf">47.1</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>          </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mf">46.1</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">101</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">subset</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>          </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>          </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">276331</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">02</code><code> </code><code class="mi">12</code><code class="p">:</code><code class="mi">30</code><code class="p">:</code><code class="mo">00</code><code> </code><code class="n">to</code><code> </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">05</code><code>&#13;
</code><code>           </code><code class="mi">17</code><code class="p">:</code><code class="mi">15</code><code class="p">:</code><code class="mi">30</code><code>&#13;
</code><code>          </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">5</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>           </code><code class="c1">#   Column  Non-Null Count   Dtype</code><code>&#13;
</code><code>          </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>   </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>           </code><code class="mi">0</code><code>   </code><code class="n">No0</code><code>     </code><code class="mi">276331</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">float64</code><code>&#13;
</code><code>           </code><code class="mi">1</code><code>   </code><code class="n">No1</code><code>     </code><code class="mi">276331</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">float64</code><code>&#13;
</code><code>           </code><code class="mi">2</code><code>   </code><code class="n">No2</code><code>     </code><code class="mi">276331</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">float64</code><code>&#13;
</code><code>           </code><code class="mi">3</code><code>   </code><code class="n">No3</code><code>     </code><code class="mi">276331</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">float64</code><code>&#13;
</code><code>           </code><code class="mi">4</code><code>   </code><code class="n">No4</code><code>     </code><code class="mi">276331</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code>&#13;
</code><code>          </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">12.6</code><code> </code><code class="n">MB</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">102</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">h5</code><code class="o">.</code><code class="n">close</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">103</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rm</code><code> </code><code class="n">data</code><code class="o">/</code><code class="o">*</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO23-1" id="callout_working_with_financial_data_CO23-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>This defines the starting date and…</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO23-2" id="callout_working_with_financial_data_CO23-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>…end date for the data retrieval operation.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO23-3" id="callout_working_with_financial_data_CO23-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>The <code>read_range()</code> method takes the start and end dates as input—reading here is only a matter of milliseconds.</p></dd>&#13;
</dl>&#13;
&#13;
<p>New data that is retrieved during a day can be appended to the <code>TsTables</code> <code>table</code> object, as illustrated previously. The package is therefore a valuable addition to the capabilities of <code>pandas</code> in combination with <code>HDFStore</code> objects when it comes to the efficient storage and retrieval of (large) financial time series data sets over time.<a data-startref="ix_03_working_with_financial_data_-asciidoc24" data-type="indexterm" id="idm45785384167416"/><a data-startref="ix_03_working_with_financial_data_-asciidoc23" data-type="indexterm" id="idm45785384216296"/><a data-startref="ix_03_working_with_financial_data_-asciidoc22" data-type="indexterm" id="idm45785384215656"/><a data-startref="ix_03_working_with_financial_data_-asciidoc21" data-type="indexterm" id="idm45785384215016"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Storing Data with SQLite3" data-type="sect2"><div class="sect2" id="idm45785386647656">&#13;
<h2>Storing Data with SQLite3</h2>&#13;
&#13;
<p><a data-primary="data storage" data-secondary="SQLite3 for" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc25"/><a data-primary="SQLite3" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc26"/><a data-primary="time series data sets" data-secondary="SQLite3 for storage of" data-type="indexterm" id="ix_03_working_with_financial_data_-asciidoc27"/>Financial time series data can also be written directly from a <code>DataFrame</code> object to a relational database like <code>SQLite3</code>. The use of a relational database might be useful in scenarios where the SQL query language is applied to implement more sophisticated analyses. With regard to speed and also disk usage, relational databases cannot, however, compare with the other approaches that rely on binary storage formats like HDF5.</p>&#13;
&#13;
<p>The <code>DataFrame</code> class provides the method <code>to_sql()</code> (see the <a href="https://oreil.ly/ENhoW"><code>to_sql()</code> API reference page</a>) to write data to a table in a relational database. The size on disk with 100+ MB indicates that there is quite some overhead when using relational databases:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">104</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="n">time</code><code> </code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="n">generate_sample_data</code><code class="p">(</code><code class="mf">1e6</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">1min</code><code class="s1">'</code><code class="p">)</code><code class="o">.</code><code class="n">round</code><code class="p">(</code><code class="mi">4</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO24-1" id="co_working_with_financial_data_CO24-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>          </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mi">342</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mf">60.5</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mi">402</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>          </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mi">405</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">105</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO24-1" id="co_working_with_financial_data_CO24-2"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>          </code><code class="o">&lt;</code><code class="k">class</code><code> </code><code class="err">'</code><code class="nc">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">frame</code><code class="o">.</code><code class="n">DataFrame</code><code class="s1">'</code><code class="s1">&gt;</code><code>&#13;
</code><code>          </code><code class="n">DatetimeIndex</code><code class="p">:</code><code> </code><code class="mi">1000000</code><code> </code><code class="n">entries</code><code class="p">,</code><code> </code><code class="mi">2021</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mo">01</code><code> </code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code class="p">:</code><code class="mo">00</code><code> </code><code class="n">to</code><code> </code><code class="mi">2022</code><code class="o">-</code><code class="mi">11</code><code class="o">-</code><code class="mi">26</code><code>&#13;
</code><code>           </code><code class="mi">10</code><code class="p">:</code><code class="mi">39</code><code class="p">:</code><code class="mo">00</code><code>&#13;
</code><code>          </code><code class="n">Freq</code><code class="p">:</code><code> </code><code class="n">T</code><code>&#13;
</code><code>          </code><code class="n">Data</code><code> </code><code class="n">columns</code><code> </code><code class="p">(</code><code class="n">total</code><code> </code><code class="mi">5</code><code> </code><code class="n">columns</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>           </code><code class="c1">#   Column  Non-Null Count    Dtype</code><code>&#13;
</code><code>          </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>  </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>    </code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code class="o">-</code><code>&#13;
</code><code>           </code><code class="mi">0</code><code>   </code><code class="n">No0</code><code>     </code><code class="mi">1000000</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">float64</code><code>&#13;
</code><code>           </code><code class="mi">1</code><code>   </code><code class="n">No1</code><code>     </code><code class="mi">1000000</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">float64</code><code>&#13;
</code><code>           </code><code class="mi">2</code><code>   </code><code class="n">No2</code><code>     </code><code class="mi">1000000</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">float64</code><code>&#13;
</code><code>           </code><code class="mi">3</code><code>   </code><code class="n">No3</code><code>     </code><code class="mi">1000000</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">float64</code><code>&#13;
</code><code>           </code><code class="mi">4</code><code>   </code><code class="n">No4</code><code>     </code><code class="mi">1000000</code><code> </code><code class="n">non</code><code class="o">-</code><code class="n">null</code><code>  </code><code class="n">float64</code><code>&#13;
</code><code>          </code><code class="n">dtypes</code><code class="p">:</code><code> </code><code class="n">float64</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code>&#13;
</code><code>          </code><code class="n">memory</code><code> </code><code class="n">usage</code><code class="p">:</code><code> </code><code class="mf">45.8</code><code> </code><code class="n">MB</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">106</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">sqlite3</code><code> </code><code class="kn">as</code><code> </code><code class="nn">sq3</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO24-2" id="co_working_with_financial_data_CO24-3"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">107</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">con</code><code> </code><code class="o">=</code><code> </code><code class="n">sq3</code><code class="o">.</code><code class="n">connect</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/data.sql</code><code class="s1">'</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO24-3" id="co_working_with_financial_data_CO24-4"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">108</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="n">time</code><code> </code><code class="n">data</code><code class="o">.</code><code class="n">to_sql</code><code class="p">(</code><code class="s1">'</code><code class="s1">data</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">con</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO24-4" id="co_working_with_financial_data_CO24-5"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>          </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mf">4.6</code><code> </code><code class="n">s</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mi">352</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mf">4.95</code><code> </code><code class="n">s</code><code>&#13;
</code><code>          </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mf">5.07</code><code> </code><code class="n">s</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">109</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">ls</code><code> </code><code class="o">-</code><code class="n">n</code><code> </code><code class="n">data</code><code class="o">/</code><code class="n">data</code><code class="o">.</code><code class="o">*</code><code>&#13;
</code><code>          </code><code class="o">-</code><code class="n">rw</code><code class="o">-</code><code class="n">r</code><code class="o">-</code><code class="o">-</code><code class="n">r</code><code class="o">-</code><code class="o">-</code><code class="err">@</code><code> </code><code class="mi">1</code><code> </code><code class="mi">501</code><code>  </code><code class="mi">20</code><code>  </code><code class="mi">105316352</code><code> </code><code class="n">Aug</code><code> </code><code class="mi">25</code><code> </code><code class="mi">11</code><code class="p">:</code><code class="mi">48</code><code> </code><code class="n">data</code><code class="o">/</code><code class="n">data</code><code class="o">.</code><code class="n">sql</code></pre>&#13;
<dl class="calloutlist pagebreak-before">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO24-1" id="callout_working_with_financial_data_CO24-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>The sample financial data set has 1,000,000 rows and five columns; memory usage is about 46 MB.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO24-3" id="callout_working_with_financial_data_CO24-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>This imports the <code>SQLite3</code> module.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO24-4" id="callout_working_with_financial_data_CO24-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>A connection is opened to a new database file.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO24-5" id="callout_working_with_financial_data_CO24-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Writing the data to the relational database takes a couple of seconds.</p></dd>&#13;
</dl>&#13;
&#13;
<p>One strength of relational databases is the ability to implement (out-of-memory) analytics tasks based on standardized SQL statements. As an example, consider a query that selects for column <code>No1</code> all those rows where the value in that row lies between 105 and 108:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">110</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">query</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">SELECT * FROM data WHERE No1 &gt; 105 and No2 &lt; 108</code><code class="s1">'</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO25-1" id="co_working_with_financial_data_CO25-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">111</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">%</code><code class="n">time</code><code> </code><code class="n">res</code><code> </code><code class="o">=</code><code> </code><code class="n">con</code><code class="o">.</code><code class="n">execute</code><code class="p">(</code><code class="n">query</code><code class="p">)</code><code class="o">.</code><code class="n">fetchall</code><code class="p">(</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO25-2" id="co_working_with_financial_data_CO25-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>          </code><code class="n">CPU</code><code> </code><code class="n">times</code><code class="p">:</code><code> </code><code class="n">user</code><code> </code><code class="mi">109</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">sys</code><code class="p">:</code><code> </code><code class="mf">30.3</code><code> </code><code class="n">ms</code><code class="p">,</code><code> </code><code class="n">total</code><code class="p">:</code><code> </code><code class="mi">139</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>          </code><code class="n">Wall</code><code> </code><code class="n">time</code><code class="p">:</code><code> </code><code class="mi">138</code><code> </code><code class="n">ms</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">112</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">res</code><code class="p">[</code><code class="p">:</code><code class="mi">5</code><code class="p">]</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO25-3" id="co_working_with_financial_data_CO25-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">112</code><code class="p">]</code><code class="p">:</code><code> </code><code class="p">[</code><code class="p">(</code><code class="s1">'</code><code class="s1">2021-01-03 19:19:00</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mf">103.6894</code><code class="p">,</code><code> </code><code class="mf">105.0117</code><code class="p">,</code><code> </code><code class="mf">103.9025</code><code class="p">,</code><code> </code><code class="mf">95.8619</code><code class="p">,</code><code>&#13;
</code><code>           </code><code class="mf">93.6062</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="p">(</code><code class="s1">'</code><code class="s1">2021-01-03 19:20:00</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mf">103.6724</code><code class="p">,</code><code> </code><code class="mf">105.0654</code><code class="p">,</code><code> </code><code class="mf">103.9277</code><code class="p">,</code><code> </code><code class="mf">95.8915</code><code class="p">,</code><code>&#13;
</code><code>           </code><code class="mf">93.5673</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="p">(</code><code class="s1">'</code><code class="s1">2021-01-03 19:21:00</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mf">103.6213</code><code class="p">,</code><code> </code><code class="mf">105.1132</code><code class="p">,</code><code> </code><code class="mf">103.8598</code><code class="p">,</code><code> </code><code class="mf">95.7606</code><code class="p">,</code><code>&#13;
</code><code>           </code><code class="mf">93.5618</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="p">(</code><code class="s1">'</code><code class="s1">2021-01-03 19:22:00</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mf">103.6724</code><code class="p">,</code><code> </code><code class="mf">105.1896</code><code class="p">,</code><code> </code><code class="mf">103.8704</code><code class="p">,</code><code> </code><code class="mf">95.7302</code><code class="p">,</code><code>&#13;
</code><code>           </code><code class="mf">93.4139</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>          </code><code class="p">(</code><code class="s1">'</code><code class="s1">2021-01-03 19:23:00</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mf">103.8115</code><code class="p">,</code><code> </code><code class="mf">105.1152</code><code class="p">,</code><code> </code><code class="mf">103.8342</code><code class="p">,</code><code> </code><code class="mf">95.706</code><code class="p">,</code><code>&#13;
</code><code>           </code><code class="mf">93.4436</code><code class="p">)</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">113</code><code class="p">]</code><code class="p">:</code><code> </code><code class="nb">len</code><code class="p">(</code><code class="n">res</code><code class="p">)</code><code>  </code><a class="co" href="#callout_working_with_financial_data_CO25-4" id="co_working_with_financial_data_CO25-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">113</code><code class="p">]</code><code class="p">:</code><code> </code><code class="mi">5035</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">114</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">con</code><code class="o">.</code><code class="n">close</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">115</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">rm</code><code> </code><code class="n">data</code><code class="o">/</code><code class="o">*</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO25-1" id="callout_working_with_financial_data_CO25-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>The SQL query as a Python <code>str</code> object.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO25-2" id="callout_working_with_financial_data_CO25-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>The query executed to retrieve all results rows.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO25-3" id="callout_working_with_financial_data_CO25-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>The first five results printed.</p></dd>&#13;
<dt><a class="co" href="#co_working_with_financial_data_CO25-4" id="callout_working_with_financial_data_CO25-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>The length of the results <code>list</code> object.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Admittedly, such simple queries are also possible with <code>pandas</code> if the data set fits into memory. However, the SQL query language has proven useful and powerful for decades now and should be in the algorithmic trader’s arsenal of data weapons.</p>&#13;
<div data-type="note" epub:type="note">&#13;
<p><code>pandas</code> also supports database connections via <code>SQLAlchemy</code>, a Python abstraction layer package for diverse relational databases (refer to the <a href="http://sqlalchemy.org"><code>SQLAlchemy</code> home page</a>). This in turn allows for the use of, for example, <a href="https://mysql.com"><code>MySQL</code></a> as the relational database backend<a data-startref="ix_03_working_with_financial_data_-asciidoc27" data-type="indexterm" id="idm45785385713256"/><a data-startref="ix_03_working_with_financial_data_-asciidoc26" data-type="indexterm" id="idm45785385712616"/><a data-startref="ix_03_working_with_financial_data_-asciidoc25" data-type="indexterm" id="idm45785385711976"/>.<a data-startref="ix_03_working_with_financial_data_-asciidoc16" data-type="indexterm" id="idm45785385711208"/><a data-startref="ix_03_working_with_financial_data_-asciidoc15" data-type="indexterm" id="idm45785385710536"/></p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Conclusions" data-type="sect1"><div class="sect1" id="idm45785384213864">&#13;
<h1>Conclusions</h1>&#13;
&#13;
<p>This chapter covers the handling of financial time series data. It illustrates the reading of such data from different file-based sources, like CSV files. It also shows how to retrieve financial data from web services, such as that of Quandl, for end-of-day and options data. Open financial data sources are a valuable addition to the financial landscape. Quandl is a platform integrating thousands of open data sets under the umbrella of a unified API.</p>&#13;
&#13;
<p>Another important topic covered in this chapter is the efficient storage of complete <code>DataFrame</code> objects on disk, as well as of the data contained in such an in-memory object in databases. Database flavors used in this chapter include the HDF5 database standard and the light-weight relational database <code>SQLite3</code>. This chapter lays the foundation for <a data-type="xref" href="ch04.html#vectorized_backtesting">Chapter 4</a>, which addresses vectorized backtesting; <a data-type="xref" href="ch05.html#machine_learning">Chapter 5</a>, which covers machine learning and deep learning for market prediction; and <a data-type="xref" href="ch06.html#event_based_backtesting">Chapter 6</a>, which discusses event-based backtesting of trading strategies.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="pagebreak-before" data-pdf-bookmark="References and Further Resources" data-type="sect1"><div class="sect1" id="idm45785385691880">&#13;
<h1>References and Further Resources</h1>&#13;
&#13;
<p>You can find more information about Quandl at the following link:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><a href="http://quandl.org"><em class="hyperlink">http://quandl.org</em></a></p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Information about the package used to retrieve data from that source is found here:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><a href="https://www.quandl.com/tools/python">Python wrapper page on Quandl</a></p>&#13;
</li>&#13;
<li>&#13;
<p><a href="https://github.com/quandl/quandl-python">GitHub page of the Quandl Python wrapper</a></p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>You should consult the official documentation pages for more information on the packages used in this chapter:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><a href="http://pandas.pydata.org"><code>pandas</code> home page</a></p>&#13;
</li>&#13;
<li>&#13;
<p><a href="http://pytables.org"><code>PyTables</code> home page</a></p>&#13;
</li>&#13;
<li>&#13;
<p><a href="https://github.com/yhilpisch/tstables"><code>TsTables</code> fork on GitHub</a></p>&#13;
</li>&#13;
<li>&#13;
<p><a href="http://sqlite.org"><code>SQLite</code> home page</a></p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Books and articles cited in this chapter:</p>&#13;
&#13;
<ul class="author-date-bib">&#13;
<li>&#13;
<p>Hilpisch, Yves. 2018. <em>Python for Finance: Mastering Data-Driven Finance</em>. 2nd ed. Sebastopol: O’Reilly.</p>&#13;
</li>&#13;
<li>&#13;
<p>McKinney, Wes. 2017. <em>Python for Data Analysis: Data Wrangling with Pandas, NumPy, and IPython</em>. 2nd ed. Sebastopol: O’Reilly.</p>&#13;
</li>&#13;
<li>&#13;
<p>Thomas, Rob. “Bad Election Day Forecasts Deal Blow to Data Science: Prediction Models Suffered from Narrow Data, Faulty Algorithms and Human Foibles.” <em>Wall Street Journal</em>, November 9, 2016.</p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Python Scripts" data-type="sect1"><div class="sect1" id="sample_data">&#13;
<h1>Python Scripts</h1>&#13;
&#13;
<p><a data-primary="Monte Carlo simulation" data-secondary="time series data based on" data-type="indexterm" id="idm45785387281480"/><a data-primary="Python scripts" data-secondary="sample time series data set" data-type="indexterm" id="idm45785387280536"/><a data-primary="time series data sets" data-secondary="Python script for generating sample set" data-type="indexterm" id="idm45785387307608"/>The following Python script generates sample financial time series data based on a Monte Carlo simulation for a geometric Brownian motion; for more, see Hilpisch (2018, ch. 12):<a data-startref="ix_03_working_with_financial_data_-asciidoc0" data-type="indexterm" id="idm45785387306376"/></p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="c1">#</code>&#13;
<code class="c1"># Python Module to Generate a</code>&#13;
<code class="c1"># Sample Financial Data Set</code>&#13;
<code class="c1">#</code>&#13;
<code class="c1"># Python for Algorithmic Trading</code>&#13;
<code class="c1"># (c) Dr. Yves J. Hilpisch</code>&#13;
<code class="c1"># The Python Quants GmbH</code>&#13;
<code class="c1">#</code>&#13;
<code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code>&#13;
<code class="kn">import</code> <code class="nn">pandas</code> <code class="kn">as</code> <code class="nn">pd</code>&#13;
&#13;
<code class="n">r</code> <code class="o">=</code> <code class="mf">0.05</code>  <code class="c1"># constant short rate</code>&#13;
<code class="n">sigma</code> <code class="o">=</code> <code class="mf">0.5</code>  <code class="c1"># volatility factor</code>&#13;
&#13;
&#13;
<code class="k">def</code> <code class="nf">generate_sample_data</code><code class="p">(</code><code class="n">rows</code><code class="p">,</code> <code class="n">cols</code><code class="p">,</code> <code class="n">freq</code><code class="o">=</code><code class="s1">'1min'</code><code class="p">):</code>&#13;
    <code class="sd">'''</code>&#13;
<code class="sd">    Function to generate sample financial data.</code>&#13;
&#13;
<code class="sd">    Parameters</code>&#13;
<code class="sd">    ==========</code>&#13;
<code class="sd">    rows: int</code>&#13;
<code class="sd">        number of rows to generate</code>&#13;
<code class="sd">    cols: int</code>&#13;
<code class="sd">        number of columns to generate</code>&#13;
<code class="sd">    freq: str</code>&#13;
<code class="sd">        frequency string for DatetimeIndex</code>&#13;
&#13;
<code class="sd">    Returns</code>&#13;
<code class="sd">    =======</code>&#13;
<code class="sd">    df: DataFrame</code>&#13;
<code class="sd">        DataFrame object with the sample data</code>&#13;
<code class="sd">    '''</code>&#13;
    <code class="n">rows</code> <code class="o">=</code> <code class="nb">int</code><code class="p">(</code><code class="n">rows</code><code class="p">)</code>&#13;
    <code class="n">cols</code> <code class="o">=</code> <code class="nb">int</code><code class="p">(</code><code class="n">cols</code><code class="p">)</code>&#13;
    <code class="c1"># generate a DatetimeIndex object given the frequency</code>&#13;
    <code class="n">index</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">date_range</code><code class="p">(</code><code class="s1">'2021-1-1'</code><code class="p">,</code> <code class="n">periods</code><code class="o">=</code><code class="n">rows</code><code class="p">,</code> <code class="n">freq</code><code class="o">=</code><code class="n">freq</code><code class="p">)</code>&#13;
    <code class="c1"># determine time delta in year fractions</code>&#13;
    <code class="n">dt</code> <code class="o">=</code> <code class="p">(</code><code class="n">index</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code> <code class="o">-</code> <code class="n">index</code><code class="p">[</code><code class="mi">0</code><code class="p">])</code> <code class="o">/</code> <code class="n">pd</code><code class="o">.</code><code class="n">Timedelta</code><code class="p">(</code><code class="n">value</code><code class="o">=</code><code class="s1">'365D'</code><code class="p">)</code>&#13;
    <code class="c1"># generate column names</code>&#13;
    <code class="n">columns</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'No</code><code class="si">%d</code><code class="s1">'</code> <code class="o">%</code> <code class="n">i</code> <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="n">cols</code><code class="p">)]</code>&#13;
    <code class="c1"># generate sample paths for geometric Brownian motion</code>&#13;
    <code class="n">raw</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">exp</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">cumsum</code><code class="p">((</code><code class="n">r</code> <code class="o">-</code> <code class="mf">0.5</code> <code class="o">*</code> <code class="n">sigma</code> <code class="o">**</code> <code class="mi">2</code><code class="p">)</code> <code class="o">*</code> <code class="n">dt</code> <code class="o">+</code>&#13;
                 <code class="n">sigma</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">dt</code><code class="p">)</code> <code class="o">*</code>&#13;
                 <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">standard_normal</code><code class="p">((</code><code class="n">rows</code><code class="p">,</code> <code class="n">cols</code><code class="p">)),</code> <code class="n">axis</code><code class="o">=</code><code class="mi">0</code><code class="p">))</code>&#13;
    <code class="c1"># normalize the data to start at 100</code>&#13;
    <code class="n">raw</code> <code class="o">=</code> <code class="n">raw</code> <code class="o">/</code> <code class="n">raw</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code> <code class="o">*</code> <code class="mi">100</code>&#13;
    <code class="c1"># generate the DataFrame object</code>&#13;
    <code class="n">df</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">raw</code><code class="p">,</code> <code class="n">index</code><code class="o">=</code><code class="n">index</code><code class="p">,</code> <code class="n">columns</code><code class="o">=</code><code class="n">columns</code><code class="p">)</code>&#13;
    <code class="k">return</code> <code class="n">df</code>&#13;
&#13;
&#13;
<code class="k">if</code> <code class="nv-Magic">__name__</code> <code class="o">==</code> <code class="s1">'__main__'</code><code class="p">:</code>&#13;
    <code class="n">rows</code> <code class="o">=</code> <code class="mi">5</code>  <code class="c1"># number of rows</code>&#13;
    <code class="n">columns</code> <code class="o">=</code> <code class="mi">3</code>  <code class="c1"># number of columns</code>&#13;
    <code class="n">freq</code> <code class="o">=</code> <code class="s1">'D'</code>  <code class="c1"># daily frequency</code>&#13;
    <code class="k">print</code><code class="p">(</code><code class="n">generate_sample_data</code><code class="p">(</code><code class="n">rows</code><code class="p">,</code> <code class="n">columns</code><code class="p">,</code> <code class="n">freq</code><code class="p">))</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45785385472888"><sup><a href="ch03.html#idm45785385472888-marker">1</a></sup> Of course, multiple <code>DataFrame</code> objects could also be stored in a single <code>HDFStore</code> object.</p><p data-type="footnote" id="idm45785385469896"><sup><a href="ch03.html#idm45785385469896-marker">2</a></sup> All values reported here are from the author’s MacMini with Intel i7 hexa core processor (12 threads), 32 GB of random access memory (DDR4 RAM), and a 512 GB solid state drive (SSD).</p></div></div></section></body></html>