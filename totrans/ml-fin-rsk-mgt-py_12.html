<html><head></head><body><section data-pdf-bookmark="Chapter 9. A Corporate Governance Risk Measure: Stock Price Crash" data-type="chapter" epub:type="chapter"><div class="chapter" id="chapter_9">&#13;
<h1><span class="label">Chapter 9. </span>A Corporate Governance Risk Measure: Stock Price Crash</h1>&#13;
&#13;
<blockquote data-type="epigram">&#13;
<p> Understanding corporate governance not only enlightens the discussion of perhaps marginal improvements in rich economies, but can also stimulate major institutional changes in places where they need to be made.</p>&#13;
<p data-type="attribution">Shleifer and Vishny (1997)</p>&#13;
</blockquote>&#13;
&#13;
<p><a data-primary="stock price crash risk" data-type="indexterm" id="ix_stock_price_crash_ch9"/><a data-primary="corporate governance" data-seealso="stock price crash risk" data-type="indexterm" id="idm45737205683824"/>Do you think that the quality of corporate governance can be assessed using a risk measure? According to recent studies, the answer is yes. The link between corporate governance and risk measure has been established via <em>stock price crash risk</em>, which is&#13;
referred to as the risk of a large negative individual stock return. This association triggered a lot of research in this field.</p>&#13;
&#13;
<p>The importance of detecting the determinants of stock price crash lies in identifying the root causes of low (or high) quality corporate governance.&#13;
Identifying these root causes help a company to concentrate on problematic managerial areas, enhancing the functioning performance of the company as well as improving its reputation. This, in turn, lowers the risk of stock price crash and increases the company‚Äôs total revenue.</p>&#13;
&#13;
<p>Stock price crash provides a signal for investors and risk managers about the weakness and strength of a company‚Äôs <em>corporate governance</em>. Corporate governance is defined as the way corporations are directed and controlled,&#13;
as well as the ways they are or are not ‚Äúpromoting corporate fairness, transparency, and accountability‚Äù (Wolfensohn 1999).</p>&#13;
&#13;
<p class="pagebreak-before less_space">Following this definition, corporate governance has three pillars:</p>&#13;
<dl>&#13;
<dt><a data-primary="fairness pillar, corporate governance" data-type="indexterm" id="idm45737205678384"/>Fairness</dt>&#13;
<dd>&#13;
<p>This principle refers to equal treatment of all shareholders.</p>&#13;
</dd>&#13;
<dt><a data-primary="transparency pillar, corporate governance" data-type="indexterm" id="idm45737205676432"/>Transparency</dt>&#13;
<dd>&#13;
<p>Informing shareholders about any company events&#13;
in a timely manner is called <em>transparency</em>. This implies the opposite of opaqueness, or a company‚Äôs unwillingness to disclose information to shareholders.</p>&#13;
</dd>&#13;
<dt><a data-primary="accountability pillar, corporate governance" data-type="indexterm" id="idm45737205709376"/>Accountability</dt>&#13;
<dd>&#13;
<p>This is related to setting a well-established code of conduct by which a fair, balanced, and understandable assessment of a company‚Äôs position is presented to shareholders.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p><a data-primary="agency cost" data-type="indexterm" id="idm45737205707168"/>Accountability is an instrument for controlling <em>agency cost</em>, which is a cost arising from competing interests of shareholders and management. <a data-primary="asymmetric information" data-secondary="and agency cost" data-secondary-sortas="agency cost" data-type="indexterm" id="idm45737205705952"/>Agency cost is another source of asymmetric information because managers and shareholders do not have the same amount of information.&#13;
Conflict arises when managers‚Äô and shareholders‚Äô interests diverge.&#13;
More precisely, managers are, on the one hand, willing to maximize their own power and wealth. On the other hand, shareholders are looking for a way to maximize shareholder values. These two goals may conflict, and because of the informational superiority of managers, some company policies may be intended to increase the power and wealth of the managers at the expense of shareholder interests.</p>&#13;
&#13;
<p>Therefore, stock price crash may be a warning sign about the quality of corporate governance. For instance, in the presence of information asymmetry, agency theory suggests that outside stakeholders let managers generate more opaque financial reports to withhold bad news (Hutton, Marcus, and Tehranian 2009). <a data-primary="discretionary-disclosure theory" data-type="indexterm" id="idm45737205703248"/>The more recent explanation of this phenomenon is known as <em>discretionary-disclosure</em> theory (Bae, Lim, and Wei 2006). According to this theory, firms prefer to announce good news immediately, but they stockpile negative information.  When the accumulated negative information reaches a tipping point, it will cause a large decline. Since concealing bad news about a firm prevents taking timely corrective actions, once the accumulated bad news is released to the market, investors will revise their future expectations, and  there will inevitably be a sudden decline in prices,&#13;
which is called <em>crash risk</em> (Hutton, Marcus, and Tehranian 2009 and Kim 2011).</p>&#13;
&#13;
<p>Moreover, opaque financial reporting, which is related to the accountability principle, creates an environment in which managers are unwilling to disclose bad news. This results in an unfair presentation of the financial position of a company and, in turn, increases the likelihood of future stock price crash (Bleck and Liu (2007), Myers (2006), and Kim and Zhang (2013)).</p>&#13;
&#13;
<p>Thus, the association between corporate governance and stock price crash is evident in various ways. In this chapter, we first visit stock price measures and then see how we can apply these measures to detect crashes.</p>&#13;
&#13;
<p><a data-primary="Compustat database" data-type="indexterm" id="idm45737205699344"/><a data-primary="CRSP (Center for Research in Security Prices)" data-type="indexterm" id="idm45737205698640"/>We‚Äôll first obtain some data from the Center for Research in Security Prices (CRSP) and Compustat database and then identify the main determinants of stock price crash.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>CRSP has provided data for academic research and to support classroom instructions since 1960. CRSP has high-quality data in finance, economics, and related fields. For more information see the <a href="https://oreil.ly/oO3X8">CRSP website</a>.</p>&#13;
&#13;
<p>Similarly, the Compustat database has provided financial, economic, and market information about global companies since 1962. It is a product of S&amp;P Global Market Intelligence. For more information see <a href="https://oreil.ly/E4Hpj">Compustat Brochure</a>.</p>&#13;
</div>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Stock Price Crash Measures" data-type="sect1"><div class="sect1" id="idm45737205694064">&#13;
<h1>Stock Price Crash Measures</h1>&#13;
&#13;
<p><a data-primary="stock price crash risk" data-secondary="stock price crash measures" data-type="indexterm" id="idm45737206820176"/>The literature about stock price crash has been growing and different crash measures are employed by different researchers. Before introducing ML-based crash measures, it is worth comparing the pros and cons of these differing approaches.</p>&#13;
&#13;
<p><a data-primary="crash risk measures" data-seealso="stock price crash risk" data-type="indexterm" id="idm45737206818496"/>The main crash measures used in the literature are:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Down-to-up volatility (DUVOL)</p>&#13;
</li>&#13;
<li>&#13;
<p>Negative coefficient of skewness (NCSKEW)</p>&#13;
</li>&#13;
<li>&#13;
<p>CRASH</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p><a data-primary="DUVOL (down-to-up volatility) crash measure method" data-type="indexterm" id="idm45737206814064"/>DUVOL is a very common crash-measure method based on the standard deviation of ‚Äúdown‚Äù and ‚Äúup‚Äù weekly&#13;
firm-specific returns. A down week is a week in which the firm-specific weekly stock return is below the mean weekly return over the fiscal year. Conversely, an up week is a week in which the firm-specific weekly stock return is above the mean weekly return over a fiscal year. Described mathematically:</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign DUVOL equals log left-parenthesis StartFraction left-parenthesis n Subscript u minus 1 Baseline right-parenthesis sigma-summation Underscript down Endscripts upper R Subscript i t Superscript 2 Baseline Over left-parenthesis n Subscript d minus 1 Baseline right-parenthesis sigma-summation Underscript up Endscripts upper R Subscript i t Superscript 2 Baseline EndFraction right-parenthesis dollar-sign">&#13;
  <mrow>&#13;
    <mtext>DUVOL</mtext>&#13;
    <mo>=</mo>&#13;
    <mo form="prefix">log</mo>&#13;
    <mo>(</mo>&#13;
    <mfrac><mrow><mrow><mo>(</mo><msub><mi>n</mi> <mrow><mi>u</mi><mo>-</mo><mn>1</mn></mrow> </msub><mo>)</mo></mrow><msub><mo>‚àë</mo> <mtext>down</mtext> </msub><msubsup><mi>R</mi> <mrow><mi>i</mi><mi>t</mi></mrow> <mn>2</mn> </msubsup></mrow> <mrow><mrow><mo>(</mo><msub><mi>n</mi> <mrow><mi>d</mi><mo>-</mo><mn>1</mn></mrow> </msub><mo>)</mo></mrow><msub><mo>‚àë</mo> <mtext>up</mtext> </msub><msubsup><mi>R</mi> <mrow><mi>i</mi><mi>t</mi></mrow> <mn>2</mn> </msubsup></mrow></mfrac>&#13;
    <mo>)</mo>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <em>n</em> is the number of trading weeks on stock <em>i</em> in year <em>t</em>, <math alttext="n Subscript u">&#13;
  <msub><mi>n</mi> <mi>u</mi> </msub>&#13;
</math> is the number of up weeks, and <math alttext="n Subscript d">&#13;
  <msub><mi>n</mi> <mi>d</mi> </msub>&#13;
</math> is the number of down weeks.&#13;
In a year, weeks with firm-specific returns below the annual mean are called down weeks, while the weeks with firm-specific returns above the annual mean are up weeks.</p>&#13;
&#13;
<p><a data-primary="NCSKEW (negative coefficient of skewness) crash measure method" data-type="indexterm" id="idm45737205642112"/>NCSKEW is calculated by taking the negative of the third moment of daily returns and dividing it by (the sample analog to) the standard deviation of daily returns raised to the third power (Chen, Hong, and Stein 2001):</p>&#13;
<div data-type="equation">&#13;
<math alttext="dollar-sign NCSKEW equals minus StartFraction left-parenthesis n left-parenthesis n minus 1 right-parenthesis Superscript 3 slash 2 Baseline sigma-summation upper R Subscript i t Superscript 3 Baseline right-parenthesis Over left-parenthesis left-parenthesis n minus 1 right-parenthesis left-parenthesis n minus 2 right-parenthesis left-parenthesis sigma-summation upper R Subscript i t Superscript 2 Baseline right-parenthesis Superscript 3 slash 2 Baseline right-parenthesis EndFraction dollar-sign">&#13;
  <mrow>&#13;
    <mtext>NCSKEW</mtext>&#13;
    <mo>=</mo>&#13;
    <mo>-</mo>&#13;
    <mfrac><mrow><mo>(</mo><mi>n</mi><msup><mrow><mo>(</mo><mi>n</mi><mo>-</mo><mn>1</mn><mo>)</mo></mrow> <mrow><mn>3</mn><mo>/</mo><mn>2</mn></mrow> </msup><mo>‚àë</mo><msubsup><mi>R</mi> <mrow><mi>i</mi><mi>t</mi></mrow> <mn>3</mn> </msubsup><mo>)</mo></mrow> <mrow><mo>(</mo><mrow><mo>(</mo><mi>n</mi><mo>-</mo><mn>1</mn><mo>)</mo></mrow><mrow><mo>(</mo><mi>n</mi><mo>-</mo><mn>2</mn><mo>)</mo></mrow><msup><mrow><mo>(</mo><mo>‚àë</mo><msubsup><mi>R</mi> <mrow><mi>i</mi><mi>t</mi></mrow> <mn>2</mn> </msubsup><mo>)</mo></mrow> <mrow><mn>3</mn><mo>/</mo><mn>2</mn></mrow> </msup><mo>)</mo></mrow></mfrac>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>The higher the values of the NCSKEW and DUVOL measures, the higher the risk of a crash.</p>&#13;
&#13;
<p><a data-primary="CRASH stock crash measure method" data-type="indexterm" id="idm45737205621776"/>The CRASH measure, on the other hand, is calculated based on the distance from the firm-specific weekly returns. That is, CRASH takes the value of 1 if the return is less than 3.09 (or sometimes 3.2) standard deviations below the mean, and a 0 otherwise.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Minimum Covariance Determinant" data-type="sect1"><div class="sect1" id="idm45737206821168">&#13;
<h1>Minimum Covariance Determinant</h1>&#13;
&#13;
<p><a data-primary="stock price crash risk" data-secondary="minimum covariance determinant method" data-type="indexterm" id="ix_stock_price_crash_mcd"/><a data-primary="ML (machine learning)" data-secondary="minimum covariance determinant method" data-type="indexterm" id="ix_ml_min_co-var_determin"/><a data-primary="MCD (minimum covariance determinant)" data-type="indexterm" id="ix_min_co-var_determin"/>It comes as no surprise that ML-based algorithms attract a great deal of attention, as they attack the weaknesses of the rule-based models and show good predictive performance. We‚Äôll therefore try to estimate stock price crash risk using an ML-based method called <em>minimum covariance determinant</em> (MCD).  MCD is a method proposed to detect anomalies in a distribution with elliptically symmetric and unimodal datasets. Anomalies in stock returns are detected using the MCD estimator, and this becomes the dependent variable in the logistic panel regression by which we explore the root causes of crash risk.</p>&#13;
&#13;
<p>The MCD estimator provides a robust and consistent method in detecting outliers.&#13;
This is important because outliers may have a huge effect on the multivariate analysis. As summarized by Finch (2012), the presence of outliers in multivariate analysis can distort the correlation coefficient causing biased estimates.</p>&#13;
&#13;
<p>The algorithm of MCD can be given as follows:</p>&#13;
<ol>&#13;
<li>&#13;
<p>Detect initial robust clustering based on the data.</p>&#13;
</li>&#13;
<li>&#13;
<p>Calculate mean vector <math alttext="upper M Superscript a">&#13;
  <msup><mi>M</mi> <mi>a</mi> </msup>&#13;
</math> and positive definite<sup><a data-type="noteref" href="ch09.html#idm45737208073680" id="idm45737208073680-marker">1</a></sup> covariance matrix <math alttext="sigma-summation Overscript a Endscripts">&#13;
  <msup><mo>‚àë</mo> <mi>a</mi> </msup>&#13;
</math> for each cluster.</p>&#13;
</li>&#13;
<li>&#13;
<p>Compute MCD, for each observation in the cluster.</p>&#13;
</li>&#13;
<li>&#13;
<p>Assign a new observation with smaller MCD to the cluster.</p>&#13;
</li>&#13;
<li>&#13;
<p>Select a half sample, <em>h</em>, based on smallest MCD and compute <math alttext="upper M Superscript a">&#13;
  <msup><mi>M</mi> <mi>a</mi> </msup>&#13;
</math> and <math alttext="sigma-summation Overscript a Endscripts">&#13;
  <msup><mo>‚àë</mo> <mi>a</mi> </msup>&#13;
</math> from <em>h</em>.</p>&#13;
</li>&#13;
<li>&#13;
<p>Repeat steps 2 through 5 until there is no room for change in <em>h</em>.</p>&#13;
</li>&#13;
<li>&#13;
<p>Detect outlier if&#13;
<math alttext="c Subscript p Baseline equals StartRoot chi Subscript p comma 0.95 Superscript 2 Baseline EndRoot">&#13;
  <mrow>&#13;
    <msub><mi>c</mi> <mi>p</mi> </msub>&#13;
    <mo>=</mo>&#13;
    <msqrt>&#13;
      <msubsup><mi>œá</mi> <mrow><mi>p</mi><mo>,</mo><mn>0</mn><mo>.</mo><mn>95</mn></mrow> <mn>2</mn> </msubsup>&#13;
    </msqrt>&#13;
  </mrow>&#13;
</math>   is less than <math alttext="d squared">&#13;
  <msup><mi>d</mi> <mn>2</mn> </msup>&#13;
</math>.</p>&#13;
</li>&#13;
&#13;
</ol>&#13;
&#13;
<p>The strength of the MCD comes in the form of its explainability, adjustability, low computational time requirement, and robustness:</p>&#13;
<dl>&#13;
<dt><a data-primary="explainability, MCD" data-type="indexterm" id="idm45737208050944"/>Explainability</dt>&#13;
<dd>&#13;
&#13;
<p>Explainability is the extent to which the algorithm behind a model can be explained.&#13;
MCD assumes the data to be elliptically distributed and the outliers are computed by the Mahalanobis distance metric.</p>&#13;
</dd>&#13;
</dl>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><a data-primary="Mahalanobis distance metric" data-type="indexterm" id="idm45737208048016"/>Mahalanobis distance is a distance metric used in multivariate settings. Of the distance measures, Mahalanobis stands out with its ability to detect outliers, even though it is a computationally expensive method, as it considers the inter-correlation structure of the variables.</p>&#13;
&#13;
<p>Mathematically, Mahalanobis distance is formulated as &#13;
<span class="keep-together">follows</span>:</p>&#13;
<div data-type="equation">&#13;
<math display="block">&#13;
  <mrow>&#13;
    <msub><mi>d</mi> <mi>m</mi> </msub>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <mi>x</mi>&#13;
      <mo>,</mo>&#13;
      <mi>Œº</mi>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
    <mo>=</mo>&#13;
    <msqrt>&#13;
      <mrow>&#13;
        <msup><mrow><mo>(</mo><mi>x</mi><mo>-</mo><mi>Œº</mi><mo>)</mo></mrow> <mi>T</mi> </msup>&#13;
        <msup><mo>‚àë</mo> <mrow><mo>-</mo><mn>1</mn></mrow> </msup>&#13;
        <mrow>&#13;
          <mo>(</mo>&#13;
          <mi>x</mi>&#13;
          <mo>-</mo>&#13;
          <mi>Œº</mi>&#13;
          <mo>)</mo>&#13;
        </mrow>&#13;
      </mrow>&#13;
    </msqrt>&#13;
    <mo>.</mo>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="mu equals double-struck upper E left-parenthesis upper X right-parenthesis">&#13;
  <mrow>&#13;
    <mi>Œº</mi>&#13;
    <mo>=</mo>&#13;
    <mi>ùîº</mi>&#13;
    <mo>(</mo>&#13;
    <mi>X</mi>&#13;
    <mo>)</mo>&#13;
  </mrow>&#13;
</math>, <math alttext="sigma-summation">&#13;
  <mo>‚àë</mo>&#13;
</math> is the covariance matrix, and <em>X</em> is a vector.</p>&#13;
</div>&#13;
<dl>&#13;
<dt><a data-primary="adjustability, MCD" data-type="indexterm" id="idm45737208023872"/>Adjustability</dt>&#13;
<dd>&#13;
<div class="openblock">&#13;
<p>Adjustability stresses the importance of having a data-dependent model that is allowed to calibrate itself on a consistent basis so that structural change can be captured.</p>&#13;
</div>&#13;
&#13;
</dd>&#13;
<dt><a data-primary="low computational time, MCD" data-type="indexterm" id="idm45737207693280"/>Low computational time</dt>&#13;
<dd>&#13;
<p>This refers to fast calculation of covariance matrix and avoids using an entire sample. Instead, MCD uses a half sample in which no outliers are included so that outlying observations do not skew MCD location or shape.</p>&#13;
</dd>&#13;
<dt><a data-primary="robustness, MCD" data-type="indexterm" id="idm45737207691040"/>Robustness</dt>&#13;
<dd>&#13;
<p>Using a half sample in MCD also ensures robustness, because it implies that the model is consistent under contamination (Hubert et al. 2018).</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>We‚Äôll now apply the MCD method to detect outliers in stock returns, and the result is employed as the dependent variable. Accordingly, if there is a crash in the stock price, the dependent variable takes the value of 1 and 0 otherwise.</p>&#13;
&#13;
<p><a data-primary="Elliptic Envelope library" data-type="indexterm" id="idm45737207688224"/>From the empirical standpoint, there is a built-in library to run this algorithm in Python that is <em>Elliptic Envelope</em> and we will make use of it.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Application of Minimum Covariance Determinant" data-type="sect1"><div class="sect1" id="idm45737205620016">&#13;
<h1>Application of Minimum Covariance Determinant</h1>&#13;
&#13;
<p>Thus far, we have discussed the theoretical background of stock price crash detection. From this point on, we will focus on the empirical part and see how we can incorporate theory into practice. While doing this, we won‚Äôt limit our attention to stock price crash detection. After proposing an ML-based stock price crash detection, we will delve into the root causes of the crashes. To do that, given the large body of literature, we will employ a number of variables to observe how and to what extent they affect the occurrence of stock price crash. Thus, the aim of this chapter is two-fold: detecting stock price crash and identifying the root causes of the crash. Please keep in mind that there are many different and competing ideas about the detection of stock price crash and the variables that affect this crash.</p>&#13;
&#13;
<p>In this analysis, we‚Äôll use the stock and balance sheet information of the following companies:</p>&#13;
<table>&#13;
&#13;
<tbody>&#13;
<tr>&#13;
<td><p>Apple</p></td>&#13;
<td><p>AT&amp;T</p></td>&#13;
<td><p>Banco Bradesco</p></td>&#13;
<td><p>Bank of America Corp.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>CISCO</p></td>&#13;
<td><p>Coca-Cola</p></td>&#13;
<td><p>Comcast</p></td>&#13;
<td><p>DuPont de Nemours</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Exxon Mobil Corp.</p></td>&#13;
<td><p>Facebook</p></td>&#13;
<td><p>Ford Motor</p></td>&#13;
<td><p>General Electric</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Intel Corp.</p></td>&#13;
<td><p>Johnson &amp; Johnson</p></td>&#13;
<td><p>J.P. Morgan</p></td>&#13;
<td><p>Merck &amp; Co., Inc.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Microsoft</p></td>&#13;
<td><p>Motus GI Holdings Inc.</p></td>&#13;
<td><p>Oracle Corp.</p></td>&#13;
<td><p>Pfizer Inc.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Procter &amp; Gamble Co.</p></td>&#13;
<td><p>Sherritt International Corp.</p></td>&#13;
<td><p>Sirius XM Holdings Inc.</p></td>&#13;
<td><p>Trisura Group Ltd.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>UBS</p></td>&#13;
<td><p>Verizon</p></td>&#13;
<td><p>Walmart</p></td>&#13;
<td><p>Wells Fargo &amp; Co.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p><a data-primary="firm-specific return" data-type="indexterm" id="idm45737207662336"/><a data-primary="return" data-secondary="firm-specific return" data-type="indexterm" id="idm45737207661632"/>To move forward, we need to calculate weekly firm-specific returns, but our data is daily, so let‚Äôs jump in and do the necessary coding:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">pandas</code><code> </code><code class="kn">as</code><code> </code><code class="nn">pd</code><code>&#13;
</code><code>        </code><code class="kn">import</code><code> </code><code class="nn">matplotlib.pyplot</code><code> </code><code class="kn">as</code><code> </code><code class="nn">plt</code><code>&#13;
</code><code>        </code><code class="kn">import</code><code> </code><code class="nn">numpy</code><code> </code><code class="kn">as</code><code> </code><code class="nn">np</code><code>&#13;
</code><code>        </code><code class="kn">import</code><code> </code><code class="nn">seaborn</code><code> </code><code class="kn">as</code><code> </code><code class="nn">sns</code><code class="p">;</code><code> </code><code class="n">sns</code><code class="o">.</code><code class="n">set</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>        </code><code class="n">pd</code><code class="o">.</code><code class="n">set_option</code><code class="p">(</code><code class="s1">'</code><code class="s1">use_inf_as_na</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="bp">True</code><code class="p">)</code><code>&#13;
</code><code>        </code><code class="kn">import</code><code> </code><code class="nn">warnings</code><code>&#13;
</code><code>        </code><code class="n">warnings</code><code class="o">.</code><code class="n">filterwarnings</code><code class="p">(</code><code class="s1">'</code><code class="s1">ignore</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">2</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">crash_data</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'</code><code class="s1">crash_data.csv</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">3</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">crash_data</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">3</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">Unnamed</code><code class="p">:</code><code> </code><code class="mi">0</code><code>       </code><code class="n">RET</code><code>      </code><code class="n">date</code><code> </code><code class="n">TICKER</code><code>    </code><code class="n">vwretx</code><code>  </code><code class="n">BIDLO</code><code>   </code><code class="n">ASKHI</code><code>    </code><code class="n">PRC</code><code>  </code><code>\&#13;
</code><code>        </code><code class="mi">0</code><code>    </code><code class="mi">27882462</code><code>  </code><code class="mf">0.041833</code><code>  </code><code class="mi">20100104</code><code>    </code><code class="n">BAC</code><code>  </code><code class="mf">0.017045</code><code>  </code><code class="mf">15.12</code><code>  </code><code class="mf">15.750</code><code>  </code><code class="mf">15.69</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="mi">1</code><code>    </code><code class="mi">27882463</code><code>  </code><code class="mf">0.032505</code><code>  </code><code class="mi">20100105</code><code>    </code><code class="n">BAC</code><code>  </code><code class="mf">0.003362</code><code>  </code><code class="mf">15.70</code><code>  </code><code class="mf">16.210</code><code>  </code><code class="mf">16.20</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="mi">2</code><code>    </code><code class="mi">27882464</code><code>  </code><code class="mf">0.011728</code><code>  </code><code class="mi">20100106</code><code>    </code><code class="n">BAC</code><code>  </code><code class="mf">0.001769</code><code>  </code><code class="mf">16.03</code><code>  </code><code class="mf">16.540</code><code>  </code><code class="mf">16.39</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="mi">3</code><code>    </code><code class="mi">27882465</code><code>  </code><code class="mf">0.032947</code><code>  </code><code class="mi">20100107</code><code>    </code><code class="n">BAC</code><code>  </code><code class="mf">0.002821</code><code>  </code><code class="mf">16.51</code><code>  </code><code class="mf">17.185</code><code>  </code><code class="mf">16.93</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="mi">4</code><code>    </code><code class="mi">27882466</code><code> </code><code class="o">-</code><code class="mf">0.008860</code><code>  </code><code class="mi">20100108</code><code>    </code><code class="n">BAC</code><code>  </code><code class="mf">0.004161</code><code>  </code><code class="mf">16.63</code><code>  </code><code class="mf">17.100</code><code>  </code><code class="mf">16.78</code><code>&#13;
</code><code>&#13;
</code><code>                   </code><code class="n">VOL</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="mi">0</code><code>  </code><code class="mf">180845100.0</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="mi">1</code><code>  </code><code class="mf">209521200.0</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="mi">2</code><code>  </code><code class="mf">205257900.0</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="mi">3</code><code>  </code><code class="mf">320868400.0</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="mi">4</code><code>  </code><code class="mf">220104600.0</code><code>&#13;
</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">crash_data</code><code class="o">.</code><code class="n">date</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">to_datetime</code><code class="p">(</code><code class="n">crash_data</code><code class="o">.</code><code class="n">date</code><code class="p">,</code><code> </code><code class="n">format</code><code class="o">=</code><code class="s1">'</code><code class="si">%Y</code><code class="si">%m</code><code class="si">%d</code><code class="s1">'</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO1-1" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>        </code><code class="n">crash_data</code><code> </code><code class="o">=</code><code> </code><code class="n">crash_data</code><code class="o">.</code><code class="n">set_index</code><code class="p">(</code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO1-2" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO1-2"><img alt="2" src="assets/2.png"/></a></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO1-1" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Converting date column into proper date format</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO1-2" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO1-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Setting date as index</p></dd>&#13;
</dl>&#13;
&#13;
<p>As a reminder, the data we‚Äôre using has been collected from CRSP and Compustat. <a data-type="xref" href="#att_exp_2">Table¬†9-1</a> provides a brief explanation of the data.</p>&#13;
<table id="att_exp_2">&#13;
<caption><span class="label">Table 9-1. </span>Attributes and explanations</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Attribute</th>&#13;
<th>Explanation</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>RET</code></p></td>&#13;
<td><p>The stock return</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>vwretx</code></p></td>&#13;
<td><p>The volume weighted return</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>BIDLO</code></p></td>&#13;
<td><p>The lowest bid price</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>ASKHI</code></p></td>&#13;
<td><p>The highest ask price</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>PRC</code></p></td>&#13;
<td><p>The trading price</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>VOL</code></p></td>&#13;
<td><p>The trading volume</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>Given this data, let‚Äôs calculate the weekly mean return and generate <a data-type="xref" href="#ret_hist">Figure¬†9-1</a> with the first four stocks. To do this calculation, we‚Äôll also calculate the weekly mean of the other variables, as we‚Äôll use them along the way:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">5</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">crash_dataw</code><code> </code><code class="o">=</code><code> </code><code class="n">crash_data</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">)</code><code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'</code><code class="s1">W</code><code class="s1">'</code><code class="p">)</code><code class="o">.</code><code>\&#13;
</code><code>                      </code><code class="n">agg</code><code class="p">(</code><code class="p">{</code><code class="s1">'</code><code class="s1">RET</code><code class="s1">'</code><code class="p">:</code><code class="s1">'</code><code class="s1">mean</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">vwretx</code><code class="s1">'</code><code class="p">:</code><code class="s1">'</code><code class="s1">mean</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">VOL</code><code class="s1">'</code><code class="p">:</code><code class="s1">'</code><code class="s1">mean</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                           </code><code class="s1">'</code><code class="s1">BIDLO</code><code class="s1">'</code><code class="p">:</code><code class="s1">'</code><code class="s1">mean</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ASKHI</code><code class="s1">'</code><code class="p">:</code><code class="s1">'</code><code class="s1">mean</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">PRC</code><code class="s1">'</code><code class="p">:</code><code class="s1">'</code><code class="s1">mean</code><code class="s1">'</code><code class="p">}</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO2-1" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO2-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">6</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">crash_dataw</code><code> </code><code class="o">=</code><code> </code><code class="n">crash_dataw</code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>        </code><code class="n">crash_dataw</code><code class="o">.</code><code class="n">dropna</code><code class="p">(</code><code class="n">inplace</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code><code>&#13;
</code><code>        </code><code class="n">stocks</code><code> </code><code class="o">=</code><code> </code><code class="n">crash_dataw</code><code class="o">.</code><code class="n">TICKER</code><code class="o">.</code><code class="n">unique</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">7</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">12</code><code class="p">,</code><code> </code><code class="mi">8</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>        </code><code class="n">k</code><code> </code><code class="o">=</code><code> </code><code class="mi">1</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="n">stocks</code><code class="p">[</code><code class="p">:</code><code> </code><code class="mi">4</code><code class="p">]</code><code class="p">:</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO2-2" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO2-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>            </code><code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">k</code><code class="p">)</code><code>&#13;
</code><code>            </code><code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">crash_dataw</code><code class="p">[</code><code class="n">crash_dataw</code><code class="o">.</code><code class="n">TICKER</code><code> </code><code class="o">==</code><code> </code><code class="n">i</code><code class="p">]</code><code class="p">[</code><code class="s1">'</code><code class="s1">RET</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>&#13;
</code><code>            </code><code class="n">plt</code><code class="o">.</code><code class="n">title</code><code class="p">(</code><code class="s1">'</code><code class="s1">Histogram of </code><code class="s1">'</code><code class="o">+</code><code class="n">i</code><code class="p">)</code><code>&#13;
</code><code>            </code><code class="n">k</code><code class="o">+</code><code class="o">=</code><code class="mi">1</code><code>&#13;
</code><code>        </code><code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">(</code><code class="p">)</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO2-1" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO2-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Computing weekly returns per stocks along with other variables</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO2-2" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO2-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Picking first four stocks</p></dd>&#13;
</dl>&#13;
&#13;
<p><a data-type="xref" href="#ret_hist">Figure¬†9-1</a> shows the histograms of our four first stocks, namely, Apple, Bank &#13;
<span class="keep-together">of America</span>, Banco Bradesco, and Comcast. As expected, the distributions seem to &#13;
<span class="keep-together">be normal</span>, but we now have returns that, generally speaking,&#13;
show leptokurtic &#13;
<span class="keep-together">distribution</span>.</p>&#13;
&#13;
<figure><div class="figure" id="ret_hist">&#13;
<img alt="ret_hist" src="assets/mlfr_0901.png"/>&#13;
<h6><span class="label">Figure 9-1. </span>Return histogram</h6>&#13;
</div></figure>&#13;
&#13;
<p>In what follows, we calculate return in a way to exclude market impact, which is known as finding the <em>firm-specific return</em>. To calculate the firm-specific weekly return, we run linear regression based on the following equation:</p>&#13;
<div data-type="equation">&#13;
<math alttext="r Subscript j comma t Baseline equals alpha 0 plus beta 1 r Subscript m comma t minus 2 Baseline plus beta 2 r Subscript m comma t minus 1 Baseline plus beta 3 r Subscript m comma t Baseline plus beta 4 r Subscript m comma t plus 1 Baseline plus beta 5 r Subscript m comma t plus 2 Baseline plus epsilon Subscript j comma t" display="block">&#13;
  <mrow>&#13;
    <msub><mi>r</mi> <mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
    <mo>=</mo>&#13;
    <msub><mi>Œ±</mi> <mn>0</mn> </msub>&#13;
    <mo>+</mo>&#13;
    <msub><mi>Œ≤</mi> <mn>1</mn> </msub>&#13;
    <msub><mi>r</mi> <mrow><mi>m</mi><mo>,</mo><mi>t</mi><mo>-</mo><mn>2</mn></mrow> </msub>&#13;
    <mo>+</mo>&#13;
    <msub><mi>Œ≤</mi> <mn>2</mn> </msub>&#13;
    <msub><mi>r</mi> <mrow><mi>m</mi><mo>,</mo><mi>t</mi><mo>-</mo><mn>1</mn></mrow> </msub>&#13;
    <mo>+</mo>&#13;
    <msub><mi>Œ≤</mi> <mn>3</mn> </msub>&#13;
    <msub><mi>r</mi> <mrow><mi>m</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
    <mo>+</mo>&#13;
    <msub><mi>Œ≤</mi> <mn>4</mn> </msub>&#13;
    <msub><mi>r</mi> <mrow><mi>m</mi><mo>,</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow> </msub>&#13;
    <mo>+</mo>&#13;
    <msub><mi>Œ≤</mi> <mn>5</mn> </msub>&#13;
    <msub><mi>r</mi> <mrow><mi>m</mi><mo>,</mo><mi>t</mi><mo>+</mo><mn>2</mn></mrow> </msub>&#13;
    <mo>+</mo>&#13;
    <msub><mi>œµ</mi> <mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>where <math alttext="r Subscript j comma t">&#13;
  <msub><mi>r</mi> <mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
</math> is the return of firm <em>j</em> in week <em>t</em>, and <math alttext="r Subscript m">&#13;
  <msub><mi>r</mi> <mi>m</mi> </msub>&#13;
</math>, <em>t</em> is the return on the CRSP value-weighted market return in week <em>t</em>.&#13;
Scaling the residuals of this regression by 1 + logarithm provides us the firm-specific return.</p>&#13;
&#13;
<p>According to the expanded market model, the firm specific weekly returns can be calculated as <math alttext="upper W Subscript i comma t Baseline equals l n left-parenthesis 1 plus epsilon Subscript i comma t Baseline right-parenthesis">&#13;
  <mrow>&#13;
    <msub><mi>W</mi> <mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
    <mo>=</mo>&#13;
    <mi>l</mi>&#13;
    <mi>n</mi>&#13;
    <mrow>&#13;
      <mo>(</mo>&#13;
      <mn>1</mn>&#13;
      <mo>+</mo>&#13;
      <msub><mi>œµ</mi> <mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
      <mo>)</mo>&#13;
    </mrow>&#13;
  </mrow>&#13;
</math> (Kim, Li, and Zhang 2011):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">8</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">import</code><code> </code><code class="nn">statsmodels.api</code><code> </code><code class="kn">as</code><code> </code><code class="nn">sm</code><code>&#13;
</code><code>        </code><code class="n">residuals</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="n">stocks</code><code class="p">:</code><code>&#13;
</code><code>            </code><code class="n">Y</code><code> </code><code class="o">=</code><code> </code><code class="n">crash_dataw</code><code class="o">.</code><code class="n">loc</code><code class="p">[</code><code class="n">crash_dataw</code><code class="p">[</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="n">i</code><code class="p">]</code><code class="p">[</code><code class="s1">'</code><code class="s1">RET</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">values</code><code>&#13;
</code><code>            </code><code class="n">X</code><code> </code><code class="o">=</code><code> </code><code class="n">crash_dataw</code><code class="o">.</code><code class="n">loc</code><code class="p">[</code><code class="n">crash_dataw</code><code class="p">[</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="n">i</code><code class="p">]</code><code class="p">[</code><code class="s1">'</code><code class="s1">vwretx</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">values</code><code>&#13;
</code><code>            </code><code class="n">X</code><code> </code><code class="o">=</code><code> </code><code class="n">sm</code><code class="o">.</code><code class="n">add_constant</code><code class="p">(</code><code class="n">X</code><code class="p">)</code><code>&#13;
</code><code>            </code><code class="n">ols</code><code> </code><code class="o">=</code><code> </code><code class="n">sm</code><code class="o">.</code><code class="n">OLS</code><code class="p">(</code><code class="n">Y</code><code class="p">[</code><code class="mi">2</code><code class="p">:</code><code class="o">-</code><code class="mi">2</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">X</code><code class="p">[</code><code class="mi">2</code><code class="p">:</code><code class="o">-</code><code class="mi">2</code><code class="p">]</code><code> </code><code class="o">+</code><code> </code><code class="n">X</code><code class="p">[</code><code class="mi">1</code><code class="p">:</code><code class="o">-</code><code class="mi">3</code><code class="p">]</code><code> </code><code class="o">+</code><code> </code><code class="n">X</code><code class="p">[</code><code class="mi">0</code><code class="p">:</code><code class="o">-</code><code class="mi">4</code><code class="p">]</code><code> </code><code class="o">+</code><code> </code><code>\&#13;
</code><code>                         </code><code class="n">X</code><code class="p">[</code><code class="mi">3</code><code class="p">:</code><code class="o">-</code><code class="mi">1</code><code class="p">]</code><code> </code><code class="o">+</code><code> </code><code class="n">X</code><code class="p">[</code><code class="mi">4</code><code class="p">:</code><code class="p">]</code><code class="p">)</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO3-1" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO3-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>            </code><code class="n">residuals</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">ols</code><code class="o">.</code><code class="n">resid</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">9</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">residuals</code><code> </code><code class="o">=</code><code> </code><code class="nb">list</code><code class="p">(</code><code class="nb">map</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">log</code><code class="p">(</code><code class="mi">1</code><code> </code><code class="o">+</code><code> </code><code class="n">x</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">residuals</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO3-2" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO3-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">crash_data_sliced</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="p">[</code><code class="p">]</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="n">stocks</code><code class="p">:</code><code>&#13;
</code><code>             </code><code class="n">crash_data_sliced</code><code> </code><code class="o">=</code><code> </code><code class="n">crash_data_sliced</code><code class="o">.</code><code>\&#13;
</code><code>                                 </code><code class="n">append</code><code class="p">(</code><code class="n">crash_dataw</code><code class="o">.</code><code class="n">loc</code><code class="p">[</code><code class="n">crash_dataw</code><code class="o">.</code><code class="n">TICKER</code><code> </code><code class="o">==</code><code> </code><code class="n">i</code><code class="p">]</code><code>&#13;
</code><code>                                        </code><code class="p">[</code><code class="mi">2</code><code class="p">:</code><code class="o">-</code><code class="mi">2</code><code class="p">]</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO3-3" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO3-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>         </code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">10</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">TICKER</code><code>       </code><code class="n">date</code><code>       </code><code class="n">RET</code><code>    </code><code class="n">vwretx</code><code>          </code><code class="n">VOL</code><code>       </code><code class="n">BIDLO</code><code>&#13;
</code><code>          </code><code class="n">ASKHI</code><code>  </code><code>\&#13;
</code><code>         </code><code class="mi">2</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2010</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mi">24</code><code> </code><code class="o">-</code><code class="mf">0.009510</code><code> </code><code class="o">-</code><code class="mf">0.009480</code><code>  </code><code class="mf">25930885.00</code><code>  </code><code class="mf">205.277505</code><code>&#13;
</code><code>          </code><code class="mf">212.888450</code><code>&#13;
</code><code>         </code><code class="mi">3</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2010</code><code class="o">-</code><code class="mo">01</code><code class="o">-</code><code class="mi">31</code><code> </code><code class="o">-</code><code class="mf">0.005426</code><code> </code><code class="o">-</code><code class="mf">0.003738</code><code>  </code><code class="mf">52020594.00</code><code>  </code><code class="mf">198.250202</code><code>&#13;
</code><code>          </code><code class="mf">207.338002</code><code>&#13;
</code><code>         </code><code class="mi">4</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2010</code><code class="o">-</code><code class="mo">02</code><code class="o">-</code><code class="mo">07</code><code>  </code><code class="mf">0.003722</code><code> </code><code class="o">-</code><code class="mf">0.001463</code><code>  </code><code class="mf">26953208.40</code><code>  </code><code class="mf">192.304004</code><code>&#13;
</code><code>          </code><code class="mf">197.378002</code><code>&#13;
</code><code>         </code><code class="mi">5</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2010</code><code class="o">-</code><code class="mo">02</code><code class="o">-</code><code class="mi">14</code><code>  </code><code class="mf">0.005031</code><code>  </code><code class="mf">0.002970</code><code>  </code><code class="mf">19731018.60</code><code>  </code><code class="mf">194.513998</code><code>&#13;
</code><code>          </code><code class="mf">198.674002</code><code>&#13;
</code><code>         </code><code class="mi">6</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2010</code><code class="o">-</code><code class="mo">02</code><code class="o">-</code><code class="mi">21</code><code>  </code><code class="mf">0.001640</code><code>  </code><code class="mf">0.007700</code><code>  </code><code class="mf">16618997.25</code><code>  </code><code class="mf">201.102500</code><code>&#13;
</code><code>          </code><code class="mf">203.772500</code><code>&#13;
</code><code>&#13;
</code><code>                   </code><code class="n">PRC</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="mi">2</code><code>  </code><code class="mf">208.146752</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="mi">3</code><code>  </code><code class="mf">201.650398</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="mi">4</code><code>  </code><code class="mf">195.466002</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="mi">5</code><code>  </code><code class="mf">196.895200</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="mi">6</code><code>  </code><code class="mf">202.636995</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO3-1" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO3-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Running linear regression by the predefined equation</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO3-2" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO3-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Computing the 1 + logarithm of the residuals</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO3-3" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO3-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Dropping the first and last two observations to align with the previous data</p></dd>&#13;
</dl>&#13;
&#13;
<p>After all these preparations, we are ready to run the <a data-primary="Elliptic Envelope library" data-type="indexterm" id="idm45737204501152"/>Elliptic Envelope to detect the crash.</p>&#13;
&#13;
<p>Only two parameters are identified: <code>support_fraction</code> and <code>contamination</code>. The former parameter is used to control for the proportion of points to be included in the support of the raw MCD estimate, and the latter is used to identify the proportion of outliers in the dataset:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">11</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">from</code><code> </code><code class="nn">sklearn.covariance</code><code> </code><code class="kn">import</code><code> </code><code class="n">EllipticEnvelope</code><code>&#13;
</code><code>         </code><code class="n">envelope</code><code> </code><code class="o">=</code><code> </code><code class="n">EllipticEnvelope</code><code class="p">(</code><code class="n">contamination</code><code class="o">=</code><code class="mf">0.02</code><code class="p">,</code><code> </code><code class="n">support_fraction</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-1" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO4-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>         </code><code class="n">ee_predictions</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="p">}</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="k">for</code><code> </code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">j</code><code> </code><code class="ow">in</code><code> </code><code class="nb">zip</code><code class="p">(</code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">stocks</code><code class="p">)</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">stocks</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>             </code><code class="n">envelope</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="n">residuals</code><code class="p">[</code><code class="n">i</code><code class="p">]</code><code class="p">)</code><code class="o">.</code><code class="n">reshape</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>             </code><code class="n">ee_predictions</code><code class="p">[</code><code class="n">j</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">envelope</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="n">residuals</code><code class="p">[</code><code class="n">i</code><code class="p">]</code><code class="p">)</code><code>&#13;
</code><code>                                                  </code><code class="o">.</code><code class="n">reshape</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-2" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO4-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">12</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">transform</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="k">for</code><code> </code><code class="n">i</code><code> </code><code class="ow">in</code><code> </code><code class="n">stocks</code><code class="p">:</code><code>&#13;
</code><code>             </code><code class="k">for</code><code> </code><code class="n">j</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">ee_predictions</code><code class="p">[</code><code class="n">i</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>                 </code><code class="n">transform</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">where</code><code class="p">(</code><code class="n">ee_predictions</code><code class="p">[</code><code class="n">i</code><code class="p">]</code><code class="p">[</code><code class="n">j</code><code class="p">]</code><code> </code><code class="o">==</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-3" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO4-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">13</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">crash_data_sliced</code><code> </code><code class="o">=</code><code> </code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">crash_data_sliced</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">concatenate</code><code class="p">(</code><code class="n">residuals</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-4" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO4-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>         </code><code class="n">crash_data_sliced</code><code class="p">[</code><code class="s1">'</code><code class="s1">neg_outliers</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">where</code><code class="p">(</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="n">transform</code><code class="p">)</code><code class="p">)</code><code> </code><code>\&#13;
</code><code>                                                        </code><code class="o">==</code><code> </code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-5" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO4-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>         </code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">loc</code><code class="p">[</code><code class="p">(</code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">neg_outliers</code><code> </code><code class="o">==</code><code> </code><code class="mi">1</code><code class="p">)</code><code> </code><code class="o">&amp;</code><code>&#13;
</code><code>                               </code><code class="p">(</code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">residuals</code><code> </code><code class="o">&gt;</code><code> </code><code class="mi">0</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                               </code><code class="s1">'</code><code class="s1">neg_outliers</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-6" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO4-6"><img alt="6" src="assets/6.png"/></a></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO4-1" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Running Elliptic Envelope with <code>contamination</code> and <code>support_fraction</code> as 2 and 1, respectively</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO4-2" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Predicting the crashes</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO4-3" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Transforming crashes into desired form</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO4-4" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Obtaining a one-dimensional <code>numpy</code> array to create a new column in the &#13;
<span class="keep-together">dataframe</span></p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO4-5" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Performing the final transformation for crashes, named <code>neg_outliers</code></p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO4-6" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO4-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>Getting rid of crashes on the positive side (i.e., the right tail) of the distribution</p></dd>&#13;
</dl>&#13;
&#13;
<p>The following code block is provided to visualize if the algorithm properly captures the crashes. In this analysis, General Motors, Intel, Johnson &amp; Johnson, and J.P. Morgan are used. As suggested by the resultant <a data-type="xref" href="#anomaly_hist">Figure¬†9-2</a>, the algorithm works fine and identifies the crashes on the negative side of the distribution (shown as black bars):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">12</code><code class="p">,</code> <code class="mi">8</code><code class="p">))</code>&#13;
         <code class="n">k</code> <code class="o">=</code> <code class="mi">1</code>&#13;
&#13;
         <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="n">stocks</code><code class="p">[</code><code class="mi">8</code><code class="p">:</code><code class="mi">12</code><code class="p">]:</code>&#13;
             <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="n">k</code><code class="p">)</code>&#13;
             <code class="n">crash_data_sliced</code><code class="p">[</code><code class="s1">'residuals'</code><code class="p">][</code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">i</code><code class="p">]</code>\&#13;
             <code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">label</code><code class="o">=</code><code class="s1">'normal'</code><code class="p">,</code> <code class="n">bins</code><code class="o">=</code><code class="mi">30</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>&#13;
             <code class="n">outliers</code> <code class="o">=</code> <code class="n">crash_data_sliced</code><code class="p">[</code><code class="s1">'residuals'</code><code class="p">]</code>&#13;
             <code class="p">[(</code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">i</code><code class="p">)</code> <code class="o">&amp;</code>&#13;
              <code class="p">(</code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">neg_outliers</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="p">)]</code>&#13;
             <code class="n">outliers</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">color</code><code class="o">=</code><code class="s1">'black'</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'anomaly'</code><code class="p">)</code>&#13;
             <code class="n">plt</code><code class="o">.</code><code class="n">title</code><code class="p">(</code><code class="n">i</code><code class="p">)</code>&#13;
             <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">()</code>&#13;
             <code class="n">k</code> <code class="o">+=</code> <code class="mi">1</code>&#13;
         <code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code></pre>&#13;
&#13;
<figure><div class="figure" id="anomaly_hist">&#13;
<img alt="anomaly_hist" src="assets/mlfr_0902.png"/>&#13;
<h6><span class="label">Figure 9-2. </span>Anomaly histogram</h6>&#13;
</div></figure>&#13;
&#13;
<p>From this point on, we will use two different datasets, as balance sheet information is required in this analysis. So we will convert our weekly data into an annual one so that this data will be merged with the balance sheet information (which includes annual information). In addition, the annual mean and standard deviation of returns are necessary to calculate&#13;
crash risk, another stock price crash risk:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">15</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">crash_data_sliced</code><code> </code><code class="o">=</code><code> </code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">set_index</code><code class="p">(</code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">index</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">to_datetime</code><code class="p">(</code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">index</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">16</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">std</code><code> </code><code class="o">=</code><code> </code><code class="n">crash_data</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">)</code><code class="p">[</code><code class="s1">'</code><code class="s1">RET</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'</code><code class="s1">W</code><code class="s1">'</code><code class="p">)</code><code class="o">.</code><code class="n">std</code><code class="p">(</code><code class="p">)</code><code>\&#13;
</code><code>               </code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">crash_dataw</code><code class="p">[</code><code class="s1">'</code><code class="s1">std</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">std</code><code class="p">[</code><code class="s1">'</code><code class="s1">RET</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO5-1" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO5-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">17</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">yearly_data</code><code> </code><code class="o">=</code><code> </code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">)</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code>\&#13;
</code><code>                       </code><code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'</code><code class="s1">Y</code><code class="s1">'</code><code class="p">)</code><code class="o">.</code><code class="n">agg</code><code class="p">(</code><code class="p">{</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">:</code><code class="p">{</code><code class="s1">'</code><code class="s1">mean</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">std</code><code class="s1">'</code><code class="p">}</code><code class="p">}</code><code class="p">)</code><code>\&#13;
</code><code>                       </code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">yearly_data</code><code class="o">.</code><code class="n">columns</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">mean</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">std</code><code class="s1">'</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="n">yearly_data</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">17</code><code class="p">]</code><code class="p">:</code><code>   </code><code class="n">TICKER</code><code>       </code><code class="n">date</code><code>      </code><code class="n">mean</code><code>       </code><code class="n">std</code><code>&#13;
</code><code>         </code><code class="mi">0</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2010</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>  </code><code class="mf">0.000686</code><code>  </code><code class="mf">0.008291</code><code>&#13;
</code><code>         </code><code class="mi">1</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2011</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>  </code><code class="mf">0.000431</code><code>  </code><code class="mf">0.009088</code><code>&#13;
</code><code>         </code><code class="mi">2</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2012</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code> </code><code class="o">-</code><code class="mf">0.000079</code><code>  </code><code class="mf">0.008056</code><code>&#13;
</code><code>         </code><code class="mi">3</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2013</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code> </code><code class="o">-</code><code class="mf">0.001019</code><code>  </code><code class="mf">0.009096</code><code>&#13;
</code><code>         </code><code class="mi">4</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2014</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>  </code><code class="mf">0.000468</code><code>  </code><code class="mf">0.006174</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">18</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_crash</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">merge</code><code class="p">(</code><code class="n">crash_data_sliced</code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">yearly_data</code><code class="p">,</code><code>&#13;
</code><code>                                </code><code class="n">how</code><code class="o">=</code><code class="s1">'</code><code class="s1">outer</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">on</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO5-2" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO5-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">19</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_crash</code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">annual_mean</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">annual_std</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash</code><code>\&#13;
</code><code>                                                      </code><code class="o">.</code><code class="n">sort_values</code><code class="p">(</code><code class="n">by</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                                                       </code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>\&#13;
</code><code>                                                      </code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="p">:</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mi">2</code><code class="p">:</code><code class="p">]</code><code>\&#13;
</code><code>                                                      </code><code class="o">.</code><code class="n">fillna</code><code class="p">(</code><code class="n">method</code><code class="o">=</code><code class="s1">'</code><code class="s1">bfill</code><code class="s1">'</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO5-3" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO5-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>         </code><code class="n">merge_crash</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash</code><code class="o">.</code><code class="n">sort_values</code><code class="p">(</code><code class="n">by</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                                                </code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code>\&#13;
</code><code>                                                               </code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code>\&#13;
</code><code>                                                      </code><code class="o">.</code><code class="n">fillna</code><code class="p">(</code><code class="n">method</code><code class="o">=</code><code class="s1">'</code><code class="s1">ffill</code><code class="s1">'</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO5-3" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO5-4"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>         </code><code class="n">merge_crash</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash</code><code class="o">.</code><code class="n">drop</code><code class="p">(</code><code class="n">merge_crash</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="p">:</code><code> </code><code class="p">,</code><code class="o">-</code><code class="mi">4</code><code class="p">:</code><code class="o">-</code><code class="mi">2</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">axis</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO5-4" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO5-5"><img alt="4" src="assets/4.png"/></a></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO5-1" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO5-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Resampling data to compute mean and standard deviation of returns</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO5-2" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO5-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Merging <code>yearly_data</code> and <code>crash_data_sliced</code> based on <code>Ticker</code> and <code>date</code></p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO5-3" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO5-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Backward filling for annual data</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO5-5" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO5-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Dropping columns to prevent confusion</p></dd>&#13;
</dl>&#13;
&#13;
<p><a data-primary="crash risk measures" data-type="indexterm" id="ix_crash_risk_meas"/>In the literature, one of the most widely used stock price crash measures is crash risk because it has a discrete type, making it a convenient tool for comparison purposes.</p>&#13;
&#13;
<p>So let‚Äôs now generate crash risk in Python. We‚Äôll use the <code>merge_crash</code> data we generated in the previous snippet. Given the formula for crash risk, we check if the weekly return is less than 3.09 standard deviations below the mean. If so, it is labeled as 1, indicating a crash, otherwise it‚Äôs labeled as 0. It will turn out that we have 44 crashes out of 13,502 observations.</p>&#13;
&#13;
<p>In the final block (<code>In [22]</code>), the crash risk measure is annualized so that we are able to include it in our final data:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">20</code><code class="p">]:</code> <code class="n">crash_risk_out</code> <code class="o">=</code> <code class="p">[]</code>&#13;
&#13;
         <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="n">stocks</code><code class="p">:</code>&#13;
             <code class="k">for</code> <code class="n">k</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">merge_crash</code><code class="p">[</code><code class="n">merge_crash</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">j</code><code class="p">])):</code>&#13;
                 <code class="k">if</code> <code class="n">merge_crash</code><code class="p">[</code><code class="n">merge_crash</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">j</code><code class="p">][</code><code class="s1">'residuals'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">k</code><code class="p">]</code> <code class="o">&lt;</code> \&#13;
                 <code class="n">merge_crash</code><code class="p">[</code><code class="n">merge_crash</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">j</code><code class="p">][</code><code class="s1">'annual_mean'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">k</code><code class="p">]</code> <code class="o">-</code> \&#13;
                 <code class="mf">3.09</code> <code class="o">*</code> \&#13;
                 <code class="n">merge_crash</code><code class="p">[</code><code class="n">merge_crash</code><code class="o">.</code><code class="n">TICKER</code> <code class="o">==</code> <code class="n">j</code><code class="p">][</code><code class="s1">'annual_std'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">k</code><code class="p">]:</code>&#13;
                     <code class="n">crash_risk_out</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code>&#13;
                 <code class="k">else</code><code class="p">:</code>&#13;
                     <code class="n">crash_risk_out</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">21</code><code class="p">]:</code> <code class="n">merge_crash</code><code class="p">[</code><code class="s1">'crash_risk'</code><code class="p">]</code> <code class="o">=</code> <code class="n">crash_risk_out</code>&#13;
         <code class="n">merge_crash</code><code class="p">[</code><code class="s1">'crash_risk'</code><code class="p">]</code><code class="o">.</code><code class="n">value_counts</code><code class="p">()</code>&#13;
<code class="n">Out</code><code class="p">[</code><code class="mi">21</code><code class="p">]:</code> <code class="mi">0</code>    <code class="mi">13476</code>&#13;
         <code class="mi">1</code>       <code class="mi">44</code>&#13;
         <code class="n">Name</code><code class="p">:</code> <code class="n">crash_risk</code><code class="p">,</code> <code class="n">dtype</code><code class="p">:</code> <code class="n">int64</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">22</code><code class="p">]:</code> <code class="n">merge_crash</code> <code class="o">=</code> <code class="n">merge_crash</code><code class="o">.</code><code class="n">set_index</code><code class="p">(</code><code class="s1">'date'</code><code class="p">)</code>&#13;
         <code class="n">merge_crash_annual</code> <code class="o">=</code> <code class="n">merge_crash</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'TICKER'</code><code class="p">)</code>\&#13;
                              <code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'1Y'</code><code class="p">)[</code><code class="s1">'crash_risk'</code><code class="p">]</code><code class="o">.</code><code class="n">sum</code><code class="p">()</code><code class="o">.</code><code class="n">reset_index</code><code class="p">()</code></pre>&#13;
&#13;
<p><a data-primary="DUVOL (down-to-up volatility) crash measure method" data-type="indexterm" id="ix_duvol_crash_meas"/><a data-primary="NCSKEW (negative coefficient of skewness) crash measure method" data-type="indexterm" id="ix_ncskew_crash_meas"/>If you are using multiple stocks as we are here, it is not an easy task to compute DUVOL and NCSKEW. The first step is to reckon the down and up weeks. As a reminder, a down (or up) week is computed as the week in which weekly return is less than (or greater than) the annual return.&#13;
In the last part of the following code block, we compute the necessary ingredients, such as square residuals, for down weeks that we‚Äôll need to calculate the DUVOL and NCSKEW crash measures:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">23</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">down</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="k">for</code><code> </code><code class="n">j</code><code> </code><code class="ow">in</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">merge_crash</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>&#13;
</code><code>             </code><code class="k">if</code><code> </code><code class="n">merge_crash</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">j</code><code class="p">]</code><code> </code><code class="o">&lt;</code><code> </code><code>\&#13;
</code><code>                </code><code class="n">merge_crash</code><code class="p">[</code><code class="s1">'</code><code class="s1">annual_mean</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="n">j</code><code class="p">]</code><code class="p">:</code><code>&#13;
</code><code>                 </code><code class="n">down</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO6-1" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO6-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>             </code><code class="k">else</code><code class="p">:</code><code>&#13;
</code><code>                 </code><code class="n">down</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO6-2" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO6-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">24</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_crash</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash</code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">merge_crash</code><code class="p">[</code><code class="s1">'</code><code class="s1">down</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">down</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">merge_crash</code><code class="p">[</code><code class="s1">'</code><code class="s1">up</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">1</code><code> </code><code class="o">-</code><code> </code><code class="n">merge_crash</code><code class="p">[</code><code class="s1">'</code><code class="s1">down</code><code class="s1">'</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="n">down_residuals</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash</code><code class="p">[</code><code class="n">merge_crash</code><code class="o">.</code><code class="n">down</code><code> </code><code class="o">==</code><code> </code><code class="mi">1</code><code class="p">]</code><code>\&#13;
</code><code>                          </code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO6-3" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO6-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>         </code><code class="n">up_residuals</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash</code><code class="p">[</code><code class="n">merge_crash</code><code class="o">.</code><code class="n">up</code><code> </code><code class="o">==</code><code> </code><code class="mi">1</code><code class="p">]</code><code>\&#13;
</code><code>                        </code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO6-4" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO6-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">25</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">down_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals_down_sq</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">down_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code>&#13;
</code><code>         </code><code class="n">down_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals_down_cubic</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">down_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">*</code><code class="o">*</code><code class="mi">3</code><code>&#13;
</code><code>         </code><code class="n">up_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals_up_sq</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">up_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code>&#13;
</code><code>         </code><code class="n">up_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals_up_cubic</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">up_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">3</code><code>&#13;
</code><code>         </code><code class="n">down_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">down_residuals</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">down_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="n">up_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">up_residuals</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">up_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="k">del</code><code> </code><code class="n">down_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="k">del</code><code> </code><code class="n">up_residuals</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">26</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_crash</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals_sq</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">2</code><code>&#13;
</code><code>         </code><code class="n">merge_crash</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals_cubic</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">*</code><code class="o">*</code><code> </code><code class="mi">3</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO6-1" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO6-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>If the conditional returns true, add 1 to the <code>down</code> list</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO6-2" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO6-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>If the conditional returns true, add 0 to the <code>down</code> list</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO6-3" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO6-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Creating a new variable named <code>down_residuals</code> including down weeks</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO6-4" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO6-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Creating a new variable named <code>up_residuals</code> including up weeks</p></dd>&#13;
</dl>&#13;
&#13;
<p>The next step is to merge <code>down_residuals</code> and <code>up_residuals</code> with <code>merge_crash</code>. Then, we specify and annualize all the variables we want to check to identify which variables matter most in explaining stock price crash:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">27</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_crash_all</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash</code><code class="o">.</code><code class="n">merge</code><code class="p">(</code><code class="n">down_residuals</code><code class="p">,</code><code>&#13;
</code><code>                                             </code><code class="n">on</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>                                             </code><code class="n">how</code><code class="o">=</code><code class="s1">'</code><code class="s1">outer</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">merge_crash_all</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash_all</code><code class="o">.</code><code class="n">merge</code><code class="p">(</code><code class="n">up_residuals</code><code class="p">,</code><code>&#13;
</code><code>                                                 </code><code class="n">on</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>                                                 </code><code class="n">how</code><code class="o">=</code><code class="s1">'</code><code class="s1">outer</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">28</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">cols</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">BIDLO</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ASKHI</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">residuals</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                 </code><code class="s1">'</code><code class="s1">annual_std</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">residuals_sq</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">residuals_cubic</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                 </code><code class="s1">'</code><code class="s1">down</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">up</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">residuals_up_sq</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">residuals_down_sq</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                 </code><code class="s1">'</code><code class="s1">neg_outliers</code><code class="s1">'</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="n">merge_crash_all</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash_all</code><code class="o">.</code><code class="n">set_index</code><code class="p">(</code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">merge_grouped</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash_all</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">)</code><code class="p">[</code><code class="n">cols</code><code class="p">]</code><code>\&#13;
</code><code>                         </code><code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'</code><code class="s1">1Y</code><code class="s1">'</code><code class="p">)</code><code class="o">.</code><code class="n">sum</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO7-1" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO7-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>         </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">neg_outliers</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">where</code><code class="p">(</code><code class="n">merge_grouped</code><code class="o">.</code><code class="n">neg_outliers</code><code> </code><code class="o">&gt;</code><code class="o">=</code><code>&#13;
</code><code>                                                  </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO7-2" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO7-2"><img alt="2" src="assets/2.png"/></a></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO7-1" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO7-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Specifying and annualizing the variables of interest</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO7-2" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO7-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Converting greater than 1 <code>negative outliers</code> observations, if any</p></dd>&#13;
</dl>&#13;
&#13;
<p>There are two important questions remaining: how many down and up weeks do we have, and what is their sum? These questions are important because the number of up and down weeks refers to <math alttext="n Subscript u">&#13;
  <msub><mi>n</mi> <mi>u</mi> </msub>&#13;
</math> and <math alttext="n Subscript d">&#13;
  <msub><mi>n</mi> <mi>d</mi> </msub>&#13;
</math> in the DUVOL formula, respectively. So let‚Äôs do that calculation:<a data-primary="" data-startref="ix_crash_risk_meas" data-type="indexterm" id="idm45737203611968"/></p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">29</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_grouped</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_grouped</code><code class="o">.</code><code class="n">set_index</code><code class="p">(</code><code class="s1">'</code><code class="s1">date</code><code class="s1">'</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">merge_all</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_grouped</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">)</code><code>\&#13;
</code><code>                     </code><code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'</code><code class="s1">1Y</code><code class="s1">'</code><code class="p">)</code><code class="o">.</code><code class="n">agg</code><code class="p">(</code><code class="p">{</code><code class="s1">'</code><code class="s1">down</code><code class="s1">'</code><code class="p">:</code><code class="p">[</code><code class="s1">'</code><code class="s1">sum</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">count</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>                                          </code><code class="s1">'</code><code class="s1">up</code><code class="s1">'</code><code class="p">:</code><code class="p">[</code><code class="s1">'</code><code class="s1">sum</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">count</code><code class="s1">'</code><code class="p">]</code><code class="p">}</code><code class="p">)</code><code>\&#13;
</code><code>                     </code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO8-1" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO8-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>         </code><code class="n">merge_all</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">29</code><code class="p">]</code><code class="p">:</code><code>   </code><code class="n">TICKER</code><code>       </code><code class="n">date</code><code> </code><code class="n">down</code><code>        </code><code class="n">up</code><code>&#13;
</code><code>                              </code><code class="nb">sum</code><code> </code><code class="n">count</code><code> </code><code class="nb">sum</code><code> </code><code class="n">count</code><code>&#13;
</code><code>         </code><code class="mi">0</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2010</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>   </code><code class="mi">27</code><code>     </code><code class="mi">1</code><code>  </code><code class="mi">23</code><code>     </code><code class="mi">1</code><code>&#13;
</code><code>         </code><code class="mi">1</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2011</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>   </code><code class="mi">26</code><code>     </code><code class="mi">1</code><code>  </code><code class="mi">27</code><code>     </code><code class="mi">1</code><code>&#13;
</code><code>         </code><code class="mi">2</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2012</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>   </code><code class="mi">28</code><code>     </code><code class="mi">1</code><code>  </code><code class="mi">26</code><code>     </code><code class="mi">1</code><code>&#13;
</code><code>         </code><code class="mi">3</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2013</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>   </code><code class="mi">24</code><code>     </code><code class="mi">1</code><code>  </code><code class="mi">29</code><code>     </code><code class="mi">1</code><code>&#13;
</code><code>         </code><code class="mi">4</code><code>   </code><code class="n">AAPL</code><code> </code><code class="mi">2014</code><code class="o">-</code><code class="mi">12</code><code class="o">-</code><code class="mi">31</code><code>   </code><code class="mi">22</code><code>     </code><code class="mi">1</code><code>  </code><code class="mi">31</code><code>     </code><code class="mi">1</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">30</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">down</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">down</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="s1">'</code><code class="s1">sum</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">values</code><code>&#13;
</code><code>         </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">up</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_all</code><code class="p">[</code><code class="s1">'</code><code class="s1">up</code><code class="s1">'</code><code class="p">]</code><code class="p">[</code><code class="s1">'</code><code class="s1">sum</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">values</code><code>&#13;
</code><code>         </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">count</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">down</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">+</code><code> </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">up</code><code class="s1">'</code><code class="p">]</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO8-1" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO8-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Calculating annualized summation and count of down and up weeks</p></dd>&#13;
</dl>&#13;
&#13;
<p>Finally, we are all set to calculate DUVOL and NCSKEW using all the inputs we‚Äôve derived so far:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">31</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_grouped</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_grouped</code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">32</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">duvol</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">log</code><code class="p">(</code><code class="p">(</code><code class="p">(</code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">up</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">)</code><code> </code><code class="o">*</code><code>&#13;
</code><code>                                          </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals_down_sq</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code> </code><code class="o">/</code><code>&#13;
</code><code>                                         </code><code class="p">(</code><code class="p">(</code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">down</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">)</code><code> </code><code class="o">*</code><code>&#13;
</code><code>                                          </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals_up_sq</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO9-1" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO9-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">duvol</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">33</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">-</code><code class="mf">0.023371498758114867</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">34</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">ncskew</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="o">-</code><code> </code><code class="p">(</code><code class="p">(</code><code class="p">(</code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">count</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">*</code><code>&#13;
</code><code>                                        </code><code class="p">(</code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">count</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">)</code><code> </code><code class="o">*</code><code class="o">*</code><code>&#13;
</code><code>                                        </code><code class="p">(</code><code class="mi">3</code><code> </code><code class="o">/</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="p">)</code><code> </code><code class="o">*</code><code>&#13;
</code><code>                                      </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals_cubic</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code> </code><code class="o">/</code><code>&#13;
</code><code>                                      </code><code class="p">(</code><code class="p">(</code><code class="p">(</code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">count</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="p">)</code><code> </code><code class="o">*</code><code>&#13;
</code><code>                                        </code><code class="p">(</code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">count</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">-</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="p">)</code><code> </code><code class="o">*</code><code>&#13;
</code><code>                                       </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">residuals_sq</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">*</code><code class="o">*</code><code>&#13;
</code><code>                                       </code><code class="p">(</code><code class="mi">3</code><code> </code><code class="o">/</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO9-2" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO9-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">ncskew</code><code class="s1">'</code><code class="p">]</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">35</code><code class="p">]</code><code class="p">:</code><code> </code><code class="o">-</code><code class="mf">0.031025284134663118</code><code>&#13;
</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">36</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">crash_risk</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash_annual</code><code class="p">[</code><code class="s1">'</code><code class="s1">crash_risk</code><code class="s1">'</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'</code><code class="s1">crash_risk</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">np</code><code class="o">.</code><code class="n">where</code><code class="p">(</code><code class="n">merge_grouped</code><code class="o">.</code><code class="n">crash_risk</code><code> </code><code class="o">&gt;</code><code class="o">=</code><code>&#13;
</code><code>                                                </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">37</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">merge_crash_all_grouped2</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash_all</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'</code><code class="s1">TICKER</code><code class="s1">'</code><code class="p">)</code><code>\&#13;
</code><code>                                     </code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">VOL</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">PRC</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code>\&#13;
</code><code>                                    </code><code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'</code><code class="s1">1Y</code><code class="s1">'</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">merge_grouped</code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">VOL</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">PRC</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_crash_all_grouped2</code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">VOL</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">PRC</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code>         </code><code class="n">merge_grouped</code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">ncskew</code><code class="s1">'</code><code class="p">,</code><code class="s1">'</code><code class="s1">duvol</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code class="o">.</code><code class="n">corr</code><code class="p">(</code><code class="p">)</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO9-1" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO9-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Calculating DUVOL</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO9-2" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO9-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Calculating NCSKEW</p></dd>&#13;
</dl>&#13;
&#13;
<p>DUVOL gives the proportion of the magnitude of the returns below the annual mean to the magnitude of the returns above the annual mean. Consequently, higher DUVOL implies left-skewed distribution or higher crash probability. Given the mean DUVOL value of -0.0233, we can come to the conclusion that stock prices are less likely to crash over the specified period.<a data-primary="" data-startref="ix_duvol_crash_meas" data-type="indexterm" id="idm45737201897632"/></p>&#13;
&#13;
<p>NSCKEW, on the other hand, compares the shapes of the tails‚Äîthat is, in the case of longer left tail compared to the right tail, stock prices tend to crash. As expected, the correlation between NCSKEW and DUVOL is high, confirming that both measures pick up much the same information through different ways.<a data-primary="" data-startref="ix_min_co-var_determin" data-type="indexterm" id="idm45737201924880"/><a data-primary="" data-startref="ix_ml_min_co-var_determin" data-type="indexterm" id="idm45737201923904"/><a data-primary="" data-startref="ix_stock_price_crash_mcd" data-type="indexterm" id="idm45737201922896"/><a data-primary="" data-startref="ix_ncskew_crash_meas" data-type="indexterm" id="idm45737201829744"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Logistic Panel Application" data-type="sect1"><div class="sect1" id="idm45737207685472">&#13;
<h1>Logistic Panel Application</h1>&#13;
&#13;
<p><a data-primary="stock price crash risk" data-secondary="logistic panel application" data-type="indexterm" id="ix_stock_crash_logist_panel"/><a data-primary="panel data analysis, stock price crash" data-type="indexterm" id="ix_panel_data_price_crash"/><a data-primary="logistic panel application" data-type="indexterm" id="ix_log_panel_app"/>Since we are seeking the variables that can explain the stock price crash risk, this section provides a backbone analysis. Because we have both stocks and time series in the data, panel data analysis is a suitable technique to use.</p>&#13;
&#13;
<p>At least three factors have contributed to the geometric growth of panel data studies (Hsiao 2014):</p>&#13;
<ol>&#13;
<li>&#13;
<p>Data availability</p>&#13;
</li>&#13;
<li>&#13;
<p>Greater capacity for modeling the complexity of human behavior than a single cross-section or time series data</p>&#13;
</li>&#13;
<li>&#13;
<p>Its challenging methodology</p>&#13;
</li>&#13;
&#13;
</ol>&#13;
&#13;
<p>In a nutshell, panel data analysis combines time series and cross-sectional data and, therefore, has many advantages over time series and cross-sectional analysis. Ullah (1998) summarizes these advantages this way:</p>&#13;
<blockquote>&#13;
<p>Obvious benefits are a much larger data set with more variability and less collinearity among the variables than is typical of cross-section or time-series data. With additional, more informative data, one can get more reliable estimates and test more sophisticated behavioral models with less restrictive assumptions. Another advantage of panel data sets are their ability to control for individual heterogeneity‚Ä¶ In particular, panel data sets are better able to study complex issues of dynamic behavior.</p></blockquote>&#13;
&#13;
<p>As our data is of discrete type, logistic panel  application addresses the need. However, there is a shortage of libraries for panel data analysis, and the situation is even worse when it comes to logistic panel applications. The library we‚Äôll use is the Python Econometrics Models module (<code>pyeconometrics</code>), which has a few advanced-level models, including:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Fixed effects logistic regression (Logit)</p>&#13;
</li>&#13;
<li>&#13;
<p>Random effects logistic regression (Logit and Probit)</p>&#13;
</li>&#13;
<li>&#13;
<p>Tobit I (linear regression for truncated data)</p>&#13;
</li>&#13;
</ul>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>A potential endogeneity problem arising from time-invariant omitted variables is one of the concerns that needs to be accounted for. To control for this, we‚Äôll use a fixed effect logistic panel model.</p>&#13;
</div>&#13;
&#13;
<p>To run a logistic panel application, the <code>pyeconometrics</code> module is used, but installation of this library is a bit different.  Please visit its <a href="https://oreil.ly/cxATG">GitHub repo</a> for more information.</p>&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p>Installing <code>pyeconometrics</code> is a bit different than installing some of the libraries and modules we‚Äôve used. To make sure you properly install the library, please visit its <a href="https://oreil.ly/Ap8NO">GitHub repo</a>.</p>&#13;
</div>&#13;
&#13;
<p>Let‚Äôs now introduce the variables we‚Äôll use in this analysis. Having obtained the stock price crash measures, it‚Äôs time to discuss which variables matter in estimating&#13;
stock price crash risk. <a data-type="xref" href="#table-9-1">Table¬†9-2</a> lists the independent variables.</p>&#13;
<table id="table-9-1">&#13;
<caption><span class="label">Table 9-2. </span>Independent variables used in the analysis of stock price crash</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Variable</th>&#13;
<th>Explanation</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p>Size (<code>log_size</code>)</p></td>&#13;
<td><p>Logarithm of total asset owned by company.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Receivables (<code>rect</code>)</p></td>&#13;
<td><p>Accounts receivable/debtors.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Property, plant and equipment (<code>ppegt</code>)</p></td>&#13;
<td><p>Total property, plant, and equipment.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Average turnover (<code>dturn</code>)</p></td>&#13;
<td><p>The average monthly turnover ratio in year <em>t</em> minus the average monthly turnover ratio in year <em>t</em> - 1. The turnover ratio is the monthly trading volume divided by the total number of shares outstanding.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>NCSKEW (<code>ncskew</code>)</p></td>&#13;
<td><p>The negative coefficient of skewness of firm-specific weekly returns in a year, which is the negative of the third moment of firm-specific weekly returns divided by the cubed standard deviation.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Firm-specific return &#13;
<span class="keep-together">(<code>residuals</code>)</span></p></td>&#13;
<td><p>The average of firm-specific weekly returns in a year.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Return on asset (<code>RoA</code>)</p></td>&#13;
<td><p>The returns on asset in a year, which is the ratio of net income to total assets.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Standard deviation (<code>annual_std</code>)</p></td>&#13;
<td><p>The standard deviation of firm-specific weekly returns in a year.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Firm-specific sentiment (<code>firm_sent</code>)</p></td>&#13;
<td><p>The firm-specific investor sentiment measure obtained by PCA.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>The return on assets and leverage variables are calculated using balance sheet data:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">38</code><code class="p">]:</code> <code class="n">bs</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'bs_v.3.csv'</code><code class="p">)</code>&#13;
         <code class="n">bs</code><code class="p">[</code><code class="s1">'Date'</code><code class="p">]</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">to_datetime</code><code class="p">(</code><code class="n">bs</code><code class="o">.</code><code class="n">datadate</code><code class="p">,</code> <code class="n">format</code><code class="o">=</code><code class="s1">'</code><code class="si">%Y%m%d</code><code class="s1">'</code><code class="p">)</code>&#13;
         <code class="n">bs</code><code class="p">[</code><code class="s1">'annual_date'</code><code class="p">]</code> <code class="o">=</code> <code class="n">bs</code><code class="p">[</code><code class="s1">'Date'</code><code class="p">]</code><code class="o">.</code><code class="n">dt</code><code class="o">.</code><code class="n">year</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">39</code><code class="p">]:</code> <code class="n">bs</code><code class="p">[</code><code class="s1">'RoA'</code><code class="p">]</code> <code class="o">=</code> <code class="n">bs</code><code class="p">[</code><code class="s1">'ni'</code><code class="p">]</code> <code class="o">/</code> <code class="n">bs</code><code class="p">[</code><code class="s1">'at'</code><code class="p">]</code>&#13;
         <code class="n">bs</code><code class="p">[</code><code class="s1">'leverage'</code><code class="p">]</code> <code class="o">=</code> <code class="n">bs</code><code class="p">[</code><code class="s1">'lt'</code><code class="p">]</code> <code class="o">/</code> <code class="n">bs</code><code class="p">[</code><code class="s1">'at'</code><code class="p">]</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">40</code><code class="p">]:</code> <code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'annual_date'</code><code class="p">]</code> <code class="o">=</code> <code class="n">merge_grouped</code><code class="p">[</code><code class="s1">'date'</code><code class="p">]</code><code class="o">.</code><code class="n">dt</code><code class="o">.</code><code class="n">year</code>&#13;
         <code class="n">bs</code><code class="p">[</code><code class="s1">'TICKER'</code><code class="p">]</code> <code class="o">=</code> <code class="n">bs</code><code class="o">.</code><code class="n">tic</code>&#13;
         <code class="k">del</code> <code class="n">bs</code><code class="p">[</code><code class="s1">'tic'</code><code class="p">]</code></pre>&#13;
&#13;
<p>The next step is to obtain the rest of the variables merging balance sheet data (<code>bs</code>) and stock-related data (<code>merge_crash_all_grouped</code>):</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">41</code><code class="p">]:</code> <code class="n">merge_ret_bs</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">merge</code><code class="p">(</code><code class="n">bs</code><code class="p">,</code> <code class="n">merge_grouped</code><code class="p">,</code>&#13;
                                 <code class="n">on</code><code class="o">=</code><code class="p">[</code><code class="s1">'TICKER'</code><code class="p">,</code> <code class="s1">'annual_date'</code><code class="p">])</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">42</code><code class="p">]:</code> <code class="n">merge_ret_bs2</code> <code class="o">=</code> <code class="n">merge_ret_bs</code><code class="o">.</code><code class="n">set_index</code><code class="p">(</code><code class="s1">'Date'</code><code class="p">)</code>&#13;
         <code class="n">merge_ret_bs2</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'TICKER'</code><code class="p">)</code><code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'Y'</code><code class="p">)</code><code class="o">.</code><code class="n">mean</code><code class="p">()</code>&#13;
         <code class="n">merge_ret_bs2</code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="n">inplace</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">43</code><code class="p">]:</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'vol_csho_diff'</code><code class="p">]</code> <code class="o">=</code> <code class="p">(</code><code class="n">merge_ret_bs2</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'TICKER'</code><code class="p">)</code>&#13;
                                           <code class="p">[</code><code class="s1">'VOL'</code><code class="p">]</code><code class="o">.</code><code class="n">shift</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">)</code> <code class="o">/</code>&#13;
                                           <code class="n">merge_ret_bs2</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'TICKER'</code><code class="p">)</code>&#13;
                                           <code class="p">[</code><code class="s1">'csho'</code><code class="p">]</code><code class="o">.</code><code class="n">shift</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">))</code>&#13;
         <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'dturn1'</code><code class="p">]</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'VOL'</code><code class="p">]</code> <code class="o">/</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'csho'</code><code class="p">]</code>&#13;
         <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'dturn'</code><code class="p">]</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'vol_csho_diff'</code><code class="p">]</code> <code class="o">-</code> \&#13;
                                  <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'dturn1'</code><code class="p">]</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">44</code><code class="p">]:</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'p/e'</code><code class="p">]</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'PRC'</code><code class="p">]</code> <code class="o">/</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'ni'</code><code class="p">]</code>&#13;
         <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'turnover_rate'</code><code class="p">]</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'VOL'</code><code class="p">]</code> <code class="o">/</code> \&#13;
                                          <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'csho'</code><code class="p">]</code>&#13;
         <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'equity_share'</code><code class="p">]</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'ceq'</code><code class="p">]</code> <code class="o">/</code> \&#13;
                                         <code class="p">(</code><code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'ceq'</code><code class="p">]</code> <code class="o">+</code>&#13;
                                          <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'dt'</code><code class="p">])</code>&#13;
         <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'firm_size'</code><code class="p">]</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">log</code><code class="p">(</code><code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'at'</code><code class="p">])</code>&#13;
         <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'cefd'</code><code class="p">]</code> <code class="o">=</code> <code class="p">(((</code><code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'at'</code><code class="p">]</code> <code class="o">-</code>&#13;
                                  <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'lt'</code><code class="p">])</code> <code class="o">/</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'csho'</code><code class="p">])</code> <code class="o">-</code>&#13;
                                  <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'PRC'</code><code class="p">])</code> <code class="o">/</code> <code class="p">(</code><code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'at'</code><code class="p">]</code> <code class="o">-</code>&#13;
                                  <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'lt'</code><code class="p">])</code> <code class="o">/</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'csho'</code><code class="p">]</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">45</code><code class="p">]:</code> <code class="n">merge_ret_bs2</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="o">.</code><code class="n">set_index</code><code class="p">(</code><code class="s1">'Date'</code><code class="p">)</code>&#13;
         <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'buying_volume'</code><code class="p">]</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'VOL'</code><code class="p">]</code> <code class="o">*</code> \&#13;
                                          <code class="p">(</code><code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'PRC'</code><code class="p">]</code> <code class="o">-</code>&#13;
                                           <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'BIDLO'</code><code class="p">])</code> <code class="o">/</code> \&#13;
                                          <code class="p">(</code><code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'ASKHI'</code><code class="p">]</code> <code class="o">-</code>&#13;
                                           <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'BIDLO'</code><code class="p">])</code>&#13;
         <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'selling_volume'</code><code class="p">]</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'VOL'</code><code class="p">]</code> <code class="o">*</code> \&#13;
                                           <code class="p">(</code><code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'ASKHI'</code><code class="p">]</code> <code class="o">-</code>&#13;
                                            <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'PRC'</code><code class="p">])</code> <code class="o">/</code> \&#13;
                                           <code class="p">(</code><code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'ASKHI'</code><code class="p">]</code> <code class="o">-</code>&#13;
                                            <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'BIDLO'</code><code class="p">])</code>&#13;
         <code class="n">buying_volume</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'TICKER'</code><code class="p">)[</code><code class="s1">'buying_volume'</code><code class="p">]</code> \&#13;
                         <code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'Y'</code><code class="p">)</code><code class="o">.</code><code class="n">sum</code><code class="p">()</code><code class="o">.</code><code class="n">reset_index</code><code class="p">()</code>&#13;
         <code class="n">selling_volume</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'TICKER'</code><code class="p">)[</code><code class="s1">'selling_volume'</code><code class="p">]</code> \&#13;
                         <code class="o">.</code><code class="n">resample</code><code class="p">(</code><code class="s1">'Y'</code><code class="p">)</code><code class="o">.</code><code class="n">sum</code><code class="p">()</code><code class="o">.</code><code class="n">reset_index</code><code class="p">()</code>&#13;
         <code class="k">del</code> <code class="n">buying_volume</code><code class="p">[</code><code class="s1">'TICKER'</code><code class="p">]</code>&#13;
         <code class="k">del</code> <code class="n">buying_volume</code><code class="p">[</code><code class="s1">'Date'</code><code class="p">]</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">46</code><code class="p">]:</code> <code class="n">buy_sel_vol</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">concat</code><code class="p">([</code><code class="n">buying_volume</code><code class="p">,</code><code class="n">selling_volume</code><code class="p">],</code> <code class="n">axis</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code>&#13;
         <code class="n">buy_sel_vol</code><code class="p">[</code><code class="s1">'bsi'</code><code class="p">]</code> <code class="o">=</code> <code class="p">(</code><code class="n">buy_sel_vol</code><code class="o">.</code><code class="n">buying_volume</code> <code class="o">-</code>&#13;
                               <code class="n">buy_sel_vol</code><code class="o">.</code><code class="n">selling_volume</code><code class="p">)</code> <code class="o">/</code> \&#13;
                              <code class="p">(</code><code class="n">buy_sel_vol</code><code class="o">.</code><code class="n">buying_volume</code> <code class="o">+</code>&#13;
                               <code class="n">buy_sel_vol</code><code class="o">.</code><code class="n">selling_volume</code><code class="p">)</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">47</code><code class="p">]:</code> <code class="n">merge_ret_bs2</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="o">.</code><code class="n">reset_index</code><code class="p">()</code>&#13;
         <code class="n">merge_ret_bs2</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">merge</code><code class="p">(</code><code class="n">buy_sel_vol</code> <code class="p">,</code><code class="n">merge_ret_bs2</code><code class="p">,</code>&#13;
                                  <code class="n">on</code><code class="o">=</code><code class="p">[</code><code class="s1">'TICKER'</code><code class="p">,</code> <code class="s1">'Date'</code><code class="p">])</code></pre>&#13;
&#13;
<p>Aside from firm-specific sentiment, the rest of the variables are widely used and quite useful in&#13;
explaining stock price crash risk.</p>&#13;
&#13;
<p>Deriving an index and using it as a proxy is something very popular among researchers&#13;
when it is hard to find a suitable variable to represent a phenomenon. For instance, assume that you think that the firm-specific sentiment is a variable that includes very powerful insight about stock price&#13;
crash, but how can you come up with a variable representing firm-specific sentiment? To address this issue, we can consider all the variables that are somewhat related to firm-specific sentiment, and then identify the relationships to create an index using principal component analysis. This is what we are about to do.</p>&#13;
&#13;
<p>Despite some well-known determinants of stock price crash risk, an important aspect of crash risk that‚Äôs thought to be neglected is firm-specific investor sentiment. It is rather intuitive to say that, depending on the perceptions of investors about a &#13;
<span class="keep-together">company</span>, the stock price might go up or down. That is, if an investor tends to feel &#13;
<span class="keep-together">optimistic</span> about an individual stock, it is likely that they will buy the asset, which, in turn, drives the price up or down (Yin and Tian 2017).</p>&#13;
&#13;
<p>In this respect, price-to-earnings ratio (P/E), turnover rate (TURN), equity share (EQS), closed-end fund discount (CEFD), leverage (LEV), buying and selling volume (BSI) are used in identifying the firm-specific sentiment. Explanations of these variables are provided in <a data-type="xref" href="#firm_specific">Table¬†9-3</a>.</p>&#13;
<table id="firm_specific">&#13;
<caption><span class="label">Table 9-3. </span>Variables used for firm-specific sentiment</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Variable</th>&#13;
<th>Explanation</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p>Price-to-earnings ratio (<code>p/e</code>)</p></td>&#13;
<td><p>Market value per share/earning per share</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Turnover rate (<code>turnover_rate</code>)</p></td>&#13;
<td><p>Total number of shares traded/average number of shares outstanding</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Equity share (<code>equity_share</code>)</p></td>&#13;
<td><p>Common stock</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Closed-end fund discount (<code>cefd</code>)</p></td>&#13;
<td><p>Assets that raise a fixed amount of capital through an initial public offering</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Leverage (<code>leverage</code>)</p></td>&#13;
<td><p>Sum of long-term debt and debt in current liabilities/total assets</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Buying and selling volume (<code>bsi</code>)</p></td>&#13;
<td><p>Buying (selling) volume is the number of shares that were associated with buying (selling) trades</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>To capture the firm-specific sentiment properly, we need to extract as much information as we can, and PCA is a convenient tool to accomplish this task with:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">48</code><code class="p">]</code><code class="p">:</code><code> </code><code class="kn">from</code><code> </code><code class="nn">sklearn.preprocessing</code><code> </code><code class="kn">import</code><code> </code><code class="n">StandardScaler</code><code>&#13;
</code><code>         </code><code class="kn">from</code><code> </code><code class="nn">sklearn.decomposition</code><code> </code><code class="kn">import</code><code> </code><code class="n">PCA</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">49</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">firm_sentiment</code><code> </code><code class="o">=</code><code> </code><code class="n">merge_ret_bs2</code><code class="p">[</code><code class="p">[</code><code class="s1">'</code><code class="s1">p/e</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">turnover_rate</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                         </code><code class="s1">'</code><code class="s1">equity_share</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">cefd</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                         </code><code class="s1">'</code><code class="s1">leverage</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">bsi</code><code class="s1">'</code><code class="p">]</code><code class="p">]</code><code>&#13;
</code><code>         </code><code class="n">firm_sentiment</code><code> </code><code class="o">=</code><code> </code><code class="n">firm_sentiment</code><code class="o">.</code><code class="n">apply</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">x</code><code class="o">.</code><code class="n">fillna</code><code class="p">(</code><code class="n">x</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                                               </code><code class="n">axis</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO10-1" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO10-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">50</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">firm_sentiment_std</code><code> </code><code class="o">=</code><code> </code><code class="n">StandardScaler</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="n">fit_transform</code><code class="p">(</code><code class="n">firm_sentiment</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">pca</code><code> </code><code class="o">=</code><code> </code><code class="n">PCA</code><code class="p">(</code><code class="n">n_components</code><code class="o">=</code><code class="mi">6</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">pca_market_sentiment</code><code> </code><code class="o">=</code><code> </code><code class="n">pca</code><code class="o">.</code><code class="n">fit_transform</code><code class="p">(</code><code class="n">firm_sentiment_std</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="k">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">Explained Variance Ratios per Component are:</code><code class="se">\n</code><code class="s1"> {}</code><code class="s1">'</code><code>\&#13;
</code><code>               </code><code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">pca</code><code class="o">.</code><code class="n">explained_variance_ratio_</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">Explained</code><code> </code><code class="n">Variance</code><code> </code><code class="n">Ratios</code><code> </code><code class="n">per</code><code> </code><code class="n">Component</code><code> </code><code class="n">are</code><code class="p">:</code><code>&#13;
</code><code>          </code><code class="p">[</code><code class="mf">0.35828322</code><code> </code><code class="mf">0.2752777</code><code>  </code><code class="mf">0.15343653</code><code> </code><code class="mf">0.12206041</code><code> </code><code class="mf">0.06681776</code><code> </code><code class="mf">0.02412438</code><code class="p">]</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">51</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">loadings_1</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">pca</code><code class="o">.</code><code class="n">components_</code><code class="o">.</code><code class="n">T</code><code> </code><code class="o">*</code><code>&#13;
</code><code>                                   </code><code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">pca</code><code class="o">.</code><code class="n">explained_variance_</code><code class="p">)</code><code class="p">,</code><code>&#13;
</code><code>                                   </code><code class="n">columns</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">PC1</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">PC2</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">PC3</code><code class="s1">'</code><code class="p">,</code><code>&#13;
</code><code>                                            </code><code class="s1">'</code><code class="s1">PC4</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">PC5</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">PC6</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>&#13;
</code><code>                                   </code><code class="n">index</code><code class="o">=</code><code class="n">firm_sentiment</code><code class="o">.</code><code class="n">columns</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO10-2" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO10-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>         </code><code class="n">loadings_1</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">51</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">PC1</code><code>       </code><code class="n">PC2</code><code>       </code><code class="n">PC3</code><code>       </code><code class="n">PC4</code><code>       </code><code class="n">PC5</code><code>       </code><code class="n">PC6</code><code>&#13;
</code><code>         </code><code class="n">p</code><code class="o">/</code><code class="n">e</code><code>           </code><code class="o">-</code><code class="mf">0.250786</code><code>  </code><code class="mf">0.326182</code><code>  </code><code class="mf">0.911665</code><code>  </code><code class="mf">0.056323</code><code>  </code><code class="mf">0.000583</code><code>&#13;
</code><code>          </code><code class="mf">0.021730</code><code>&#13;
</code><code>         </code><code class="n">turnover_rate</code><code> </code><code class="o">-</code><code class="mf">0.101554</code><code>  </code><code class="mf">0.854432</code><code> </code><code class="o">-</code><code class="mf">0.197381</code><code>  </code><code class="mf">0.201749</code><code>  </code><code class="mf">0.428911</code><code>&#13;
</code><code>          </code><code class="o">-</code><code class="mf">0.008421</code><code>&#13;
</code><code>         </code><code class="n">equity_share</code><code>  </code><code class="o">-</code><code class="mf">0.913620</code><code> </code><code class="o">-</code><code class="mf">0.162406</code><code> </code><code class="o">-</code><code class="mf">0.133783</code><code>  </code><code class="mf">0.224513</code><code> </code><code class="o">-</code><code class="mf">0.031672</code><code>&#13;
</code><code>          </code><code class="mf">0.271443</code><code>&#13;
</code><code>         </code><code class="n">cefd</code><code>           </code><code class="mf">0.639570</code><code> </code><code class="o">-</code><code class="mf">0.118671</code><code>  </code><code class="mf">0.038422</code><code>  </code><code class="mf">0.754467</code><code> </code><code class="o">-</code><code class="mf">0.100176</code><code>&#13;
</code><code>          </code><code class="mf">0.014146</code><code>&#13;
</code><code>         </code><code class="n">leverage</code><code>       </code><code class="mf">0.917298</code><code>  </code><code class="mf">0.098311</code><code>  </code><code class="mf">0.068633</code><code> </code><code class="o">-</code><code class="mf">0.264369</code><code>  </code><code class="mf">0.089224</code><code>&#13;
</code><code>          </code><code class="mf">0.265335</code><code>&#13;
</code><code>         </code><code class="n">bsi</code><code>            </code><code class="mf">0.006731</code><code>  </code><code class="mf">0.878526</code><code> </code><code class="o">-</code><code class="mf">0.173740</code><code> </code><code class="o">-</code><code class="mf">0.044127</code><code> </code><code class="o">-</code><code class="mf">0.446735</code><code>&#13;
</code><code>          </code><code class="mf">0.022520</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">52</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">df_loading1</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">loadings_1</code><code class="o">.</code><code class="n">mean</code><code class="p">(</code><code class="n">axis</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_corporate_governance_risk_measure__stock_price_crash_CO10-3" id="co_a_corporate_governance_risk_measure__stock_price_crash_CO10-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>         </code><code class="n">df_loading1</code><code>&#13;
</code><code class="n">Out</code><code class="p">[</code><code class="mi">52</code><code class="p">]</code><code class="p">:</code><code>                       </code><code class="mi">0</code><code>&#13;
</code><code>         </code><code class="n">p</code><code class="o">/</code><code class="n">e</code><code>            </code><code class="mf">0.177616</code><code>&#13;
</code><code>         </code><code class="n">turnover_rate</code><code>  </code><code class="mf">0.196289</code><code>&#13;
</code><code>         </code><code class="n">equity_share</code><code>  </code><code class="o">-</code><code class="mf">0.124254</code><code>&#13;
</code><code>         </code><code class="n">cefd</code><code>           </code><code class="mf">0.204626</code><code>&#13;
</code><code>         </code><code class="n">leverage</code><code>       </code><code class="mf">0.195739</code><code>&#13;
</code><code>         </code><code class="n">bsi</code><code>            </code><code class="mf">0.040529</code><code>&#13;
</code><code>&#13;
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">53</code><code class="p">]</code><code class="p">:</code><code> </code><code class="n">firm_sentiment</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">pca_market_sentiment</code><code class="p">,</code><code>&#13;
</code><code>                                              </code><code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">(</code><code class="n">df_loading1</code><code class="p">)</code><code class="p">)</code><code class="p">)</code><code>&#13;
</code><code>         </code><code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'</code><code class="s1">firm_sent</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">firm_sentiment</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO10-1" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO10-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Filling missing value with mean</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO10-2" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO10-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Calculating the loadings</p></dd>&#13;
<dt><a class="co" href="#co_a_corporate_governance_risk_measure__stock_price_crash_CO10-3" id="callout_a_corporate_governance_risk_measure__stock_price_crash_CO10-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Taking cross-sectional average of loadings</p></dd>&#13;
</dl>&#13;
&#13;
<p>Having obtained the loadings of the features, the result of the cross-sectional average of components produces the following result:</p>&#13;
<div class="less-left-margin" data-type="equation">&#13;
<math alttext="SENT i comma t equals 0.177 upper P slash upper E Subscript i comma t Baseline plus 0.196 TURN Subscript i comma t Baseline minus 0.124 EQS Subscript i comma t Baseline plus 0.204 CEFD Subscript i comma t Baseline plus 0.195 LEV Subscript i comma t Baseline plus 0.040 BSI Subscript i comma t Baseline" display="block">&#13;
  <mrow>&#13;
    <mtext>SENT</mtext>&#13;
    <mrow>&#13;
      <mi>i</mi>&#13;
      <mo>,</mo>&#13;
      <mi>t</mi>&#13;
    </mrow>&#13;
    <mo>=</mo>&#13;
    <mn>0</mn>&#13;
    <mo>.</mo>&#13;
    <mn>177</mn>&#13;
    <msub><mtext>P/E</mtext> <mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
    <mo>+</mo>&#13;
    <mn>0</mn>&#13;
    <mo>.</mo>&#13;
    <mn>196</mn>&#13;
    <msub><mtext>TURN</mtext> <mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
    <mo>-</mo>&#13;
    <mn>0</mn>&#13;
    <mo>.</mo>&#13;
    <mn>124</mn>&#13;
    <msub><mtext>EQS</mtext> <mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
    <mo>+</mo>&#13;
    <mn>0</mn>&#13;
    <mo>.</mo>&#13;
    <mn>204</mn>&#13;
    <msub><mtext>CEFD</mtext> <mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
    <mo>+</mo>&#13;
    <mn>0</mn>&#13;
    <mo>.</mo>&#13;
    <mn>195</mn>&#13;
    <msub><mtext>LEV</mtext> <mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
    <mo>+</mo>&#13;
    <mn>0</mn>&#13;
    <mo>.</mo>&#13;
    <mn>040</mn>&#13;
    <msub><mtext>BSI</mtext> <mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow> </msub>&#13;
  </mrow>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>The result implies that firm-specific sentiment is positively affected by all the variables except for the equity share. In addition, leverage and turnover rate have the largest impact on the firm-specific sentiment.</p>&#13;
&#13;
<p>We have one more step to go: interpret the logistic panel data analysis. Before that, the independent and dependent variables should be defined, and the necessary libraries are used to do so:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">54</code><code class="p">]:</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'log_size'</code><code class="p">]</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">log</code><code class="p">(</code><code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'at'</code><code class="p">])</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">55</code><code class="p">]:</code> <code class="n">merge_ret_bs2</code><code class="o">.</code><code class="n">set_index</code><code class="p">([</code><code class="s1">'TICKER'</code><code class="p">,</code> <code class="s1">'Date'</code><code class="p">],</code> <code class="n">inplace</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">56</code><code class="p">]:</code> <code class="n">X</code> <code class="o">=</code> <code class="p">(</code><code class="n">merge_ret_bs2</code><code class="p">[[</code><code class="s1">'log_size'</code><code class="p">,</code> <code class="s1">'rect'</code><code class="p">,</code> <code class="s1">'ppegt'</code><code class="p">,</code> <code class="s1">'dturn'</code><code class="p">,</code>&#13;
                         <code class="s1">'ncskew'</code><code class="p">,</code> <code class="s1">'residuals'</code><code class="p">,</code> <code class="s1">'RoA'</code><code class="p">,</code> <code class="s1">'annual_std'</code><code class="p">,</code>&#13;
                         <code class="s1">'firm_sent'</code><code class="p">]])</code><code class="o">.</code><code class="n">shift</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code>&#13;
         <code class="n">X</code><code class="p">[</code><code class="s1">'neg_outliers'</code><code class="p">]</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'neg_outliers'</code><code class="p">]</code></pre>&#13;
&#13;
<p>Logistic panel data analysis shows us which variables have a statistically significant relationship with the <code>neg_outliers</code>, the stock price crash measure obtained from the Elliptic Envelope algorithm. The result suggests that, aside from <code>ppegt</code> and <code>residuals</code>, all other variables are statistically significant at conventional confidence intervals. Specifically, <code>log_size</code>, <code>dturn</code>, <code>firm_sent</code>, and <code>annual_std</code> do trigger a crash.</p>&#13;
&#13;
<p>As is seen from the result, the coefficients of firm-specific investor sentiment index are positive, financially important, and statistically significant at 1% level. Literature suggests that, in times of high sentiment, under pressure of optimistic expectations, managers tend to accelerate good news but withhold bad news to maintain the positive environment (Bergman and Roychowdhury 2008). Thus, the result suggests a positive relationship between sentiment and crash risk.</p>&#13;
&#13;
<p>With all these variables showing a strong statistically-significant relation to <code>neg_outliers</code>, we are able to run a reliable predictive analysis:</p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">57</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">pyeconometrics.panel_discrete_models</code> <code class="kn">import</code> <code class="n">FixedEffectPanelModel</code>&#13;
         <code class="kn">from</code> <code class="nn">sklearn.model_selection</code> <code class="kn">import</code> <code class="n">train_test_split</code>&#13;
         <code class="kn">from</code> <code class="nn">sklearn.metrics</code> <code class="kn">import</code> <code class="n">accuracy_score</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">58</code><code class="p">]:</code> <code class="n">FE_ML</code> <code class="o">=</code> <code class="n">FixedEffectPanelModel</code><code class="p">()</code>&#13;
         <code class="n">FE_ML</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="s1">'neg_outliers'</code><code class="p">)</code>&#13;
         <code class="n">FE_ML</code><code class="o">.</code><code class="n">summary</code><code class="p">()</code>&#13;
    <code class="o">======================================================================</code>&#13;
    <code class="o">==========</code>&#13;
    <code class="n">Dep</code><code class="o">.</code> <code class="n">Variable</code><code class="p">:</code>                  <code class="n">neg_outliers</code>   <code class="n">Pseudo</code> <code class="n">R</code><code class="o">-</code><code class="n">squ</code><code class="o">.</code><code class="p">:</code>      <code class="mf">0.09611</code>&#13;
    <code class="n">Model</code><code class="p">:</code>             <code class="n">Panel</code> <code class="n">Fixed</code> <code class="n">Effects</code> <code class="n">Logit</code>   <code class="n">Log</code><code class="o">-</code><code class="n">Likelihood</code><code class="p">:</code>     <code class="o">-</code><code class="mf">83.035</code>&#13;
    <code class="n">Method</code><code class="p">:</code>                                  <code class="n">MLE</code>   <code class="n">LL</code><code class="o">-</code><code class="n">Null</code><code class="p">:</code>            <code class="o">-</code><code class="mf">91.864</code>&#13;
    <code class="n">No</code><code class="o">.</code> <code class="n">Observations</code><code class="p">:</code>                        <code class="mi">193</code>   <code class="n">LLR</code> <code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="p">:</code>          <code class="mf">0.061</code>&#13;
    <code class="n">Df</code> <code class="n">Model</code><code class="p">:</code>                                  <code class="mi">9</code>&#13;
&#13;
    <code class="n">Converged</code><code class="p">:</code>                                  <code class="bp">True</code>&#13;
&#13;
    <code class="o">======================================================================</code>&#13;
                        <code class="n">coef</code>  <code class="n">std</code> <code class="n">err</code>        <code class="n">t</code>    <code class="n">P</code><code class="o">&gt;|</code><code class="n">t</code><code class="o">|</code> <code class="p">[</code><code class="mf">95.0</code><code class="o">%</code> <code class="n">Conf</code><code class="o">.</code> <code class="n">Int</code><code class="o">.</code><code class="p">]</code>&#13;
    <code class="o">----------------------------------------------------------------------</code>&#13;
    <code class="n">_cons</code>                     <code class="o">-</code><code class="mf">2.5897</code>    <code class="mf">1.085</code>   <code class="o">-</code><code class="mf">2.387</code>    <code class="mf">0.008</code>    <code class="o">-</code><code class="mf">4.716</code>&#13;
    <code class="o">-</code><code class="mf">0.464</code>&#13;
    <code class="n">log_size</code>                   <code class="mf">0.1908</code>    <code class="mf">0.089</code>    <code class="mf">2.155</code>    <code class="mf">0.016</code>     <code class="mf">0.017</code>&#13;
    <code class="mf">0.364</code>&#13;
    <code class="n">rect</code>                      <code class="o">-</code><code class="mf">0.0000</code>    <code class="mf">0.000</code>   <code class="o">-</code><code class="mf">4.508</code>    <code class="mf">0.000</code>    <code class="o">-</code><code class="mf">0.000</code>&#13;
    <code class="o">-</code><code class="mf">0.000</code>&#13;
    <code class="n">ppegt</code>                     <code class="o">-</code><code class="mf">0.0000</code>    <code class="mf">0.000</code>   <code class="o">-</code><code class="mf">0.650</code>    <code class="mf">0.258</code>    <code class="o">-</code><code class="mf">0.000</code>&#13;
    <code class="mf">0.000</code>&#13;
    <code class="n">dturn</code>                      <code class="mf">0.0003</code>    <code class="mf">0.000</code>    <code class="mf">8.848</code>    <code class="mf">0.000</code>     <code class="mf">0.000</code>&#13;
    <code class="mf">0.000</code>&#13;
    <code class="n">ncskew</code>                    <code class="o">-</code><code class="mf">0.2156</code>    <code class="mf">0.089</code>   <code class="o">-</code><code class="mf">2.420</code>    <code class="mf">0.008</code>    <code class="o">-</code><code class="mf">0.390</code>&#13;
    <code class="o">-</code><code class="mf">0.041</code>&#13;
    <code class="n">residuals</code>                 <code class="o">-</code><code class="mf">0.3843</code>    <code class="mf">1.711</code>   <code class="o">-</code><code class="mf">0.225</code>    <code class="mf">0.411</code>    <code class="o">-</code><code class="mf">3.737</code>&#13;
    <code class="mf">2.968</code>&#13;
    <code class="n">RoA</code>                        <code class="mf">1.4897</code>    <code class="mf">1.061</code>    <code class="mf">1.404</code>    <code class="mf">0.080</code>    <code class="o">-</code><code class="mf">0.590</code>&#13;
    <code class="mf">3.569</code>&#13;
    <code class="n">annual_std</code>                 <code class="mf">1.9252</code>    <code class="mf">0.547</code>    <code class="mf">3.517</code>    <code class="mf">0.000</code>     <code class="mf">0.852</code>&#13;
    <code class="mf">2.998</code>&#13;
    <code class="n">firm_sent</code>                  <code class="mf">0.6847</code>    <code class="mf">0.151</code>    <code class="mf">4.541</code>    <code class="mf">0.000</code>     <code class="mf">0.389</code>&#13;
    <code class="mf">0.980</code>&#13;
    <code class="o">----------------------------------------------------------------------</code></pre>&#13;
&#13;
<p>For the sake of comparison, this time the dependent variable is replaced by <code>crash_risk</code>, which is of discrete type as well. Thanks to this comparison, we are able to compare the goodness of the model as well as likely predictive power. Given the goodness measure of our model, <math alttext="upper R squared">&#13;
  <msup><mi>R</mi> <mn>2</mn> </msup>&#13;
</math>, the model with a dependent variable of <code>neg_outliers</code> has higher explanatory power. However, please note that <math alttext="upper R squared">&#13;
  <msup><mi>R</mi> <mn>2</mn> </msup>&#13;
</math> is not the only metric used to compare the goodness of a model. As this discussion is beyond the scope of the book, I will not go into detail.</p>&#13;
&#13;
<p>Aside from that, what is apparent is signs of some estimated coefficients are different across these two models. For instance, according to the literature,&#13;
firm sentiment (<code>firm_sent</code>) is supposed to have a positive sign, as once investor sentiment surges, bad news hoarding behavior increases, leading to a&#13;
rise in the stock price crash risk.&#13;
These important observations are captured in the previous model, which contains our newly introduced dependent variable <code>neg_outliers</code>.&#13;
The model with <code>neg_outliers</code> yields better and more reliable predictions:<a data-primary="" data-startref="ix_stock_crash_logist_panel" data-type="indexterm" id="idm45737200234720"/><a data-primary="" data-startref="ix_log_panel_app" data-type="indexterm" id="idm45737200233872"/><a data-primary="" data-startref="ix_panel_data_price_crash" data-type="indexterm" id="idm45737200232928"/></p>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">59</code><code class="p">]:</code> <code class="k">del</code> <code class="n">X</code><code class="p">[</code><code class="s1">'neg_outliers'</code><code class="p">]</code>&#13;
         <code class="n">X</code><code class="p">[</code><code class="s1">'crash_risk'</code><code class="p">]</code> <code class="o">=</code> <code class="n">merge_ret_bs2</code><code class="p">[</code><code class="s1">'crash_risk'</code><code class="p">]</code>&#13;
&#13;
<code class="n">In</code> <code class="p">[</code><code class="mi">60</code><code class="p">]:</code> <code class="n">FE_crash</code> <code class="o">=</code> <code class="n">FixedEffectPanelModel</code><code class="p">()</code>&#13;
         <code class="n">FE_crash</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="s1">'crash_risk'</code><code class="p">)</code>&#13;
         <code class="n">FE_crash</code><code class="o">.</code><code class="n">summary</code><code class="p">()</code>&#13;
    <code class="o">======================================================================</code>&#13;
    <code class="n">Dep</code><code class="o">.</code> <code class="n">Variable</code><code class="p">:</code>                   <code class="n">crash_risk</code>   <code class="n">Pseudo</code> <code class="n">R</code><code class="o">-</code><code class="n">squ</code><code class="o">.</code><code class="p">:</code>   <code class="mf">0.05324</code>&#13;
    <code class="n">Model</code><code class="p">:</code>            <code class="n">Panel</code> <code class="n">Fixed</code> <code class="n">Effects</code> <code class="n">Logit</code>   <code class="n">Log</code><code class="o">-</code><code class="n">Likelihood</code><code class="p">:</code>  <code class="o">-</code><code class="mf">55.640</code>&#13;
    <code class="n">Method</code><code class="p">:</code>                                 <code class="n">MLE</code>   <code class="n">LL</code><code class="o">-</code><code class="n">Null</code><code class="p">:</code>         <code class="o">-</code><code class="mf">58.769</code>&#13;
    <code class="n">No</code><code class="o">.</code> <code class="n">Observations</code><code class="p">:</code>                       <code class="mi">193</code>   <code class="n">LLR</code> <code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="p">:</code>       <code class="mf">0.793</code>&#13;
    <code class="n">Df</code> <code class="n">Model</code><code class="p">:</code>                                 <code class="mi">9</code>&#13;
&#13;
    <code class="n">Converged</code><code class="p">:</code>                                  <code class="bp">True</code>&#13;
&#13;
    <code class="o">======================================================================</code>&#13;
                            <code class="n">coef</code>  <code class="n">std</code> <code class="n">err</code>        <code class="n">t</code>    <code class="n">P</code><code class="o">&gt;|</code><code class="n">t</code><code class="o">|</code> <code class="p">[</code><code class="mf">95.0</code><code class="o">%</code> <code class="n">Conf</code><code class="o">.</code> <code class="n">Int</code><code class="o">.</code><code class="p">]</code>&#13;
&#13;
    <code class="o">----------------------------------------------------------------------</code>&#13;
    <code class="n">_cons</code>                     <code class="o">-</code><code class="mf">3.1859</code>    <code class="mf">1.154</code>   <code class="o">-</code><code class="mf">2.762</code>    <code class="mf">0.003</code>    <code class="o">-</code><code class="mf">5.447</code>&#13;
    <code class="o">-</code><code class="mf">0.925</code>&#13;
    <code class="n">log_size</code>                   <code class="mf">0.2012</code>    <code class="mf">0.094</code>    <code class="mf">2.134</code>    <code class="mf">0.016</code>     <code class="mf">0.016</code>&#13;
    <code class="mf">0.386</code>&#13;
    <code class="n">rect</code>                      <code class="o">-</code><code class="mf">0.0000</code>    <code class="mf">0.000</code>   <code class="o">-</code><code class="mf">1.861</code>    <code class="mf">0.031</code>    <code class="o">-</code><code class="mf">0.000</code>&#13;
    <code class="mf">0.000</code>&#13;
    <code class="n">ppegt</code>                     <code class="o">-</code><code class="mf">0.0000</code>    <code class="mf">0.000</code>   <code class="o">-</code><code class="mf">0.638</code>    <code class="mf">0.262</code>    <code class="o">-</code><code class="mf">0.000</code>&#13;
    <code class="mf">0.000</code>&#13;
    <code class="n">dturn</code>                      <code class="mf">0.0001</code>    <code class="mf">0.000</code>    <code class="mf">2.882</code>    <code class="mf">0.002</code>     <code class="mf">0.000</code>&#13;
    <code class="mf">0.000</code>&#13;
    <code class="n">ncskew</code>                     <code class="mf">0.3840</code>    <code class="mf">0.114</code>    <code class="mf">3.367</code>    <code class="mf">0.000</code>     <code class="mf">0.160</code>&#13;
    <code class="mf">0.608</code>&#13;
    <code class="n">residuals</code>                  <code class="mf">3.3976</code>    <code class="mf">2.062</code>    <code class="mf">1.648</code>    <code class="mf">0.050</code>    <code class="o">-</code><code class="mf">0.644</code>&#13;
    <code class="mf">7.439</code>&#13;
    <code class="n">RoA</code>                        <code class="mf">2.5096</code>    <code class="mf">1.258</code>    <code class="mf">1.994</code>    <code class="mf">0.023</code>     <code class="mf">0.043</code>&#13;
    <code class="mf">4.976</code>&#13;
    <code class="n">annual_std</code>                 <code class="mf">2.4094</code>    <code class="mf">0.657</code>    <code class="mf">3.668</code>    <code class="mf">0.000</code>     <code class="mf">1.122</code>&#13;
    <code class="mf">3.697</code>&#13;
    <code class="n">firm_sent</code>                 <code class="o">-</code><code class="mf">0.0041</code>    <code class="mf">0.164</code>   <code class="o">-</code><code class="mf">0.025</code>    <code class="mf">0.490</code>    <code class="o">-</code><code class="mf">0.326</code>&#13;
    <code class="mf">0.318</code>&#13;
    <code class="o">----------------------------------------------------------------------</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Conclusion" data-type="sect1"><div class="sect1" id="idm45737201828544">&#13;
<h1>Conclusion</h1>&#13;
&#13;
<p>In this chapter, we learned how to detect&#13;
stock price crash using ML. Using the MCD method, negative anomalies in the market-adjusted firm-specific stock price returns were detected and defined as a stock price crash risk indicator. The results suggest that there is a positive relationship between sentiment and crash risk, indicating that during high sentiment times, under pressure of optimistic expectations, managers tend to withhold bad news, and this accumulated bad news leads to large declines.</p>&#13;
&#13;
<p>In addition, other stock price crash measures, namely NCSKEW, DUVOL, and crash risk, were also obtained. Of them, we used NCSKEW and crash risk in our analysis as the independent and dependent variables, respectively.</p>&#13;
&#13;
<p>The logistic panel analysis showed that the model with <code>neg_outliers</code> estimated coefficients with signs in conformity with the literature, making it more useful and also increasing the reliability of its predictive analysis compared to the one with <code>crash_risk</code>.<a data-primary="" data-startref="ix_stock_price_crash_ch9" data-type="indexterm" id="idm45737199947536"/></p>&#13;
&#13;
<p>In the next chapter, a brand-new and highly popular topic in finance circles will be introduced: <em>synthetic data generation</em> and its use in risk management.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="pagebreak-before less_space" data-pdf-bookmark="References" data-type="sect1"><div class="sect1" id="idm45737199945456">&#13;
<h1>References</h1>&#13;
&#13;
<p>Articles and books cited in this chapter:</p>&#13;
&#13;
<ul class="author-date-bib">&#13;
<li>&#13;
<p>Bae, Kee‚ÄêHong, Chanwoo Lim, and KC John Wei. 2006. ‚ÄúCorporate Governance and Conditional Skewness In The World‚Äôs Stock Markets.‚Äù <em>The Journal of Business</em> 79 (6): 2999-3028.</p>&#13;
</li>&#13;
<li>&#13;
<p>Bergman, Nittai K., and Sugata Roychowdhury. 2008. ‚ÄúInvestor Sentiment and Corporate Disclosure.‚Äù <em>Journal of Accounting Research</em> 46 (5): 1057-1083.</p>&#13;
</li>&#13;
<li>&#13;
<p>Bleck, Alexander, and Xuewen Liu. 2007. ‚ÄúMarket Transparency and The Accounting Regime.‚Äù <em>Journal of Accounting Research</em> 45 (2): 229-256.</p>&#13;
</li>&#13;
<li>&#13;
<p>Chen, Joseph, Harrison Hong, and Jeremy C. Stein. 2001. ‚ÄúForecasting Crashes: Trading Volume, Past Returns, and Conditional Skewness In Stock Prices.‚Äù <em>Journal of Financial Economics</em> 61 (3): 345-381.</p>&#13;
</li>&#13;
<li>&#13;
<p>Hubert, Mia, Michiel Debruyne, and Peter J. Rousseeuw. 2018. ‚ÄúMinimum Covariance Determinant and Extensions.‚Äù 2018. <em>Wiley Interdisciplinary Reviews: Computational Statistics</em> 10 (3): e1421.</p>&#13;
</li>&#13;
<li>&#13;
<p>Hutton, Amy P., Alan J. Marcus, and Hassan Tehranian. 2009. ‚ÄúOpaque Financial Reports, R2, and Crash Risk.‚Äù <em>Journal of Financial Economics</em> 94 (1): 67-86.</p>&#13;
</li>&#13;
<li>&#13;
<p>Hsiao, Cheng. 2014. <em>Analysis Of Panel Data</em>. Cambridge University Press.</p>&#13;
</li>&#13;
<li>&#13;
<p>Kim J. B., Li Y., and Zhang L. 2011. ‚ÄúCorporate Tax Avoidance and Stock Price Crash Risk: Firm-Level Analysis.‚Äù <em>Journal of Financial Economics</em> 100 (3): 639-662.</p>&#13;
</li>&#13;
<li>&#13;
<p>Kim, Jeong‚ÄêBon, and Liandong Zhang. 2014. ‚ÄúFinancial Reporting Opacity and Expected Crash Risk: Evidence From Implied Volatility Smirks.‚Äù <em>Contemporary Accounting Research</em> 31 (3): 851-875.</p>&#13;
</li>&#13;
<li>&#13;
<p>Jin, Li, and Stewart C. Myers. 2006. ‚ÄúR2 Around The World: New Theory and New Tests.‚Äù <em>Journal of Financial Economics</em> 79 (2): 257-292.</p>&#13;
</li>&#13;
<li>&#13;
<p>Finch, Holmes. 2012. ‚ÄúDistribution Of Variables By Method Of Outlier Detection.‚Äù <em>Frontiers in Psychology</em> (3): 211.</p>&#13;
</li>&#13;
<li>&#13;
<p>Wolfensohn, James. 1999. ‚ÄúThe Critical Study Of Corporate Governance Provisions In India.‚Äù <em>Financial Times</em> 25 (4). Retrieved from <a href="https://oreil.ly/EnLaQ"><em class="hyperlink">https://oreil.ly/EnLaQ</em></a>.</p>&#13;
</li>&#13;
<li>&#13;
<p>Shleifer, Andrei, and Robert W. Vishny. 1997. ‚ÄúA Survey Of Corporate Governance.‚Äù <em>The Journal of Finance</em> 52 (2): 737-783.</p>&#13;
</li>&#13;
<li>&#13;
<p>Ullah, Aman, ed. 1998. <em>Handbook Of Applied Economic Statistics</em>. Boca Raton: CRC Press.</p>&#13;
</li>&#13;
<li>&#13;
<p>Yin, Yugang, and Rongfu Tian. 2017. ‚ÄúInvestor Sentiment, Financial Report Quality and Stock Price Crash Risk: Role Of Short-Sales Constraints.‚Äù <em>Emerging Markets Finance and Trade</em> 53 (3): 493-510.</p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45737208073680"><sup><a href="ch09.html#idm45737208073680-marker">1</a></sup> A symmetric matrix with all positive eigenvalues is referred to as a <em>positive definite matrix</em>.</p></div></div></section></body></html>