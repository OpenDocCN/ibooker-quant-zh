# 序言

> 人工智能和机器学习反映了技术的自然演进，增强的计算能力使计算机能够处理大数据集并分析数据，以识别模式和异常值。
> 
> 黑石集团（2019 年）

金融建模有着悠久的历史，并完成了许多成功的任务，但同时也因模型缺乏*灵活性*和*包容性*而受到激烈批评。2007-2008 年的金融危机加剧了这场辩论，也为金融建模领域的创新和不同方法铺平了道路。

当然，金融危机并不是促使金融领域人工智能应用增长的唯一因素。数据的可用性和计算能力的增加是推动金融领域人工智能应用和加强研究的另外两大驱动力，始于上世纪 90 年代。

金融稳定委员会（2017 年）强调了这一事实的有效性：

> 许多人工智能和机器学习的应用或使用“案例”已经存在。这些使用案例的采用受到了供应因素的推动，如技术进步、金融部门数据和基础设施的可用性，以及需求因素，如盈利需求、与其他公司的竞争以及金融监管的要求。

作为金融建模的一个分支，金融风险管理随着人工智能的采用在金融决策过程中的角色不断增强而不断发展。在他著名的书中，博斯特罗姆（2014 年）指出人类历史上有两次重要的革命：农业革命和工业革命。这两次革命产生了如此深远的影响，以至于任何类似规模的第三次革命将在两周内使世界经济翻倍。更引人注目的是，如果第三次革命由人工智能完成，影响将更为深远。

因此，人们对通过利用大数据和理解风险过程的复杂结构来塑造金融风险管理的人工智能应用寄予了极高的期望，规模前所未有。

通过这项研究，我旨在填补关于基于机器学习的金融应用的空白，以便改进金融模型的预测和测量性能。参数模型存在低方差和高偏差的问题；机器学习模型以其灵活性可以解决这一问题。此外，金融领域一个常见的问题是数据分布的变化总是对模型结果的可靠性构成威胁，但机器学习模型可以自适应地变化模式，使模型更好地拟合。因此，在金融领域存在着对可应用机器学习模型的巨大需求和需求，而这本书的主要区别在于包括全新的基于机器学习的金融风险管理建模方法。

简言之，本书旨在转变当前以参数模型为基础的金融风险管理局面。这种转变的主要动机是基于机器学习模型的高精度金融模型的最新发展。因此，本书适合那些在金融和机器学习方面有一些初步知识的人，我只是简要解释了这些主题。

因此，本书的目标读者包括但不限于金融风险分析师、金融工程师、风险协调员、风险建模师、模型验证员、量化风险分析师、投资组合分析员以及对金融和数据科学感兴趣的人士。

鉴于目标读者的背景，具备金融和数据科学初级水平的知识将使您能够从本书中获益最多。然而，并不意味着来自不同背景的人士不能理解本书的主题。只要花足够的时间并参考本书以外的其他金融和数据科学书籍，不同背景的读者也能掌握这些概念。

本书共有 10 章：

第一章，“风险管理基础”

本章介绍了风险管理的主要概念。在定义风险和风险类型（如市场风险、信用风险、操作风险和流动性风险）之后，进行了讨论。解释了风险管理，包括其重要性以及如何用于减少损失。还讨论了可以解决市场失灵的不对称信息，重点讨论了信息不对称和逆向选择。

第二章，“时间序列建模介绍”

本章展示了使用传统模型进行时间序列应用，即移动平均模型、自回归模型和自回归积分移动平均模型。我们学习如何使用 API 访问金融数据以及如何应用它。本章的主要目的是为比较传统时间序列方法与时间序列建模的最新发展提供一个基准，这是下一章的主要焦点。

第三章，“时间序列建模的深度学习”

本章介绍了用于时间序列建模的深度学习工具。循环神经网络和长短期记忆是我们能够处理具有时间维度数据的两种方法。本章还对深度学习模型在时间序列建模中的适用性留下了深刻印象。

第四章，“基于机器学习的波动率预测”

金融市场的增强整合导致金融市场长期不确定性的增加，这进一步突显了波动性的重要性。波动性用于衡量风险程度，这是金融领域的主要任务之一。本章讨论了基于支持向量回归、神经网络、深度学习和贝叶斯方法的新型波动性建模。为了比较性能，还采用了传统的 ARCH 和 GARCH 类型模型。

第五章，“建模市场风险”

在这里，采用基于机器学习的模型来提升传统市场风险模型的估算性能，即价值风险（VaR）和预期损失（ES）。VaR 是一种定量方法，用于衡量由于市场波动而导致的公允价值潜在损失，该损失在定义的时间段内且在定义的置信水平下不会超过。而 ES 则关注分布尾部，指的是大额和意外损失。VaR 模型使用去噪协方差矩阵进行开发，而 ES 则通过整合数据的流动性维度进行开发。

第六章，“信贷风险估计”

本章介绍了一种基于全面的机器学习方法来估计信贷风险。机器学习模型基于过去的信贷信息以及其他数据进行应用。方法始于风险分桶，这是巴塞尔协议建议的，并继续使用不同的模型：贝叶斯估计、马尔可夫链模型、支持向量分类、随机森林、神经网络和深度学习。在章节的最后部分，将比较这些模型的性能。

第七章，“流动性建模”

在本章中，高斯混合模型用于对被认为是风险管理中被忽视的流动性进行建模。该模型使我们能够整合流动性代理的不同方面，以便更稳健地捕捉流动性对金融风险的影响。

第八章，“建模操作风险”

本章涵盖了操作风险，这可能导致失败，主要是由于公司内部的弱点。操作风险的几个来源中，欺诈风险是最耗时且对公司运营最为有害的之一。在这里，我们将主要关注欺诈，并开发新的方法来基于机器学习模型实现更好的欺诈应用性能。

第九章，“企业治理风险度量：股价暴跌”

本章介绍了一种全新的建模企业治理风险的方法：股价暴跌。许多研究发现股价暴跌与企业治理之间存在实证联系。本章尝试通过最小协方差行列式模型揭示企业治理风险组成部分与股价暴跌之间的关系。

第十章，“金融中的合成数据生成和隐马尔可夫模型”

在这里，我们使用合成数据来估算不同的金融风险。本章的目的是突出合成数据的出现，这有助于我们减少有限历史数据的影响。合成数据使我们能够拥有足够大且高质量的数据，从而提高模型的质量。

# 本书使用的约定

本书使用以下排版约定：

*斜体*

表示新术语、网址、电子邮件地址、文件名和文件扩展名。

`Constant width`

用于程序清单，以及段落内引用程序元素，例如变量或函数名称、数据库、数据类型、环境变量、语句和关键字。

**`Constant width bold`**

显示用户应按照字面意义输入的命令或其他文本。

*`Constant width italic`*

显示应由用户提供值或由上下文确定的值的文本。

###### 注意

此元素表示一般注意事项。

###### 警告

此元素表示警告或注意。

# 使用代码示例

附加材料（代码示例、练习等）可在[*https://github.com/abdullahkarasan/mlfrm*](https://github.com/abdullahkarasan/mlfrm)下载。

如果您有技术问题或在使用代码示例时遇到问题，请发送电子邮件至*bookquestions@oreilly.com*。

本书旨在帮助您完成工作。一般情况下，如果本书提供示例代码，则可以在您的程序和文档中使用它。除非您复制了代码的大部分内容，否则无需联系我们请求许可。例如，编写使用本书中数个代码块的程序不需要许可。销售或分发 O'Reilly 图书的示例代码需要许可。引用本书回答问题并引用示例代码不需要许可。将本书中大量示例代码整合到产品文档中需要许可。

我们感谢，但不需要署名。署名通常包括标题、作者、出版商和 ISBN。例如：“*Python 金融风险管理机器学习* by Abdullah Karasan（O’Reilly）。版权 2022 Abdullah Karasan，978-1-492-08525-6。”

如果您认为您对代码示例的使用超出了合理使用范围或上述许可，请随时通过*permissions@oreilly.com*与我们联系。

# O’Reilly 在线学习

###### 注意

超过 40 年来，[*O’Reilly Media*](http://oreilly.com)为企业的成功提供技术和业务培训、知识和洞察。

我们独特的专家和创新者网络通过图书、文章和我们的在线学习平台分享他们的知识和专长。O’Reilly 的在线学习平台让您随时访问现场培训课程、深度学习路径、互动编码环境，以及来自 O’Reilly 和其他 200 多家出版商的大量文本和视频。有关更多信息，请访问[*http://oreilly.com*](http://oreilly.com)。

# 如何联系我们

请将有关此书的评论和问题发送给出版商：

+   O’Reilly Media, Inc.

+   1005 Gravenstein Highway North

+   Sebastopol, CA 95472

+   800-998-9938（美国或加拿大）

+   707-829-0515（国际或本地）

+   707-829-0104（传真）

我们有这本书的网页，列出勘误、示例和任何额外信息。您可以访问[*https://oreil.ly/ml-for-fin-risk-mgmt*](https://oreil.ly/ml-for-fin-risk-mgmt)。

发送邮件至*bookquestions@oreilly.com*评论或询问有关此书的技术问题。

有关我们的图书和课程的新闻和信息，请访问[*http://oreilly.com*](http://oreilly.com)。

在 Facebook 上找到我们：[*http://facebook.com/oreilly*](http://facebook.com/oreilly)。

在 Twitter 上关注我们：[*http://twitter.com/oreillymedia*](http://twitter.com/oreillymedia)。

在 YouTube 上关注我们：[*http://www.youtube.com/oreillymedia*](http://www.youtube.com/oreillymedia)。

# 致谢

决定写这本书并非一时冲动。我觉得缺乏涵盖主要金融风险管理模型与机器学习模型的源资料。这本书是将机器学习模型应用于金融风险管理问题的努力。我得出结论，这本书应该从各个角度有所不同，如提供理论和实证方法，并包含所有可复制的代码。当我与 O’Reilly 的 Michelle Smith 分享这个想法时，得到了她的认可和持续的鼓励。Michelle 对这个项目寄予厚望，并在整个过程中给予了支持，对此我非常感激。

随着书的新章节到来，与我的编辑米歇尔·克罗宁（Michele Cronin）举行的信息丰富且有趣的每周会议使我保持在正确的轨道上，并帮助我获得编辑视角。随着进展，每一章都带来了新的挑战，需要不懈的日夜来应对。然而，我花费的时间越多，发现不准确、错别字和其他类型错误就越困难。这正是技术审阅者们宝贵的反馈发挥作用的时候。我要感谢梅赫梅特·本图尔克（Mehmet Benturk）、哈里奥姆·塔特萨特（Hariom Tatsat）、艾萨克·雷亚（Isaac Rhea）、迪米特里·比安科（Dimitri Bianco）、麦克莱恩·马歇尔（McKlayne Marshall）和迈克尔·谢勒（Michael Shearer）为使这本书成为今天的样子所付出的努力。

另外，我要感谢丹尼·埃尔凡鲍姆（Danny Elfanbaum）和兰迪·巴拉班（Randy Balaban）对文本一致性的迅速和有益的评论。经历了一个漫长而曲折的一年后，我终于完成了这段让人疲惫但又启发人的人生里程碑，充满希望，希望这本书能为那些希望在金融中学习机器学习的人指引道路。

我要向那些为这本书作出贡献的人表达我最深的感激之情。
